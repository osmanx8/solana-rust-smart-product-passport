var ti=Object.defineProperty;var ni=(s,e,t)=>e in s?ti(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var an=(s,e,t)=>(ni(s,typeof e!="symbol"?e+"":e,t),t);import{r as reactExports,a as reactDomExports,g as getAugmentedNamespace,c as commonjsGlobal,b as getDefaultExportFromCjs$1,R as React,d as React$1}from"./vendor-444b8e6b.js";function _mergeNamespaces(s,e){for(var t=0;t<e.length;t++){const o=e[t];if(typeof o!="string"&&!Array.isArray(o)){for(const a in o)if(a!=="default"&&!(a in s)){const c=Object.getOwnPropertyDescriptor(o,a);c&&Object.defineProperty(s,a,c.get?c:{enumerable:!0,get:()=>o[a]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function t(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(a){if(a.ep)return;a.ep=!0;const c=t(a);fetch(a.href,c)}})();var jsxRuntime={exports:{}},reactJsxRuntime_production_min={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m$1=Object.prototype.hasOwnProperty,n=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(s,e,t){var o,a={},c=null,d=null;t!==void 0&&(c=""+t),e.key!==void 0&&(c=""+e.key),e.ref!==void 0&&(d=e.ref);for(o in e)m$1.call(e,o)&&!p.hasOwnProperty(o)&&(a[o]=e[o]);if(s&&s.defaultProps)for(o in e=s.defaultProps,e)a[o]===void 0&&(a[o]=e[o]);return{$$typeof:k,type:s,key:c,ref:d,props:a,_owner:n.current}}reactJsxRuntime_production_min.Fragment=l;reactJsxRuntime_production_min.jsx=q;reactJsxRuntime_production_min.jsxs=q;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},m=reactDomExports;client.createRoot=m.createRoot,client.hydrateRoot=m.hydrateRoot;var buffer={},base64Js={};base64Js.byteLength=byteLength;var toByteArray_1=base64Js.toByteArray=toByteArray,fromByteArray_1=base64Js.fromByteArray=fromByteArray,lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i$1=0,len=code.length;i$1<len;++i$1)lookup[i$1]=code[i$1],revLookup[code.charCodeAt(i$1)]=i$1;revLookup["-".charCodeAt(0)]=62;revLookup["_".charCodeAt(0)]=63;function getLens(s){var e=s.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=s.indexOf("=");t===-1&&(t=e);var o=t===e?0:4-t%4;return[t,o]}function byteLength(s){var e=getLens(s),t=e[0],o=e[1];return(t+o)*3/4-o}function _byteLength(s,e,t){return(e+t)*3/4-t}function toByteArray(s){var e,t=getLens(s),o=t[0],a=t[1],c=new Arr(_byteLength(s,o,a)),d=0,g=a>0?o-4:o,y;for(y=0;y<g;y+=4)e=revLookup[s.charCodeAt(y)]<<18|revLookup[s.charCodeAt(y+1)]<<12|revLookup[s.charCodeAt(y+2)]<<6|revLookup[s.charCodeAt(y+3)],c[d++]=e>>16&255,c[d++]=e>>8&255,c[d++]=e&255;return a===2&&(e=revLookup[s.charCodeAt(y)]<<2|revLookup[s.charCodeAt(y+1)]>>4,c[d++]=e&255),a===1&&(e=revLookup[s.charCodeAt(y)]<<10|revLookup[s.charCodeAt(y+1)]<<4|revLookup[s.charCodeAt(y+2)]>>2,c[d++]=e>>8&255,c[d++]=e&255),c}function tripletToBase64(s){return lookup[s>>18&63]+lookup[s>>12&63]+lookup[s>>6&63]+lookup[s&63]}function encodeChunk(s,e,t){for(var o,a=[],c=e;c<t;c+=3)o=(s[c]<<16&16711680)+(s[c+1]<<8&65280)+(s[c+2]&255),a.push(tripletToBase64(o));return a.join("")}function fromByteArray(s){for(var e,t=s.length,o=t%3,a=[],c=16383,d=0,g=t-o;d<g;d+=c)a.push(encodeChunk(s,d,d+c>g?g:d+c));return o===1?(e=s[t-1],a.push(lookup[e>>2]+lookup[e<<4&63]+"==")):o===2&&(e=(s[t-2]<<8)+s[t-1],a.push(lookup[e>>10]+lookup[e>>4&63]+lookup[e<<2&63]+"=")),a.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(s,e,t,o,a){var c,d,g=a*8-o-1,y=(1<<g)-1,_=y>>1,E=-7,S=t?a-1:0,A=t?-1:1,C=s[e+S];for(S+=A,c=C&(1<<-E)-1,C>>=-E,E+=g;E>0;c=c*256+s[e+S],S+=A,E-=8);for(d=c&(1<<-E)-1,c>>=-E,E+=o;E>0;d=d*256+s[e+S],S+=A,E-=8);if(c===0)c=1-_;else{if(c===y)return d?NaN:(C?-1:1)*(1/0);d=d+Math.pow(2,o),c=c-_}return(C?-1:1)*d*Math.pow(2,c-o)};ieee754.write=function(s,e,t,o,a,c){var d,g,y,_=c*8-a-1,E=(1<<_)-1,S=E>>1,A=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=o?0:c-1,N=o?1:-1,O=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(g=isNaN(e)?1:0,d=E):(d=Math.floor(Math.log(e)/Math.LN2),e*(y=Math.pow(2,-d))<1&&(d--,y*=2),d+S>=1?e+=A/y:e+=A*Math.pow(2,1-S),e*y>=2&&(d++,y/=2),d+S>=E?(g=0,d=E):d+S>=1?(g=(e*y-1)*Math.pow(2,a),d=d+S):(g=e*Math.pow(2,S-1)*Math.pow(2,a),d=0));a>=8;s[t+C]=g&255,C+=N,g/=256,a-=8);for(d=d<<a|g,_+=a;_>0;s[t+C]=d&255,C+=N,d/=256,_-=8);s[t+C-N]|=O*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(s){const e=base64Js,t=ieee754,o=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=g,s.SlowBuffer=j,s.INSPECT_MAX_BYTES=50;const a=2147483647;s.kMaxLength=a,g.TYPED_ARRAY_SUPPORT=c(),!g.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const te=new Uint8Array(1),U={foo:function(){return 42}};return Object.setPrototypeOf(U,Uint8Array.prototype),Object.setPrototypeOf(te,U),te.foo()===42}catch{return!1}}Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.buffer}}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(g.isBuffer(this))return this.byteOffset}});function d(te){if(te>a)throw new RangeError('The value "'+te+'" is invalid for option "size"');const U=new Uint8Array(te);return Object.setPrototypeOf(U,g.prototype),U}function g(te,U,$){if(typeof te=="number"){if(typeof U=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return S(te)}return y(te,U,$)}g.poolSize=8192;function y(te,U,$){if(typeof te=="string")return A(te,U);if(ArrayBuffer.isView(te))return N(te);if(te==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof te);if(Ge(te,ArrayBuffer)||te&&Ge(te.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Ge(te,SharedArrayBuffer)||te&&Ge(te.buffer,SharedArrayBuffer)))return O(te,U,$);if(typeof te=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ae=te.valueOf&&te.valueOf();if(ae!=null&&ae!==te)return g.from(ae,U,$);const be=I(te);if(be)return be;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof te[Symbol.toPrimitive]=="function")return g.from(te[Symbol.toPrimitive]("string"),U,$);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof te)}g.from=function(te,U,$){return y(te,U,$)},Object.setPrototypeOf(g.prototype,Uint8Array.prototype),Object.setPrototypeOf(g,Uint8Array);function _(te){if(typeof te!="number")throw new TypeError('"size" argument must be of type number');if(te<0)throw new RangeError('The value "'+te+'" is invalid for option "size"')}function E(te,U,$){return _(te),te<=0?d(te):U!==void 0?typeof $=="string"?d(te).fill(U,$):d(te).fill(U):d(te)}g.alloc=function(te,U,$){return E(te,U,$)};function S(te){return _(te),d(te<0?0:P(te)|0)}g.allocUnsafe=function(te){return S(te)},g.allocUnsafeSlow=function(te){return S(te)};function A(te,U){if((typeof U!="string"||U==="")&&(U="utf8"),!g.isEncoding(U))throw new TypeError("Unknown encoding: "+U);const $=B(te,U)|0;let ae=d($);const be=ae.write(te,U);return be!==$&&(ae=ae.slice(0,be)),ae}function C(te){const U=te.length<0?0:P(te.length)|0,$=d(U);for(let ae=0;ae<U;ae+=1)$[ae]=te[ae]&255;return $}function N(te){if(Ge(te,Uint8Array)){const U=new Uint8Array(te);return O(U.buffer,U.byteOffset,U.byteLength)}return C(te)}function O(te,U,$){if(U<0||te.byteLength<U)throw new RangeError('"offset" is outside of buffer bounds');if(te.byteLength<U+($||0))throw new RangeError('"length" is outside of buffer bounds');let ae;return U===void 0&&$===void 0?ae=new Uint8Array(te):$===void 0?ae=new Uint8Array(te,U):ae=new Uint8Array(te,U,$),Object.setPrototypeOf(ae,g.prototype),ae}function I(te){if(g.isBuffer(te)){const U=P(te.length)|0,$=d(U);return $.length===0||te.copy($,0,0,U),$}if(te.length!==void 0)return typeof te.length!="number"||He(te.length)?d(0):C(te);if(te.type==="Buffer"&&Array.isArray(te.data))return C(te.data)}function P(te){if(te>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return te|0}function j(te){return+te!=te&&(te=0),g.alloc(+te)}g.isBuffer=function(U){return U!=null&&U._isBuffer===!0&&U!==g.prototype},g.compare=function(U,$){if(Ge(U,Uint8Array)&&(U=g.from(U,U.offset,U.byteLength)),Ge($,Uint8Array)&&($=g.from($,$.offset,$.byteLength)),!g.isBuffer(U)||!g.isBuffer($))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(U===$)return 0;let ae=U.length,be=$.length;for(let Se=0,Ae=Math.min(ae,be);Se<Ae;++Se)if(U[Se]!==$[Se]){ae=U[Se],be=$[Se];break}return ae<be?-1:be<ae?1:0},g.isEncoding=function(U){switch(String(U).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(U,$){if(!Array.isArray(U))throw new TypeError('"list" argument must be an Array of Buffers');if(U.length===0)return g.alloc(0);let ae;if($===void 0)for($=0,ae=0;ae<U.length;++ae)$+=U[ae].length;const be=g.allocUnsafe($);let Se=0;for(ae=0;ae<U.length;++ae){let Ae=U[ae];if(Ge(Ae,Uint8Array))Se+Ae.length>be.length?(g.isBuffer(Ae)||(Ae=g.from(Ae)),Ae.copy(be,Se)):Uint8Array.prototype.set.call(be,Ae,Se);else if(g.isBuffer(Ae))Ae.copy(be,Se);else throw new TypeError('"list" argument must be an Array of Buffers');Se+=Ae.length}return be};function B(te,U){if(g.isBuffer(te))return te.length;if(ArrayBuffer.isView(te)||Ge(te,ArrayBuffer))return te.byteLength;if(typeof te!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof te);const $=te.length,ae=arguments.length>2&&arguments[2]===!0;if(!ae&&$===0)return 0;let be=!1;for(;;)switch(U){case"ascii":case"latin1":case"binary":return $;case"utf8":case"utf-8":return gt(te).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $*2;case"hex":return $>>>1;case"base64":return ue(te).length;default:if(be)return ae?-1:gt(te).length;U=(""+U).toLowerCase(),be=!0}}g.byteLength=B;function H(te,U,$){let ae=!1;if((U===void 0||U<0)&&(U=0),U>this.length||(($===void 0||$>this.length)&&($=this.length),$<=0)||($>>>=0,U>>>=0,$<=U))return"";for(te||(te="utf8");;)switch(te){case"hex":return ee(this,U,$);case"utf8":case"utf-8":return R(this,U,$);case"ascii":return Y(this,U,$);case"latin1":case"binary":return W(this,U,$);case"base64":return V(this,U,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,U,$);default:if(ae)throw new TypeError("Unknown encoding: "+te);te=(te+"").toLowerCase(),ae=!0}}g.prototype._isBuffer=!0;function se(te,U,$){const ae=te[U];te[U]=te[$],te[$]=ae}g.prototype.swap16=function(){const U=this.length;if(U%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let $=0;$<U;$+=2)se(this,$,$+1);return this},g.prototype.swap32=function(){const U=this.length;if(U%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let $=0;$<U;$+=4)se(this,$,$+3),se(this,$+1,$+2);return this},g.prototype.swap64=function(){const U=this.length;if(U%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let $=0;$<U;$+=8)se(this,$,$+7),se(this,$+1,$+6),se(this,$+2,$+5),se(this,$+3,$+4);return this},g.prototype.toString=function(){const U=this.length;return U===0?"":arguments.length===0?R(this,0,U):H.apply(this,arguments)},g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=function(U){if(!g.isBuffer(U))throw new TypeError("Argument must be a Buffer");return this===U?!0:g.compare(this,U)===0},g.prototype.inspect=function(){let U="";const $=s.INSPECT_MAX_BYTES;return U=this.toString("hex",0,$).replace(/(.{2})/g,"$1 ").trim(),this.length>$&&(U+=" ... "),"<Buffer "+U+">"},o&&(g.prototype[o]=g.prototype.inspect),g.prototype.compare=function(U,$,ae,be,Se){if(Ge(U,Uint8Array)&&(U=g.from(U,U.offset,U.byteLength)),!g.isBuffer(U))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof U);if($===void 0&&($=0),ae===void 0&&(ae=U?U.length:0),be===void 0&&(be=0),Se===void 0&&(Se=this.length),$<0||ae>U.length||be<0||Se>this.length)throw new RangeError("out of range index");if(be>=Se&&$>=ae)return 0;if(be>=Se)return-1;if($>=ae)return 1;if($>>>=0,ae>>>=0,be>>>=0,Se>>>=0,this===U)return 0;let Ae=Se-be,Ie=ae-$;const $e=Math.min(Ae,Ie),je=this.slice(be,Se),lt=U.slice($,ae);for(let ht=0;ht<$e;++ht)if(je[ht]!==lt[ht]){Ae=je[ht],Ie=lt[ht];break}return Ae<Ie?-1:Ie<Ae?1:0};function oe(te,U,$,ae,be){if(te.length===0)return-1;if(typeof $=="string"?(ae=$,$=0):$>2147483647?$=2147483647:$<-2147483648&&($=-2147483648),$=+$,He($)&&($=be?0:te.length-1),$<0&&($=te.length+$),$>=te.length){if(be)return-1;$=te.length-1}else if($<0)if(be)$=0;else return-1;if(typeof U=="string"&&(U=g.from(U,ae)),g.isBuffer(U))return U.length===0?-1:Q(te,U,$,ae,be);if(typeof U=="number")return U=U&255,typeof Uint8Array.prototype.indexOf=="function"?be?Uint8Array.prototype.indexOf.call(te,U,$):Uint8Array.prototype.lastIndexOf.call(te,U,$):Q(te,[U],$,ae,be);throw new TypeError("val must be string, number or Buffer")}function Q(te,U,$,ae,be){let Se=1,Ae=te.length,Ie=U.length;if(ae!==void 0&&(ae=String(ae).toLowerCase(),ae==="ucs2"||ae==="ucs-2"||ae==="utf16le"||ae==="utf-16le")){if(te.length<2||U.length<2)return-1;Se=2,Ae/=2,Ie/=2,$/=2}function $e(lt,ht){return Se===1?lt[ht]:lt.readUInt16BE(ht*Se)}let je;if(be){let lt=-1;for(je=$;je<Ae;je++)if($e(te,je)===$e(U,lt===-1?0:je-lt)){if(lt===-1&&(lt=je),je-lt+1===Ie)return lt*Se}else lt!==-1&&(je-=je-lt),lt=-1}else for($+Ie>Ae&&($=Ae-Ie),je=$;je>=0;je--){let lt=!0;for(let ht=0;ht<Ie;ht++)if($e(te,je+ht)!==$e(U,ht)){lt=!1;break}if(lt)return je}return-1}g.prototype.includes=function(U,$,ae){return this.indexOf(U,$,ae)!==-1},g.prototype.indexOf=function(U,$,ae){return oe(this,U,$,ae,!0)},g.prototype.lastIndexOf=function(U,$,ae){return oe(this,U,$,ae,!1)};function fe(te,U,$,ae){$=Number($)||0;const be=te.length-$;ae?(ae=Number(ae),ae>be&&(ae=be)):ae=be;const Se=U.length;ae>Se/2&&(ae=Se/2);let Ae;for(Ae=0;Ae<ae;++Ae){const Ie=parseInt(U.substr(Ae*2,2),16);if(He(Ie))return Ae;te[$+Ae]=Ie}return Ae}function Z(te,U,$,ae){return _e(gt(U,te.length-$),te,$,ae)}function ce(te,U,$,ae){return _e(et(U),te,$,ae)}function ge(te,U,$,ae){return _e(ue(U),te,$,ae)}function me(te,U,$,ae){return _e(he(U,te.length-$),te,$,ae)}g.prototype.write=function(U,$,ae,be){if($===void 0)be="utf8",ae=this.length,$=0;else if(ae===void 0&&typeof $=="string")be=$,ae=this.length,$=0;else if(isFinite($))$=$>>>0,isFinite(ae)?(ae=ae>>>0,be===void 0&&(be="utf8")):(be=ae,ae=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Se=this.length-$;if((ae===void 0||ae>Se)&&(ae=Se),U.length>0&&(ae<0||$<0)||$>this.length)throw new RangeError("Attempt to write outside buffer bounds");be||(be="utf8");let Ae=!1;for(;;)switch(be){case"hex":return fe(this,U,$,ae);case"utf8":case"utf-8":return Z(this,U,$,ae);case"ascii":case"latin1":case"binary":return ce(this,U,$,ae);case"base64":return ge(this,U,$,ae);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,U,$,ae);default:if(Ae)throw new TypeError("Unknown encoding: "+be);be=(""+be).toLowerCase(),Ae=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(te,U,$){return U===0&&$===te.length?e.fromByteArray(te):e.fromByteArray(te.slice(U,$))}function R(te,U,$){$=Math.min(te.length,$);const ae=[];let be=U;for(;be<$;){const Se=te[be];let Ae=null,Ie=Se>239?4:Se>223?3:Se>191?2:1;if(be+Ie<=$){let $e,je,lt,ht;switch(Ie){case 1:Se<128&&(Ae=Se);break;case 2:$e=te[be+1],($e&192)===128&&(ht=(Se&31)<<6|$e&63,ht>127&&(Ae=ht));break;case 3:$e=te[be+1],je=te[be+2],($e&192)===128&&(je&192)===128&&(ht=(Se&15)<<12|($e&63)<<6|je&63,ht>2047&&(ht<55296||ht>57343)&&(Ae=ht));break;case 4:$e=te[be+1],je=te[be+2],lt=te[be+3],($e&192)===128&&(je&192)===128&&(lt&192)===128&&(ht=(Se&15)<<18|($e&63)<<12|(je&63)<<6|lt&63,ht>65535&&ht<1114112&&(Ae=ht))}}Ae===null?(Ae=65533,Ie=1):Ae>65535&&(Ae-=65536,ae.push(Ae>>>10&1023|55296),Ae=56320|Ae&1023),ae.push(Ae),be+=Ie}return z(ae)}const L=4096;function z(te){const U=te.length;if(U<=L)return String.fromCharCode.apply(String,te);let $="",ae=0;for(;ae<U;)$+=String.fromCharCode.apply(String,te.slice(ae,ae+=L));return $}function Y(te,U,$){let ae="";$=Math.min(te.length,$);for(let be=U;be<$;++be)ae+=String.fromCharCode(te[be]&127);return ae}function W(te,U,$){let ae="";$=Math.min(te.length,$);for(let be=U;be<$;++be)ae+=String.fromCharCode(te[be]);return ae}function ee(te,U,$){const ae=te.length;(!U||U<0)&&(U=0),(!$||$<0||$>ae)&&($=ae);let be="";for(let Se=U;Se<$;++Se)be+=Ve[te[Se]];return be}function ie(te,U,$){const ae=te.slice(U,$);let be="";for(let Se=0;Se<ae.length-1;Se+=2)be+=String.fromCharCode(ae[Se]+ae[Se+1]*256);return be}g.prototype.slice=function(U,$){const ae=this.length;U=~~U,$=$===void 0?ae:~~$,U<0?(U+=ae,U<0&&(U=0)):U>ae&&(U=ae),$<0?($+=ae,$<0&&($=0)):$>ae&&($=ae),$<U&&($=U);const be=this.subarray(U,$);return Object.setPrototypeOf(be,g.prototype),be};function X(te,U,$){if(te%1!==0||te<0)throw new RangeError("offset is not uint");if(te+U>$)throw new RangeError("Trying to access beyond buffer length")}g.prototype.readUintLE=g.prototype.readUIntLE=function(U,$,ae){U=U>>>0,$=$>>>0,ae||X(U,$,this.length);let be=this[U],Se=1,Ae=0;for(;++Ae<$&&(Se*=256);)be+=this[U+Ae]*Se;return be},g.prototype.readUintBE=g.prototype.readUIntBE=function(U,$,ae){U=U>>>0,$=$>>>0,ae||X(U,$,this.length);let be=this[U+--$],Se=1;for(;$>0&&(Se*=256);)be+=this[U+--$]*Se;return be},g.prototype.readUint8=g.prototype.readUInt8=function(U,$){return U=U>>>0,$||X(U,1,this.length),this[U]},g.prototype.readUint16LE=g.prototype.readUInt16LE=function(U,$){return U=U>>>0,$||X(U,2,this.length),this[U]|this[U+1]<<8},g.prototype.readUint16BE=g.prototype.readUInt16BE=function(U,$){return U=U>>>0,$||X(U,2,this.length),this[U]<<8|this[U+1]},g.prototype.readUint32LE=g.prototype.readUInt32LE=function(U,$){return U=U>>>0,$||X(U,4,this.length),(this[U]|this[U+1]<<8|this[U+2]<<16)+this[U+3]*16777216},g.prototype.readUint32BE=g.prototype.readUInt32BE=function(U,$){return U=U>>>0,$||X(U,4,this.length),this[U]*16777216+(this[U+1]<<16|this[U+2]<<8|this[U+3])},g.prototype.readBigUInt64LE=pt(function(U){U=U>>>0,ft(U,"offset");const $=this[U],ae=this[U+7];($===void 0||ae===void 0)&&Ze(U,this.length-8);const be=$+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24,Se=this[++U]+this[++U]*2**8+this[++U]*2**16+ae*2**24;return BigInt(be)+(BigInt(Se)<<BigInt(32))}),g.prototype.readBigUInt64BE=pt(function(U){U=U>>>0,ft(U,"offset");const $=this[U],ae=this[U+7];($===void 0||ae===void 0)&&Ze(U,this.length-8);const be=$*2**24+this[++U]*2**16+this[++U]*2**8+this[++U],Se=this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+ae;return(BigInt(be)<<BigInt(32))+BigInt(Se)}),g.prototype.readIntLE=function(U,$,ae){U=U>>>0,$=$>>>0,ae||X(U,$,this.length);let be=this[U],Se=1,Ae=0;for(;++Ae<$&&(Se*=256);)be+=this[U+Ae]*Se;return Se*=128,be>=Se&&(be-=Math.pow(2,8*$)),be},g.prototype.readIntBE=function(U,$,ae){U=U>>>0,$=$>>>0,ae||X(U,$,this.length);let be=$,Se=1,Ae=this[U+--be];for(;be>0&&(Se*=256);)Ae+=this[U+--be]*Se;return Se*=128,Ae>=Se&&(Ae-=Math.pow(2,8*$)),Ae},g.prototype.readInt8=function(U,$){return U=U>>>0,$||X(U,1,this.length),this[U]&128?(255-this[U]+1)*-1:this[U]},g.prototype.readInt16LE=function(U,$){U=U>>>0,$||X(U,2,this.length);const ae=this[U]|this[U+1]<<8;return ae&32768?ae|4294901760:ae},g.prototype.readInt16BE=function(U,$){U=U>>>0,$||X(U,2,this.length);const ae=this[U+1]|this[U]<<8;return ae&32768?ae|4294901760:ae},g.prototype.readInt32LE=function(U,$){return U=U>>>0,$||X(U,4,this.length),this[U]|this[U+1]<<8|this[U+2]<<16|this[U+3]<<24},g.prototype.readInt32BE=function(U,$){return U=U>>>0,$||X(U,4,this.length),this[U]<<24|this[U+1]<<16|this[U+2]<<8|this[U+3]},g.prototype.readBigInt64LE=pt(function(U){U=U>>>0,ft(U,"offset");const $=this[U],ae=this[U+7];($===void 0||ae===void 0)&&Ze(U,this.length-8);const be=this[U+4]+this[U+5]*2**8+this[U+6]*2**16+(ae<<24);return(BigInt(be)<<BigInt(32))+BigInt($+this[++U]*2**8+this[++U]*2**16+this[++U]*2**24)}),g.prototype.readBigInt64BE=pt(function(U){U=U>>>0,ft(U,"offset");const $=this[U],ae=this[U+7];($===void 0||ae===void 0)&&Ze(U,this.length-8);const be=($<<24)+this[++U]*2**16+this[++U]*2**8+this[++U];return(BigInt(be)<<BigInt(32))+BigInt(this[++U]*2**24+this[++U]*2**16+this[++U]*2**8+ae)}),g.prototype.readFloatLE=function(U,$){return U=U>>>0,$||X(U,4,this.length),t.read(this,U,!0,23,4)},g.prototype.readFloatBE=function(U,$){return U=U>>>0,$||X(U,4,this.length),t.read(this,U,!1,23,4)},g.prototype.readDoubleLE=function(U,$){return U=U>>>0,$||X(U,8,this.length),t.read(this,U,!0,52,8)},g.prototype.readDoubleBE=function(U,$){return U=U>>>0,$||X(U,8,this.length),t.read(this,U,!1,52,8)};function F(te,U,$,ae,be,Se){if(!g.isBuffer(te))throw new TypeError('"buffer" argument must be a Buffer instance');if(U>be||U<Se)throw new RangeError('"value" argument is out of bounds');if($+ae>te.length)throw new RangeError("Index out of range")}g.prototype.writeUintLE=g.prototype.writeUIntLE=function(U,$,ae,be){if(U=+U,$=$>>>0,ae=ae>>>0,!be){const Ie=Math.pow(2,8*ae)-1;F(this,U,$,ae,Ie,0)}let Se=1,Ae=0;for(this[$]=U&255;++Ae<ae&&(Se*=256);)this[$+Ae]=U/Se&255;return $+ae},g.prototype.writeUintBE=g.prototype.writeUIntBE=function(U,$,ae,be){if(U=+U,$=$>>>0,ae=ae>>>0,!be){const Ie=Math.pow(2,8*ae)-1;F(this,U,$,ae,Ie,0)}let Se=ae-1,Ae=1;for(this[$+Se]=U&255;--Se>=0&&(Ae*=256);)this[$+Se]=U/Ae&255;return $+ae},g.prototype.writeUint8=g.prototype.writeUInt8=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,1,255,0),this[$]=U&255,$+1},g.prototype.writeUint16LE=g.prototype.writeUInt16LE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,2,65535,0),this[$]=U&255,this[$+1]=U>>>8,$+2},g.prototype.writeUint16BE=g.prototype.writeUInt16BE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,2,65535,0),this[$]=U>>>8,this[$+1]=U&255,$+2},g.prototype.writeUint32LE=g.prototype.writeUInt32LE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,4,4294967295,0),this[$+3]=U>>>24,this[$+2]=U>>>16,this[$+1]=U>>>8,this[$]=U&255,$+4},g.prototype.writeUint32BE=g.prototype.writeUInt32BE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,4,4294967295,0),this[$]=U>>>24,this[$+1]=U>>>16,this[$+2]=U>>>8,this[$+3]=U&255,$+4};function J(te,U,$,ae,be){Ce(U,ae,be,te,$,7);let Se=Number(U&BigInt(4294967295));te[$++]=Se,Se=Se>>8,te[$++]=Se,Se=Se>>8,te[$++]=Se,Se=Se>>8,te[$++]=Se;let Ae=Number(U>>BigInt(32)&BigInt(4294967295));return te[$++]=Ae,Ae=Ae>>8,te[$++]=Ae,Ae=Ae>>8,te[$++]=Ae,Ae=Ae>>8,te[$++]=Ae,$}function Ee(te,U,$,ae,be){Ce(U,ae,be,te,$,7);let Se=Number(U&BigInt(4294967295));te[$+7]=Se,Se=Se>>8,te[$+6]=Se,Se=Se>>8,te[$+5]=Se,Se=Se>>8,te[$+4]=Se;let Ae=Number(U>>BigInt(32)&BigInt(4294967295));return te[$+3]=Ae,Ae=Ae>>8,te[$+2]=Ae,Ae=Ae>>8,te[$+1]=Ae,Ae=Ae>>8,te[$]=Ae,$+8}g.prototype.writeBigUInt64LE=pt(function(U,$=0){return J(this,U,$,BigInt(0),BigInt("0xffffffffffffffff"))}),g.prototype.writeBigUInt64BE=pt(function(U,$=0){return Ee(this,U,$,BigInt(0),BigInt("0xffffffffffffffff"))}),g.prototype.writeIntLE=function(U,$,ae,be){if(U=+U,$=$>>>0,!be){const $e=Math.pow(2,8*ae-1);F(this,U,$,ae,$e-1,-$e)}let Se=0,Ae=1,Ie=0;for(this[$]=U&255;++Se<ae&&(Ae*=256);)U<0&&Ie===0&&this[$+Se-1]!==0&&(Ie=1),this[$+Se]=(U/Ae>>0)-Ie&255;return $+ae},g.prototype.writeIntBE=function(U,$,ae,be){if(U=+U,$=$>>>0,!be){const $e=Math.pow(2,8*ae-1);F(this,U,$,ae,$e-1,-$e)}let Se=ae-1,Ae=1,Ie=0;for(this[$+Se]=U&255;--Se>=0&&(Ae*=256);)U<0&&Ie===0&&this[$+Se+1]!==0&&(Ie=1),this[$+Se]=(U/Ae>>0)-Ie&255;return $+ae},g.prototype.writeInt8=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,1,127,-128),U<0&&(U=255+U+1),this[$]=U&255,$+1},g.prototype.writeInt16LE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,2,32767,-32768),this[$]=U&255,this[$+1]=U>>>8,$+2},g.prototype.writeInt16BE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,2,32767,-32768),this[$]=U>>>8,this[$+1]=U&255,$+2},g.prototype.writeInt32LE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,4,2147483647,-2147483648),this[$]=U&255,this[$+1]=U>>>8,this[$+2]=U>>>16,this[$+3]=U>>>24,$+4},g.prototype.writeInt32BE=function(U,$,ae){return U=+U,$=$>>>0,ae||F(this,U,$,4,2147483647,-2147483648),U<0&&(U=4294967295+U+1),this[$]=U>>>24,this[$+1]=U>>>16,this[$+2]=U>>>8,this[$+3]=U&255,$+4},g.prototype.writeBigInt64LE=pt(function(U,$=0){return J(this,U,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),g.prototype.writeBigInt64BE=pt(function(U,$=0){return Ee(this,U,$,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Re(te,U,$,ae,be,Se){if($+ae>te.length)throw new RangeError("Index out of range");if($<0)throw new RangeError("Index out of range")}function Te(te,U,$,ae,be){return U=+U,$=$>>>0,be||Re(te,U,$,4),t.write(te,U,$,ae,23,4),$+4}g.prototype.writeFloatLE=function(U,$,ae){return Te(this,U,$,!0,ae)},g.prototype.writeFloatBE=function(U,$,ae){return Te(this,U,$,!1,ae)};function Ue(te,U,$,ae,be){return U=+U,$=$>>>0,be||Re(te,U,$,8),t.write(te,U,$,ae,52,8),$+8}g.prototype.writeDoubleLE=function(U,$,ae){return Ue(this,U,$,!0,ae)},g.prototype.writeDoubleBE=function(U,$,ae){return Ue(this,U,$,!1,ae)},g.prototype.copy=function(U,$,ae,be){if(!g.isBuffer(U))throw new TypeError("argument should be a Buffer");if(ae||(ae=0),!be&&be!==0&&(be=this.length),$>=U.length&&($=U.length),$||($=0),be>0&&be<ae&&(be=ae),be===ae||U.length===0||this.length===0)return 0;if($<0)throw new RangeError("targetStart out of bounds");if(ae<0||ae>=this.length)throw new RangeError("Index out of range");if(be<0)throw new RangeError("sourceEnd out of bounds");be>this.length&&(be=this.length),U.length-$<be-ae&&(be=U.length-$+ae);const Se=be-ae;return this===U&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin($,ae,be):Uint8Array.prototype.set.call(U,this.subarray(ae,be),$),Se},g.prototype.fill=function(U,$,ae,be){if(typeof U=="string"){if(typeof $=="string"?(be=$,$=0,ae=this.length):typeof ae=="string"&&(be=ae,ae=this.length),be!==void 0&&typeof be!="string")throw new TypeError("encoding must be a string");if(typeof be=="string"&&!g.isEncoding(be))throw new TypeError("Unknown encoding: "+be);if(U.length===1){const Ae=U.charCodeAt(0);(be==="utf8"&&Ae<128||be==="latin1")&&(U=Ae)}}else typeof U=="number"?U=U&255:typeof U=="boolean"&&(U=Number(U));if($<0||this.length<$||this.length<ae)throw new RangeError("Out of range index");if(ae<=$)return this;$=$>>>0,ae=ae===void 0?this.length:ae>>>0,U||(U=0);let Se;if(typeof U=="number")for(Se=$;Se<ae;++Se)this[Se]=U;else{const Ae=g.isBuffer(U)?U:g.from(U,be),Ie=Ae.length;if(Ie===0)throw new TypeError('The value "'+U+'" is invalid for argument "value"');for(Se=0;Se<ae-$;++Se)this[Se+$]=Ae[Se%Ie]}return this};const ze={};function Ke(te,U,$){ze[te]=class extends ${constructor(){super(),Object.defineProperty(this,"message",{value:U.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${te}]`,this.stack,delete this.name}get code(){return te}set code(be){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:be,writable:!0})}toString(){return`${this.name} [${te}]: ${this.message}`}}}Ke("ERR_BUFFER_OUT_OF_BOUNDS",function(te){return te?`${te} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ke("ERR_INVALID_ARG_TYPE",function(te,U){return`The "${te}" argument must be of type number. Received type ${typeof U}`},TypeError),Ke("ERR_OUT_OF_RANGE",function(te,U,$){let ae=`The value of "${te}" is out of range.`,be=$;return Number.isInteger($)&&Math.abs($)>2**32?be=it(String($)):typeof $=="bigint"&&(be=String($),($>BigInt(2)**BigInt(32)||$<-(BigInt(2)**BigInt(32)))&&(be=it(be)),be+="n"),ae+=` It must be ${U}. Received ${be}`,ae},RangeError);function it(te){let U="",$=te.length;const ae=te[0]==="-"?1:0;for(;$>=ae+4;$-=3)U=`_${te.slice($-3,$)}${U}`;return`${te.slice(0,$)}${U}`}function Ye(te,U,$){ft(U,"offset"),(te[U]===void 0||te[U+$]===void 0)&&Ze(U,te.length-($+1))}function Ce(te,U,$,ae,be,Se){if(te>$||te<U){const Ae=typeof U=="bigint"?"n":"";let Ie;throw Se>3?U===0||U===BigInt(0)?Ie=`>= 0${Ae} and < 2${Ae} ** ${(Se+1)*8}${Ae}`:Ie=`>= -(2${Ae} ** ${(Se+1)*8-1}${Ae}) and < 2 ** ${(Se+1)*8-1}${Ae}`:Ie=`>= ${U}${Ae} and <= ${$}${Ae}`,new ze.ERR_OUT_OF_RANGE("value",Ie,te)}Ye(ae,be,Se)}function ft(te,U){if(typeof te!="number")throw new ze.ERR_INVALID_ARG_TYPE(U,"number",te)}function Ze(te,U,$){throw Math.floor(te)!==te?(ft(te,$),new ze.ERR_OUT_OF_RANGE($||"offset","an integer",te)):U<0?new ze.ERR_BUFFER_OUT_OF_BOUNDS:new ze.ERR_OUT_OF_RANGE($||"offset",`>= ${$?1:0} and <= ${U}`,te)}const nt=/[^+/0-9A-Za-z-_]/g;function dt(te){if(te=te.split("=")[0],te=te.trim().replace(nt,""),te.length<2)return"";for(;te.length%4!==0;)te=te+"=";return te}function gt(te,U){U=U||1/0;let $;const ae=te.length;let be=null;const Se=[];for(let Ae=0;Ae<ae;++Ae){if($=te.charCodeAt(Ae),$>55295&&$<57344){if(!be){if($>56319){(U-=3)>-1&&Se.push(239,191,189);continue}else if(Ae+1===ae){(U-=3)>-1&&Se.push(239,191,189);continue}be=$;continue}if($<56320){(U-=3)>-1&&Se.push(239,191,189),be=$;continue}$=(be-55296<<10|$-56320)+65536}else be&&(U-=3)>-1&&Se.push(239,191,189);if(be=null,$<128){if((U-=1)<0)break;Se.push($)}else if($<2048){if((U-=2)<0)break;Se.push($>>6|192,$&63|128)}else if($<65536){if((U-=3)<0)break;Se.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((U-=4)<0)break;Se.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return Se}function et(te){const U=[];for(let $=0;$<te.length;++$)U.push(te.charCodeAt($)&255);return U}function he(te,U){let $,ae,be;const Se=[];for(let Ae=0;Ae<te.length&&!((U-=2)<0);++Ae)$=te.charCodeAt(Ae),ae=$>>8,be=$%256,Se.push(be),Se.push(ae);return Se}function ue(te){return e.toByteArray(dt(te))}function _e(te,U,$,ae){let be;for(be=0;be<ae&&!(be+$>=U.length||be>=te.length);++be)U[be+$]=te[be];return be}function Ge(te,U){return te instanceof U||te!=null&&te.constructor!=null&&te.constructor.name!=null&&te.constructor.name===U.name}function He(te){return te!==te}const Ve=function(){const te="0123456789abcdef",U=new Array(256);for(let $=0;$<16;++$){const ae=$*16;for(let be=0;be<16;++be)U[ae+be]=te[$]+te[be]}return U}();function pt(te){return typeof BigInt>"u"?We:te}function We(){throw new Error("BigInt not supported")}})(buffer);const crypto$1=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function isBytes$1(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function anumber(s){if(!Number.isSafeInteger(s)||s<0)throw new Error("positive integer expected, got "+s)}function abytes$1(s,...e){if(!isBytes$1(s))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(s.length))throw new Error("Uint8Array expected of length "+e+", got length="+s.length)}function ahash(s){if(typeof s!="function"||typeof s.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");anumber(s.outputLen),anumber(s.blockLen)}function aexists(s,e=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(e&&s.finished)throw new Error("Hash#digest() has already been called")}function aoutput(s,e){abytes$1(s);const t=e.outputLen;if(s.length<t)throw new Error("digestInto() expects output buffer of length at least "+t)}function u32$2(s){return new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4))}function clean(...s){for(let e=0;e<s.length;e++)s[e].fill(0)}function createView(s){return new DataView(s.buffer,s.byteOffset,s.byteLength)}function rotr(s,e){return s<<32-e|s>>>e}const isLE=(()=>new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68)();function byteSwap(s){return s<<24&4278190080|s<<8&16711680|s>>>8&65280|s>>>24&255}function byteSwap32(s){for(let e=0;e<s.length;e++)s[e]=byteSwap(s[e]);return s}const swap32IfBE=isLE?s=>s:byteSwap32;function utf8ToBytes(s){if(typeof s!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(s))}function toBytes(s){return typeof s=="string"&&(s=utf8ToBytes(s)),abytes$1(s),s}function concatBytes$1(...s){let e=0;for(let o=0;o<s.length;o++){const a=s[o];abytes$1(a),e+=a.length}const t=new Uint8Array(e);for(let o=0,a=0;o<s.length;o++){const c=s[o];t.set(c,a),a+=c.length}return t}class Hash{}function createHasher(s){const e=o=>s().update(toBytes(o)).digest(),t=s();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>s(),e}function randomBytes(s=32){if(crypto$1&&typeof crypto$1.getRandomValues=="function")return crypto$1.getRandomValues(new Uint8Array(s));if(crypto$1&&typeof crypto$1.randomBytes=="function")return Uint8Array.from(crypto$1.randomBytes(s));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64(s,e,t,o){if(typeof s.setBigUint64=="function")return s.setBigUint64(e,t,o);const a=BigInt(32),c=BigInt(4294967295),d=Number(t>>a&c),g=Number(t&c),y=o?4:0,_=o?0:4;s.setUint32(e+y,d,o),s.setUint32(e+_,g,o)}function Chi(s,e,t){return s&e^~s&t}function Maj(s,e,t){return s&e^s&t^e&t}class HashMD extends Hash{constructor(e,t,o,a){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=o,this.isLE=a,this.buffer=new Uint8Array(e),this.view=createView(this.buffer)}update(e){aexists(this),e=toBytes(e),abytes$1(e);const{view:t,buffer:o,blockLen:a}=this,c=e.length;for(let d=0;d<c;){const g=Math.min(a-this.pos,c-d);if(g===a){const y=createView(e);for(;a<=c-d;d+=a)this.process(y,d);continue}o.set(e.subarray(d,d+g),this.pos),this.pos+=g,d+=g,this.pos===a&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){aexists(this),aoutput(e,this),this.finished=!0;const{buffer:t,view:o,blockLen:a,isLE:c}=this;let{pos:d}=this;t[d++]=128,clean(this.buffer.subarray(d)),this.padOffset>a-d&&(this.process(o,0),d=0);for(let S=d;S<a;S++)t[S]=0;setBigUint64(o,a-8,BigInt(this.length*8),c),this.process(o,0);const g=createView(e),y=this.outputLen;if(y%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const _=y/4,E=this.get();if(_>E.length)throw new Error("_sha2: outputLen bigger than state");for(let S=0;S<_;S++)g.setUint32(4*S,E[S],c)}digest(){const{buffer:e,outputLen:t}=this;this.digestInto(e);const o=e.slice(0,t);return this.destroy(),o}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:t,buffer:o,length:a,finished:c,destroyed:d,pos:g}=this;return e.destroyed=d,e.finished=c,e.length=a,e.pos=g,a%t&&e.buffer.set(o),e}clone(){return this._cloneInto()}}const SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(s,e=!1){return e?{h:Number(s&U32_MASK64),l:Number(s>>_32n&U32_MASK64)}:{h:Number(s>>_32n&U32_MASK64)|0,l:Number(s&U32_MASK64)|0}}function split(s,e=!1){const t=s.length;let o=new Uint32Array(t),a=new Uint32Array(t);for(let c=0;c<t;c++){const{h:d,l:g}=fromBig(s[c],e);[o[c],a[c]]=[d,g]}return[o,a]}const shrSH=(s,e,t)=>s>>>t,shrSL=(s,e,t)=>s<<32-t|e>>>t,rotrSH=(s,e,t)=>s>>>t|e<<32-t,rotrSL=(s,e,t)=>s<<32-t|e>>>t,rotrBH=(s,e,t)=>s<<64-t|e>>>t-32,rotrBL=(s,e,t)=>s>>>t-32|e<<64-t,rotlSH=(s,e,t)=>s<<t|e>>>32-t,rotlSL=(s,e,t)=>e<<t|s>>>32-t,rotlBH=(s,e,t)=>e<<t-32|s>>>64-t,rotlBL=(s,e,t)=>s<<t-32|e>>>64-t;function add(s,e,t,o){const a=(e>>>0)+(o>>>0);return{h:s+t+(a/2**32|0)|0,l:a|0}}const add3L=(s,e,t)=>(s>>>0)+(e>>>0)+(t>>>0),add3H=(s,e,t,o)=>e+t+o+(s/2**32|0)|0,add4L=(s,e,t,o)=>(s>>>0)+(e>>>0)+(t>>>0)+(o>>>0),add4H=(s,e,t,o,a)=>e+t+o+a+(s/2**32|0)|0,add5L=(s,e,t,o,a)=>(s>>>0)+(e>>>0)+(t>>>0)+(o>>>0)+(a>>>0),add5H=(s,e,t,o,a,c)=>e+t+o+a+c+(s/2**32|0)|0,SHA256_K=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(e=32){super(64,e,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:e,B:t,C:o,D:a,E:c,F:d,G:g,H:y}=this;return[e,t,o,a,c,d,g,y]}set(e,t,o,a,c,d,g,y){this.A=e|0,this.B=t|0,this.C=o|0,this.D=a|0,this.E=c|0,this.F=d|0,this.G=g|0,this.H=y|0}process(e,t){for(let S=0;S<16;S++,t+=4)SHA256_W[S]=e.getUint32(t,!1);for(let S=16;S<64;S++){const A=SHA256_W[S-15],C=SHA256_W[S-2],N=rotr(A,7)^rotr(A,18)^A>>>3,O=rotr(C,17)^rotr(C,19)^C>>>10;SHA256_W[S]=O+SHA256_W[S-7]+N+SHA256_W[S-16]|0}let{A:o,B:a,C:c,D:d,E:g,F:y,G:_,H:E}=this;for(let S=0;S<64;S++){const A=rotr(g,6)^rotr(g,11)^rotr(g,25),C=E+A+Chi(g,y,_)+SHA256_K[S]+SHA256_W[S]|0,O=(rotr(o,2)^rotr(o,13)^rotr(o,22))+Maj(o,a,c)|0;E=_,_=y,y=g,g=d+C|0,d=c,c=a,a=o,o=C+O|0}o=o+this.A|0,a=a+this.B|0,c=c+this.C|0,d=d+this.D|0,g=g+this.E|0,y=y+this.F|0,_=_+this.G|0,E=E+this.H|0,this.set(o,a,c,d,g,y,_,E)}roundClean(){clean(SHA256_W)}destroy(){this.set(0,0,0,0,0,0,0,0),clean(this.buffer)}}const K512=(()=>split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))))(),SHA512_Kh=(()=>K512[0])(),SHA512_Kl=(()=>K512[1])(),SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA512 extends HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=SHA512_IV[0]|0,this.Al=SHA512_IV[1]|0,this.Bh=SHA512_IV[2]|0,this.Bl=SHA512_IV[3]|0,this.Ch=SHA512_IV[4]|0,this.Cl=SHA512_IV[5]|0,this.Dh=SHA512_IV[6]|0,this.Dl=SHA512_IV[7]|0,this.Eh=SHA512_IV[8]|0,this.El=SHA512_IV[9]|0,this.Fh=SHA512_IV[10]|0,this.Fl=SHA512_IV[11]|0,this.Gh=SHA512_IV[12]|0,this.Gl=SHA512_IV[13]|0,this.Hh=SHA512_IV[14]|0,this.Hl=SHA512_IV[15]|0}get(){const{Ah:e,Al:t,Bh:o,Bl:a,Ch:c,Cl:d,Dh:g,Dl:y,Eh:_,El:E,Fh:S,Fl:A,Gh:C,Gl:N,Hh:O,Hl:I}=this;return[e,t,o,a,c,d,g,y,_,E,S,A,C,N,O,I]}set(e,t,o,a,c,d,g,y,_,E,S,A,C,N,O,I){this.Ah=e|0,this.Al=t|0,this.Bh=o|0,this.Bl=a|0,this.Ch=c|0,this.Cl=d|0,this.Dh=g|0,this.Dl=y|0,this.Eh=_|0,this.El=E|0,this.Fh=S|0,this.Fl=A|0,this.Gh=C|0,this.Gl=N|0,this.Hh=O|0,this.Hl=I|0}process(e,t){for(let B=0;B<16;B++,t+=4)SHA512_W_H[B]=e.getUint32(t),SHA512_W_L[B]=e.getUint32(t+=4);for(let B=16;B<80;B++){const H=SHA512_W_H[B-15]|0,se=SHA512_W_L[B-15]|0,oe=rotrSH(H,se,1)^rotrSH(H,se,8)^shrSH(H,se,7),Q=rotrSL(H,se,1)^rotrSL(H,se,8)^shrSL(H,se,7),fe=SHA512_W_H[B-2]|0,Z=SHA512_W_L[B-2]|0,ce=rotrSH(fe,Z,19)^rotrBH(fe,Z,61)^shrSH(fe,Z,6),ge=rotrSL(fe,Z,19)^rotrBL(fe,Z,61)^shrSL(fe,Z,6),me=add4L(Q,ge,SHA512_W_L[B-7],SHA512_W_L[B-16]),V=add4H(me,oe,ce,SHA512_W_H[B-7],SHA512_W_H[B-16]);SHA512_W_H[B]=V|0,SHA512_W_L[B]=me|0}let{Ah:o,Al:a,Bh:c,Bl:d,Ch:g,Cl:y,Dh:_,Dl:E,Eh:S,El:A,Fh:C,Fl:N,Gh:O,Gl:I,Hh:P,Hl:j}=this;for(let B=0;B<80;B++){const H=rotrSH(S,A,14)^rotrSH(S,A,18)^rotrBH(S,A,41),se=rotrSL(S,A,14)^rotrSL(S,A,18)^rotrBL(S,A,41),oe=S&C^~S&O,Q=A&N^~A&I,fe=add5L(j,se,Q,SHA512_Kl[B],SHA512_W_L[B]),Z=add5H(fe,P,H,oe,SHA512_Kh[B],SHA512_W_H[B]),ce=fe|0,ge=rotrSH(o,a,28)^rotrBH(o,a,34)^rotrBH(o,a,39),me=rotrSL(o,a,28)^rotrBL(o,a,34)^rotrBL(o,a,39),V=o&c^o&g^c&g,R=a&d^a&y^d&y;P=O|0,j=I|0,O=C|0,I=N|0,C=S|0,N=A|0,{h:S,l:A}=add(_|0,E|0,Z|0,ce|0),_=g|0,E=y|0,g=c|0,y=d|0,c=o|0,d=a|0;const L=add3L(ce,me,R);o=add3H(L,Z,ge,V),a=L|0}({h:o,l:a}=add(this.Ah|0,this.Al|0,o|0,a|0)),{h:c,l:d}=add(this.Bh|0,this.Bl|0,c|0,d|0),{h:g,l:y}=add(this.Ch|0,this.Cl|0,g|0,y|0),{h:_,l:E}=add(this.Dh|0,this.Dl|0,_|0,E|0),{h:S,l:A}=add(this.Eh|0,this.El|0,S|0,A|0),{h:C,l:N}=add(this.Fh|0,this.Fl|0,C|0,N|0),{h:O,l:I}=add(this.Gh|0,this.Gl|0,O|0,I|0),{h:P,l:j}=add(this.Hh|0,this.Hl|0,P|0,j|0),this.set(o,a,c,d,g,y,_,E,S,A,C,N,O,I,P,j)}roundClean(){clean(SHA512_W_H,SHA512_W_L)}destroy(){clean(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sha256$2=createHasher(()=>new SHA256),sha512=createHasher(()=>new SHA512);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$6=BigInt(0),_1n$7=BigInt(1);function isBytes(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function abytes(s){if(!isBytes(s))throw new Error("Uint8Array expected")}function abool(s,e){if(typeof e!="boolean")throw new Error(s+" boolean expected, got "+e)}function numberToHexUnpadded(s){const e=s.toString(16);return e.length&1?"0"+e:e}function hexToNumber(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?_0n$6:BigInt("0x"+s)}const hasHexBuiltin=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hexes=Array.from({length:256},(s,e)=>e.toString(16).padStart(2,"0"));function bytesToHex(s){if(abytes(s),hasHexBuiltin)return s.toHex();let e="";for(let t=0;t<s.length;t++)e+=hexes[s[t]];return e}const asciis={_0:48,_9:57,A:65,F:70,a:97,f:102};function asciiToBase16(s){if(s>=asciis._0&&s<=asciis._9)return s-asciis._0;if(s>=asciis.A&&s<=asciis.F)return s-(asciis.A-10);if(s>=asciis.a&&s<=asciis.f)return s-(asciis.a-10)}function hexToBytes(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);if(hasHexBuiltin)return Uint8Array.fromHex(s);const e=s.length,t=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const o=new Uint8Array(t);for(let a=0,c=0;a<t;a++,c+=2){const d=asciiToBase16(s.charCodeAt(c)),g=asciiToBase16(s.charCodeAt(c+1));if(d===void 0||g===void 0){const y=s[c]+s[c+1];throw new Error('hex string expected, got non-hex character "'+y+'" at index '+c)}o[a]=d*16+g}return o}function bytesToNumberBE(s){return hexToNumber(bytesToHex(s))}function bytesToNumberLE(s){return abytes(s),hexToNumber(bytesToHex(Uint8Array.from(s).reverse()))}function numberToBytesBE(s,e){return hexToBytes(s.toString(16).padStart(e*2,"0"))}function numberToBytesLE(s,e){return numberToBytesBE(s,e).reverse()}function ensureBytes(s,e,t){let o;if(typeof e=="string")try{o=hexToBytes(e)}catch(c){throw new Error(s+" must be hex string or Uint8Array, cause: "+c)}else if(isBytes(e))o=Uint8Array.from(e);else throw new Error(s+" must be hex string or Uint8Array");const a=o.length;if(typeof t=="number"&&a!==t)throw new Error(s+" of length "+t+" expected, got "+a);return o}function concatBytes(...s){let e=0;for(let o=0;o<s.length;o++){const a=s[o];abytes(a),e+=a.length}const t=new Uint8Array(e);for(let o=0,a=0;o<s.length;o++){const c=s[o];t.set(c,a),a+=c.length}return t}const isPosBig=s=>typeof s=="bigint"&&_0n$6<=s;function inRange$1(s,e,t){return isPosBig(s)&&isPosBig(e)&&isPosBig(t)&&e<=s&&s<t}function aInRange(s,e,t,o){if(!inRange$1(e,t,o))throw new Error("expected valid "+s+": "+t+" <= n < "+o+", got "+e)}function bitLen(s){let e;for(e=0;s>_0n$6;s>>=_1n$7,e+=1);return e}const bitMask=s=>(_1n$7<<BigInt(s))-_1n$7,u8n=s=>new Uint8Array(s),u8fr=s=>Uint8Array.from(s);function createHmacDrbg(s,e,t){if(typeof s!="number"||s<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let o=u8n(s),a=u8n(s),c=0;const d=()=>{o.fill(1),a.fill(0),c=0},g=(...S)=>t(a,o,...S),y=(S=u8n(0))=>{a=g(u8fr([0]),S),o=g(),S.length!==0&&(a=g(u8fr([1]),S),o=g())},_=()=>{if(c++>=1e3)throw new Error("drbg: tried 1000 values");let S=0;const A=[];for(;S<e;){o=g();const C=o.slice();A.push(C),S+=o.length}return concatBytes(...A)};return(S,A)=>{d(),y(S);let C;for(;!(C=A(_()));)y();return d(),C}}const validatorFns={bigint:s=>typeof s=="bigint",function:s=>typeof s=="function",boolean:s=>typeof s=="boolean",string:s=>typeof s=="string",stringOrUint8Array:s=>typeof s=="string"||isBytes(s),isSafeInteger:s=>Number.isSafeInteger(s),array:s=>Array.isArray(s),field:(s,e)=>e.Fp.isValid(s),hash:s=>typeof s=="function"&&Number.isSafeInteger(s.outputLen)};function validateObject(s,e,t={}){const o=(a,c,d)=>{const g=validatorFns[c];if(typeof g!="function")throw new Error("invalid validator function");const y=s[a];if(!(d&&y===void 0)&&!g(y,s))throw new Error("param "+String(a)+" is invalid. Expected "+c+", got "+y)};for(const[a,c]of Object.entries(e))o(a,c,!1);for(const[a,c]of Object.entries(t))o(a,c,!0);return s}function memoized(s){const e=new WeakMap;return(t,...o)=>{const a=e.get(t);if(a!==void 0)return a;const c=s(t,...o);return e.set(t,c),c}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$5=BigInt(0),_1n$6=BigInt(1),_2n$4=BigInt(2),_3n$1=BigInt(3),_4n$1=BigInt(4),_5n$1=BigInt(5),_8n$2=BigInt(8);function mod(s,e){const t=s%e;return t>=_0n$5?t:e+t}function pow2(s,e,t){let o=s;for(;e-- >_0n$5;)o*=o,o%=t;return o}function invert(s,e){if(s===_0n$5)throw new Error("invert: expected non-zero number");if(e<=_0n$5)throw new Error("invert: expected positive modulus, got "+e);let t=mod(s,e),o=e,a=_0n$5,c=_1n$6;for(;t!==_0n$5;){const g=o/t,y=o%t,_=a-c*g;o=t,t=y,a=c,c=_}if(o!==_1n$6)throw new Error("invert: does not exist");return mod(a,e)}function sqrt3mod4(s,e){const t=(s.ORDER+_1n$6)/_4n$1,o=s.pow(e,t);if(!s.eql(s.sqr(o),e))throw new Error("Cannot find square root");return o}function sqrt5mod8(s,e){const t=(s.ORDER-_5n$1)/_8n$2,o=s.mul(e,_2n$4),a=s.pow(o,t),c=s.mul(e,a),d=s.mul(s.mul(c,_2n$4),a),g=s.mul(c,s.sub(d,s.ONE));if(!s.eql(s.sqr(g),e))throw new Error("Cannot find square root");return g}function tonelliShanks(s){if(s<BigInt(3))throw new Error("sqrt is not defined for small field");let e=s-_1n$6,t=0;for(;e%_2n$4===_0n$5;)e/=_2n$4,t++;let o=_2n$4;const a=Field(s);for(;FpLegendre(a,o)===1;)if(o++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(t===1)return sqrt3mod4;let c=a.pow(o,e);const d=(e+_1n$6)/_2n$4;return function(y,_){if(y.is0(_))return _;if(FpLegendre(y,_)!==1)throw new Error("Cannot find square root");let E=t,S=y.mul(y.ONE,c),A=y.pow(_,e),C=y.pow(_,d);for(;!y.eql(A,y.ONE);){if(y.is0(A))return y.ZERO;let N=1,O=y.sqr(A);for(;!y.eql(O,y.ONE);)if(N++,O=y.sqr(O),N===E)throw new Error("Cannot find square root");const I=_1n$6<<BigInt(E-N-1),P=y.pow(S,I);E=N,S=y.sqr(P),A=y.mul(A,S),C=y.mul(C,P)}return C}}function FpSqrt(s){return s%_4n$1===_3n$1?sqrt3mod4:s%_8n$2===_5n$1?sqrt5mod8:tonelliShanks(s)}const isNegativeLE=(s,e)=>(mod(s,e)&_1n$6)===_1n$6,FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(s){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=FIELD_FIELDS.reduce((o,a)=>(o[a]="function",o),e);return validateObject(s,t)}function FpPow(s,e,t){if(t<_0n$5)throw new Error("invalid exponent, negatives unsupported");if(t===_0n$5)return s.ONE;if(t===_1n$6)return e;let o=s.ONE,a=e;for(;t>_0n$5;)t&_1n$6&&(o=s.mul(o,a)),a=s.sqr(a),t>>=_1n$6;return o}function FpInvertBatch(s,e,t=!1){const o=new Array(e.length).fill(t?s.ZERO:void 0),a=e.reduce((d,g,y)=>s.is0(g)?d:(o[y]=d,s.mul(d,g)),s.ONE),c=s.inv(a);return e.reduceRight((d,g,y)=>s.is0(g)?d:(o[y]=s.mul(d,o[y]),s.mul(d,g)),c),o}function FpLegendre(s,e){const t=(s.ORDER-_1n$6)/_2n$4,o=s.pow(e,t),a=s.eql(o,s.ONE),c=s.eql(o,s.ZERO),d=s.eql(o,s.neg(s.ONE));if(!a&&!c&&!d)throw new Error("invalid Legendre symbol result");return a?1:c?0:-1}function nLength(s,e){e!==void 0&&anumber(e);const t=e!==void 0?e:s.toString(2).length,o=Math.ceil(t/8);return{nBitLength:t,nByteLength:o}}function Field(s,e,t=!1,o={}){if(s<=_0n$5)throw new Error("invalid field: expected ORDER > 0, got "+s);const{nBitLength:a,nByteLength:c}=nLength(s,e);if(c>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let d;const g=Object.freeze({ORDER:s,isLE:t,BITS:a,BYTES:c,MASK:bitMask(a),ZERO:_0n$5,ONE:_1n$6,create:y=>mod(y,s),isValid:y=>{if(typeof y!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof y);return _0n$5<=y&&y<s},is0:y=>y===_0n$5,isOdd:y=>(y&_1n$6)===_1n$6,neg:y=>mod(-y,s),eql:(y,_)=>y===_,sqr:y=>mod(y*y,s),add:(y,_)=>mod(y+_,s),sub:(y,_)=>mod(y-_,s),mul:(y,_)=>mod(y*_,s),pow:(y,_)=>FpPow(g,y,_),div:(y,_)=>mod(y*invert(_,s),s),sqrN:y=>y*y,addN:(y,_)=>y+_,subN:(y,_)=>y-_,mulN:(y,_)=>y*_,inv:y=>invert(y,s),sqrt:o.sqrt||(y=>(d||(d=FpSqrt(s)),d(g,y))),toBytes:y=>t?numberToBytesLE(y,c):numberToBytesBE(y,c),fromBytes:y=>{if(y.length!==c)throw new Error("Field.fromBytes: expected "+c+" bytes, got "+y.length);return t?bytesToNumberLE(y):bytesToNumberBE(y)},invertBatch:y=>FpInvertBatch(g,y),cmov:(y,_,E)=>E?_:y});return Object.freeze(g)}function getFieldBytesLength(s){if(typeof s!="bigint")throw new Error("field order must be bigint");const e=s.toString(2).length;return Math.ceil(e/8)}function getMinHashLength(s){const e=getFieldBytesLength(s);return e+Math.ceil(e/2)}function mapHashToField(s,e,t=!1){const o=s.length,a=getFieldBytesLength(e),c=getMinHashLength(e);if(o<16||o<c||o>1024)throw new Error("expected "+c+"-1024 bytes of input, got "+o);const d=t?bytesToNumberLE(s):bytesToNumberBE(s),g=mod(d,e-_1n$6)+_1n$6;return t?numberToBytesLE(g,a):numberToBytesBE(g,a)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$4=BigInt(0),_1n$5=BigInt(1);function constTimeNegate(s,e){const t=e.negate();return s?t:e}function validateW(s,e){if(!Number.isSafeInteger(s)||s<=0||s>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+s)}function calcWOpts(s,e){validateW(s,e);const t=Math.ceil(e/s)+1,o=2**(s-1),a=2**s,c=bitMask(s),d=BigInt(s);return{windows:t,windowSize:o,mask:c,maxNumber:a,shiftBy:d}}function calcOffsets(s,e,t){const{windowSize:o,mask:a,maxNumber:c,shiftBy:d}=t;let g=Number(s&a),y=s>>d;g>o&&(g-=c,y+=_1n$5);const _=e*o,E=_+Math.abs(g)-1,S=g===0,A=g<0,C=e%2!==0;return{nextN:y,offset:E,isZero:S,isNeg:A,isNegF:C,offsetF:_}}function validateMSMPoints(s,e){if(!Array.isArray(s))throw new Error("array expected");s.forEach((t,o)=>{if(!(t instanceof e))throw new Error("invalid point at index "+o)})}function validateMSMScalars(s,e){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((t,o)=>{if(!e.isValid(t))throw new Error("invalid scalar at index "+o)})}const pointPrecomputes=new WeakMap,pointWindowSizes=new WeakMap;function getW(s){return pointWindowSizes.get(s)||1}function wNAF(s,e){return{constTimeNegate,hasPrecomputes(t){return getW(t)!==1},unsafeLadder(t,o,a=s.ZERO){let c=t;for(;o>_0n$4;)o&_1n$5&&(a=a.add(c)),c=c.double(),o>>=_1n$5;return a},precomputeWindow(t,o){const{windows:a,windowSize:c}=calcWOpts(o,e),d=[];let g=t,y=g;for(let _=0;_<a;_++){y=g,d.push(y);for(let E=1;E<c;E++)y=y.add(g),d.push(y);g=y.double()}return d},wNAF(t,o,a){let c=s.ZERO,d=s.BASE;const g=calcWOpts(t,e);for(let y=0;y<g.windows;y++){const{nextN:_,offset:E,isZero:S,isNeg:A,isNegF:C,offsetF:N}=calcOffsets(a,y,g);a=_,S?d=d.add(constTimeNegate(C,o[N])):c=c.add(constTimeNegate(A,o[E]))}return{p:c,f:d}},wNAFUnsafe(t,o,a,c=s.ZERO){const d=calcWOpts(t,e);for(let g=0;g<d.windows&&a!==_0n$4;g++){const{nextN:y,offset:_,isZero:E,isNeg:S}=calcOffsets(a,g,d);if(a=y,!E){const A=o[_];c=c.add(S?A.negate():A)}}return c},getPrecomputes(t,o,a){let c=pointPrecomputes.get(o);return c||(c=this.precomputeWindow(o,t),t!==1&&pointPrecomputes.set(o,a(c))),c},wNAFCached(t,o,a){const c=getW(t);return this.wNAF(c,this.getPrecomputes(c,t,a),o)},wNAFCachedUnsafe(t,o,a,c){const d=getW(t);return d===1?this.unsafeLadder(t,o,c):this.wNAFUnsafe(d,this.getPrecomputes(d,t,a),o,c)},setWindowSize(t,o){validateW(o,e),pointWindowSizes.set(t,o),pointPrecomputes.delete(t)}}}function pippenger(s,e,t,o){validateMSMPoints(t,s),validateMSMScalars(o,e);const a=t.length,c=o.length;if(a!==c)throw new Error("arrays of points and scalars must have equal length");const d=s.ZERO,g=bitLen(BigInt(a));let y=1;g>12?y=g-3:g>4?y=g-2:g>0&&(y=2);const _=bitMask(y),E=new Array(Number(_)+1).fill(d),S=Math.floor((e.BITS-1)/y)*y;let A=d;for(let C=S;C>=0;C-=y){E.fill(d);for(let O=0;O<c;O++){const I=o[O],P=Number(I>>BigInt(C)&_);E[P]=E[P].add(t[O])}let N=d;for(let O=E.length-1,I=d;O>0;O--)I=I.add(E[O]),N=N.add(I);if(A=A.add(N),C!==0)for(let O=0;O<y;O++)A=A.double()}return A}function validateBasic(s){return validateField(s.Fp),validateObject(s,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(s.n,s.nBitLength),...s,p:s.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$4=BigInt(1),_2n$3=BigInt(2),_8n$1=BigInt(8),VERIFY_DEFAULT={zip215:!0};function validateOpts$1(s){const e=validateBasic(s);return validateObject(s,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function twistedEdwards(s){const e=validateOpts$1(s),{Fp:t,n:o,prehash:a,hash:c,randomBytes:d,nByteLength:g,h:y}=e,_=_2n$3<<BigInt(g*8)-_1n$4,E=t.create,S=Field(e.n,e.nBitLength);function A(W,ee){const ie=t.sqr(W),X=t.sqr(ee),F=t.add(t.mul(e.a,ie),X),J=t.add(t.ONE,t.mul(e.d,t.mul(ie,X)));return t.eql(F,J)}if(!A(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const C=e.uvRatio||((W,ee)=>{try{return{isValid:!0,value:t.sqrt(W*t.inv(ee))}}catch{return{isValid:!1,value:_0n$3}}}),N=e.adjustScalarBytes||(W=>W),O=e.domain||((W,ee,ie)=>{if(abool("phflag",ie),ee.length||ie)throw new Error("Contexts/pre-hash are not supported");return W});function I(W,ee,ie=!1){const X=ie?_1n$4:_0n$3;aInRange("coordinate "+W,ee,X,_)}function P(W){if(!(W instanceof H))throw new Error("ExtendedPoint expected")}const j=memoized((W,ee)=>{const{ex:ie,ey:X,ez:F}=W,J=W.is0();ee==null&&(ee=J?_8n$1:t.inv(F));const Ee=E(ie*ee),Re=E(X*ee),Te=E(F*ee);if(J)return{x:_0n$3,y:_1n$4};if(Te!==_1n$4)throw new Error("invZ was invalid");return{x:Ee,y:Re}}),B=memoized(W=>{const{a:ee,d:ie}=e;if(W.is0())throw new Error("bad point: ZERO");const{ex:X,ey:F,ez:J,et:Ee}=W,Re=E(X*X),Te=E(F*F),Ue=E(J*J),ze=E(Ue*Ue),Ke=E(Re*ee),it=E(Ue*E(Ke+Te)),Ye=E(ze+E(ie*E(Re*Te)));if(it!==Ye)throw new Error("bad point: equation left != right (1)");const Ce=E(X*F),ft=E(J*Ee);if(Ce!==ft)throw new Error("bad point: equation left != right (2)");return!0});class H{constructor(ee,ie,X,F){I("x",ee),I("y",ie),I("z",X,!0),I("t",F),this.ex=ee,this.ey=ie,this.ez=X,this.et=F,Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(ee){if(ee instanceof H)throw new Error("extended point not allowed");const{x:ie,y:X}=ee||{};return I("x",ie),I("y",X),new H(ie,X,_1n$4,E(ie*X))}static normalizeZ(ee){const ie=FpInvertBatch(t,ee.map(X=>X.ez));return ee.map((X,F)=>X.toAffine(ie[F])).map(H.fromAffine)}static msm(ee,ie){return pippenger(H,S,ee,ie)}_setWindowSize(ee){Q.setWindowSize(this,ee)}assertValidity(){B(this)}equals(ee){P(ee);const{ex:ie,ey:X,ez:F}=this,{ex:J,ey:Ee,ez:Re}=ee,Te=E(ie*Re),Ue=E(J*F),ze=E(X*Re),Ke=E(Ee*F);return Te===Ue&&ze===Ke}is0(){return this.equals(H.ZERO)}negate(){return new H(E(-this.ex),this.ey,this.ez,E(-this.et))}double(){const{a:ee}=e,{ex:ie,ey:X,ez:F}=this,J=E(ie*ie),Ee=E(X*X),Re=E(_2n$3*E(F*F)),Te=E(ee*J),Ue=ie+X,ze=E(E(Ue*Ue)-J-Ee),Ke=Te+Ee,it=Ke-Re,Ye=Te-Ee,Ce=E(ze*it),ft=E(Ke*Ye),Ze=E(ze*Ye),nt=E(it*Ke);return new H(Ce,ft,nt,Ze)}add(ee){P(ee);const{a:ie,d:X}=e,{ex:F,ey:J,ez:Ee,et:Re}=this,{ex:Te,ey:Ue,ez:ze,et:Ke}=ee,it=E(F*Te),Ye=E(J*Ue),Ce=E(Re*X*Ke),ft=E(Ee*ze),Ze=E((F+J)*(Te+Ue)-it-Ye),nt=ft-Ce,dt=ft+Ce,gt=E(Ye-ie*it),et=E(Ze*nt),he=E(dt*gt),ue=E(Ze*gt),_e=E(nt*dt);return new H(et,he,_e,ue)}subtract(ee){return this.add(ee.negate())}wNAF(ee){return Q.wNAFCached(this,ee,H.normalizeZ)}multiply(ee){const ie=ee;aInRange("scalar",ie,_1n$4,o);const{p:X,f:F}=this.wNAF(ie);return H.normalizeZ([X,F])[0]}multiplyUnsafe(ee,ie=H.ZERO){const X=ee;return aInRange("scalar",X,_0n$3,o),X===_0n$3?oe:this.is0()||X===_1n$4?this:Q.wNAFCachedUnsafe(this,X,H.normalizeZ,ie)}isSmallOrder(){return this.multiplyUnsafe(y).is0()}isTorsionFree(){return Q.unsafeLadder(this,o).is0()}toAffine(ee){return j(this,ee)}clearCofactor(){const{h:ee}=e;return ee===_1n$4?this:this.multiplyUnsafe(ee)}static fromHex(ee,ie=!1){const{d:X,a:F}=e,J=t.BYTES;ee=ensureBytes("pointHex",ee,J),abool("zip215",ie);const Ee=ee.slice(),Re=ee[J-1];Ee[J-1]=Re&-129;const Te=bytesToNumberLE(Ee),Ue=ie?_:t.ORDER;aInRange("pointHex.y",Te,_0n$3,Ue);const ze=E(Te*Te),Ke=E(ze-_1n$4),it=E(X*ze-F);let{isValid:Ye,value:Ce}=C(Ke,it);if(!Ye)throw new Error("Point.fromHex: invalid y coordinate");const ft=(Ce&_1n$4)===_1n$4,Ze=(Re&128)!==0;if(!ie&&Ce===_0n$3&&Ze)throw new Error("Point.fromHex: x=0 and x_0=1");return Ze!==ft&&(Ce=E(-Ce)),H.fromAffine({x:Ce,y:Te})}static fromPrivateKey(ee){const{scalar:ie}=ce(ee);return se.multiply(ie)}toRawBytes(){const{x:ee,y:ie}=this.toAffine(),X=numberToBytesLE(ie,t.BYTES);return X[X.length-1]|=ee&_1n$4?128:0,X}toHex(){return bytesToHex(this.toRawBytes())}}H.BASE=new H(e.Gx,e.Gy,_1n$4,E(e.Gx*e.Gy)),H.ZERO=new H(_0n$3,_1n$4,_1n$4,_0n$3);const{BASE:se,ZERO:oe}=H,Q=wNAF(H,g*8);function fe(W){return mod(W,o)}function Z(W){return fe(bytesToNumberLE(W))}function ce(W){const ee=t.BYTES;W=ensureBytes("private key",W,ee);const ie=ensureBytes("hashed private key",c(W),2*ee),X=N(ie.slice(0,ee)),F=ie.slice(ee,2*ee),J=Z(X);return{head:X,prefix:F,scalar:J}}function ge(W){const{head:ee,prefix:ie,scalar:X}=ce(W),F=se.multiply(X),J=F.toRawBytes();return{head:ee,prefix:ie,scalar:X,point:F,pointBytes:J}}function me(W){return ge(W).pointBytes}function V(W=Uint8Array.of(),...ee){const ie=concatBytes(...ee);return Z(c(O(ie,ensureBytes("context",W),!!a)))}function R(W,ee,ie={}){W=ensureBytes("message",W),a&&(W=a(W));const{prefix:X,scalar:F,pointBytes:J}=ge(ee),Ee=V(ie.context,X,W),Re=se.multiply(Ee).toRawBytes(),Te=V(ie.context,Re,J,W),Ue=fe(Ee+Te*F);aInRange("signature.s",Ue,_0n$3,o);const ze=concatBytes(Re,numberToBytesLE(Ue,t.BYTES));return ensureBytes("result",ze,t.BYTES*2)}const L=VERIFY_DEFAULT;function z(W,ee,ie,X=L){const{context:F,zip215:J}=X,Ee=t.BYTES;W=ensureBytes("signature",W,2*Ee),ee=ensureBytes("message",ee),ie=ensureBytes("publicKey",ie,Ee),J!==void 0&&abool("zip215",J),a&&(ee=a(ee));const Re=bytesToNumberLE(W.slice(Ee,2*Ee));let Te,Ue,ze;try{Te=H.fromHex(ie,J),Ue=H.fromHex(W.slice(0,Ee),J),ze=se.multiplyUnsafe(Re)}catch{return!1}if(!J&&Te.isSmallOrder())return!1;const Ke=V(F,Ue.toRawBytes(),Te.toRawBytes(),ee);return Ue.add(Te.multiplyUnsafe(Ke)).subtract(ze).clearCofactor().equals(H.ZERO)}return se._setWindowSize(8),{CURVE:e,getPublicKey:me,sign:R,verify:z,ExtendedPoint:H,utils:{getExtendedPublicKey:ge,randomPrivateKey:()=>d(t.BYTES),precompute(W=8,ee=H.BASE){return ee._setWindowSize(W),ee.multiply(BigInt(3)),ee}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ED25519_P=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ED25519_SQRT_M1=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const _1n$3=BigInt(1),_2n$2=BigInt(2);BigInt(3);const _5n=BigInt(5),_8n=BigInt(8);function ed25519_pow_2_252_3(s){const e=BigInt(10),t=BigInt(20),o=BigInt(40),a=BigInt(80),c=ED25519_P,g=s*s%c*s%c,y=pow2(g,_2n$2,c)*g%c,_=pow2(y,_1n$3,c)*s%c,E=pow2(_,_5n,c)*_%c,S=pow2(E,e,c)*E%c,A=pow2(S,t,c)*S%c,C=pow2(A,o,c)*A%c,N=pow2(C,a,c)*C%c,O=pow2(N,a,c)*C%c,I=pow2(O,e,c)*E%c;return{pow_p_5_8:pow2(I,_2n$2,c)*s%c,b2:g}}function adjustScalarBytes(s){return s[0]&=248,s[31]&=127,s[31]|=64,s}function uvRatio(s,e){const t=ED25519_P,o=mod(e*e*e,t),a=mod(o*o*e,t),c=ed25519_pow_2_252_3(s*a).pow_p_5_8;let d=mod(s*o*c,t);const g=mod(e*d*d,t),y=d,_=mod(d*ED25519_SQRT_M1,t),E=g===s,S=g===mod(-s,t),A=g===mod(-s*ED25519_SQRT_M1,t);return E&&(d=y),(S||A)&&(d=_),isNegativeLE(d,t)&&(d=mod(-d,t)),{isValid:E||S,value:d}}const Fp=(()=>Field(ED25519_P,void 0,!0))(),ed25519Defaults=(()=>({a:Fp.create(BigInt(-1)),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:_8n,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:sha512,randomBytes,adjustScalarBytes,uvRatio}))(),ed25519=(()=>twistedEdwards(ed25519Defaults))();var bn={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(__viteBrowserExternal$1);bn.exports;(function(s){(function(e,t){function o(V,R){if(!V)throw new Error(R||"Assertion failed")}function a(V,R){V.super_=R;var L=function(){};L.prototype=R.prototype,V.prototype=new L,V.prototype.constructor=V}function c(V,R,L){if(c.isBN(V))return V;this.negative=0,this.words=null,this.length=0,this.red=null,V!==null&&((R==="le"||R==="be")&&(L=R,R=10),this._init(V||0,R||10,L||"be"))}typeof e=="object"?e.exports=c:t.BN=c,c.BN=c,c.wordSize=26;var d;try{typeof window<"u"&&typeof window.Buffer<"u"?d=window.Buffer:d=require$$0$1.Buffer}catch{}c.isBN=function(R){return R instanceof c?!0:R!==null&&typeof R=="object"&&R.constructor.wordSize===c.wordSize&&Array.isArray(R.words)},c.max=function(R,L){return R.cmp(L)>0?R:L},c.min=function(R,L){return R.cmp(L)<0?R:L},c.prototype._init=function(R,L,z){if(typeof R=="number")return this._initNumber(R,L,z);if(typeof R=="object")return this._initArray(R,L,z);L==="hex"&&(L=16),o(L===(L|0)&&L>=2&&L<=36),R=R.toString().replace(/\s+/g,"");var Y=0;R[0]==="-"&&(Y++,this.negative=1),Y<R.length&&(L===16?this._parseHex(R,Y,z):(this._parseBase(R,L,Y),z==="le"&&this._initArray(this.toArray(),L,z)))},c.prototype._initNumber=function(R,L,z){R<0&&(this.negative=1,R=-R),R<67108864?(this.words=[R&67108863],this.length=1):R<4503599627370496?(this.words=[R&67108863,R/67108864&67108863],this.length=2):(o(R<9007199254740992),this.words=[R&67108863,R/67108864&67108863,1],this.length=3),z==="le"&&this._initArray(this.toArray(),L,z)},c.prototype._initArray=function(R,L,z){if(o(typeof R.length=="number"),R.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(R.length/3),this.words=new Array(this.length);for(var Y=0;Y<this.length;Y++)this.words[Y]=0;var W,ee,ie=0;if(z==="be")for(Y=R.length-1,W=0;Y>=0;Y-=3)ee=R[Y]|R[Y-1]<<8|R[Y-2]<<16,this.words[W]|=ee<<ie&67108863,this.words[W+1]=ee>>>26-ie&67108863,ie+=24,ie>=26&&(ie-=26,W++);else if(z==="le")for(Y=0,W=0;Y<R.length;Y+=3)ee=R[Y]|R[Y+1]<<8|R[Y+2]<<16,this.words[W]|=ee<<ie&67108863,this.words[W+1]=ee>>>26-ie&67108863,ie+=24,ie>=26&&(ie-=26,W++);return this._strip()};function g(V,R){var L=V.charCodeAt(R);if(L>=48&&L<=57)return L-48;if(L>=65&&L<=70)return L-55;if(L>=97&&L<=102)return L-87;o(!1,"Invalid character in "+V)}function y(V,R,L){var z=g(V,L);return L-1>=R&&(z|=g(V,L-1)<<4),z}c.prototype._parseHex=function(R,L,z){this.length=Math.ceil((R.length-L)/6),this.words=new Array(this.length);for(var Y=0;Y<this.length;Y++)this.words[Y]=0;var W=0,ee=0,ie;if(z==="be")for(Y=R.length-1;Y>=L;Y-=2)ie=y(R,L,Y)<<W,this.words[ee]|=ie&67108863,W>=18?(W-=18,ee+=1,this.words[ee]|=ie>>>26):W+=8;else{var X=R.length-L;for(Y=X%2===0?L+1:L;Y<R.length;Y+=2)ie=y(R,L,Y)<<W,this.words[ee]|=ie&67108863,W>=18?(W-=18,ee+=1,this.words[ee]|=ie>>>26):W+=8}this._strip()};function _(V,R,L,z){for(var Y=0,W=0,ee=Math.min(V.length,L),ie=R;ie<ee;ie++){var X=V.charCodeAt(ie)-48;Y*=z,X>=49?W=X-49+10:X>=17?W=X-17+10:W=X,o(X>=0&&W<z,"Invalid character"),Y+=W}return Y}c.prototype._parseBase=function(R,L,z){this.words=[0],this.length=1;for(var Y=0,W=1;W<=67108863;W*=L)Y++;Y--,W=W/L|0;for(var ee=R.length-z,ie=ee%Y,X=Math.min(ee,ee-ie)+z,F=0,J=z;J<X;J+=Y)F=_(R,J,J+Y,L),this.imuln(W),this.words[0]+F<67108864?this.words[0]+=F:this._iaddn(F);if(ie!==0){var Ee=1;for(F=_(R,J,R.length,L),J=0;J<ie;J++)Ee*=L;this.imuln(Ee),this.words[0]+F<67108864?this.words[0]+=F:this._iaddn(F)}this._strip()},c.prototype.copy=function(R){R.words=new Array(this.length);for(var L=0;L<this.length;L++)R.words[L]=this.words[L];R.length=this.length,R.negative=this.negative,R.red=this.red};function E(V,R){V.words=R.words,V.length=R.length,V.negative=R.negative,V.red=R.red}if(c.prototype._move=function(R){E(R,this)},c.prototype.clone=function(){var R=new c(null);return this.copy(R),R},c.prototype._expand=function(R){for(;this.length<R;)this.words[this.length++]=0;return this},c.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{c.prototype[Symbol.for("nodejs.util.inspect.custom")]=S}catch{c.prototype.inspect=S}else c.prototype.inspect=S;function S(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var A=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],C=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],N=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];c.prototype.toString=function(R,L){R=R||10,L=L|0||1;var z;if(R===16||R==="hex"){z="";for(var Y=0,W=0,ee=0;ee<this.length;ee++){var ie=this.words[ee],X=((ie<<Y|W)&16777215).toString(16);W=ie>>>24-Y&16777215,Y+=2,Y>=26&&(Y-=26,ee--),W!==0||ee!==this.length-1?z=A[6-X.length]+X+z:z=X+z}for(W!==0&&(z=W.toString(16)+z);z.length%L!==0;)z="0"+z;return this.negative!==0&&(z="-"+z),z}if(R===(R|0)&&R>=2&&R<=36){var F=C[R],J=N[R];z="";var Ee=this.clone();for(Ee.negative=0;!Ee.isZero();){var Re=Ee.modrn(J).toString(R);Ee=Ee.idivn(J),Ee.isZero()?z=Re+z:z=A[F-Re.length]+Re+z}for(this.isZero()&&(z="0"+z);z.length%L!==0;)z="0"+z;return this.negative!==0&&(z="-"+z),z}o(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var R=this.words[0];return this.length===2?R+=this.words[1]*67108864:this.length===3&&this.words[2]===1?R+=4503599627370496+this.words[1]*67108864:this.length>2&&o(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-R:R},c.prototype.toJSON=function(){return this.toString(16,2)},d&&(c.prototype.toBuffer=function(R,L){return this.toArrayLike(d,R,L)}),c.prototype.toArray=function(R,L){return this.toArrayLike(Array,R,L)};var O=function(R,L){return R.allocUnsafe?R.allocUnsafe(L):new R(L)};c.prototype.toArrayLike=function(R,L,z){this._strip();var Y=this.byteLength(),W=z||Math.max(1,Y);o(Y<=W,"byte array longer than desired length"),o(W>0,"Requested array length <= 0");var ee=O(R,W),ie=L==="le"?"LE":"BE";return this["_toArrayLike"+ie](ee,Y),ee},c.prototype._toArrayLikeLE=function(R,L){for(var z=0,Y=0,W=0,ee=0;W<this.length;W++){var ie=this.words[W]<<ee|Y;R[z++]=ie&255,z<R.length&&(R[z++]=ie>>8&255),z<R.length&&(R[z++]=ie>>16&255),ee===6?(z<R.length&&(R[z++]=ie>>24&255),Y=0,ee=0):(Y=ie>>>24,ee+=2)}if(z<R.length)for(R[z++]=Y;z<R.length;)R[z++]=0},c.prototype._toArrayLikeBE=function(R,L){for(var z=R.length-1,Y=0,W=0,ee=0;W<this.length;W++){var ie=this.words[W]<<ee|Y;R[z--]=ie&255,z>=0&&(R[z--]=ie>>8&255),z>=0&&(R[z--]=ie>>16&255),ee===6?(z>=0&&(R[z--]=ie>>24&255),Y=0,ee=0):(Y=ie>>>24,ee+=2)}if(z>=0)for(R[z--]=Y;z>=0;)R[z--]=0},Math.clz32?c.prototype._countBits=function(R){return 32-Math.clz32(R)}:c.prototype._countBits=function(R){var L=R,z=0;return L>=4096&&(z+=13,L>>>=13),L>=64&&(z+=7,L>>>=7),L>=8&&(z+=4,L>>>=4),L>=2&&(z+=2,L>>>=2),z+L},c.prototype._zeroBits=function(R){if(R===0)return 26;var L=R,z=0;return L&8191||(z+=13,L>>>=13),L&127||(z+=7,L>>>=7),L&15||(z+=4,L>>>=4),L&3||(z+=2,L>>>=2),L&1||z++,z},c.prototype.bitLength=function(){var R=this.words[this.length-1],L=this._countBits(R);return(this.length-1)*26+L};function I(V){for(var R=new Array(V.bitLength()),L=0;L<R.length;L++){var z=L/26|0,Y=L%26;R[L]=V.words[z]>>>Y&1}return R}c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var R=0,L=0;L<this.length;L++){var z=this._zeroBits(this.words[L]);if(R+=z,z!==26)break}return R},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(R){return this.negative!==0?this.abs().inotn(R).iaddn(1):this.clone()},c.prototype.fromTwos=function(R){return this.testn(R-1)?this.notn(R).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(R){for(;this.length<R.length;)this.words[this.length++]=0;for(var L=0;L<R.length;L++)this.words[L]=this.words[L]|R.words[L];return this._strip()},c.prototype.ior=function(R){return o((this.negative|R.negative)===0),this.iuor(R)},c.prototype.or=function(R){return this.length>R.length?this.clone().ior(R):R.clone().ior(this)},c.prototype.uor=function(R){return this.length>R.length?this.clone().iuor(R):R.clone().iuor(this)},c.prototype.iuand=function(R){var L;this.length>R.length?L=R:L=this;for(var z=0;z<L.length;z++)this.words[z]=this.words[z]&R.words[z];return this.length=L.length,this._strip()},c.prototype.iand=function(R){return o((this.negative|R.negative)===0),this.iuand(R)},c.prototype.and=function(R){return this.length>R.length?this.clone().iand(R):R.clone().iand(this)},c.prototype.uand=function(R){return this.length>R.length?this.clone().iuand(R):R.clone().iuand(this)},c.prototype.iuxor=function(R){var L,z;this.length>R.length?(L=this,z=R):(L=R,z=this);for(var Y=0;Y<z.length;Y++)this.words[Y]=L.words[Y]^z.words[Y];if(this!==L)for(;Y<L.length;Y++)this.words[Y]=L.words[Y];return this.length=L.length,this._strip()},c.prototype.ixor=function(R){return o((this.negative|R.negative)===0),this.iuxor(R)},c.prototype.xor=function(R){return this.length>R.length?this.clone().ixor(R):R.clone().ixor(this)},c.prototype.uxor=function(R){return this.length>R.length?this.clone().iuxor(R):R.clone().iuxor(this)},c.prototype.inotn=function(R){o(typeof R=="number"&&R>=0);var L=Math.ceil(R/26)|0,z=R%26;this._expand(L),z>0&&L--;for(var Y=0;Y<L;Y++)this.words[Y]=~this.words[Y]&67108863;return z>0&&(this.words[Y]=~this.words[Y]&67108863>>26-z),this._strip()},c.prototype.notn=function(R){return this.clone().inotn(R)},c.prototype.setn=function(R,L){o(typeof R=="number"&&R>=0);var z=R/26|0,Y=R%26;return this._expand(z+1),L?this.words[z]=this.words[z]|1<<Y:this.words[z]=this.words[z]&~(1<<Y),this._strip()},c.prototype.iadd=function(R){var L;if(this.negative!==0&&R.negative===0)return this.negative=0,L=this.isub(R),this.negative^=1,this._normSign();if(this.negative===0&&R.negative!==0)return R.negative=0,L=this.isub(R),R.negative=1,L._normSign();var z,Y;this.length>R.length?(z=this,Y=R):(z=R,Y=this);for(var W=0,ee=0;ee<Y.length;ee++)L=(z.words[ee]|0)+(Y.words[ee]|0)+W,this.words[ee]=L&67108863,W=L>>>26;for(;W!==0&&ee<z.length;ee++)L=(z.words[ee]|0)+W,this.words[ee]=L&67108863,W=L>>>26;if(this.length=z.length,W!==0)this.words[this.length]=W,this.length++;else if(z!==this)for(;ee<z.length;ee++)this.words[ee]=z.words[ee];return this},c.prototype.add=function(R){var L;return R.negative!==0&&this.negative===0?(R.negative=0,L=this.sub(R),R.negative^=1,L):R.negative===0&&this.negative!==0?(this.negative=0,L=R.sub(this),this.negative=1,L):this.length>R.length?this.clone().iadd(R):R.clone().iadd(this)},c.prototype.isub=function(R){if(R.negative!==0){R.negative=0;var L=this.iadd(R);return R.negative=1,L._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(R),this.negative=1,this._normSign();var z=this.cmp(R);if(z===0)return this.negative=0,this.length=1,this.words[0]=0,this;var Y,W;z>0?(Y=this,W=R):(Y=R,W=this);for(var ee=0,ie=0;ie<W.length;ie++)L=(Y.words[ie]|0)-(W.words[ie]|0)+ee,ee=L>>26,this.words[ie]=L&67108863;for(;ee!==0&&ie<Y.length;ie++)L=(Y.words[ie]|0)+ee,ee=L>>26,this.words[ie]=L&67108863;if(ee===0&&ie<Y.length&&Y!==this)for(;ie<Y.length;ie++)this.words[ie]=Y.words[ie];return this.length=Math.max(this.length,ie),Y!==this&&(this.negative=1),this._strip()},c.prototype.sub=function(R){return this.clone().isub(R)};function P(V,R,L){L.negative=R.negative^V.negative;var z=V.length+R.length|0;L.length=z,z=z-1|0;var Y=V.words[0]|0,W=R.words[0]|0,ee=Y*W,ie=ee&67108863,X=ee/67108864|0;L.words[0]=ie;for(var F=1;F<z;F++){for(var J=X>>>26,Ee=X&67108863,Re=Math.min(F,R.length-1),Te=Math.max(0,F-V.length+1);Te<=Re;Te++){var Ue=F-Te|0;Y=V.words[Ue]|0,W=R.words[Te]|0,ee=Y*W+Ee,J+=ee/67108864|0,Ee=ee&67108863}L.words[F]=Ee|0,X=J|0}return X!==0?L.words[F]=X|0:L.length--,L._strip()}var j=function(R,L,z){var Y=R.words,W=L.words,ee=z.words,ie=0,X,F,J,Ee=Y[0]|0,Re=Ee&8191,Te=Ee>>>13,Ue=Y[1]|0,ze=Ue&8191,Ke=Ue>>>13,it=Y[2]|0,Ye=it&8191,Ce=it>>>13,ft=Y[3]|0,Ze=ft&8191,nt=ft>>>13,dt=Y[4]|0,gt=dt&8191,et=dt>>>13,he=Y[5]|0,ue=he&8191,_e=he>>>13,Ge=Y[6]|0,He=Ge&8191,Ve=Ge>>>13,pt=Y[7]|0,We=pt&8191,te=pt>>>13,U=Y[8]|0,$=U&8191,ae=U>>>13,be=Y[9]|0,Se=be&8191,Ae=be>>>13,Ie=W[0]|0,$e=Ie&8191,je=Ie>>>13,lt=W[1]|0,ht=lt&8191,yt=lt>>>13,st=W[2]|0,ye=st&8191,Xe=st>>>13,ct=W[3]|0,mt=ct&8191,at=ct>>>13,Vt=W[4]|0,xt=Vt&8191,It=Vt>>>13,tn=W[5]|0,bt=tn&8191,Dt=tn>>>13,on=W[6]|0,Wt=on&8191,kt=on>>>13,yn=W[7]|0,Ut=yn&8191,Qe=yn>>>13,An=W[8]|0,Kt=An&8191,Ft=An>>>13,Mn=W[9]|0,Xt=Mn&8191,de=Mn>>>13;z.negative=R.negative^L.negative,z.length=19,X=Math.imul(Re,$e),F=Math.imul(Re,je),F=F+Math.imul(Te,$e)|0,J=Math.imul(Te,je);var Me=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Me>>>26)|0,Me&=67108863,X=Math.imul(ze,$e),F=Math.imul(ze,je),F=F+Math.imul(Ke,$e)|0,J=Math.imul(Ke,je),X=X+Math.imul(Re,ht)|0,F=F+Math.imul(Re,yt)|0,F=F+Math.imul(Te,ht)|0,J=J+Math.imul(Te,yt)|0;var De=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(De>>>26)|0,De&=67108863,X=Math.imul(Ye,$e),F=Math.imul(Ye,je),F=F+Math.imul(Ce,$e)|0,J=Math.imul(Ce,je),X=X+Math.imul(ze,ht)|0,F=F+Math.imul(ze,yt)|0,F=F+Math.imul(Ke,ht)|0,J=J+Math.imul(Ke,yt)|0,X=X+Math.imul(Re,ye)|0,F=F+Math.imul(Re,Xe)|0,F=F+Math.imul(Te,ye)|0,J=J+Math.imul(Te,Xe)|0;var Fe=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Fe>>>26)|0,Fe&=67108863,X=Math.imul(Ze,$e),F=Math.imul(Ze,je),F=F+Math.imul(nt,$e)|0,J=Math.imul(nt,je),X=X+Math.imul(Ye,ht)|0,F=F+Math.imul(Ye,yt)|0,F=F+Math.imul(Ce,ht)|0,J=J+Math.imul(Ce,yt)|0,X=X+Math.imul(ze,ye)|0,F=F+Math.imul(ze,Xe)|0,F=F+Math.imul(Ke,ye)|0,J=J+Math.imul(Ke,Xe)|0,X=X+Math.imul(Re,mt)|0,F=F+Math.imul(Re,at)|0,F=F+Math.imul(Te,mt)|0,J=J+Math.imul(Te,at)|0;var Pe=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,X=Math.imul(gt,$e),F=Math.imul(gt,je),F=F+Math.imul(et,$e)|0,J=Math.imul(et,je),X=X+Math.imul(Ze,ht)|0,F=F+Math.imul(Ze,yt)|0,F=F+Math.imul(nt,ht)|0,J=J+Math.imul(nt,yt)|0,X=X+Math.imul(Ye,ye)|0,F=F+Math.imul(Ye,Xe)|0,F=F+Math.imul(Ce,ye)|0,J=J+Math.imul(Ce,Xe)|0,X=X+Math.imul(ze,mt)|0,F=F+Math.imul(ze,at)|0,F=F+Math.imul(Ke,mt)|0,J=J+Math.imul(Ke,at)|0,X=X+Math.imul(Re,xt)|0,F=F+Math.imul(Re,It)|0,F=F+Math.imul(Te,xt)|0,J=J+Math.imul(Te,It)|0;var rt=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(rt>>>26)|0,rt&=67108863,X=Math.imul(ue,$e),F=Math.imul(ue,je),F=F+Math.imul(_e,$e)|0,J=Math.imul(_e,je),X=X+Math.imul(gt,ht)|0,F=F+Math.imul(gt,yt)|0,F=F+Math.imul(et,ht)|0,J=J+Math.imul(et,yt)|0,X=X+Math.imul(Ze,ye)|0,F=F+Math.imul(Ze,Xe)|0,F=F+Math.imul(nt,ye)|0,J=J+Math.imul(nt,Xe)|0,X=X+Math.imul(Ye,mt)|0,F=F+Math.imul(Ye,at)|0,F=F+Math.imul(Ce,mt)|0,J=J+Math.imul(Ce,at)|0,X=X+Math.imul(ze,xt)|0,F=F+Math.imul(ze,It)|0,F=F+Math.imul(Ke,xt)|0,J=J+Math.imul(Ke,It)|0,X=X+Math.imul(Re,bt)|0,F=F+Math.imul(Re,Dt)|0,F=F+Math.imul(Te,bt)|0,J=J+Math.imul(Te,Dt)|0;var ot=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(ot>>>26)|0,ot&=67108863,X=Math.imul(He,$e),F=Math.imul(He,je),F=F+Math.imul(Ve,$e)|0,J=Math.imul(Ve,je),X=X+Math.imul(ue,ht)|0,F=F+Math.imul(ue,yt)|0,F=F+Math.imul(_e,ht)|0,J=J+Math.imul(_e,yt)|0,X=X+Math.imul(gt,ye)|0,F=F+Math.imul(gt,Xe)|0,F=F+Math.imul(et,ye)|0,J=J+Math.imul(et,Xe)|0,X=X+Math.imul(Ze,mt)|0,F=F+Math.imul(Ze,at)|0,F=F+Math.imul(nt,mt)|0,J=J+Math.imul(nt,at)|0,X=X+Math.imul(Ye,xt)|0,F=F+Math.imul(Ye,It)|0,F=F+Math.imul(Ce,xt)|0,J=J+Math.imul(Ce,It)|0,X=X+Math.imul(ze,bt)|0,F=F+Math.imul(ze,Dt)|0,F=F+Math.imul(Ke,bt)|0,J=J+Math.imul(Ke,Dt)|0,X=X+Math.imul(Re,Wt)|0,F=F+Math.imul(Re,kt)|0,F=F+Math.imul(Te,Wt)|0,J=J+Math.imul(Te,kt)|0;var St=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(St>>>26)|0,St&=67108863,X=Math.imul(We,$e),F=Math.imul(We,je),F=F+Math.imul(te,$e)|0,J=Math.imul(te,je),X=X+Math.imul(He,ht)|0,F=F+Math.imul(He,yt)|0,F=F+Math.imul(Ve,ht)|0,J=J+Math.imul(Ve,yt)|0,X=X+Math.imul(ue,ye)|0,F=F+Math.imul(ue,Xe)|0,F=F+Math.imul(_e,ye)|0,J=J+Math.imul(_e,Xe)|0,X=X+Math.imul(gt,mt)|0,F=F+Math.imul(gt,at)|0,F=F+Math.imul(et,mt)|0,J=J+Math.imul(et,at)|0,X=X+Math.imul(Ze,xt)|0,F=F+Math.imul(Ze,It)|0,F=F+Math.imul(nt,xt)|0,J=J+Math.imul(nt,It)|0,X=X+Math.imul(Ye,bt)|0,F=F+Math.imul(Ye,Dt)|0,F=F+Math.imul(Ce,bt)|0,J=J+Math.imul(Ce,Dt)|0,X=X+Math.imul(ze,Wt)|0,F=F+Math.imul(ze,kt)|0,F=F+Math.imul(Ke,Wt)|0,J=J+Math.imul(Ke,kt)|0,X=X+Math.imul(Re,Ut)|0,F=F+Math.imul(Re,Qe)|0,F=F+Math.imul(Te,Ut)|0,J=J+Math.imul(Te,Qe)|0;var Et=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Et>>>26)|0,Et&=67108863,X=Math.imul($,$e),F=Math.imul($,je),F=F+Math.imul(ae,$e)|0,J=Math.imul(ae,je),X=X+Math.imul(We,ht)|0,F=F+Math.imul(We,yt)|0,F=F+Math.imul(te,ht)|0,J=J+Math.imul(te,yt)|0,X=X+Math.imul(He,ye)|0,F=F+Math.imul(He,Xe)|0,F=F+Math.imul(Ve,ye)|0,J=J+Math.imul(Ve,Xe)|0,X=X+Math.imul(ue,mt)|0,F=F+Math.imul(ue,at)|0,F=F+Math.imul(_e,mt)|0,J=J+Math.imul(_e,at)|0,X=X+Math.imul(gt,xt)|0,F=F+Math.imul(gt,It)|0,F=F+Math.imul(et,xt)|0,J=J+Math.imul(et,It)|0,X=X+Math.imul(Ze,bt)|0,F=F+Math.imul(Ze,Dt)|0,F=F+Math.imul(nt,bt)|0,J=J+Math.imul(nt,Dt)|0,X=X+Math.imul(Ye,Wt)|0,F=F+Math.imul(Ye,kt)|0,F=F+Math.imul(Ce,Wt)|0,J=J+Math.imul(Ce,kt)|0,X=X+Math.imul(ze,Ut)|0,F=F+Math.imul(ze,Qe)|0,F=F+Math.imul(Ke,Ut)|0,J=J+Math.imul(Ke,Qe)|0,X=X+Math.imul(Re,Kt)|0,F=F+Math.imul(Re,Ft)|0,F=F+Math.imul(Te,Kt)|0,J=J+Math.imul(Te,Ft)|0;var Rt=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,X=Math.imul(Se,$e),F=Math.imul(Se,je),F=F+Math.imul(Ae,$e)|0,J=Math.imul(Ae,je),X=X+Math.imul($,ht)|0,F=F+Math.imul($,yt)|0,F=F+Math.imul(ae,ht)|0,J=J+Math.imul(ae,yt)|0,X=X+Math.imul(We,ye)|0,F=F+Math.imul(We,Xe)|0,F=F+Math.imul(te,ye)|0,J=J+Math.imul(te,Xe)|0,X=X+Math.imul(He,mt)|0,F=F+Math.imul(He,at)|0,F=F+Math.imul(Ve,mt)|0,J=J+Math.imul(Ve,at)|0,X=X+Math.imul(ue,xt)|0,F=F+Math.imul(ue,It)|0,F=F+Math.imul(_e,xt)|0,J=J+Math.imul(_e,It)|0,X=X+Math.imul(gt,bt)|0,F=F+Math.imul(gt,Dt)|0,F=F+Math.imul(et,bt)|0,J=J+Math.imul(et,Dt)|0,X=X+Math.imul(Ze,Wt)|0,F=F+Math.imul(Ze,kt)|0,F=F+Math.imul(nt,Wt)|0,J=J+Math.imul(nt,kt)|0,X=X+Math.imul(Ye,Ut)|0,F=F+Math.imul(Ye,Qe)|0,F=F+Math.imul(Ce,Ut)|0,J=J+Math.imul(Ce,Qe)|0,X=X+Math.imul(ze,Kt)|0,F=F+Math.imul(ze,Ft)|0,F=F+Math.imul(Ke,Kt)|0,J=J+Math.imul(Ke,Ft)|0,X=X+Math.imul(Re,Xt)|0,F=F+Math.imul(Re,de)|0,F=F+Math.imul(Te,Xt)|0,J=J+Math.imul(Te,de)|0;var Oe=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,X=Math.imul(Se,ht),F=Math.imul(Se,yt),F=F+Math.imul(Ae,ht)|0,J=Math.imul(Ae,yt),X=X+Math.imul($,ye)|0,F=F+Math.imul($,Xe)|0,F=F+Math.imul(ae,ye)|0,J=J+Math.imul(ae,Xe)|0,X=X+Math.imul(We,mt)|0,F=F+Math.imul(We,at)|0,F=F+Math.imul(te,mt)|0,J=J+Math.imul(te,at)|0,X=X+Math.imul(He,xt)|0,F=F+Math.imul(He,It)|0,F=F+Math.imul(Ve,xt)|0,J=J+Math.imul(Ve,It)|0,X=X+Math.imul(ue,bt)|0,F=F+Math.imul(ue,Dt)|0,F=F+Math.imul(_e,bt)|0,J=J+Math.imul(_e,Dt)|0,X=X+Math.imul(gt,Wt)|0,F=F+Math.imul(gt,kt)|0,F=F+Math.imul(et,Wt)|0,J=J+Math.imul(et,kt)|0,X=X+Math.imul(Ze,Ut)|0,F=F+Math.imul(Ze,Qe)|0,F=F+Math.imul(nt,Ut)|0,J=J+Math.imul(nt,Qe)|0,X=X+Math.imul(Ye,Kt)|0,F=F+Math.imul(Ye,Ft)|0,F=F+Math.imul(Ce,Kt)|0,J=J+Math.imul(Ce,Ft)|0,X=X+Math.imul(ze,Xt)|0,F=F+Math.imul(ze,de)|0,F=F+Math.imul(Ke,Xt)|0,J=J+Math.imul(Ke,de)|0;var Mt=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,X=Math.imul(Se,ye),F=Math.imul(Se,Xe),F=F+Math.imul(Ae,ye)|0,J=Math.imul(Ae,Xe),X=X+Math.imul($,mt)|0,F=F+Math.imul($,at)|0,F=F+Math.imul(ae,mt)|0,J=J+Math.imul(ae,at)|0,X=X+Math.imul(We,xt)|0,F=F+Math.imul(We,It)|0,F=F+Math.imul(te,xt)|0,J=J+Math.imul(te,It)|0,X=X+Math.imul(He,bt)|0,F=F+Math.imul(He,Dt)|0,F=F+Math.imul(Ve,bt)|0,J=J+Math.imul(Ve,Dt)|0,X=X+Math.imul(ue,Wt)|0,F=F+Math.imul(ue,kt)|0,F=F+Math.imul(_e,Wt)|0,J=J+Math.imul(_e,kt)|0,X=X+Math.imul(gt,Ut)|0,F=F+Math.imul(gt,Qe)|0,F=F+Math.imul(et,Ut)|0,J=J+Math.imul(et,Qe)|0,X=X+Math.imul(Ze,Kt)|0,F=F+Math.imul(Ze,Ft)|0,F=F+Math.imul(nt,Kt)|0,J=J+Math.imul(nt,Ft)|0,X=X+Math.imul(Ye,Xt)|0,F=F+Math.imul(Ye,de)|0,F=F+Math.imul(Ce,Xt)|0,J=J+Math.imul(Ce,de)|0;var Ct=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,X=Math.imul(Se,mt),F=Math.imul(Se,at),F=F+Math.imul(Ae,mt)|0,J=Math.imul(Ae,at),X=X+Math.imul($,xt)|0,F=F+Math.imul($,It)|0,F=F+Math.imul(ae,xt)|0,J=J+Math.imul(ae,It)|0,X=X+Math.imul(We,bt)|0,F=F+Math.imul(We,Dt)|0,F=F+Math.imul(te,bt)|0,J=J+Math.imul(te,Dt)|0,X=X+Math.imul(He,Wt)|0,F=F+Math.imul(He,kt)|0,F=F+Math.imul(Ve,Wt)|0,J=J+Math.imul(Ve,kt)|0,X=X+Math.imul(ue,Ut)|0,F=F+Math.imul(ue,Qe)|0,F=F+Math.imul(_e,Ut)|0,J=J+Math.imul(_e,Qe)|0,X=X+Math.imul(gt,Kt)|0,F=F+Math.imul(gt,Ft)|0,F=F+Math.imul(et,Kt)|0,J=J+Math.imul(et,Ft)|0,X=X+Math.imul(Ze,Xt)|0,F=F+Math.imul(Ze,de)|0,F=F+Math.imul(nt,Xt)|0,J=J+Math.imul(nt,de)|0;var Qt=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,X=Math.imul(Se,xt),F=Math.imul(Se,It),F=F+Math.imul(Ae,xt)|0,J=Math.imul(Ae,It),X=X+Math.imul($,bt)|0,F=F+Math.imul($,Dt)|0,F=F+Math.imul(ae,bt)|0,J=J+Math.imul(ae,Dt)|0,X=X+Math.imul(We,Wt)|0,F=F+Math.imul(We,kt)|0,F=F+Math.imul(te,Wt)|0,J=J+Math.imul(te,kt)|0,X=X+Math.imul(He,Ut)|0,F=F+Math.imul(He,Qe)|0,F=F+Math.imul(Ve,Ut)|0,J=J+Math.imul(Ve,Qe)|0,X=X+Math.imul(ue,Kt)|0,F=F+Math.imul(ue,Ft)|0,F=F+Math.imul(_e,Kt)|0,J=J+Math.imul(_e,Ft)|0,X=X+Math.imul(gt,Xt)|0,F=F+Math.imul(gt,de)|0,F=F+Math.imul(et,Xt)|0,J=J+Math.imul(et,de)|0;var Jt=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,X=Math.imul(Se,bt),F=Math.imul(Se,Dt),F=F+Math.imul(Ae,bt)|0,J=Math.imul(Ae,Dt),X=X+Math.imul($,Wt)|0,F=F+Math.imul($,kt)|0,F=F+Math.imul(ae,Wt)|0,J=J+Math.imul(ae,kt)|0,X=X+Math.imul(We,Ut)|0,F=F+Math.imul(We,Qe)|0,F=F+Math.imul(te,Ut)|0,J=J+Math.imul(te,Qe)|0,X=X+Math.imul(He,Kt)|0,F=F+Math.imul(He,Ft)|0,F=F+Math.imul(Ve,Kt)|0,J=J+Math.imul(Ve,Ft)|0,X=X+Math.imul(ue,Xt)|0,F=F+Math.imul(ue,de)|0,F=F+Math.imul(_e,Xt)|0,J=J+Math.imul(_e,de)|0;var Lt=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,X=Math.imul(Se,Wt),F=Math.imul(Se,kt),F=F+Math.imul(Ae,Wt)|0,J=Math.imul(Ae,kt),X=X+Math.imul($,Ut)|0,F=F+Math.imul($,Qe)|0,F=F+Math.imul(ae,Ut)|0,J=J+Math.imul(ae,Qe)|0,X=X+Math.imul(We,Kt)|0,F=F+Math.imul(We,Ft)|0,F=F+Math.imul(te,Kt)|0,J=J+Math.imul(te,Ft)|0,X=X+Math.imul(He,Xt)|0,F=F+Math.imul(He,de)|0,F=F+Math.imul(Ve,Xt)|0,J=J+Math.imul(Ve,de)|0;var _t=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(_t>>>26)|0,_t&=67108863,X=Math.imul(Se,Ut),F=Math.imul(Se,Qe),F=F+Math.imul(Ae,Ut)|0,J=Math.imul(Ae,Qe),X=X+Math.imul($,Kt)|0,F=F+Math.imul($,Ft)|0,F=F+Math.imul(ae,Kt)|0,J=J+Math.imul(ae,Ft)|0,X=X+Math.imul(We,Xt)|0,F=F+Math.imul(We,de)|0,F=F+Math.imul(te,Xt)|0,J=J+Math.imul(te,de)|0;var ut=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(ut>>>26)|0,ut&=67108863,X=Math.imul(Se,Kt),F=Math.imul(Se,Ft),F=F+Math.imul(Ae,Kt)|0,J=Math.imul(Ae,Ft),X=X+Math.imul($,Xt)|0,F=F+Math.imul($,de)|0,F=F+Math.imul(ae,Xt)|0,J=J+Math.imul(ae,de)|0;var In=(ie+X|0)+((F&8191)<<13)|0;ie=(J+(F>>>13)|0)+(In>>>26)|0,In&=67108863,X=Math.imul(Se,Xt),F=Math.imul(Se,de),F=F+Math.imul(Ae,Xt)|0,J=Math.imul(Ae,de);var zt=(ie+X|0)+((F&8191)<<13)|0;return ie=(J+(F>>>13)|0)+(zt>>>26)|0,zt&=67108863,ee[0]=Me,ee[1]=De,ee[2]=Fe,ee[3]=Pe,ee[4]=rt,ee[5]=ot,ee[6]=St,ee[7]=Et,ee[8]=Rt,ee[9]=Oe,ee[10]=Mt,ee[11]=Ct,ee[12]=Qt,ee[13]=Jt,ee[14]=Lt,ee[15]=_t,ee[16]=ut,ee[17]=In,ee[18]=zt,ie!==0&&(ee[19]=ie,z.length++),z};Math.imul||(j=P);function B(V,R,L){L.negative=R.negative^V.negative,L.length=V.length+R.length;for(var z=0,Y=0,W=0;W<L.length-1;W++){var ee=Y;Y=0;for(var ie=z&67108863,X=Math.min(W,R.length-1),F=Math.max(0,W-V.length+1);F<=X;F++){var J=W-F,Ee=V.words[J]|0,Re=R.words[F]|0,Te=Ee*Re,Ue=Te&67108863;ee=ee+(Te/67108864|0)|0,Ue=Ue+ie|0,ie=Ue&67108863,ee=ee+(Ue>>>26)|0,Y+=ee>>>26,ee&=67108863}L.words[W]=ie,z=ee,ee=Y}return z!==0?L.words[W]=z:L.length--,L._strip()}function H(V,R,L){return B(V,R,L)}c.prototype.mulTo=function(R,L){var z,Y=this.length+R.length;return this.length===10&&R.length===10?z=j(this,R,L):Y<63?z=P(this,R,L):Y<1024?z=B(this,R,L):z=H(this,R,L),z},c.prototype.mul=function(R){var L=new c(null);return L.words=new Array(this.length+R.length),this.mulTo(R,L)},c.prototype.mulf=function(R){var L=new c(null);return L.words=new Array(this.length+R.length),H(this,R,L)},c.prototype.imul=function(R){return this.clone().mulTo(R,this)},c.prototype.imuln=function(R){var L=R<0;L&&(R=-R),o(typeof R=="number"),o(R<67108864);for(var z=0,Y=0;Y<this.length;Y++){var W=(this.words[Y]|0)*R,ee=(W&67108863)+(z&67108863);z>>=26,z+=W/67108864|0,z+=ee>>>26,this.words[Y]=ee&67108863}return z!==0&&(this.words[Y]=z,this.length++),this.length=R===0?1:this.length,L?this.ineg():this},c.prototype.muln=function(R){return this.clone().imuln(R)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(R){var L=I(R);if(L.length===0)return new c(1);for(var z=this,Y=0;Y<L.length&&L[Y]===0;Y++,z=z.sqr());if(++Y<L.length)for(var W=z.sqr();Y<L.length;Y++,W=W.sqr())L[Y]!==0&&(z=z.mul(W));return z},c.prototype.iushln=function(R){o(typeof R=="number"&&R>=0);var L=R%26,z=(R-L)/26,Y=67108863>>>26-L<<26-L,W;if(L!==0){var ee=0;for(W=0;W<this.length;W++){var ie=this.words[W]&Y,X=(this.words[W]|0)-ie<<L;this.words[W]=X|ee,ee=ie>>>26-L}ee&&(this.words[W]=ee,this.length++)}if(z!==0){for(W=this.length-1;W>=0;W--)this.words[W+z]=this.words[W];for(W=0;W<z;W++)this.words[W]=0;this.length+=z}return this._strip()},c.prototype.ishln=function(R){return o(this.negative===0),this.iushln(R)},c.prototype.iushrn=function(R,L,z){o(typeof R=="number"&&R>=0);var Y;L?Y=(L-L%26)/26:Y=0;var W=R%26,ee=Math.min((R-W)/26,this.length),ie=67108863^67108863>>>W<<W,X=z;if(Y-=ee,Y=Math.max(0,Y),X){for(var F=0;F<ee;F++)X.words[F]=this.words[F];X.length=ee}if(ee!==0)if(this.length>ee)for(this.length-=ee,F=0;F<this.length;F++)this.words[F]=this.words[F+ee];else this.words[0]=0,this.length=1;var J=0;for(F=this.length-1;F>=0&&(J!==0||F>=Y);F--){var Ee=this.words[F]|0;this.words[F]=J<<26-W|Ee>>>W,J=Ee&ie}return X&&J!==0&&(X.words[X.length++]=J),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},c.prototype.ishrn=function(R,L,z){return o(this.negative===0),this.iushrn(R,L,z)},c.prototype.shln=function(R){return this.clone().ishln(R)},c.prototype.ushln=function(R){return this.clone().iushln(R)},c.prototype.shrn=function(R){return this.clone().ishrn(R)},c.prototype.ushrn=function(R){return this.clone().iushrn(R)},c.prototype.testn=function(R){o(typeof R=="number"&&R>=0);var L=R%26,z=(R-L)/26,Y=1<<L;if(this.length<=z)return!1;var W=this.words[z];return!!(W&Y)},c.prototype.imaskn=function(R){o(typeof R=="number"&&R>=0);var L=R%26,z=(R-L)/26;if(o(this.negative===0,"imaskn works only with positive numbers"),this.length<=z)return this;if(L!==0&&z++,this.length=Math.min(z,this.length),L!==0){var Y=67108863^67108863>>>L<<L;this.words[this.length-1]&=Y}return this._strip()},c.prototype.maskn=function(R){return this.clone().imaskn(R)},c.prototype.iaddn=function(R){return o(typeof R=="number"),o(R<67108864),R<0?this.isubn(-R):this.negative!==0?this.length===1&&(this.words[0]|0)<=R?(this.words[0]=R-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(R),this.negative=1,this):this._iaddn(R)},c.prototype._iaddn=function(R){this.words[0]+=R;for(var L=0;L<this.length&&this.words[L]>=67108864;L++)this.words[L]-=67108864,L===this.length-1?this.words[L+1]=1:this.words[L+1]++;return this.length=Math.max(this.length,L+1),this},c.prototype.isubn=function(R){if(o(typeof R=="number"),o(R<67108864),R<0)return this.iaddn(-R);if(this.negative!==0)return this.negative=0,this.iaddn(R),this.negative=1,this;if(this.words[0]-=R,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var L=0;L<this.length&&this.words[L]<0;L++)this.words[L]+=67108864,this.words[L+1]-=1;return this._strip()},c.prototype.addn=function(R){return this.clone().iaddn(R)},c.prototype.subn=function(R){return this.clone().isubn(R)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(R,L,z){var Y=R.length+z,W;this._expand(Y);var ee,ie=0;for(W=0;W<R.length;W++){ee=(this.words[W+z]|0)+ie;var X=(R.words[W]|0)*L;ee-=X&67108863,ie=(ee>>26)-(X/67108864|0),this.words[W+z]=ee&67108863}for(;W<this.length-z;W++)ee=(this.words[W+z]|0)+ie,ie=ee>>26,this.words[W+z]=ee&67108863;if(ie===0)return this._strip();for(o(ie===-1),ie=0,W=0;W<this.length;W++)ee=-(this.words[W]|0)+ie,ie=ee>>26,this.words[W]=ee&67108863;return this.negative=1,this._strip()},c.prototype._wordDiv=function(R,L){var z=this.length-R.length,Y=this.clone(),W=R,ee=W.words[W.length-1]|0,ie=this._countBits(ee);z=26-ie,z!==0&&(W=W.ushln(z),Y.iushln(z),ee=W.words[W.length-1]|0);var X=Y.length-W.length,F;if(L!=="mod"){F=new c(null),F.length=X+1,F.words=new Array(F.length);for(var J=0;J<F.length;J++)F.words[J]=0}var Ee=Y.clone()._ishlnsubmul(W,1,X);Ee.negative===0&&(Y=Ee,F&&(F.words[X]=1));for(var Re=X-1;Re>=0;Re--){var Te=(Y.words[W.length+Re]|0)*67108864+(Y.words[W.length+Re-1]|0);for(Te=Math.min(Te/ee|0,67108863),Y._ishlnsubmul(W,Te,Re);Y.negative!==0;)Te--,Y.negative=0,Y._ishlnsubmul(W,1,Re),Y.isZero()||(Y.negative^=1);F&&(F.words[Re]=Te)}return F&&F._strip(),Y._strip(),L!=="div"&&z!==0&&Y.iushrn(z),{div:F||null,mod:Y}},c.prototype.divmod=function(R,L,z){if(o(!R.isZero()),this.isZero())return{div:new c(0),mod:new c(0)};var Y,W,ee;return this.negative!==0&&R.negative===0?(ee=this.neg().divmod(R,L),L!=="mod"&&(Y=ee.div.neg()),L!=="div"&&(W=ee.mod.neg(),z&&W.negative!==0&&W.iadd(R)),{div:Y,mod:W}):this.negative===0&&R.negative!==0?(ee=this.divmod(R.neg(),L),L!=="mod"&&(Y=ee.div.neg()),{div:Y,mod:ee.mod}):this.negative&R.negative?(ee=this.neg().divmod(R.neg(),L),L!=="div"&&(W=ee.mod.neg(),z&&W.negative!==0&&W.isub(R)),{div:ee.div,mod:W}):R.length>this.length||this.cmp(R)<0?{div:new c(0),mod:this}:R.length===1?L==="div"?{div:this.divn(R.words[0]),mod:null}:L==="mod"?{div:null,mod:new c(this.modrn(R.words[0]))}:{div:this.divn(R.words[0]),mod:new c(this.modrn(R.words[0]))}:this._wordDiv(R,L)},c.prototype.div=function(R){return this.divmod(R,"div",!1).div},c.prototype.mod=function(R){return this.divmod(R,"mod",!1).mod},c.prototype.umod=function(R){return this.divmod(R,"mod",!0).mod},c.prototype.divRound=function(R){var L=this.divmod(R);if(L.mod.isZero())return L.div;var z=L.div.negative!==0?L.mod.isub(R):L.mod,Y=R.ushrn(1),W=R.andln(1),ee=z.cmp(Y);return ee<0||W===1&&ee===0?L.div:L.div.negative!==0?L.div.isubn(1):L.div.iaddn(1)},c.prototype.modrn=function(R){var L=R<0;L&&(R=-R),o(R<=67108863);for(var z=(1<<26)%R,Y=0,W=this.length-1;W>=0;W--)Y=(z*Y+(this.words[W]|0))%R;return L?-Y:Y},c.prototype.modn=function(R){return this.modrn(R)},c.prototype.idivn=function(R){var L=R<0;L&&(R=-R),o(R<=67108863);for(var z=0,Y=this.length-1;Y>=0;Y--){var W=(this.words[Y]|0)+z*67108864;this.words[Y]=W/R|0,z=W%R}return this._strip(),L?this.ineg():this},c.prototype.divn=function(R){return this.clone().idivn(R)},c.prototype.egcd=function(R){o(R.negative===0),o(!R.isZero());var L=this,z=R.clone();L.negative!==0?L=L.umod(R):L=L.clone();for(var Y=new c(1),W=new c(0),ee=new c(0),ie=new c(1),X=0;L.isEven()&&z.isEven();)L.iushrn(1),z.iushrn(1),++X;for(var F=z.clone(),J=L.clone();!L.isZero();){for(var Ee=0,Re=1;!(L.words[0]&Re)&&Ee<26;++Ee,Re<<=1);if(Ee>0)for(L.iushrn(Ee);Ee-- >0;)(Y.isOdd()||W.isOdd())&&(Y.iadd(F),W.isub(J)),Y.iushrn(1),W.iushrn(1);for(var Te=0,Ue=1;!(z.words[0]&Ue)&&Te<26;++Te,Ue<<=1);if(Te>0)for(z.iushrn(Te);Te-- >0;)(ee.isOdd()||ie.isOdd())&&(ee.iadd(F),ie.isub(J)),ee.iushrn(1),ie.iushrn(1);L.cmp(z)>=0?(L.isub(z),Y.isub(ee),W.isub(ie)):(z.isub(L),ee.isub(Y),ie.isub(W))}return{a:ee,b:ie,gcd:z.iushln(X)}},c.prototype._invmp=function(R){o(R.negative===0),o(!R.isZero());var L=this,z=R.clone();L.negative!==0?L=L.umod(R):L=L.clone();for(var Y=new c(1),W=new c(0),ee=z.clone();L.cmpn(1)>0&&z.cmpn(1)>0;){for(var ie=0,X=1;!(L.words[0]&X)&&ie<26;++ie,X<<=1);if(ie>0)for(L.iushrn(ie);ie-- >0;)Y.isOdd()&&Y.iadd(ee),Y.iushrn(1);for(var F=0,J=1;!(z.words[0]&J)&&F<26;++F,J<<=1);if(F>0)for(z.iushrn(F);F-- >0;)W.isOdd()&&W.iadd(ee),W.iushrn(1);L.cmp(z)>=0?(L.isub(z),Y.isub(W)):(z.isub(L),W.isub(Y))}var Ee;return L.cmpn(1)===0?Ee=Y:Ee=W,Ee.cmpn(0)<0&&Ee.iadd(R),Ee},c.prototype.gcd=function(R){if(this.isZero())return R.abs();if(R.isZero())return this.abs();var L=this.clone(),z=R.clone();L.negative=0,z.negative=0;for(var Y=0;L.isEven()&&z.isEven();Y++)L.iushrn(1),z.iushrn(1);do{for(;L.isEven();)L.iushrn(1);for(;z.isEven();)z.iushrn(1);var W=L.cmp(z);if(W<0){var ee=L;L=z,z=ee}else if(W===0||z.cmpn(1)===0)break;L.isub(z)}while(!0);return z.iushln(Y)},c.prototype.invm=function(R){return this.egcd(R).a.umod(R)},c.prototype.isEven=function(){return(this.words[0]&1)===0},c.prototype.isOdd=function(){return(this.words[0]&1)===1},c.prototype.andln=function(R){return this.words[0]&R},c.prototype.bincn=function(R){o(typeof R=="number");var L=R%26,z=(R-L)/26,Y=1<<L;if(this.length<=z)return this._expand(z+1),this.words[z]|=Y,this;for(var W=Y,ee=z;W!==0&&ee<this.length;ee++){var ie=this.words[ee]|0;ie+=W,W=ie>>>26,ie&=67108863,this.words[ee]=ie}return W!==0&&(this.words[ee]=W,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(R){var L=R<0;if(this.negative!==0&&!L)return-1;if(this.negative===0&&L)return 1;this._strip();var z;if(this.length>1)z=1;else{L&&(R=-R),o(R<=67108863,"Number is too big");var Y=this.words[0]|0;z=Y===R?0:Y<R?-1:1}return this.negative!==0?-z|0:z},c.prototype.cmp=function(R){if(this.negative!==0&&R.negative===0)return-1;if(this.negative===0&&R.negative!==0)return 1;var L=this.ucmp(R);return this.negative!==0?-L|0:L},c.prototype.ucmp=function(R){if(this.length>R.length)return 1;if(this.length<R.length)return-1;for(var L=0,z=this.length-1;z>=0;z--){var Y=this.words[z]|0,W=R.words[z]|0;if(Y!==W){Y<W?L=-1:Y>W&&(L=1);break}}return L},c.prototype.gtn=function(R){return this.cmpn(R)===1},c.prototype.gt=function(R){return this.cmp(R)===1},c.prototype.gten=function(R){return this.cmpn(R)>=0},c.prototype.gte=function(R){return this.cmp(R)>=0},c.prototype.ltn=function(R){return this.cmpn(R)===-1},c.prototype.lt=function(R){return this.cmp(R)===-1},c.prototype.lten=function(R){return this.cmpn(R)<=0},c.prototype.lte=function(R){return this.cmp(R)<=0},c.prototype.eqn=function(R){return this.cmpn(R)===0},c.prototype.eq=function(R){return this.cmp(R)===0},c.red=function(R){return new ge(R)},c.prototype.toRed=function(R){return o(!this.red,"Already a number in reduction context"),o(this.negative===0,"red works only with positives"),R.convertTo(this)._forceRed(R)},c.prototype.fromRed=function(){return o(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(R){return this.red=R,this},c.prototype.forceRed=function(R){return o(!this.red,"Already a number in reduction context"),this._forceRed(R)},c.prototype.redAdd=function(R){return o(this.red,"redAdd works only with red numbers"),this.red.add(this,R)},c.prototype.redIAdd=function(R){return o(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,R)},c.prototype.redSub=function(R){return o(this.red,"redSub works only with red numbers"),this.red.sub(this,R)},c.prototype.redISub=function(R){return o(this.red,"redISub works only with red numbers"),this.red.isub(this,R)},c.prototype.redShl=function(R){return o(this.red,"redShl works only with red numbers"),this.red.shl(this,R)},c.prototype.redMul=function(R){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,R),this.red.mul(this,R)},c.prototype.redIMul=function(R){return o(this.red,"redMul works only with red numbers"),this.red._verify2(this,R),this.red.imul(this,R)},c.prototype.redSqr=function(){return o(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return o(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return o(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return o(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return o(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(R){return o(this.red&&!R.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,R)};var se={k256:null,p224:null,p192:null,p25519:null};function oe(V,R){this.name=V,this.p=new c(R,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}oe.prototype._tmp=function(){var R=new c(null);return R.words=new Array(Math.ceil(this.n/13)),R},oe.prototype.ireduce=function(R){var L=R,z;do this.split(L,this.tmp),L=this.imulK(L),L=L.iadd(this.tmp),z=L.bitLength();while(z>this.n);var Y=z<this.n?-1:L.ucmp(this.p);return Y===0?(L.words[0]=0,L.length=1):Y>0?L.isub(this.p):L.strip!==void 0?L.strip():L._strip(),L},oe.prototype.split=function(R,L){R.iushrn(this.n,0,L)},oe.prototype.imulK=function(R){return R.imul(this.k)};function Q(){oe.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}a(Q,oe),Q.prototype.split=function(R,L){for(var z=4194303,Y=Math.min(R.length,9),W=0;W<Y;W++)L.words[W]=R.words[W];if(L.length=Y,R.length<=9){R.words[0]=0,R.length=1;return}var ee=R.words[9];for(L.words[L.length++]=ee&z,W=10;W<R.length;W++){var ie=R.words[W]|0;R.words[W-10]=(ie&z)<<4|ee>>>22,ee=ie}ee>>>=22,R.words[W-10]=ee,ee===0&&R.length>10?R.length-=10:R.length-=9},Q.prototype.imulK=function(R){R.words[R.length]=0,R.words[R.length+1]=0,R.length+=2;for(var L=0,z=0;z<R.length;z++){var Y=R.words[z]|0;L+=Y*977,R.words[z]=L&67108863,L=Y*64+(L/67108864|0)}return R.words[R.length-1]===0&&(R.length--,R.words[R.length-1]===0&&R.length--),R};function fe(){oe.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}a(fe,oe);function Z(){oe.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}a(Z,oe);function ce(){oe.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}a(ce,oe),ce.prototype.imulK=function(R){for(var L=0,z=0;z<R.length;z++){var Y=(R.words[z]|0)*19+L,W=Y&67108863;Y>>>=26,R.words[z]=W,L=Y}return L!==0&&(R.words[R.length++]=L),R},c._prime=function(R){if(se[R])return se[R];var L;if(R==="k256")L=new Q;else if(R==="p224")L=new fe;else if(R==="p192")L=new Z;else if(R==="p25519")L=new ce;else throw new Error("Unknown prime "+R);return se[R]=L,L};function ge(V){if(typeof V=="string"){var R=c._prime(V);this.m=R.p,this.prime=R}else o(V.gtn(1),"modulus must be greater than 1"),this.m=V,this.prime=null}ge.prototype._verify1=function(R){o(R.negative===0,"red works only with positives"),o(R.red,"red works only with red numbers")},ge.prototype._verify2=function(R,L){o((R.negative|L.negative)===0,"red works only with positives"),o(R.red&&R.red===L.red,"red works only with red numbers")},ge.prototype.imod=function(R){return this.prime?this.prime.ireduce(R)._forceRed(this):(E(R,R.umod(this.m)._forceRed(this)),R)},ge.prototype.neg=function(R){return R.isZero()?R.clone():this.m.sub(R)._forceRed(this)},ge.prototype.add=function(R,L){this._verify2(R,L);var z=R.add(L);return z.cmp(this.m)>=0&&z.isub(this.m),z._forceRed(this)},ge.prototype.iadd=function(R,L){this._verify2(R,L);var z=R.iadd(L);return z.cmp(this.m)>=0&&z.isub(this.m),z},ge.prototype.sub=function(R,L){this._verify2(R,L);var z=R.sub(L);return z.cmpn(0)<0&&z.iadd(this.m),z._forceRed(this)},ge.prototype.isub=function(R,L){this._verify2(R,L);var z=R.isub(L);return z.cmpn(0)<0&&z.iadd(this.m),z},ge.prototype.shl=function(R,L){return this._verify1(R),this.imod(R.ushln(L))},ge.prototype.imul=function(R,L){return this._verify2(R,L),this.imod(R.imul(L))},ge.prototype.mul=function(R,L){return this._verify2(R,L),this.imod(R.mul(L))},ge.prototype.isqr=function(R){return this.imul(R,R.clone())},ge.prototype.sqr=function(R){return this.mul(R,R)},ge.prototype.sqrt=function(R){if(R.isZero())return R.clone();var L=this.m.andln(3);if(o(L%2===1),L===3){var z=this.m.add(new c(1)).iushrn(2);return this.pow(R,z)}for(var Y=this.m.subn(1),W=0;!Y.isZero()&&Y.andln(1)===0;)W++,Y.iushrn(1);o(!Y.isZero());var ee=new c(1).toRed(this),ie=ee.redNeg(),X=this.m.subn(1).iushrn(1),F=this.m.bitLength();for(F=new c(2*F*F).toRed(this);this.pow(F,X).cmp(ie)!==0;)F.redIAdd(ie);for(var J=this.pow(F,Y),Ee=this.pow(R,Y.addn(1).iushrn(1)),Re=this.pow(R,Y),Te=W;Re.cmp(ee)!==0;){for(var Ue=Re,ze=0;Ue.cmp(ee)!==0;ze++)Ue=Ue.redSqr();o(ze<Te);var Ke=this.pow(J,new c(1).iushln(Te-ze-1));Ee=Ee.redMul(Ke),J=Ke.redSqr(),Re=Re.redMul(J),Te=ze}return Ee},ge.prototype.invm=function(R){var L=R._invmp(this.m);return L.negative!==0?(L.negative=0,this.imod(L).redNeg()):this.imod(L)},ge.prototype.pow=function(R,L){if(L.isZero())return new c(1).toRed(this);if(L.cmpn(1)===0)return R.clone();var z=4,Y=new Array(1<<z);Y[0]=new c(1).toRed(this),Y[1]=R;for(var W=2;W<Y.length;W++)Y[W]=this.mul(Y[W-1],R);var ee=Y[0],ie=0,X=0,F=L.bitLength()%26;for(F===0&&(F=26),W=L.length-1;W>=0;W--){for(var J=L.words[W],Ee=F-1;Ee>=0;Ee--){var Re=J>>Ee&1;if(ee!==Y[0]&&(ee=this.sqr(ee)),Re===0&&ie===0){X=0;continue}ie<<=1,ie|=Re,X++,!(X!==z&&(W!==0||Ee!==0))&&(ee=this.mul(ee,Y[ie]),X=0,ie=0)}F=26}return ee},ge.prototype.convertTo=function(R){var L=R.umod(this.m);return L===R?L.clone():L},ge.prototype.convertFrom=function(R){var L=R.clone();return L.red=null,L},c.mont=function(R){return new me(R)};function me(V){ge.call(this,V),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}a(me,ge),me.prototype.convertTo=function(R){return this.imod(R.ushln(this.shift))},me.prototype.convertFrom=function(R){var L=this.imod(R.mul(this.rinv));return L.red=null,L},me.prototype.imul=function(R,L){if(R.isZero()||L.isZero())return R.words[0]=0,R.length=1,R;var z=R.imul(L),Y=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),W=z.isub(Y).iushrn(this.shift),ee=W;return W.cmp(this.m)>=0?ee=W.isub(this.m):W.cmpn(0)<0&&(ee=W.iadd(this.m)),ee._forceRed(this)},me.prototype.mul=function(R,L){if(R.isZero()||L.isZero())return new c(0)._forceRed(this);var z=R.mul(L),Y=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),W=z.isub(Y).iushrn(this.shift),ee=W;return W.cmp(this.m)>=0?ee=W.isub(this.m):W.cmpn(0)<0&&(ee=W.iadd(this.m)),ee._forceRed(this)},me.prototype.invm=function(R){var L=this.imod(R._invmp(this.m).mul(this.r2));return L._forceRed(this)}})(s,commonjsGlobal)})(bn);var bnExports=bn.exports;const BN=getDefaultExportFromCjs$1(bnExports);var safeBuffer={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(s,e){var t=buffer,o=t.Buffer;function a(d,g){for(var y in d)g[y]=d[y]}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?s.exports=t:(a(t,e),e.Buffer=c);function c(d,g,y){return o(d,g,y)}c.prototype=Object.create(o.prototype),a(o,c),c.from=function(d,g,y){if(typeof d=="number")throw new TypeError("Argument must not be a number");return o(d,g,y)},c.alloc=function(d,g,y){if(typeof d!="number")throw new TypeError("Argument must be a number");var _=o(d);return g!==void 0?typeof y=="string"?_.fill(g,y):_.fill(g):_.fill(0),_},c.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return o(d)},c.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return t.SlowBuffer(d)}})(safeBuffer,safeBuffer.exports);var safeBufferExports=safeBuffer.exports,_Buffer=safeBufferExports.Buffer;function base(s){if(s.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),t=0;t<e.length;t++)e[t]=255;for(var o=0;o<s.length;o++){var a=s.charAt(o),c=a.charCodeAt(0);if(e[c]!==255)throw new TypeError(a+" is ambiguous");e[c]=o}var d=s.length,g=s.charAt(0),y=Math.log(d)/Math.log(256),_=Math.log(256)/Math.log(d);function E(C){if((Array.isArray(C)||C instanceof Uint8Array)&&(C=_Buffer.from(C)),!_Buffer.isBuffer(C))throw new TypeError("Expected Buffer");if(C.length===0)return"";for(var N=0,O=0,I=0,P=C.length;I!==P&&C[I]===0;)I++,N++;for(var j=(P-I)*_+1>>>0,B=new Uint8Array(j);I!==P;){for(var H=C[I],se=0,oe=j-1;(H!==0||se<O)&&oe!==-1;oe--,se++)H+=256*B[oe]>>>0,B[oe]=H%d>>>0,H=H/d>>>0;if(H!==0)throw new Error("Non-zero carry");O=se,I++}for(var Q=j-O;Q!==j&&B[Q]===0;)Q++;for(var fe=g.repeat(N);Q<j;++Q)fe+=s.charAt(B[Q]);return fe}function S(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return _Buffer.alloc(0);for(var N=0,O=0,I=0;C[N]===g;)O++,N++;for(var P=(C.length-N)*y+1>>>0,j=new Uint8Array(P);N<C.length;){var B=C.charCodeAt(N);if(B>255)return;var H=e[B];if(H===255)return;for(var se=0,oe=P-1;(H!==0||se<I)&&oe!==-1;oe--,se++)H+=d*j[oe]>>>0,j[oe]=H%256>>>0,H=H/256>>>0;if(H!==0)throw new Error("Non-zero carry");I=se,N++}for(var Q=P-I;Q!==P&&j[Q]===0;)Q++;var fe=_Buffer.allocUnsafe(O+(P-Q));fe.fill(0,0,O);for(var Z=O;Q!==P;)fe[Z++]=j[Q++];return fe}function A(C){var N=S(C);if(N)return N;throw new Error("Non-base"+d+" character")}return{encode:E,decodeUnsafe:S,decode:A}}var src=base,basex=src,ALPHABET="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",bs58=basex(ALPHABET);const bs58$1=getDefaultExportFromCjs$1(bs58),sha256$1=sha256$2;var lib={};function inRange(s,e,t){return e<=s&&s<=t}function ToDictionary(s){if(s===void 0)return{};if(s===Object(s))return s;throw TypeError("Could not convert argument to dictionary")}function stringToCodePoints(s){for(var e=String(s),t=e.length,o=0,a=[];o<t;){var c=e.charCodeAt(o);if(c<55296||c>57343)a.push(c);else if(56320<=c&&c<=57343)a.push(65533);else if(55296<=c&&c<=56319)if(o===t-1)a.push(65533);else{var d=s.charCodeAt(o+1);if(56320<=d&&d<=57343){var g=c&1023,y=d&1023;a.push(65536+(g<<10)+y),o+=1}else a.push(65533)}o+=1}return a}function codePointsToString(s){for(var e="",t=0;t<s.length;++t){var o=s[t];o<=65535?e+=String.fromCharCode(o):(o-=65536,e+=String.fromCharCode((o>>10)+55296,(o&1023)+56320))}return e}var end_of_stream=-1;function Stream(s){this.tokens=[].slice.call(s)}Stream.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():end_of_stream},prepend:function(s){if(Array.isArray(s))for(var e=s;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(s)},push:function(s){if(Array.isArray(s))for(var e=s;e.length;)this.tokens.push(e.shift());else this.tokens.push(s)}};var finished=-1;function decoderError(s,e){if(s)throw TypeError("Decoder error");return e||65533}var DEFAULT_ENCODING="utf-8";function TextDecoder$1(s,e){if(!(this instanceof TextDecoder$1))return new TextDecoder$1(s,e);if(s=s!==void 0?String(s).toLowerCase():DEFAULT_ENCODING,s!==DEFAULT_ENCODING)throw new Error("Encoding not supported. Only utf-8 is supported");e=ToDictionary(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=!!e.fatal,this._ignoreBOM=!!e.ignoreBOM,Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}TextDecoder$1.prototype={decode:function(e,t){var o;typeof e=="object"&&e instanceof ArrayBuffer?o=new Uint8Array(e):typeof e=="object"&&"buffer"in e&&e.buffer instanceof ArrayBuffer?o=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):o=new Uint8Array(0),t=ToDictionary(t),this._streaming||(this._decoder=new UTF8Decoder({fatal:this._fatal}),this._BOMseen=!1),this._streaming=!!t.stream;for(var a=new Stream(o),c=[],d;!a.endOfStream()&&(d=this._decoder.handler(a,a.read()),d!==finished);)d!==null&&(Array.isArray(d)?c.push.apply(c,d):c.push(d));if(!this._streaming){do{if(d=this._decoder.handler(a,a.read()),d===finished)break;d!==null&&(Array.isArray(d)?c.push.apply(c,d):c.push(d))}while(!a.endOfStream());this._decoder=null}return c.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(c[0]===65279?(this._BOMseen=!0,c.shift()):this._BOMseen=!0),codePointsToString(c)}};function TextEncoder$1(s,e){if(!(this instanceof TextEncoder$1))return new TextEncoder$1(s,e);if(s=s!==void 0?String(s).toLowerCase():DEFAULT_ENCODING,s!==DEFAULT_ENCODING)throw new Error("Encoding not supported. Only utf-8 is supported");e=ToDictionary(e),this._streaming=!1,this._encoder=null,this._options={fatal:!!e.fatal},Object.defineProperty(this,"encoding",{value:"utf-8"})}TextEncoder$1.prototype={encode:function(e,t){e=e?String(e):"",t=ToDictionary(t),this._streaming||(this._encoder=new UTF8Encoder(this._options)),this._streaming=!!t.stream;for(var o=[],a=new Stream(stringToCodePoints(e)),c;!a.endOfStream()&&(c=this._encoder.handler(a,a.read()),c!==finished);)Array.isArray(c)?o.push.apply(o,c):o.push(c);if(!this._streaming){for(;c=this._encoder.handler(a,a.read()),c!==finished;)Array.isArray(c)?o.push.apply(o,c):o.push(c);this._encoder=null}return new Uint8Array(o)}};function UTF8Decoder(s){var e=s.fatal,t=0,o=0,a=0,c=128,d=191;this.handler=function(g,y){if(y===end_of_stream&&a!==0)return a=0,decoderError(e);if(y===end_of_stream)return finished;if(a===0){if(inRange(y,0,127))return y;if(inRange(y,194,223))a=1,t=y-192;else if(inRange(y,224,239))y===224&&(c=160),y===237&&(d=159),a=2,t=y-224;else if(inRange(y,240,244))y===240&&(c=144),y===244&&(d=143),a=3,t=y-240;else return decoderError(e);return t=t<<6*a,null}if(!inRange(y,c,d))return t=a=o=0,c=128,d=191,g.prepend(y),decoderError(e);if(c=128,d=191,o+=1,t+=y-128<<6*(a-o),o!==a)return null;var _=t;return t=a=o=0,_}}function UTF8Encoder(s){s.fatal,this.handler=function(e,t){if(t===end_of_stream)return finished;if(inRange(t,0,127))return t;var o,a;inRange(t,128,2047)?(o=1,a=192):inRange(t,2048,65535)?(o=2,a=224):inRange(t,65536,1114111)&&(o=3,a=240);for(var c=[(t>>6*o)+a];o>0;){var d=t>>6*(o-1);c.push(128|d&63),o-=1}return c}}const encoding$1=Object.freeze(Object.defineProperty({__proto__:null,TextDecoder:TextDecoder$1,TextEncoder:TextEncoder$1},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(encoding$1);var __createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(s,e,t,o){o===void 0&&(o=t),Object.defineProperty(s,o,{enumerable:!0,get:function(){return e[t]}})}:function(s,e,t,o){o===void 0&&(o=t),s[o]=e[t]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(s,e){Object.defineProperty(s,"default",{enumerable:!0,value:e})}:function(s,e){s.default=e}),__decorate=commonjsGlobal&&commonjsGlobal.__decorate||function(s,e,t,o){var a=arguments.length,c=a<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,t):o,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(s,e,t,o);else for(var g=s.length-1;g>=0;g--)(d=s[g])&&(c=(a<3?d(c):a>3?d(e,t,c):d(e,t))||c);return a>3&&c&&Object.defineProperty(e,t,c),c},__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(s){if(s&&s.__esModule)return s;var e={};if(s!=null)for(var t in s)t!=="default"&&Object.hasOwnProperty.call(s,t)&&__createBinding(e,s,t);return __setModuleDefault(e,s),e},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(lib,"__esModule",{value:!0});var deserializeUnchecked_1=lib.deserializeUnchecked=deserialize_1=lib.deserialize=serialize_1=lib.serialize=lib.BinaryReader=lib.BinaryWriter=lib.BorshError=lib.baseDecode=lib.baseEncode=void 0;const bn_js_1=__importDefault(bnExports),bs58_1=__importDefault(bs58),encoding=__importStar(require$$2),ResolvedTextDecoder=typeof TextDecoder!="function"?encoding.TextDecoder:TextDecoder,textDecoder=new ResolvedTextDecoder("utf-8",{fatal:!0});function baseEncode(s){return typeof s=="string"&&(s=Buffer.from(s,"utf8")),bs58_1.default.encode(Buffer.from(s))}lib.baseEncode=baseEncode;function baseDecode(s){return Buffer.from(bs58_1.default.decode(s))}lib.baseDecode=baseDecode;const INITIAL_LENGTH=1024;class BorshError extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}lib.BorshError=BorshError;class BinaryWriter{constructor(){this.buf=Buffer.alloc(INITIAL_LENGTH),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(INITIAL_LENGTH)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(Buffer.from(new bn_js_1.default(e).toArray("le",64)))}writeBuffer(e){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),e,Buffer.alloc(INITIAL_LENGTH)]),this.length+=e.length}writeString(e){this.maybeResize();const t=Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const o of e)this.maybeResize(),t(o)}toArray(){return this.buf.subarray(0,this.length)}}lib.BinaryWriter=BinaryWriter;function handlingRangeError(s,e,t){const o=t.value;t.value=function(...a){try{return o.apply(this,a)}catch(c){if(c instanceof RangeError){const d=c.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(d)>=0)throw new BorshError("Reached the end of buffer when deserializing")}throw c}}}class BinaryReader{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new bn_js_1.default(e,"le")}readU128(){const e=this.readBuffer(16);return new bn_js_1.default(e,"le")}readU256(){const e=this.readBuffer(32);return new bn_js_1.default(e,"le")}readU512(){const e=this.readBuffer(64);return new bn_js_1.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new BorshError(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return textDecoder.decode(t)}catch(o){throw new BorshError(`Error decoding UTF-8 string: ${o}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),o=Array();for(let a=0;a<t;++a)o.push(e());return o}}__decorate([handlingRangeError],BinaryReader.prototype,"readU8",null);__decorate([handlingRangeError],BinaryReader.prototype,"readU16",null);__decorate([handlingRangeError],BinaryReader.prototype,"readU32",null);__decorate([handlingRangeError],BinaryReader.prototype,"readU64",null);__decorate([handlingRangeError],BinaryReader.prototype,"readU128",null);__decorate([handlingRangeError],BinaryReader.prototype,"readU256",null);__decorate([handlingRangeError],BinaryReader.prototype,"readU512",null);__decorate([handlingRangeError],BinaryReader.prototype,"readString",null);__decorate([handlingRangeError],BinaryReader.prototype,"readFixedArray",null);__decorate([handlingRangeError],BinaryReader.prototype,"readArray",null);lib.BinaryReader=BinaryReader;function capitalizeFirstLetter(s){return s.charAt(0).toUpperCase()+s.slice(1)}function serializeField(s,e,t,o,a){try{if(typeof o=="string")a[`write${capitalizeFirstLetter(o)}`](t);else if(o instanceof Array)if(typeof o[0]=="number"){if(t.length!==o[0])throw new BorshError(`Expecting byte array of length ${o[0]}, but got ${t.length} bytes`);a.writeFixedArray(t)}else if(o.length===2&&typeof o[1]=="number"){if(t.length!==o[1])throw new BorshError(`Expecting byte array of length ${o[1]}, but got ${t.length} bytes`);for(let c=0;c<o[1];c++)serializeField(s,null,t[c],o[0],a)}else a.writeArray(t,c=>{serializeField(s,e,c,o[0],a)});else if(o.kind!==void 0)switch(o.kind){case"option":{t==null?a.writeU8(0):(a.writeU8(1),serializeField(s,e,t,o.type,a));break}case"map":{a.writeU32(t.size),t.forEach((c,d)=>{serializeField(s,e,d,o.key,a),serializeField(s,e,c,o.value,a)});break}default:throw new BorshError(`FieldType ${o} unrecognized`)}else serializeStruct(s,t,a)}catch(c){throw c instanceof BorshError&&c.addToFieldPath(e),c}}function serializeStruct(s,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const o=s.get(e.constructor);if(!o)throw new BorshError(`Class ${e.constructor.name} is missing in schema`);if(o.kind==="struct")o.fields.map(([a,c])=>{serializeField(s,a,e[a],c,t)});else if(o.kind==="enum"){const a=e[o.field];for(let c=0;c<o.values.length;++c){const[d,g]=o.values[c];if(d===a){t.writeU8(c),serializeField(s,d,e[d],g,t);break}}}else throw new BorshError(`Unexpected schema kind: ${o.kind} for ${e.constructor.name}`)}function serialize(s,e,t=BinaryWriter){const o=new t;return serializeStruct(s,e,o),o.toArray()}var serialize_1=lib.serialize=serialize;function deserializeField(s,e,t,o){try{if(typeof t=="string")return o[`read${capitalizeFirstLetter(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return o.readFixedArray(t[0]);if(typeof t[1]=="number"){const a=[];for(let c=0;c<t[1];c++)a.push(deserializeField(s,null,t[0],o));return a}else return o.readArray(()=>deserializeField(s,e,t[0],o))}if(t.kind==="option")return o.readU8()?deserializeField(s,e,t.type,o):void 0;if(t.kind==="map"){let a=new Map;const c=o.readU32();for(let d=0;d<c;d++){const g=deserializeField(s,e,t.key,o),y=deserializeField(s,e,t.value,o);a.set(g,y)}return a}return deserializeStruct(s,t,o)}catch(a){throw a instanceof BorshError&&a.addToFieldPath(e),a}}function deserializeStruct(s,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const o=s.get(e);if(!o)throw new BorshError(`Class ${e.name} is missing in schema`);if(o.kind==="struct"){const a={};for(const[c,d]of s.get(e).fields)a[c]=deserializeField(s,c,d,t);return new e(a)}if(o.kind==="enum"){const a=t.readU8();if(a>=o.values.length)throw new BorshError(`Enum index: ${a} is out of range`);const[c,d]=o.values[a],g=deserializeField(s,c,d,t);return new e({[c]:g})}throw new BorshError(`Unexpected schema kind: ${o.kind} for ${e.constructor.name}`)}function deserialize(s,e,t,o=BinaryReader){const a=new o(t),c=deserializeStruct(s,e,a);if(a.offset<t.length)throw new BorshError(`Unexpected ${t.length-a.offset} bytes after deserialized data`);return c}var deserialize_1=lib.deserialize=deserialize;function deserializeUnchecked(s,e,t,o=BinaryReader){const a=new o(t);return deserializeStruct(s,e,a)}deserializeUnchecked_1=lib.deserializeUnchecked=deserializeUnchecked;var Layout$4={};Object.defineProperty(Layout$4,"__esModule",{value:!0});Layout$4.s16=Layout$4.s8=Layout$4.nu64be=Layout$4.u48be=Layout$4.u40be=Layout$4.u32be=Layout$4.u24be=Layout$4.u16be=nu64$1=Layout$4.nu64=Layout$4.u48=Layout$4.u40=u32$1=Layout$4.u32=Layout$4.u24=u16=Layout$4.u16=u8$1=Layout$4.u8=offset$1=Layout$4.offset=Layout$4.greedy=Layout$4.Constant=Layout$4.UTF8=Layout$4.CString=Layout$4.Blob=Layout$4.Boolean=Layout$4.BitField=Layout$4.BitStructure=Layout$4.VariantLayout=Layout$4.Union=Layout$4.UnionLayoutDiscriminator=Layout$4.UnionDiscriminator=Layout$4.Structure=Layout$4.Sequence=Layout$4.DoubleBE=Layout$4.Double=Layout$4.FloatBE=Layout$4.Float=Layout$4.NearInt64BE=Layout$4.NearInt64=Layout$4.NearUInt64BE=Layout$4.NearUInt64=Layout$4.IntBE=Layout$4.Int=Layout$4.UIntBE=Layout$4.UInt=Layout$4.OffsetLayout=Layout$4.GreedyCount=Layout$4.ExternalLayout=Layout$4.bindConstructorLayout=Layout$4.nameWithProperty=Layout$4.Layout=Layout$4.uint8ArrayToBuffer=Layout$4.checkUint8Array=void 0;Layout$4.constant=Layout$4.utf8=Layout$4.cstr=blob$1=Layout$4.blob=Layout$4.unionLayoutDiscriminator=Layout$4.union=seq=Layout$4.seq=Layout$4.bits=struct$1=Layout$4.struct=Layout$4.f64be=Layout$4.f64=Layout$4.f32be=Layout$4.f32=Layout$4.ns64be=Layout$4.s48be=Layout$4.s40be=Layout$4.s32be=Layout$4.s24be=Layout$4.s16be=ns64$1=Layout$4.ns64=Layout$4.s48=Layout$4.s40=Layout$4.s32=Layout$4.s24=void 0;const buffer_1=buffer;function checkUint8Array(s){if(!(s instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}Layout$4.checkUint8Array=checkUint8Array;function uint8ArrayToBuffer(s){return checkUint8Array(s),buffer_1.Buffer.from(s.buffer,s.byteOffset,s.length)}Layout$4.uint8ArrayToBuffer=uint8ArrayToBuffer;let Layout$3=class{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}};Layout$4.Layout=Layout$3;function nameWithProperty$2(s,e){return e.property?s+"["+e.property+"]":s}Layout$4.nameWithProperty=nameWithProperty$2;function bindConstructorLayout$1(s,e){if(typeof s!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(s,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof Layout$3))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");s.layout_=e,e.boundConstructor_=s,e.makeDestinationObject=()=>new s,Object.defineProperty(s.prototype,"encode",{value(t,o){return e.encode(this,t,o)},writable:!0}),Object.defineProperty(s,"decode",{value(t,o){return e.decode(t,o)},writable:!0})}Layout$4.bindConstructorLayout=bindConstructorLayout$1;let ExternalLayout$2=class extends Layout$3{isCount(){throw new Error("ExternalLayout is abstract")}};Layout$4.ExternalLayout=ExternalLayout$2;let GreedyCount$1=class extends ExternalLayout$2{constructor(e=1,t){if(!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t=0){checkUint8Array(e);const o=e.length-t;return Math.floor(o/this.elementSpan)}encode(e,t,o){return 0}};Layout$4.GreedyCount=GreedyCount$1;let OffsetLayout$2=class extends ExternalLayout$2{constructor(e,t=0,o){if(!(e instanceof Layout$3))throw new TypeError("layout must be a Layout");if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,o||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof UInt$2||this.layout instanceof UIntBE$2}decode(e,t=0){return this.layout.decode(e,t+this.offset)}encode(e,t,o=0){return this.layout.encode(e,t,o+this.offset)}};Layout$4.OffsetLayout=OffsetLayout$2;let UInt$2=class extends Layout$3{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return uint8ArrayToBuffer(e).readUIntLE(t,this.span)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeUIntLE(e,o,this.span),this.span}};Layout$4.UInt=UInt$2;let UIntBE$2=class extends Layout$3{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return uint8ArrayToBuffer(e).readUIntBE(t,this.span)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeUIntBE(e,o,this.span),this.span}};Layout$4.UIntBE=UIntBE$2;let Int$1=class extends Layout$3{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return uint8ArrayToBuffer(e).readIntLE(t,this.span)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeIntLE(e,o,this.span),this.span}};Layout$4.Int=Int$1;let IntBE$1=class extends Layout$3{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t=0){return uint8ArrayToBuffer(e).readIntBE(t,this.span)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeIntBE(e,o,this.span),this.span}};Layout$4.IntBE=IntBE$1;const V2E32$2=Math.pow(2,32);function divmodInt64$2(s){const e=Math.floor(s/V2E32$2),t=s-e*V2E32$2;return{hi32:e,lo32:t}}function roundedInt64$2(s,e){return s*V2E32$2+e}let NearUInt64$2=class extends Layout$3{constructor(e){super(8,e)}decode(e,t=0){const o=uint8ArrayToBuffer(e),a=o.readUInt32LE(t),c=o.readUInt32LE(t+4);return roundedInt64$2(c,a)}encode(e,t,o=0){const a=divmodInt64$2(e),c=uint8ArrayToBuffer(t);return c.writeUInt32LE(a.lo32,o),c.writeUInt32LE(a.hi32,o+4),8}};Layout$4.NearUInt64=NearUInt64$2;let NearUInt64BE$1=class extends Layout$3{constructor(e){super(8,e)}decode(e,t=0){const o=uint8ArrayToBuffer(e),a=o.readUInt32BE(t),c=o.readUInt32BE(t+4);return roundedInt64$2(a,c)}encode(e,t,o=0){const a=divmodInt64$2(e),c=uint8ArrayToBuffer(t);return c.writeUInt32BE(a.hi32,o),c.writeUInt32BE(a.lo32,o+4),8}};Layout$4.NearUInt64BE=NearUInt64BE$1;let NearInt64$2=class extends Layout$3{constructor(e){super(8,e)}decode(e,t=0){const o=uint8ArrayToBuffer(e),a=o.readUInt32LE(t),c=o.readInt32LE(t+4);return roundedInt64$2(c,a)}encode(e,t,o=0){const a=divmodInt64$2(e),c=uint8ArrayToBuffer(t);return c.writeUInt32LE(a.lo32,o),c.writeInt32LE(a.hi32,o+4),8}};Layout$4.NearInt64=NearInt64$2;let NearInt64BE$1=class extends Layout$3{constructor(e){super(8,e)}decode(e,t=0){const o=uint8ArrayToBuffer(e),a=o.readInt32BE(t),c=o.readUInt32BE(t+4);return roundedInt64$2(a,c)}encode(e,t,o=0){const a=divmodInt64$2(e),c=uint8ArrayToBuffer(t);return c.writeInt32BE(a.hi32,o),c.writeUInt32BE(a.lo32,o+4),8}};Layout$4.NearInt64BE=NearInt64BE$1;let Float$1=class extends Layout$3{constructor(e){super(4,e)}decode(e,t=0){return uint8ArrayToBuffer(e).readFloatLE(t)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeFloatLE(e,o),4}};Layout$4.Float=Float$1;let FloatBE$1=class extends Layout$3{constructor(e){super(4,e)}decode(e,t=0){return uint8ArrayToBuffer(e).readFloatBE(t)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeFloatBE(e,o),4}};Layout$4.FloatBE=FloatBE$1;let Double$1=class extends Layout$3{constructor(e){super(8,e)}decode(e,t=0){return uint8ArrayToBuffer(e).readDoubleLE(t)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeDoubleLE(e,o),8}};Layout$4.Double=Double$1;let DoubleBE$1=class extends Layout$3{constructor(e){super(8,e)}decode(e,t=0){return uint8ArrayToBuffer(e).readDoubleBE(t)}encode(e,t,o=0){return uint8ArrayToBuffer(t).writeDoubleBE(e,o),8}};Layout$4.DoubleBE=DoubleBE$1;let Sequence$1=class extends Layout$3{constructor(e,t,o){if(!(e instanceof Layout$3))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof ExternalLayout$2&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let a=-1;!(t instanceof ExternalLayout$2)&&0<e.span&&(a=t*e.span),super(a,o),this.elementLayout=e,this.count=t}getSpan(e,t=0){if(0<=this.span)return this.span;let o=0,a=this.count;if(a instanceof ExternalLayout$2&&(a=a.decode(e,t)),0<this.elementLayout.span)o=a*this.elementLayout.span;else{let c=0;for(;c<a;)o+=this.elementLayout.getSpan(e,t+o),++c}return o}decode(e,t=0){const o=[];let a=0,c=this.count;for(c instanceof ExternalLayout$2&&(c=c.decode(e,t));a<c;)o.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),a+=1;return o}encode(e,t,o=0){const a=this.elementLayout,c=e.reduce((d,g)=>d+a.encode(g,t,o+d),0);return this.count instanceof ExternalLayout$2&&this.count.encode(e.length,t,o),c}};Layout$4.Sequence=Sequence$1;let Structure$2=class extends Layout$3{constructor(e,t,o){if(!(Array.isArray(e)&&e.reduce((c,d)=>c&&d instanceof Layout$3,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&o===void 0&&(o=t,t=void 0);for(const c of e)if(0>c.span&&c.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let a=-1;try{a=e.reduce((c,d)=>c+d.getSpan(),0)}catch{}super(a,t),this.fields=e,this.decodePrefixes=!!o}getSpan(e,t=0){if(0<=this.span)return this.span;let o=0;try{o=this.fields.reduce((a,c)=>{const d=c.getSpan(e,t);return t+=d,a+d},0)}catch{throw new RangeError("indeterminate span")}return o}decode(e,t=0){checkUint8Array(e);const o=this.makeDestinationObject();for(const a of this.fields)if(a.property!==void 0&&(o[a.property]=a.decode(e,t)),t+=a.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return o}encode(e,t,o=0){const a=o;let c=0,d=0;for(const g of this.fields){let y=g.span;if(d=0<y?y:0,g.property!==void 0){const _=e[g.property];_!==void 0&&(d=g.encode(_,t,o),0>y&&(y=g.getSpan(t,o)))}c=o,o+=y}return c+d-a}fromArray(e){const t=this.makeDestinationObject();for(const o of this.fields)o.property!==void 0&&0<e.length&&(t[o.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const o of this.fields){if(o.property===e)return t;0>o.span?t=-1:0<=t&&(t+=o.span)}}};Layout$4.Structure=Structure$2;let UnionDiscriminator$2=class{constructor(e){this.property=e}decode(e,t){throw new Error("UnionDiscriminator is abstract")}encode(e,t,o){throw new Error("UnionDiscriminator is abstract")}};Layout$4.UnionDiscriminator=UnionDiscriminator$2;let UnionLayoutDiscriminator$2=class extends UnionDiscriminator$2{constructor(e,t){if(!(e instanceof ExternalLayout$2&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,o){return this.layout.encode(e,t,o)}};Layout$4.UnionLayoutDiscriminator=UnionLayoutDiscriminator$2;let Union$2=class extends Layout$3{constructor(e,t,o){let a;if(e instanceof UInt$2||e instanceof UIntBE$2)a=new UnionLayoutDiscriminator$2(new OffsetLayout$2(e));else if(e instanceof ExternalLayout$2&&e.isCount())a=new UnionLayoutDiscriminator$2(e);else if(e instanceof UnionDiscriminator$2)a=e;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Layout$3))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let c=-1;t&&(c=t.span,0<=c&&(e instanceof UInt$2||e instanceof UIntBE$2)&&(c+=a.layout.span)),super(c,o),this.discriminator=a,this.usesPrefixDiscriminator=e instanceof UInt$2||e instanceof UIntBE$2,this.defaultLayout=t,this.registry={};let d=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(g){return d(g)},this.configGetSourceVariant=function(g){d=g.bind(this)}}getSpan(e,t=0){if(0<=this.span)return this.span;const o=this.getVariant(e,t);if(!o)throw new Error("unable to determine span for unrecognized variant");return o.getSpan(e,t)}defaultGetSourceVariant(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(const t in this.registry){const o=this.registry[t];if(o.property&&Object.prototype.hasOwnProperty.call(e,o.property))return o}throw new Error("unable to infer src variant")}decode(e,t=0){let o;const a=this.discriminator,c=a.decode(e,t),d=this.registry[c];if(d===void 0){const g=this.defaultLayout;let y=0;this.usesPrefixDiscriminator&&(y=a.layout.span),o=this.makeDestinationObject(),o[a.property]=c,o[g.property]=g.decode(e,t+y)}else o=d.decode(e,t);return o}encode(e,t,o=0){const a=this.getSourceVariant(e);if(a===void 0){const c=this.discriminator,d=this.defaultLayout;let g=0;return this.usesPrefixDiscriminator&&(g=c.layout.span),c.encode(e[c.property],t,o),g+d.encode(e[d.property],t,o+g)}return a.encode(e,t,o)}addVariant(e,t,o){const a=new VariantLayout$2(this,e,t,o);return this.registry[e]=a,a}getVariant(e,t=0){let o;return e instanceof Uint8Array?o=this.discriminator.decode(e,t):o=e,this.registry[o]}};Layout$4.Union=Union$2;let VariantLayout$2=class extends Layout$3{constructor(e,t,o,a){if(!(e instanceof Union$2))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof o=="string"&&a===void 0&&(a=o,o=null),o){if(!(o instanceof Layout$3))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=o.span&&o.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof a!="string")throw new TypeError("variant must have a String property")}let c=e.span;0>e.span&&(c=o?o.span:0,0<=c&&e.usesPrefixDiscriminator&&(c+=e.discriminator.layout.span)),super(c,a),this.union=e,this.variant=t,this.layout=o||null}getSpan(e,t=0){if(0<=this.span)return this.span;let o=0;this.union.usesPrefixDiscriminator&&(o=this.union.discriminator.layout.span);let a=0;return this.layout&&(a=this.layout.getSpan(e,t+o)),o+a}decode(e,t=0){const o=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let a=0;return this.union.usesPrefixDiscriminator&&(a=this.union.discriminator.layout.span),this.layout?o[this.property]=this.layout.decode(e,t+a):this.property?o[this.property]=!0:this.union.usesPrefixDiscriminator&&(o[this.union.discriminator.property]=this.variant),o}encode(e,t,o=0){let a=0;if(this.union.usesPrefixDiscriminator&&(a=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,o);let c=a;if(this.layout&&(this.layout.encode(e[this.property],t,o+a),c+=this.layout.getSpan(t,o+a),0<=this.union.span&&c>this.union.span))throw new Error("encoded variant overruns containing union");return c}fromArray(e){if(this.layout)return this.layout.fromArray(e)}};Layout$4.VariantLayout=VariantLayout$2;function fixBitwiseResult$1(s){return 0>s&&(s+=4294967296),s}let BitStructure$1=class extends Layout$3{constructor(e,t,o){if(!(e instanceof UInt$2||e instanceof UIntBE$2))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&o===void 0&&(o=t,t=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,o),this.word=e,this.msb=!!t,this.fields=[];let a=0;this._packedSetValue=function(c){return a=fixBitwiseResult$1(c),this},this._packedGetValue=function(){return a}}decode(e,t=0){const o=this.makeDestinationObject(),a=this.word.decode(e,t);this._packedSetValue(a);for(const c of this.fields)c.property!==void 0&&(o[c.property]=c.decode(e));return o}encode(e,t,o=0){const a=this.word.decode(t,o);this._packedSetValue(a);for(const c of this.fields)if(c.property!==void 0){const d=e[c.property];d!==void 0&&c.encode(d)}return this.word.encode(this._packedGetValue(),t,o)}addField(e,t){const o=new BitField$1(this,e,t);return this.fields.push(o),o}addBoolean(e){const t=new Boolean$2(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}};Layout$4.BitStructure=BitStructure$1;let BitField$1=class{constructor(e,t,o){if(!(e instanceof BitStructure$1))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const a=8*e.span,c=e.fields.reduce((d,g)=>d+g.bits,0);if(t+c>a)throw new Error("bits too long for span remainder ("+(a-c)+" of "+a+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=c,this.container.msb&&(this.start=a-c-t),this.wordMask=fixBitwiseResult$1(this.valueMask<<this.start),this.property=o}decode(e,t){const o=this.container._packedGetValue();return fixBitwiseResult$1(o&this.wordMask)>>>this.start}encode(e){if(typeof e!="number"||!Number.isInteger(e)||e!==fixBitwiseResult$1(e&this.valueMask))throw new TypeError(nameWithProperty$2("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),o=fixBitwiseResult$1(e<<this.start);this.container._packedSetValue(fixBitwiseResult$1(t&~this.wordMask)|o)}};Layout$4.BitField=BitField$1;let Boolean$2=class extends BitField$1{constructor(e,t){super(e,1,t)}decode(e,t){return!!super.decode(e,t)}encode(e){typeof e=="boolean"&&(e=+e),super.encode(e)}};Layout$4.Boolean=Boolean$2;let Blob$3=class extends Layout$3{constructor(e,t){if(!(e instanceof ExternalLayout$2&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let o=-1;e instanceof ExternalLayout$2||(o=e),super(o,t),this.length=e}getSpan(e,t){let o=this.span;return 0>o&&(o=this.length.decode(e,t)),o}decode(e,t=0){let o=this.span;return 0>o&&(o=this.length.decode(e,t)),uint8ArrayToBuffer(e).slice(t,t+o)}encode(e,t,o){let a=this.length;if(this.length instanceof ExternalLayout$2&&(a=e.length),!(e instanceof Uint8Array&&a===e.length))throw new TypeError(nameWithProperty$2("Blob.encode",this)+" requires (length "+a+") Uint8Array as src");if(o+a>t.length)throw new RangeError("encoding overruns Uint8Array");const c=uint8ArrayToBuffer(e);return uint8ArrayToBuffer(t).write(c.toString("hex"),o,a,"hex"),this.length instanceof ExternalLayout$2&&this.length.encode(a,t,o),a}};Layout$4.Blob=Blob$3;let CString$1=class extends Layout$3{constructor(e){super(-1,e)}getSpan(e,t=0){checkUint8Array(e);let o=t;for(;o<e.length&&e[o]!==0;)o+=1;return 1+o-t}decode(e,t=0){const o=this.getSpan(e,t);return uint8ArrayToBuffer(e).slice(t,t+o-1).toString("utf-8")}encode(e,t,o=0){typeof e!="string"&&(e=String(e));const a=buffer_1.Buffer.from(e,"utf8"),c=a.length;if(o+c>t.length)throw new RangeError("encoding overruns Buffer");const d=uint8ArrayToBuffer(t);return a.copy(d,o),d[o+c]=0,c+1}};Layout$4.CString=CString$1;let UTF8$1=class extends Layout$3{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t=0){return checkUint8Array(e),e.length-t}decode(e,t=0){const o=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");return uint8ArrayToBuffer(e).slice(t,t+o).toString("utf-8")}encode(e,t,o=0){typeof e!="string"&&(e=String(e));const a=buffer_1.Buffer.from(e,"utf8"),c=a.length;if(0<=this.maxSpan&&this.maxSpan<c)throw new RangeError("text length exceeds maxSpan");if(o+c>t.length)throw new RangeError("encoding overruns Buffer");return a.copy(uint8ArrayToBuffer(t),o),c}};Layout$4.UTF8=UTF8$1;let Constant$1=class extends Layout$3{constructor(e,t){super(0,t),this.value=e}decode(e,t){return this.value}encode(e,t,o){return 0}};Layout$4.Constant=Constant$1;Layout$4.greedy=(s,e)=>new GreedyCount$1(s,e);var offset$1=Layout$4.offset=(s,e,t)=>new OffsetLayout$2(s,e,t),u8$1=Layout$4.u8=s=>new UInt$2(1,s),u16=Layout$4.u16=s=>new UInt$2(2,s);Layout$4.u24=s=>new UInt$2(3,s);var u32$1=Layout$4.u32=s=>new UInt$2(4,s);Layout$4.u40=s=>new UInt$2(5,s);Layout$4.u48=s=>new UInt$2(6,s);var nu64$1=Layout$4.nu64=s=>new NearUInt64$2(s);Layout$4.u16be=s=>new UIntBE$2(2,s);Layout$4.u24be=s=>new UIntBE$2(3,s);Layout$4.u32be=s=>new UIntBE$2(4,s);Layout$4.u40be=s=>new UIntBE$2(5,s);Layout$4.u48be=s=>new UIntBE$2(6,s);Layout$4.nu64be=s=>new NearUInt64BE$1(s);Layout$4.s8=s=>new Int$1(1,s);Layout$4.s16=s=>new Int$1(2,s);Layout$4.s24=s=>new Int$1(3,s);Layout$4.s32=s=>new Int$1(4,s);Layout$4.s40=s=>new Int$1(5,s);Layout$4.s48=s=>new Int$1(6,s);var ns64$1=Layout$4.ns64=s=>new NearInt64$2(s);Layout$4.s16be=s=>new IntBE$1(2,s);Layout$4.s24be=s=>new IntBE$1(3,s);Layout$4.s32be=s=>new IntBE$1(4,s);Layout$4.s40be=s=>new IntBE$1(5,s);Layout$4.s48be=s=>new IntBE$1(6,s);Layout$4.ns64be=s=>new NearInt64BE$1(s);Layout$4.f32=s=>new Float$1(s);Layout$4.f32be=s=>new FloatBE$1(s);Layout$4.f64=s=>new Double$1(s);Layout$4.f64be=s=>new DoubleBE$1(s);var struct$1=Layout$4.struct=(s,e,t)=>new Structure$2(s,e,t);Layout$4.bits=(s,e,t)=>new BitStructure$1(s,e,t);var seq=Layout$4.seq=(s,e,t)=>new Sequence$1(s,e,t);Layout$4.union=(s,e,t)=>new Union$2(s,e,t);Layout$4.unionLayoutDiscriminator=(s,e)=>new UnionLayoutDiscriminator$2(s,e);var blob$1=Layout$4.blob=(s,e)=>new Blob$3(s,e);Layout$4.cstr=s=>new CString$1(s);Layout$4.utf8=(s,e)=>new UTF8$1(s,e);Layout$4.constant=(s,e)=>new Constant$1(s,e);var SOLANA_ERROR__CODECS__CANNOT_DECODE_EMPTY_BYTE_ARRAY=8078e3,SOLANA_ERROR__CODECS__INVALID_BYTE_LENGTH=8078001,SOLANA_ERROR__CODECS__ENCODER_DECODER_SIZE_COMPATIBILITY_MISMATCH=8078004,SOLANA_ERROR__CODECS__ENCODER_DECODER_FIXED_SIZE_MISMATCH=8078005,SOLANA_ERROR__CODECS__ENCODER_DECODER_MAX_SIZE_MISMATCH=8078006,SOLANA_ERROR__CODECS__NUMBER_OUT_OF_RANGE=8078011;function encodeValue(s){return Array.isArray(s)?"%5B"+s.map(encodeValue).join("%2C%20")+"%5D":typeof s=="bigint"?`${s}n`:encodeURIComponent(String(s!=null&&Object.getPrototypeOf(s)===null?{...s}:s))}function encodeObjectContextEntry([s,e]){return`${s}=${encodeValue(e)}`}function encodeContextObject(s){const e=Object.entries(s).map(encodeObjectContextEntry).join("&");return btoa(e)}function getErrorMessage(s,e={}){{let t=`Solana error #${s}; Decode this error by running \`npx @solana/errors decode -- ${s}`;return Object.keys(e).length&&(t+=` '${encodeContextObject(e)}'`),`${t}\``}}var SolanaError=class extends Error{constructor(...[e,t]){let o,a;if(t){const{cause:d,...g}=t;d&&(a={cause:d}),Object.keys(g).length>0&&(o=g)}const c=getErrorMessage(e,o);super(c,a);an(this,"cause",this.cause);an(this,"context");this.context={__code:e,...o},this.name="SolanaError"}};function getEncodedSize(s,e){return"fixedSize"in e?e.fixedSize:e.getSizeFromValue(s)}function createEncoder(s){return Object.freeze({...s,encode:e=>{const t=new Uint8Array(getEncodedSize(e,s));return s.write(e,t,0),t}})}function createDecoder(s){return Object.freeze({...s,decode:(e,t=0)=>s.read(e,t)[0]})}function isFixedSize(s){return"fixedSize"in s&&typeof s.fixedSize=="number"}function combineCodec(s,e){if(isFixedSize(s)!==isFixedSize(e))throw new SolanaError(SOLANA_ERROR__CODECS__ENCODER_DECODER_SIZE_COMPATIBILITY_MISMATCH);if(isFixedSize(s)&&isFixedSize(e)&&s.fixedSize!==e.fixedSize)throw new SolanaError(SOLANA_ERROR__CODECS__ENCODER_DECODER_FIXED_SIZE_MISMATCH,{decoderFixedSize:e.fixedSize,encoderFixedSize:s.fixedSize});if(!isFixedSize(s)&&!isFixedSize(e)&&s.maxSize!==e.maxSize)throw new SolanaError(SOLANA_ERROR__CODECS__ENCODER_DECODER_MAX_SIZE_MISMATCH,{decoderMaxSize:e.maxSize,encoderMaxSize:s.maxSize});return{...e,...s,decode:e.decode,encode:s.encode,read:e.read,write:s.write}}function assertByteArrayIsNotEmptyForCodec(s,e,t=0){if(e.length-t<=0)throw new SolanaError(SOLANA_ERROR__CODECS__CANNOT_DECODE_EMPTY_BYTE_ARRAY,{codecDescription:s})}function assertByteArrayHasEnoughBytesForCodec(s,e,t,o=0){const a=t.length-o;if(a<e)throw new SolanaError(SOLANA_ERROR__CODECS__INVALID_BYTE_LENGTH,{bytesLength:a,codecDescription:s,expected:e})}function assertNumberIsBetweenForCodec(s,e,t,o){if(o<e||o>t)throw new SolanaError(SOLANA_ERROR__CODECS__NUMBER_OUT_OF_RANGE,{codecDescription:s,max:t,min:e,value:o})}function isLittleEndian(s){return(s==null?void 0:s.endian)!==1}function numberEncoderFactory(s){return createEncoder({fixedSize:s.size,write(e,t,o){s.range&&assertNumberIsBetweenForCodec(s.name,s.range[0],s.range[1],e);const a=new ArrayBuffer(s.size);return s.set(new DataView(a),e,isLittleEndian(s.config)),t.set(new Uint8Array(a),o),o+s.size}})}function numberDecoderFactory(s){return createDecoder({fixedSize:s.size,read(e,t=0){assertByteArrayIsNotEmptyForCodec(s.name,e,t),assertByteArrayHasEnoughBytesForCodec(s.name,s.size,e,t);const o=new DataView(toArrayBuffer(e,t,s.size));return[s.get(o,isLittleEndian(s.config)),t+s.size]}})}function toArrayBuffer(s,e,t){const o=s.byteOffset+(e??0),a=t??s.byteLength;return s.buffer.slice(o,o+a)}var getU64Encoder=(s={})=>numberEncoderFactory({config:s,name:"u64",range:[0n,BigInt("0xffffffffffffffff")],set:(e,t,o)=>e.setBigUint64(0,BigInt(t),o),size:8}),getU64Decoder=(s={})=>numberDecoderFactory({config:s,get:(e,t)=>e.getBigUint64(0,t),name:"u64",size:8}),getU64Codec=(s={})=>combineCodec(getU64Encoder(s),getU64Decoder(s));let StructError$1=class extends TypeError{constructor(e,t){let o;const{message:a,explanation:c,...d}=e,{path:g}=e,y=g.length===0?a:`At path: ${g.join(".")} -- ${a}`;super(c??y),c!=null&&(this.cause=y),Object.assign(this,d),this.name=this.constructor.name,this.failures=()=>o??(o=[e,...t()])}};function isIterable$1(s){return isObject$1(s)&&typeof s[Symbol.iterator]=="function"}function isObject$1(s){return typeof s=="object"&&s!=null}function isNonArrayObject(s){return isObject$1(s)&&!Array.isArray(s)}function print$1(s){return typeof s=="symbol"?s.toString():typeof s=="string"?JSON.stringify(s):`${s}`}function shiftIterator$1(s){const{done:e,value:t}=s.next();return e?void 0:t}function toFailure$1(s,e,t,o){if(s===!0)return;s===!1?s={}:typeof s=="string"&&(s={message:s});const{path:a,branch:c}=e,{type:d}=t,{refinement:g,message:y=`Expected a value of type \`${d}\`${g?` with refinement \`${g}\``:""}, but received: \`${print$1(o)}\``}=s;return{value:o,type:d,refinement:g,key:a[a.length-1],path:a,branch:c,...s,message:y}}function*toFailures$1(s,e,t,o){isIterable$1(s)||(s=[s]);for(const a of s){const c=toFailure$1(a,e,t,o);c&&(yield c)}}function*run$1(s,e,t={}){const{path:o=[],branch:a=[s],coerce:c=!1,mask:d=!1}=t,g={path:o,branch:a,mask:d};c&&(s=e.coercer(s,g));let y="valid";for(const _ of e.validator(s,g))_.explanation=t.message,y="not_valid",yield[_,void 0];for(let[_,E,S]of e.entries(s,g)){const A=run$1(E,S,{path:_===void 0?o:[...o,_],branch:_===void 0?a:[...a,E],coerce:c,mask:d,message:t.message});for(const C of A)C[0]?(y=C[0].refinement!=null?"not_refined":"not_valid",yield[C[0],void 0]):c&&(E=C[1],_===void 0?s=E:s instanceof Map?s.set(_,E):s instanceof Set?s.add(E):isObject$1(s)&&(E!==void 0||_ in s)&&(s[_]=E))}if(y!=="not_valid")for(const _ of e.refiner(s,g))_.explanation=t.message,y="not_refined",yield[_,void 0];y==="valid"&&(yield[void 0,s])}let Struct$2=class{constructor(e){const{type:t,schema:o,validator:a,refiner:c,coercer:d=y=>y,entries:g=function*(){}}=e;this.type=t,this.schema=o,this.entries=g,this.coercer=d,a?this.validator=(y,_)=>{const E=a(y,_);return toFailures$1(E,_,this,y)}:this.validator=()=>[],c?this.refiner=(y,_)=>{const E=c(y,_);return toFailures$1(E,_,this,y)}:this.refiner=()=>[]}assert(e,t){return assert$2(e,this,t)}create(e,t){return create$1(e,this,t)}is(e){return is$1(e,this)}mask(e,t){return mask$1(e,this,t)}validate(e,t={}){return validate$2(e,this,t)}};function assert$2(s,e,t){const o=validate$2(s,e,{message:t});if(o[0])throw o[0]}function create$1(s,e,t){const o=validate$2(s,e,{coerce:!0,message:t});if(o[0])throw o[0];return o[1]}function mask$1(s,e,t){const o=validate$2(s,e,{coerce:!0,mask:!0,message:t});if(o[0])throw o[0];return o[1]}function is$1(s,e){return!validate$2(s,e)[0]}function validate$2(s,e,t={}){const o=run$1(s,e,t),a=shiftIterator$1(o);return a[0]?[new StructError$1(a[0],function*(){for(const d of o)d[0]&&(yield d[0])}),void 0]:[void 0,a[1]]}function define$1(s,e){return new Struct$2({type:s,schema:null,validator:e})}function any$1(){return define$1("any",()=>!0)}function array$1(s){return new Struct$2({type:"array",schema:s,*entries(e){if(s&&Array.isArray(e))for(const[t,o]of e.entries())yield[t,o,s]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||`Expected an array value, but received: ${print$1(e)}`}})}function boolean$1(){return define$1("boolean",s=>typeof s=="boolean")}function instance$1(s){return define$1("instance",e=>e instanceof s||`Expected a \`${s.name}\` instance, but received: ${print$1(e)}`)}function literal$1(s){const e=print$1(s),t=typeof s;return new Struct$2({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?s:null,validator(o){return o===s||`Expected the literal \`${e}\`, but received: ${print$1(o)}`}})}function never(){return define$1("never",()=>!1)}function nullable$1(s){return new Struct$2({...s,validator:(e,t)=>e===null||s.validator(e,t),refiner:(e,t)=>e===null||s.refiner(e,t)})}function number$2(){return define$1("number",s=>typeof s=="number"&&!isNaN(s)||`Expected a number, but received: ${print$1(s)}`)}function optional$1(s){return new Struct$2({...s,validator:(e,t)=>e===void 0||s.validator(e,t),refiner:(e,t)=>e===void 0||s.refiner(e,t)})}function record$1(s,e){return new Struct$2({type:"record",schema:null,*entries(t){if(isObject$1(t))for(const o in t){const a=t[o];yield[o,o,s],yield[o,a,e]}},validator(t){return isNonArrayObject(t)||`Expected an object, but received: ${print$1(t)}`},coercer(t){return isNonArrayObject(t)?{...t}:t}})}function string$1(){return define$1("string",s=>typeof s=="string"||`Expected a string, but received: ${print$1(s)}`)}function tuple(s){const e=never();return new Struct$2({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const o=Math.max(s.length,t.length);for(let a=0;a<o;a++)yield[a,t[a],s[a]||e]}},validator(t){return Array.isArray(t)||`Expected an array, but received: ${print$1(t)}`},coercer(t){return Array.isArray(t)?t.slice():t}})}function type$1(s){const e=Object.keys(s);return new Struct$2({type:"type",schema:s,*entries(t){if(isObject$1(t))for(const o of e)yield[o,t[o],s[o]]},validator(t){return isNonArrayObject(t)||`Expected an object, but received: ${print$1(t)}`},coercer(t){return isNonArrayObject(t)?{...t}:t}})}function union$2(s){const e=s.map(t=>t.type).join(" | ");return new Struct$2({type:"union",schema:null,coercer(t,o){for(const a of s){const[c,d]=a.validate(t,{coerce:!0,mask:o.mask});if(!c)return d}return t},validator(t,o){const a=[];for(const c of s){const[...d]=run$1(t,c,o),[g]=d;if(g[0])for(const[y]of d)y&&a.push(y);else return[]}return[`Expected the value to satisfy a union of \`${e}\`, but received: ${print$1(t)}`,...a]}})}function unknown$1(){return define$1("unknown",()=>!0)}function coerce$1(s,e,t){return new Struct$2({...s,coercer:(o,a)=>is$1(o,e)?s.coercer(t(o,a),a):s.coercer(o,a)})}var getRandomValues,rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const REGEX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function validate$1(s){return typeof s=="string"&&REGEX.test(s)}var byteToHex=[];for(var i=0;i<256;++i)byteToHex.push((i+256).toString(16).substr(1));function stringify(s){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,t=(byteToHex[s[e+0]]+byteToHex[s[e+1]]+byteToHex[s[e+2]]+byteToHex[s[e+3]]+"-"+byteToHex[s[e+4]]+byteToHex[s[e+5]]+"-"+byteToHex[s[e+6]]+byteToHex[s[e+7]]+"-"+byteToHex[s[e+8]]+byteToHex[s[e+9]]+"-"+byteToHex[s[e+10]]+byteToHex[s[e+11]]+byteToHex[s[e+12]]+byteToHex[s[e+13]]+byteToHex[s[e+14]]+byteToHex[s[e+15]]).toLowerCase();if(!validate$1(t))throw TypeError("Stringified UUID is invalid");return t}var _nodeId,_clockseq,_lastMSecs=0,_lastNSecs=0;function v1(s,e,t){var o=e&&t||0,a=e||new Array(16);s=s||{};var c=s.node||_nodeId,d=s.clockseq!==void 0?s.clockseq:_clockseq;if(c==null||d==null){var g=s.random||(s.rng||rng)();c==null&&(c=_nodeId=[g[0]|1,g[1],g[2],g[3],g[4],g[5]]),d==null&&(d=_clockseq=(g[6]<<8|g[7])&16383)}var y=s.msecs!==void 0?s.msecs:Date.now(),_=s.nsecs!==void 0?s.nsecs:_lastNSecs+1,E=y-_lastMSecs+(_-_lastNSecs)/1e4;if(E<0&&s.clockseq===void 0&&(d=d+1&16383),(E<0||y>_lastMSecs)&&s.nsecs===void 0&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");_lastMSecs=y,_lastNSecs=_,_clockseq=d,y+=122192928e5;var S=((y&268435455)*1e4+_)%4294967296;a[o++]=S>>>24&255,a[o++]=S>>>16&255,a[o++]=S>>>8&255,a[o++]=S&255;var A=y/4294967296*1e4&268435455;a[o++]=A>>>8&255,a[o++]=A&255,a[o++]=A>>>24&15|16,a[o++]=A>>>16&255,a[o++]=d>>>8|128,a[o++]=d&255;for(var C=0;C<6;++C)a[o+C]=c[C];return e||stringify(a)}function parse(s){if(!validate$1(s))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(s.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(s.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(s.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(s.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(s.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}function stringToBytes(s){s=unescape(encodeURIComponent(s));for(var e=[],t=0;t<s.length;++t)e.push(s.charCodeAt(t));return e}var DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",URL$1="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function v35(s,e,t){function o(a,c,d,g){if(typeof a=="string"&&(a=stringToBytes(a)),typeof c=="string"&&(c=parse(c)),c.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var y=new Uint8Array(16+a.length);if(y.set(c),y.set(a,c.length),y=t(y),y[6]=y[6]&15|e,y[8]=y[8]&63|128,d){g=g||0;for(var _=0;_<16;++_)d[g+_]=y[_];return d}return stringify(y)}try{o.name=s}catch{}return o.DNS=DNS,o.URL=URL$1,o}function md5(s){if(typeof s=="string"){var e=unescape(encodeURIComponent(s));s=new Uint8Array(e.length);for(var t=0;t<e.length;++t)s[t]=e.charCodeAt(t)}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(s),s.length*8))}function md5ToHexEncodedArray(s){for(var e=[],t=s.length*32,o="0123456789abcdef",a=0;a<t;a+=8){var c=s[a>>5]>>>a%32&255,d=parseInt(o.charAt(c>>>4&15)+o.charAt(c&15),16);e.push(d)}return e}function getOutputLength(s){return(s+64>>>9<<4)+14+1}function wordsToMd5(s,e){s[e>>5]|=128<<e%32,s[getOutputLength(e)-1]=e;for(var t=1732584193,o=-271733879,a=-1732584194,c=271733878,d=0;d<s.length;d+=16){var g=t,y=o,_=a,E=c;t=md5ff(t,o,a,c,s[d],7,-680876936),c=md5ff(c,t,o,a,s[d+1],12,-389564586),a=md5ff(a,c,t,o,s[d+2],17,606105819),o=md5ff(o,a,c,t,s[d+3],22,-1044525330),t=md5ff(t,o,a,c,s[d+4],7,-176418897),c=md5ff(c,t,o,a,s[d+5],12,1200080426),a=md5ff(a,c,t,o,s[d+6],17,-1473231341),o=md5ff(o,a,c,t,s[d+7],22,-45705983),t=md5ff(t,o,a,c,s[d+8],7,1770035416),c=md5ff(c,t,o,a,s[d+9],12,-1958414417),a=md5ff(a,c,t,o,s[d+10],17,-42063),o=md5ff(o,a,c,t,s[d+11],22,-1990404162),t=md5ff(t,o,a,c,s[d+12],7,1804603682),c=md5ff(c,t,o,a,s[d+13],12,-40341101),a=md5ff(a,c,t,o,s[d+14],17,-1502002290),o=md5ff(o,a,c,t,s[d+15],22,1236535329),t=md5gg(t,o,a,c,s[d+1],5,-165796510),c=md5gg(c,t,o,a,s[d+6],9,-1069501632),a=md5gg(a,c,t,o,s[d+11],14,643717713),o=md5gg(o,a,c,t,s[d],20,-373897302),t=md5gg(t,o,a,c,s[d+5],5,-701558691),c=md5gg(c,t,o,a,s[d+10],9,38016083),a=md5gg(a,c,t,o,s[d+15],14,-660478335),o=md5gg(o,a,c,t,s[d+4],20,-405537848),t=md5gg(t,o,a,c,s[d+9],5,568446438),c=md5gg(c,t,o,a,s[d+14],9,-1019803690),a=md5gg(a,c,t,o,s[d+3],14,-187363961),o=md5gg(o,a,c,t,s[d+8],20,1163531501),t=md5gg(t,o,a,c,s[d+13],5,-1444681467),c=md5gg(c,t,o,a,s[d+2],9,-51403784),a=md5gg(a,c,t,o,s[d+7],14,1735328473),o=md5gg(o,a,c,t,s[d+12],20,-1926607734),t=md5hh(t,o,a,c,s[d+5],4,-378558),c=md5hh(c,t,o,a,s[d+8],11,-2022574463),a=md5hh(a,c,t,o,s[d+11],16,1839030562),o=md5hh(o,a,c,t,s[d+14],23,-35309556),t=md5hh(t,o,a,c,s[d+1],4,-1530992060),c=md5hh(c,t,o,a,s[d+4],11,1272893353),a=md5hh(a,c,t,o,s[d+7],16,-155497632),o=md5hh(o,a,c,t,s[d+10],23,-1094730640),t=md5hh(t,o,a,c,s[d+13],4,681279174),c=md5hh(c,t,o,a,s[d],11,-358537222),a=md5hh(a,c,t,o,s[d+3],16,-722521979),o=md5hh(o,a,c,t,s[d+6],23,76029189),t=md5hh(t,o,a,c,s[d+9],4,-640364487),c=md5hh(c,t,o,a,s[d+12],11,-421815835),a=md5hh(a,c,t,o,s[d+15],16,530742520),o=md5hh(o,a,c,t,s[d+2],23,-995338651),t=md5ii(t,o,a,c,s[d],6,-198630844),c=md5ii(c,t,o,a,s[d+7],10,1126891415),a=md5ii(a,c,t,o,s[d+14],15,-1416354905),o=md5ii(o,a,c,t,s[d+5],21,-57434055),t=md5ii(t,o,a,c,s[d+12],6,1700485571),c=md5ii(c,t,o,a,s[d+3],10,-1894986606),a=md5ii(a,c,t,o,s[d+10],15,-1051523),o=md5ii(o,a,c,t,s[d+1],21,-2054922799),t=md5ii(t,o,a,c,s[d+8],6,1873313359),c=md5ii(c,t,o,a,s[d+15],10,-30611744),a=md5ii(a,c,t,o,s[d+6],15,-1560198380),o=md5ii(o,a,c,t,s[d+13],21,1309151649),t=md5ii(t,o,a,c,s[d+4],6,-145523070),c=md5ii(c,t,o,a,s[d+11],10,-1120210379),a=md5ii(a,c,t,o,s[d+2],15,718787259),o=md5ii(o,a,c,t,s[d+9],21,-343485551),t=safeAdd(t,g),o=safeAdd(o,y),a=safeAdd(a,_),c=safeAdd(c,E)}return[t,o,a,c]}function bytesToWords(s){if(s.length===0)return[];for(var e=s.length*8,t=new Uint32Array(getOutputLength(e)),o=0;o<e;o+=8)t[o>>5]|=(s[o/8]&255)<<o%32;return t}function safeAdd(s,e){var t=(s&65535)+(e&65535),o=(s>>16)+(e>>16)+(t>>16);return o<<16|t&65535}function bitRotateLeft(s,e){return s<<e|s>>>32-e}function md5cmn(s,e,t,o,a,c){return safeAdd(bitRotateLeft(safeAdd(safeAdd(e,s),safeAdd(o,c)),a),t)}function md5ff(s,e,t,o,a,c,d){return md5cmn(e&t|~e&o,s,e,a,c,d)}function md5gg(s,e,t,o,a,c,d){return md5cmn(e&o|t&~o,s,e,a,c,d)}function md5hh(s,e,t,o,a,c,d){return md5cmn(e^t^o,s,e,a,c,d)}function md5ii(s,e,t,o,a,c,d){return md5cmn(t^(e|~o),s,e,a,c,d)}var v3=v35("v3",48,md5);const v3$1=v3;function v4(s,e,t){s=s||{};var o=s.random||(s.rng||rng)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,e){t=t||0;for(var a=0;a<16;++a)e[t+a]=o[a];return e}return stringify(o)}function f(s,e,t,o){switch(s){case 0:return e&t^~e&o;case 1:return e^t^o;case 2:return e&t^e&o^t&o;case 3:return e^t^o}}function ROTL(s,e){return s<<e|s>>>32-e}function sha1(s){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof s=="string"){var o=unescape(encodeURIComponent(s));s=[];for(var a=0;a<o.length;++a)s.push(o.charCodeAt(a))}else Array.isArray(s)||(s=Array.prototype.slice.call(s));s.push(128);for(var c=s.length/4+2,d=Math.ceil(c/16),g=new Array(d),y=0;y<d;++y){for(var _=new Uint32Array(16),E=0;E<16;++E)_[E]=s[y*64+E*4]<<24|s[y*64+E*4+1]<<16|s[y*64+E*4+2]<<8|s[y*64+E*4+3];g[y]=_}g[d-1][14]=(s.length-1)*8/Math.pow(2,32),g[d-1][14]=Math.floor(g[d-1][14]),g[d-1][15]=(s.length-1)*8&4294967295;for(var S=0;S<d;++S){for(var A=new Uint32Array(80),C=0;C<16;++C)A[C]=g[S][C];for(var N=16;N<80;++N)A[N]=ROTL(A[N-3]^A[N-8]^A[N-14]^A[N-16],1);for(var O=t[0],I=t[1],P=t[2],j=t[3],B=t[4],H=0;H<80;++H){var se=Math.floor(H/20),oe=ROTL(O,5)+f(se,I,P,j)+B+e[se]+A[H]>>>0;B=j,j=P,P=ROTL(I,30)>>>0,I=O,O=oe}t[0]=t[0]+O>>>0,t[1]=t[1]+I>>>0,t[2]=t[2]+P>>>0,t[3]=t[3]+j>>>0,t[4]=t[4]+B>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var v5=v35("v5",80,sha1);const v5$1=v5,nil="00000000-0000-0000-0000-000000000000";function version(s){if(!validate$1(s))throw TypeError("Invalid UUID");return parseInt(s.substr(14,1),16)}const esmBrowser=Object.freeze(Object.defineProperty({__proto__:null,NIL:nil,parse,stringify,v1,v3:v3$1,v4,v5:v5$1,validate:validate$1,version},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(esmBrowser),uuid$1=require$$0.v4,generateRequest$1=function(s,e,t,o){if(typeof s!="string")throw new TypeError(s+" must be a string");o=o||{};const a=typeof o.version=="number"?o.version:2;if(a!==1&&a!==2)throw new TypeError(a+" must be 1 or 2");const c={method:s};if(a===2&&(c.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");c.params=e}if(typeof t>"u"){const d=typeof o.generator=="function"?o.generator:function(){return uuid$1()};c.id=d(c,o)}else a===2&&t===null?o.notificationIdNull&&(c.id=null):c.id=t;return c};var generateRequest_1=generateRequest$1;const uuid=require$$0.v4,generateRequest=generateRequest_1,ClientBrowser=function(s,e){if(!(this instanceof ClientBrowser))return new ClientBrowser(s,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return uuid()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=s};var browser=ClientBrowser;ClientBrowser.prototype.request=function(s,e,t,o){const a=this;let c=null;const d=Array.isArray(s)&&typeof e=="function";if(this.options.version===1&&d)throw new TypeError("JSON-RPC 1.0 does not support batching");if(d||!d&&s&&typeof s=="object"&&typeof e=="function")o=e,c=s;else{typeof t=="function"&&(o=t,t=void 0);const _=typeof o=="function";try{c=generateRequest(s,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(E){if(_)return o(E);throw E}if(!_)return c}let y;try{y=JSON.stringify(c,this.options.replacer)}catch(_){return o(_)}return this.callServer(y,function(_,E){a._parseResponse(_,E,o)}),c};ClientBrowser.prototype._parseResponse=function(s,e,t){if(s){t(s);return}if(!e)return t();let o;try{o=JSON.parse(e,this.options.reviver)}catch(a){return t(a)}if(t.length===3)if(Array.isArray(o)){const a=function(d){return typeof d.error<"u"},c=function(d){return!a(d)};return t(null,o.filter(a),o.filter(c))}else return t(null,o.error,o.result);t(null,o)};const RpcClient=getDefaultExportFromCjs$1(browser);var eventemitter3$1={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,t="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(t=!1));function a(y,_,E){this.fn=y,this.context=_,this.once=E||!1}function c(y,_,E,S,A){if(typeof E!="function")throw new TypeError("The listener must be a function");var C=new a(E,S||y,A),N=t?t+_:_;return y._events[N]?y._events[N].fn?y._events[N]=[y._events[N],C]:y._events[N].push(C):(y._events[N]=C,y._eventsCount++),y}function d(y,_){--y._eventsCount===0?y._events=new o:delete y._events[_]}function g(){this._events=new o,this._eventsCount=0}g.prototype.eventNames=function(){var _=[],E,S;if(this._eventsCount===0)return _;for(S in E=this._events)e.call(E,S)&&_.push(t?S.slice(1):S);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(E)):_},g.prototype.listeners=function(_){var E=t?t+_:_,S=this._events[E];if(!S)return[];if(S.fn)return[S.fn];for(var A=0,C=S.length,N=new Array(C);A<C;A++)N[A]=S[A].fn;return N},g.prototype.listenerCount=function(_){var E=t?t+_:_,S=this._events[E];return S?S.fn?1:S.length:0},g.prototype.emit=function(_,E,S,A,C,N){var O=t?t+_:_;if(!this._events[O])return!1;var I=this._events[O],P=arguments.length,j,B;if(I.fn){switch(I.once&&this.removeListener(_,I.fn,void 0,!0),P){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,E),!0;case 3:return I.fn.call(I.context,E,S),!0;case 4:return I.fn.call(I.context,E,S,A),!0;case 5:return I.fn.call(I.context,E,S,A,C),!0;case 6:return I.fn.call(I.context,E,S,A,C,N),!0}for(B=1,j=new Array(P-1);B<P;B++)j[B-1]=arguments[B];I.fn.apply(I.context,j)}else{var H=I.length,se;for(B=0;B<H;B++)switch(I[B].once&&this.removeListener(_,I[B].fn,void 0,!0),P){case 1:I[B].fn.call(I[B].context);break;case 2:I[B].fn.call(I[B].context,E);break;case 3:I[B].fn.call(I[B].context,E,S);break;case 4:I[B].fn.call(I[B].context,E,S,A);break;default:if(!j)for(se=1,j=new Array(P-1);se<P;se++)j[se-1]=arguments[se];I[B].fn.apply(I[B].context,j)}}return!0},g.prototype.on=function(_,E,S){return c(this,_,E,S,!1)},g.prototype.once=function(_,E,S){return c(this,_,E,S,!0)},g.prototype.removeListener=function(_,E,S,A){var C=t?t+_:_;if(!this._events[C])return this;if(!E)return d(this,C),this;var N=this._events[C];if(N.fn)N.fn===E&&(!A||N.once)&&(!S||N.context===S)&&d(this,C);else{for(var O=0,I=[],P=N.length;O<P;O++)(N[O].fn!==E||A&&!N[O].once||S&&N[O].context!==S)&&I.push(N[O]);I.length?this._events[C]=I.length===1?I[0]:I:d(this,C)}return this},g.prototype.removeAllListeners=function(_){var E;return _?(E=t?t+_:_,this._events[E]&&d(this,E)):(this._events=new o,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=t,g.EventEmitter=g,s.exports=g})(eventemitter3$1);var eventemitter3Exports$1=eventemitter3$1.exports;const EventEmitter$2=getDefaultExportFromCjs$1(eventemitter3Exports$1);var WebSocketBrowserImpl=class extends EventEmitter$2{constructor(e,t,o){super();an(this,"socket");this.socket=new window.WebSocket(e,o),this.socket.onopen=()=>this.emit("open"),this.socket.onmessage=a=>this.emit("message",a.data),this.socket.onerror=a=>this.emit("error",a),this.socket.onclose=a=>{this.emit("close",a.code,a.reason)}}send(e,t,o){const a=o||t;try{this.socket.send(e),a()}catch(c){a(c)}}close(e,t){this.socket.close(e,t)}addEventListener(e,t,o){this.socket.addEventListener(e,t,o)}};function WebSocket(s,e){return new WebSocketBrowserImpl(s,e)}var DefaultDataPack=class{encode(s){return JSON.stringify(s)}decode(s){return JSON.parse(s)}},CommonClient=class extends EventEmitter$2{constructor(e,t="ws://localhost:8080",{autoconnect:o=!0,reconnect:a=!0,reconnect_interval:c=1e3,max_reconnects:d=5,...g}={},y,_){super();an(this,"address");an(this,"rpc_id");an(this,"queue");an(this,"options");an(this,"autoconnect");an(this,"ready");an(this,"reconnect");an(this,"reconnect_timer_id");an(this,"reconnect_interval");an(this,"max_reconnects");an(this,"rest_options");an(this,"current_reconnects");an(this,"generate_request_id");an(this,"socket");an(this,"webSocketFactory");an(this,"dataPack");this.webSocketFactory=e,this.queue={},this.rpc_id=0,this.address=t,this.autoconnect=o,this.ready=!1,this.reconnect=a,this.reconnect_timer_id=void 0,this.reconnect_interval=c,this.max_reconnects=d,this.rest_options=g,this.current_reconnects=0,this.generate_request_id=y||(()=>typeof this.rpc_id=="number"?++this.rpc_id:Number(this.rpc_id)+1),_?this.dataPack=_:this.dataPack=new DefaultDataPack,this.autoconnect&&this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}connect(){this.socket||this._connect(this.address,{autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects,...this.rest_options})}call(e,t,o,a){return!a&&typeof o=="object"&&(a=o,o=null),new Promise((c,d)=>{if(!this.ready)return d(new Error("socket not ready"));const g=this.generate_request_id(e,t),y={jsonrpc:"2.0",method:e,params:t||void 0,id:g};this.socket.send(this.dataPack.encode(y),a,_=>{if(_)return d(_);this.queue[g]={promise:[c,d]},o&&(this.queue[g].timeout=setTimeout(()=>{delete this.queue[g],d(new Error("reply timeout"))},o))})})}async login(e){const t=await this.call("rpc.login",e);if(!t)throw new Error("authentication failed");return t}async listMethods(){return await this.call("__listMethods")}notify(e,t){return new Promise((o,a)=>{if(!this.ready)return a(new Error("socket not ready"));const c={jsonrpc:"2.0",method:e,params:t};this.socket.send(this.dataPack.encode(c),d=>{if(d)return a(d);o()})})}async subscribe(e){typeof e=="string"&&(e=[e]);const t=await this.call("rpc.on",e);if(typeof e=="string"&&t[e]!=="ok")throw new Error("Failed subscribing to an event '"+e+"' with: "+t[e]);return t}async unsubscribe(e){typeof e=="string"&&(e=[e]);const t=await this.call("rpc.off",e);if(typeof e=="string"&&t[e]!=="ok")throw new Error("Failed unsubscribing from an event with: "+t);return t}close(e,t){this.socket.close(e||1e3,t)}setAutoReconnect(e){this.reconnect=e}setReconnectInterval(e){this.reconnect_interval=e}setMaxReconnects(e){this.max_reconnects=e}_connect(e,t){clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(e,t),this.socket.addEventListener("open",()=>{this.ready=!0,this.emit("open"),this.current_reconnects=0}),this.socket.addEventListener("message",({data:o})=>{o instanceof ArrayBuffer&&(o=buffer.Buffer.from(o).toString());try{o=this.dataPack.decode(o)}catch{return}if(o.notification&&this.listeners(o.notification).length){if(!Object.keys(o.params).length)return this.emit(o.notification);const a=[o.notification];if(o.params.constructor===Object)a.push(o.params);else for(let c=0;c<o.params.length;c++)a.push(o.params[c]);return Promise.resolve().then(()=>{this.emit.apply(this,a)})}if(!this.queue[o.id])return o.method?Promise.resolve().then(()=>{this.emit(o.method,o==null?void 0:o.params)}):void 0;"error"in o=="result"in o&&this.queue[o.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),this.queue[o.id].timeout&&clearTimeout(this.queue[o.id].timeout),o.error?this.queue[o.id].promise[1](o.error):this.queue[o.id].promise[0](o.result),delete this.queue[o.id]}),this.socket.addEventListener("error",o=>this.emit("error",o)),this.socket.addEventListener("close",({code:o,reason:a})=>{this.ready&&setTimeout(()=>this.emit("close",o,a),0),this.ready=!1,this.socket=void 0,o!==1e3&&(this.current_reconnects++,this.reconnect&&(this.max_reconnects>this.current_reconnects||this.max_reconnects===0)&&(this.reconnect_timer_id=setTimeout(()=>this._connect(e,t),this.reconnect_interval)))})}};const _0n$2=BigInt(0),_1n$2=BigInt(1),_2n$1=BigInt(2),_7n=BigInt(7),_256n=BigInt(256),_0x71n=BigInt(113),SHA3_PI=[],SHA3_ROTL=[],_SHA3_IOTA=[];for(let s=0,e=_1n$2,t=1,o=0;s<24;s++){[t,o]=[o,(2*t+3*o)%5],SHA3_PI.push(2*(5*o+t)),SHA3_ROTL.push((s+1)*(s+2)/2%64);let a=_0n$2;for(let c=0;c<7;c++)e=(e<<_1n$2^(e>>_7n)*_0x71n)%_256n,e&_2n$1&&(a^=_1n$2<<(_1n$2<<BigInt(c))-_1n$2);_SHA3_IOTA.push(a)}const IOTAS=split(_SHA3_IOTA,!0),SHA3_IOTA_H=IOTAS[0],SHA3_IOTA_L=IOTAS[1],rotlH=(s,e,t)=>t>32?rotlBH(s,e,t):rotlSH(s,e,t),rotlL=(s,e,t)=>t>32?rotlBL(s,e,t):rotlSL(s,e,t);function keccakP(s,e=24){const t=new Uint32Array(10);for(let o=24-e;o<24;o++){for(let d=0;d<10;d++)t[d]=s[d]^s[d+10]^s[d+20]^s[d+30]^s[d+40];for(let d=0;d<10;d+=2){const g=(d+8)%10,y=(d+2)%10,_=t[y],E=t[y+1],S=rotlH(_,E,1)^t[g],A=rotlL(_,E,1)^t[g+1];for(let C=0;C<50;C+=10)s[d+C]^=S,s[d+C+1]^=A}let a=s[2],c=s[3];for(let d=0;d<24;d++){const g=SHA3_ROTL[d],y=rotlH(a,c,g),_=rotlL(a,c,g),E=SHA3_PI[d];a=s[E],c=s[E+1],s[E]=y,s[E+1]=_}for(let d=0;d<50;d+=10){for(let g=0;g<10;g++)t[g]=s[d+g];for(let g=0;g<10;g++)s[d+g]^=~t[(g+2)%10]&t[(g+4)%10]}s[0]^=SHA3_IOTA_H[o],s[1]^=SHA3_IOTA_L[o]}clean(t)}class Keccak extends Hash{constructor(e,t,o,a=!1,c=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=o,this.enableXOF=a,this.rounds=c,anumber(o),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=u32$2(this.state)}clone(){return this._cloneInto()}keccak(){swap32IfBE(this.state32),keccakP(this.state32,this.rounds),swap32IfBE(this.state32),this.posOut=0,this.pos=0}update(e){aexists(this),e=toBytes(e),abytes$1(e);const{blockLen:t,state:o}=this,a=e.length;for(let c=0;c<a;){const d=Math.min(t-this.pos,a-c);for(let g=0;g<d;g++)o[this.pos++]^=e[c++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:t,pos:o,blockLen:a}=this;e[o]^=t,t&128&&o===a-1&&this.keccak(),e[a-1]^=128,this.keccak()}writeInto(e){aexists(this,!1),abytes$1(e),this.finish();const t=this.state,{blockLen:o}=this;for(let a=0,c=e.length;a<c;){this.posOut>=o&&this.keccak();const d=Math.min(o-this.posOut,c-a);e.set(t.subarray(this.posOut,this.posOut+d),a),this.posOut+=d,a+=d}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return anumber(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(aoutput(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,clean(this.state)}_cloneInto(e){const{blockLen:t,suffix:o,outputLen:a,rounds:c,enableXOF:d}=this;return e||(e=new Keccak(t,o,a,d,c)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=c,e.suffix=o,e.outputLen=a,e.enableXOF=d,e.destroyed=this.destroyed,e}}const gen=(s,e,t)=>createHasher(()=>new Keccak(e,s,t)),keccak_256=(()=>gen(1,136,256/8))();class HMAC extends Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ahash(e);const o=toBytes(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const a=this.blockLen,c=new Uint8Array(a);c.set(o.length>a?e.create().update(o).digest():o);for(let d=0;d<c.length;d++)c[d]^=54;this.iHash.update(c),this.oHash=e.create();for(let d=0;d<c.length;d++)c[d]^=106;this.oHash.update(c),clean(c)}update(e){return aexists(this),this.iHash.update(e),this}digestInto(e){aexists(this),abytes$1(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:t,iHash:o,finished:a,destroyed:c,blockLen:d,outputLen:g}=this;return e=e,e.finished=a,e.destroyed=c,e.blockLen=d,e.outputLen=g,e.oHash=t._cloneInto(e.oHash),e.iHash=o._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(s,e,t)=>new HMAC(s,e).update(t).digest();hmac.create=(s,e)=>new HMAC(s,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validateSigVerOpts(s){s.lowS!==void 0&&abool("lowS",s.lowS),s.prehash!==void 0&&abool("prehash",s.prehash)}function validatePointOpts(s){const e=validateBasic(s);validateObject(e,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});const{endo:t,Fp:o,a}=e;if(t){if(!o.eql(a,o.ZERO))throw new Error("invalid endo: CURVE.a must be 0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...e})}class DERErr extends Error{constructor(e=""){super(e)}}const DER={Err:DERErr,_tlv:{encode:(s,e)=>{const{Err:t}=DER;if(s<0||s>256)throw new t("tlv.encode: wrong tag");if(e.length&1)throw new t("tlv.encode: unpadded data");const o=e.length/2,a=numberToHexUnpadded(o);if(a.length/2&128)throw new t("tlv.encode: long form length too big");const c=o>127?numberToHexUnpadded(a.length/2|128):"";return numberToHexUnpadded(s)+c+a+e},decode(s,e){const{Err:t}=DER;let o=0;if(s<0||s>256)throw new t("tlv.encode: wrong tag");if(e.length<2||e[o++]!==s)throw new t("tlv.decode: wrong tlv");const a=e[o++],c=!!(a&128);let d=0;if(!c)d=a;else{const y=a&127;if(!y)throw new t("tlv.decode(long): indefinite length not supported");if(y>4)throw new t("tlv.decode(long): byte length is too big");const _=e.subarray(o,o+y);if(_.length!==y)throw new t("tlv.decode: length bytes not complete");if(_[0]===0)throw new t("tlv.decode(long): zero leftmost byte");for(const E of _)d=d<<8|E;if(o+=y,d<128)throw new t("tlv.decode(long): not minimal encoding")}const g=e.subarray(o,o+d);if(g.length!==d)throw new t("tlv.decode: wrong value length");return{v:g,l:e.subarray(o+d)}}},_int:{encode(s){const{Err:e}=DER;if(s<_0n$1)throw new e("integer: negative integers are not allowed");let t=numberToHexUnpadded(s);if(Number.parseInt(t[0],16)&8&&(t="00"+t),t.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return t},decode(s){const{Err:e}=DER;if(s[0]&128)throw new e("invalid signature integer: negative");if(s[0]===0&&!(s[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return bytesToNumberBE(s)}},toSig(s){const{Err:e,_int:t,_tlv:o}=DER,a=ensureBytes("signature",s),{v:c,l:d}=o.decode(48,a);if(d.length)throw new e("invalid signature: left bytes after parsing");const{v:g,l:y}=o.decode(2,c),{v:_,l:E}=o.decode(2,y);if(E.length)throw new e("invalid signature: left bytes after parsing");return{r:t.decode(g),s:t.decode(_)}},hexFromSig(s){const{_tlv:e,_int:t}=DER,o=e.encode(2,t.encode(s.r)),a=e.encode(2,t.encode(s.s)),c=o+a;return e.encode(48,c)}};function numToSizedHex(s,e){return bytesToHex(numberToBytesBE(s,e))}const _0n$1=BigInt(0),_1n$1=BigInt(1);BigInt(2);const _3n=BigInt(3),_4n=BigInt(4);function weierstrassPoints(s){const e=validatePointOpts(s),{Fp:t}=e,o=Field(e.n,e.nBitLength),a=e.toBytes||((B,H,se)=>{const oe=H.toAffine();return concatBytes(Uint8Array.from([4]),t.toBytes(oe.x),t.toBytes(oe.y))}),c=e.fromBytes||(B=>{const H=B.subarray(1),se=t.fromBytes(H.subarray(0,t.BYTES)),oe=t.fromBytes(H.subarray(t.BYTES,2*t.BYTES));return{x:se,y:oe}});function d(B){const{a:H,b:se}=e,oe=t.sqr(B),Q=t.mul(oe,B);return t.add(t.add(Q,t.mul(B,H)),se)}function g(B,H){const se=t.sqr(H),oe=d(B);return t.eql(se,oe)}if(!g(e.Gx,e.Gy))throw new Error("bad curve params: generator point");const y=t.mul(t.pow(e.a,_3n),_4n),_=t.mul(t.sqr(e.b),BigInt(27));if(t.is0(t.add(y,_)))throw new Error("bad curve params: a or b");function E(B){return inRange$1(B,_1n$1,e.n)}function S(B){const{allowedPrivateKeyLengths:H,nByteLength:se,wrapPrivateKey:oe,n:Q}=e;if(H&&typeof B!="bigint"){if(isBytes(B)&&(B=bytesToHex(B)),typeof B!="string"||!H.includes(B.length))throw new Error("invalid private key");B=B.padStart(se*2,"0")}let fe;try{fe=typeof B=="bigint"?B:bytesToNumberBE(ensureBytes("private key",B,se))}catch{throw new Error("invalid private key, expected hex or "+se+" bytes, got "+typeof B)}return oe&&(fe=mod(fe,Q)),aInRange("private key",fe,_1n$1,Q),fe}function A(B){if(!(B instanceof O))throw new Error("ProjectivePoint expected")}const C=memoized((B,H)=>{const{px:se,py:oe,pz:Q}=B;if(t.eql(Q,t.ONE))return{x:se,y:oe};const fe=B.is0();H==null&&(H=fe?t.ONE:t.inv(Q));const Z=t.mul(se,H),ce=t.mul(oe,H),ge=t.mul(Q,H);if(fe)return{x:t.ZERO,y:t.ZERO};if(!t.eql(ge,t.ONE))throw new Error("invZ was invalid");return{x:Z,y:ce}}),N=memoized(B=>{if(B.is0()){if(e.allowInfinityPoint&&!t.is0(B.py))return;throw new Error("bad point: ZERO")}const{x:H,y:se}=B.toAffine();if(!t.isValid(H)||!t.isValid(se))throw new Error("bad point: x or y not FE");if(!g(H,se))throw new Error("bad point: equation left != right");if(!B.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class O{constructor(H,se,oe){if(H==null||!t.isValid(H))throw new Error("x required");if(se==null||!t.isValid(se)||t.is0(se))throw new Error("y required");if(oe==null||!t.isValid(oe))throw new Error("z required");this.px=H,this.py=se,this.pz=oe,Object.freeze(this)}static fromAffine(H){const{x:se,y:oe}=H||{};if(!H||!t.isValid(se)||!t.isValid(oe))throw new Error("invalid affine point");if(H instanceof O)throw new Error("projective point not allowed");const Q=fe=>t.eql(fe,t.ZERO);return Q(se)&&Q(oe)?O.ZERO:new O(se,oe,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(H){const se=FpInvertBatch(t,H.map(oe=>oe.pz));return H.map((oe,Q)=>oe.toAffine(se[Q])).map(O.fromAffine)}static fromHex(H){const se=O.fromAffine(c(ensureBytes("pointHex",H)));return se.assertValidity(),se}static fromPrivateKey(H){return O.BASE.multiply(S(H))}static msm(H,se){return pippenger(O,o,H,se)}_setWindowSize(H){j.setWindowSize(this,H)}assertValidity(){N(this)}hasEvenY(){const{y:H}=this.toAffine();if(t.isOdd)return!t.isOdd(H);throw new Error("Field doesn't support isOdd")}equals(H){A(H);const{px:se,py:oe,pz:Q}=this,{px:fe,py:Z,pz:ce}=H,ge=t.eql(t.mul(se,ce),t.mul(fe,Q)),me=t.eql(t.mul(oe,ce),t.mul(Z,Q));return ge&&me}negate(){return new O(this.px,t.neg(this.py),this.pz)}double(){const{a:H,b:se}=e,oe=t.mul(se,_3n),{px:Q,py:fe,pz:Z}=this;let ce=t.ZERO,ge=t.ZERO,me=t.ZERO,V=t.mul(Q,Q),R=t.mul(fe,fe),L=t.mul(Z,Z),z=t.mul(Q,fe);return z=t.add(z,z),me=t.mul(Q,Z),me=t.add(me,me),ce=t.mul(H,me),ge=t.mul(oe,L),ge=t.add(ce,ge),ce=t.sub(R,ge),ge=t.add(R,ge),ge=t.mul(ce,ge),ce=t.mul(z,ce),me=t.mul(oe,me),L=t.mul(H,L),z=t.sub(V,L),z=t.mul(H,z),z=t.add(z,me),me=t.add(V,V),V=t.add(me,V),V=t.add(V,L),V=t.mul(V,z),ge=t.add(ge,V),L=t.mul(fe,Z),L=t.add(L,L),V=t.mul(L,z),ce=t.sub(ce,V),me=t.mul(L,R),me=t.add(me,me),me=t.add(me,me),new O(ce,ge,me)}add(H){A(H);const{px:se,py:oe,pz:Q}=this,{px:fe,py:Z,pz:ce}=H;let ge=t.ZERO,me=t.ZERO,V=t.ZERO;const R=e.a,L=t.mul(e.b,_3n);let z=t.mul(se,fe),Y=t.mul(oe,Z),W=t.mul(Q,ce),ee=t.add(se,oe),ie=t.add(fe,Z);ee=t.mul(ee,ie),ie=t.add(z,Y),ee=t.sub(ee,ie),ie=t.add(se,Q);let X=t.add(fe,ce);return ie=t.mul(ie,X),X=t.add(z,W),ie=t.sub(ie,X),X=t.add(oe,Q),ge=t.add(Z,ce),X=t.mul(X,ge),ge=t.add(Y,W),X=t.sub(X,ge),V=t.mul(R,ie),ge=t.mul(L,W),V=t.add(ge,V),ge=t.sub(Y,V),V=t.add(Y,V),me=t.mul(ge,V),Y=t.add(z,z),Y=t.add(Y,z),W=t.mul(R,W),ie=t.mul(L,ie),Y=t.add(Y,W),W=t.sub(z,W),W=t.mul(R,W),ie=t.add(ie,W),z=t.mul(Y,ie),me=t.add(me,z),z=t.mul(X,ie),ge=t.mul(ee,ge),ge=t.sub(ge,z),z=t.mul(ee,Y),V=t.mul(X,V),V=t.add(V,z),new O(ge,me,V)}subtract(H){return this.add(H.negate())}is0(){return this.equals(O.ZERO)}wNAF(H){return j.wNAFCached(this,H,O.normalizeZ)}multiplyUnsafe(H){const{endo:se,n:oe}=e;aInRange("scalar",H,_0n$1,oe);const Q=O.ZERO;if(H===_0n$1)return Q;if(this.is0()||H===_1n$1)return this;if(!se||j.hasPrecomputes(this))return j.wNAFCachedUnsafe(this,H,O.normalizeZ);let{k1neg:fe,k1:Z,k2neg:ce,k2:ge}=se.splitScalar(H),me=Q,V=Q,R=this;for(;Z>_0n$1||ge>_0n$1;)Z&_1n$1&&(me=me.add(R)),ge&_1n$1&&(V=V.add(R)),R=R.double(),Z>>=_1n$1,ge>>=_1n$1;return fe&&(me=me.negate()),ce&&(V=V.negate()),V=new O(t.mul(V.px,se.beta),V.py,V.pz),me.add(V)}multiply(H){const{endo:se,n:oe}=e;aInRange("scalar",H,_1n$1,oe);let Q,fe;if(se){const{k1neg:Z,k1:ce,k2neg:ge,k2:me}=se.splitScalar(H);let{p:V,f:R}=this.wNAF(ce),{p:L,f:z}=this.wNAF(me);V=j.constTimeNegate(Z,V),L=j.constTimeNegate(ge,L),L=new O(t.mul(L.px,se.beta),L.py,L.pz),Q=V.add(L),fe=R.add(z)}else{const{p:Z,f:ce}=this.wNAF(H);Q=Z,fe=ce}return O.normalizeZ([Q,fe])[0]}multiplyAndAddUnsafe(H,se,oe){const Q=O.BASE,fe=(ce,ge)=>ge===_0n$1||ge===_1n$1||!ce.equals(Q)?ce.multiplyUnsafe(ge):ce.multiply(ge),Z=fe(this,se).add(fe(H,oe));return Z.is0()?void 0:Z}toAffine(H){return C(this,H)}isTorsionFree(){const{h:H,isTorsionFree:se}=e;if(H===_1n$1)return!0;if(se)return se(O,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:H,clearCofactor:se}=e;return H===_1n$1?this:se?se(O,this):this.multiplyUnsafe(e.h)}toRawBytes(H=!0){return abool("isCompressed",H),this.assertValidity(),a(O,this,H)}toHex(H=!0){return abool("isCompressed",H),bytesToHex(this.toRawBytes(H))}}O.BASE=new O(e.Gx,e.Gy,t.ONE),O.ZERO=new O(t.ZERO,t.ONE,t.ZERO);const{endo:I,nBitLength:P}=e,j=wNAF(O,I?Math.ceil(P/2):P);return{CURVE:e,ProjectivePoint:O,normPrivateKeyToScalar:S,weierstrassEquation:d,isWithinCurveOrder:E}}function validateOpts(s){const e=validateBasic(s);return validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function weierstrass(s){const e=validateOpts(s),{Fp:t,n:o,nByteLength:a,nBitLength:c}=e,d=t.BYTES+1,g=2*t.BYTES+1;function y(L){return mod(L,o)}function _(L){return invert(L,o)}const{ProjectivePoint:E,normPrivateKeyToScalar:S,weierstrassEquation:A,isWithinCurveOrder:C}=weierstrassPoints({...e,toBytes(L,z,Y){const W=z.toAffine(),ee=t.toBytes(W.x),ie=concatBytes;return abool("isCompressed",Y),Y?ie(Uint8Array.from([z.hasEvenY()?2:3]),ee):ie(Uint8Array.from([4]),ee,t.toBytes(W.y))},fromBytes(L){const z=L.length,Y=L[0],W=L.subarray(1);if(z===d&&(Y===2||Y===3)){const ee=bytesToNumberBE(W);if(!inRange$1(ee,_1n$1,t.ORDER))throw new Error("Point is not on curve");const ie=A(ee);let X;try{X=t.sqrt(ie)}catch(Ee){const Re=Ee instanceof Error?": "+Ee.message:"";throw new Error("Point is not on curve"+Re)}const F=(X&_1n$1)===_1n$1;return(Y&1)===1!==F&&(X=t.neg(X)),{x:ee,y:X}}else if(z===g&&Y===4){const ee=t.fromBytes(W.subarray(0,t.BYTES)),ie=t.fromBytes(W.subarray(t.BYTES,2*t.BYTES));return{x:ee,y:ie}}else{const ee=d,ie=g;throw new Error("invalid Point, expected length of "+ee+", or uncompressed "+ie+", got "+z)}}});function N(L){const z=o>>_1n$1;return L>z}function O(L){return N(L)?y(-L):L}const I=(L,z,Y)=>bytesToNumberBE(L.slice(z,Y));class P{constructor(z,Y,W){aInRange("r",z,_1n$1,o),aInRange("s",Y,_1n$1,o),this.r=z,this.s=Y,W!=null&&(this.recovery=W),Object.freeze(this)}static fromCompact(z){const Y=a;return z=ensureBytes("compactSignature",z,Y*2),new P(I(z,0,Y),I(z,Y,2*Y))}static fromDER(z){const{r:Y,s:W}=DER.toSig(ensureBytes("DER",z));return new P(Y,W)}assertValidity(){}addRecoveryBit(z){return new P(this.r,this.s,z)}recoverPublicKey(z){const{r:Y,s:W,recovery:ee}=this,ie=Q(ensureBytes("msgHash",z));if(ee==null||![0,1,2,3].includes(ee))throw new Error("recovery id invalid");const X=ee===2||ee===3?Y+e.n:Y;if(X>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");const F=ee&1?"03":"02",J=E.fromHex(F+numToSizedHex(X,t.BYTES)),Ee=_(X),Re=y(-ie*Ee),Te=y(W*Ee),Ue=E.BASE.multiplyAndAddUnsafe(J,Re,Te);if(!Ue)throw new Error("point at infinify");return Ue.assertValidity(),Ue}hasHighS(){return N(this.s)}normalizeS(){return this.hasHighS()?new P(this.r,y(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes(this.toDERHex())}toDERHex(){return DER.hexFromSig(this)}toCompactRawBytes(){return hexToBytes(this.toCompactHex())}toCompactHex(){const z=a;return numToSizedHex(this.r,z)+numToSizedHex(this.s,z)}}const j={isValidPrivateKey(L){try{return S(L),!0}catch{return!1}},normPrivateKeyToScalar:S,randomPrivateKey:()=>{const L=getMinHashLength(e.n);return mapHashToField(e.randomBytes(L),e.n)},precompute(L=8,z=E.BASE){return z._setWindowSize(L),z.multiply(BigInt(3)),z}};function B(L,z=!0){return E.fromPrivateKey(L).toRawBytes(z)}function H(L){if(typeof L=="bigint")return!1;if(L instanceof E)return!0;const Y=ensureBytes("key",L).length,W=t.BYTES,ee=W+1,ie=2*W+1;if(!(e.allowedPrivateKeyLengths||a===ee))return Y===ee||Y===ie}function se(L,z,Y=!0){if(H(L)===!0)throw new Error("first arg must be private key");if(H(z)===!1)throw new Error("second arg must be public key");return E.fromHex(z).multiply(S(L)).toRawBytes(Y)}const oe=e.bits2int||function(L){if(L.length>8192)throw new Error("input is too large");const z=bytesToNumberBE(L),Y=L.length*8-c;return Y>0?z>>BigInt(Y):z},Q=e.bits2int_modN||function(L){return y(oe(L))},fe=bitMask(c);function Z(L){return aInRange("num < 2^"+c,L,_0n$1,fe),numberToBytesBE(L,a)}function ce(L,z,Y=ge){if(["recovered","canonical"].some(Ke=>Ke in Y))throw new Error("sign() legacy options not supported");const{hash:W,randomBytes:ee}=e;let{lowS:ie,prehash:X,extraEntropy:F}=Y;ie==null&&(ie=!0),L=ensureBytes("msgHash",L),validateSigVerOpts(Y),X&&(L=ensureBytes("prehashed msgHash",W(L)));const J=Q(L),Ee=S(z),Re=[Z(Ee),Z(J)];if(F!=null&&F!==!1){const Ke=F===!0?ee(t.BYTES):F;Re.push(ensureBytes("extraEntropy",Ke))}const Te=concatBytes(...Re),Ue=J;function ze(Ke){const it=oe(Ke);if(!C(it))return;const Ye=_(it),Ce=E.BASE.multiply(it).toAffine(),ft=y(Ce.x);if(ft===_0n$1)return;const Ze=y(Ye*y(Ue+ft*Ee));if(Ze===_0n$1)return;let nt=(Ce.x===ft?0:2)|Number(Ce.y&_1n$1),dt=Ze;return ie&&N(Ze)&&(dt=O(Ze),nt^=1),new P(ft,dt,nt)}return{seed:Te,k2sig:ze}}const ge={lowS:e.lowS,prehash:!1},me={lowS:e.lowS,prehash:!1};function V(L,z,Y=ge){const{seed:W,k2sig:ee}=ce(L,z,Y),ie=e;return createHmacDrbg(ie.hash.outputLen,ie.nByteLength,ie.hmac)(W,ee)}E.BASE._setWindowSize(8);function R(L,z,Y,W=me){var nt;const ee=L;z=ensureBytes("msgHash",z),Y=ensureBytes("publicKey",Y);const{lowS:ie,prehash:X,format:F}=W;if(validateSigVerOpts(W),"strict"in W)throw new Error("options.strict was renamed to lowS");if(F!==void 0&&F!=="compact"&&F!=="der")throw new Error("format must be compact or der");const J=typeof ee=="string"||isBytes(ee),Ee=!J&&!F&&typeof ee=="object"&&ee!==null&&typeof ee.r=="bigint"&&typeof ee.s=="bigint";if(!J&&!Ee)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let Re,Te;try{if(Ee&&(Re=new P(ee.r,ee.s)),J){try{F!=="compact"&&(Re=P.fromDER(ee))}catch(dt){if(!(dt instanceof DER.Err))throw dt}!Re&&F!=="der"&&(Re=P.fromCompact(ee))}Te=E.fromHex(Y)}catch{return!1}if(!Re||ie&&Re.hasHighS())return!1;X&&(z=e.hash(z));const{r:Ue,s:ze}=Re,Ke=Q(z),it=_(ze),Ye=y(Ke*it),Ce=y(Ue*it),ft=(nt=E.BASE.multiplyAndAddUnsafe(Te,Ye,Ce))==null?void 0:nt.toAffine();return ft?y(ft.x)===Ue:!1}return{CURVE:e,getPublicKey:B,getSharedSecret:se,sign:V,verify:R,ProjectivePoint:E,Signature:P,utils:j}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(s){return{hash:s,hmac:(e,...t)=>hmac(s,e,concatBytes$1(...t)),randomBytes}}function createCurve(s,e){const t=o=>weierstrass({...s,...getHash(o)});return{...t(e),create:t}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_0n=BigInt(0),_1n=BigInt(1),_2n=BigInt(2),divNearest=(s,e)=>(s+e/_2n)/e;function sqrtMod(s){const e=secp256k1P,t=BigInt(3),o=BigInt(6),a=BigInt(11),c=BigInt(22),d=BigInt(23),g=BigInt(44),y=BigInt(88),_=s*s*s%e,E=_*_*s%e,S=pow2(E,t,e)*E%e,A=pow2(S,t,e)*E%e,C=pow2(A,_2n,e)*_%e,N=pow2(C,a,e)*C%e,O=pow2(N,c,e)*N%e,I=pow2(O,g,e)*O%e,P=pow2(I,y,e)*I%e,j=pow2(P,g,e)*O%e,B=pow2(j,t,e)*E%e,H=pow2(B,d,e)*N%e,se=pow2(H,o,e)*_%e,oe=pow2(se,_2n,e);if(!Fpk1.eql(Fpk1.sqr(oe),s))throw new Error("Cannot find square root");return oe}const Fpk1=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1=createCurve({a:_0n,b:BigInt(7),Fp:Fpk1,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:s=>{const e=secp256k1N,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),o=-_1n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),a=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),c=t,d=BigInt("0x100000000000000000000000000000000"),g=divNearest(c*s,e),y=divNearest(-o*s,e);let _=mod(s-g*t-y*a,e),E=mod(-g*o-y*c,e);const S=_>d,A=E>d;if(S&&(_=e-_),A&&(E=e-E),_>d||E>d)throw new Error("splitScalar: Endomorphism failed, k="+s);return{k1neg:S,k1:_,k2neg:A,k2:E}}}},sha256$2),generatePrivateKey=ed25519.utils.randomPrivateKey,generateKeypair=()=>{const s=ed25519.utils.randomPrivateKey(),e=getPublicKey(s),t=new Uint8Array(64);return t.set(s),t.set(e,32),{publicKey:e,secretKey:t}},getPublicKey=ed25519.getPublicKey;function isOnCurve(s){try{return ed25519.ExtendedPoint.fromHex(s),!0}catch{return!1}}const sign=(s,e)=>ed25519.sign(s,e.slice(0,32)),verify=ed25519.verify,toBuffer$1=s=>buffer.Buffer.isBuffer(s)?s:s instanceof Uint8Array?buffer.Buffer.from(s.buffer,s.byteOffset,s.byteLength):buffer.Buffer.from(s);let Struct$1=class{constructor(e){Object.assign(this,e)}encode(){return buffer.Buffer.from(serialize_1(SOLANA_SCHEMA,this))}static decode(e){return deserialize_1(SOLANA_SCHEMA,this,e)}static decodeUnchecked(e){return deserializeUnchecked_1(SOLANA_SCHEMA,this,e)}};class Enum extends Struct$1{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const SOLANA_SCHEMA=new Map;var _PublicKey;const MAX_SEED_LENGTH=32,PUBLIC_KEY_LENGTH=32;function isPublicKeyData(s){return s._bn!==void 0}let uniquePublicKeyCounter=1;class PublicKey extends Struct$1{constructor(e){if(super({}),this._bn=void 0,isPublicKeyData(e))this._bn=e._bn;else{if(typeof e=="string"){const t=bs58$1.decode(e);if(t.length!=PUBLIC_KEY_LENGTH)throw new Error("Invalid public key input");this._bn=new BN(t)}else this._bn=new BN(e);if(this._bn.byteLength()>PUBLIC_KEY_LENGTH)throw new Error("Invalid public key input")}}static unique(){const e=new PublicKey(uniquePublicKeyCounter);return uniquePublicKeyCounter+=1,new PublicKey(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return bs58$1.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(buffer.Buffer);if(e.length===PUBLIC_KEY_LENGTH)return e;const t=buffer.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Symbol.toStringTag](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,o){const a=buffer.Buffer.concat([e.toBuffer(),buffer.Buffer.from(t),o.toBuffer()]),c=sha256$1(a);return new PublicKey(c)}static createProgramAddressSync(e,t){let o=buffer.Buffer.alloc(0);e.forEach(function(c){if(c.length>MAX_SEED_LENGTH)throw new TypeError("Max seed length exceeded");o=buffer.Buffer.concat([o,toBuffer$1(c)])}),o=buffer.Buffer.concat([o,t.toBuffer(),buffer.Buffer.from("ProgramDerivedAddress")]);const a=sha256$1(o);if(isOnCurve(a))throw new Error("Invalid seeds, address must fall off the curve");return new PublicKey(a)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let o=255,a;for(;o!=0;){try{const c=e.concat(buffer.Buffer.from([o]));a=this.createProgramAddressSync(c,t)}catch(c){if(c instanceof TypeError)throw c;o--;continue}return[a,o]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new PublicKey(e);return isOnCurve(t.toBytes())}}_PublicKey=PublicKey;PublicKey.default=new _PublicKey("11111111111111111111111111111111");SOLANA_SCHEMA.set(PublicKey,{kind:"struct",fields:[["_bn","u256"]]});class Account{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=toBuffer$1(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=toBuffer$1(generatePrivateKey()),this._publicKey=toBuffer$1(getPublicKey(this._secretKey))}get publicKey(){return new PublicKey(this._publicKey)}get secretKey(){return buffer.Buffer.concat([this._secretKey,this._publicKey],64)}}const BPF_LOADER_DEPRECATED_PROGRAM_ID=new PublicKey("BPFLoader1111111111111111111111111111111111"),PACKET_DATA_SIZE=1280-40-8,VERSION_PREFIX_MASK=127,SIGNATURE_LENGTH_IN_BYTES=64;class TransactionExpiredBlockheightExceededError extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(TransactionExpiredBlockheightExceededError.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class TransactionExpiredTimeoutError extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(TransactionExpiredTimeoutError.prototype,"name",{value:"TransactionExpiredTimeoutError"});class TransactionExpiredNonceInvalidError extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(TransactionExpiredNonceInvalidError.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class MessageAccountKeys{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const o=new Map;this.keySegments().flat().forEach((c,d)=>{o.set(c.toBase58(),d)});const a=c=>{const d=o.get(c.toBase58());if(d===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return d};return e.map(c=>({programIdIndex:a(c.programId),accountKeyIndexes:c.keys.map(d=>a(d.pubkey)),data:c.data}))}}const publicKey$3=(s="publicKey")=>blob$1(32,s),signature=(s="signature")=>blob$1(64,s),rustString=(s="string")=>{const e=struct$1([u32$1("length"),u32$1("lengthPadding"),blob$1(offset$1(u32$1(),-8),"chars")],s),t=e.decode.bind(e),o=e.encode.bind(e),a=e;return a.decode=(c,d)=>t(c,d).chars.toString(),a.encode=(c,d,g)=>{const y={chars:buffer.Buffer.from(c,"utf8")};return o(y,d,g)},a.alloc=c=>u32$1().span+u32$1().span+buffer.Buffer.from(c,"utf8").length,a},authorized=(s="authorized")=>struct$1([publicKey$3("staker"),publicKey$3("withdrawer")],s),lockup=(s="lockup")=>struct$1([ns64$1("unixTimestamp"),ns64$1("epoch"),publicKey$3("custodian")],s),voteInit=(s="voteInit")=>struct$1([publicKey$3("nodePubkey"),publicKey$3("authorizedVoter"),publicKey$3("authorizedWithdrawer"),u8$1("commission")],s),voteAuthorizeWithSeedArgs=(s="voteAuthorizeWithSeedArgs")=>struct$1([u32$1("voteAuthorizationType"),publicKey$3("currentAuthorityDerivedKeyOwnerPubkey"),rustString("currentAuthorityDerivedKeySeed"),publicKey$3("newAuthorized")],s);function getAlloc(s,e){const t=a=>{if(a.span>=0)return a.span;if(typeof a.alloc=="function")return a.alloc(e[a.property]);if("count"in a&&"elementLayout"in a){const c=e[a.property];if(Array.isArray(c))return c.length*t(a.elementLayout)}else if("fields"in a)return getAlloc({layout:a},e[a.property]);return 0};let o=0;return s.layout.fields.forEach(a=>{o+=t(a)}),o}function decodeLength(s){let e=0,t=0;for(;;){let o=s.shift();if(e|=(o&127)<<t*7,t+=1,!(o&128))break}return e}function encodeLength(s,e){let t=e;for(;;){let o=t&127;if(t>>=7,t==0){s.push(o);break}else o|=128,s.push(o)}}function assert$1(s,e){if(!s)throw new Error(e||"Assertion failed")}class CompiledKeys{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const o=new Map,a=d=>{const g=d.toBase58();let y=o.get(g);return y===void 0&&(y={isSigner:!1,isWritable:!1,isInvoked:!1},o.set(g,y)),y},c=a(t);c.isSigner=!0,c.isWritable=!0;for(const d of e){a(d.programId).isInvoked=!0;for(const g of d.keys){const y=a(g.pubkey);y.isSigner||(y.isSigner=g.isSigner),y.isWritable||(y.isWritable=g.isWritable)}}return new CompiledKeys(t,o)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];assert$1(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,y])=>y.isSigner&&y.isWritable),o=e.filter(([,y])=>y.isSigner&&!y.isWritable),a=e.filter(([,y])=>!y.isSigner&&y.isWritable),c=e.filter(([,y])=>!y.isSigner&&!y.isWritable),d={numRequiredSignatures:t.length+o.length,numReadonlySignedAccounts:o.length,numReadonlyUnsignedAccounts:c.length};{assert$1(t.length>0,"Expected at least one writable signer key");const[y]=t[0];assert$1(y===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const g=[...t.map(([y])=>new PublicKey(y)),...o.map(([y])=>new PublicKey(y)),...a.map(([y])=>new PublicKey(y)),...c.map(([y])=>new PublicKey(y))];return[d,g]}extractTableLookup(e){const[t,o]=this.drainKeysFoundInLookupTable(e.state.addresses,d=>!d.isSigner&&!d.isInvoked&&d.isWritable),[a,c]=this.drainKeysFoundInLookupTable(e.state.addresses,d=>!d.isSigner&&!d.isInvoked&&!d.isWritable);if(!(t.length===0&&a.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:a},{writable:o,readonly:c}]}drainKeysFoundInLookupTable(e,t){const o=new Array,a=new Array;for(const[c,d]of this.keyMetaMap.entries())if(t(d)){const g=new PublicKey(c),y=e.findIndex(_=>_.equals(g));y>=0&&(assert$1(y<256,"Max lookup table index exceeded"),o.push(y),a.push(g),this.keyMetaMap.delete(c))}return[o,a]}}const END_OF_BUFFER_ERROR_MESSAGE="Reached end of buffer unexpectedly";function guardedShift(s){if(s.length===0)throw new Error(END_OF_BUFFER_ERROR_MESSAGE);return s.shift()}function guardedSplice(s,...e){const[t]=e;if(e.length===2?t+(e[1]??0)>s.length:t>=s.length)throw new Error(END_OF_BUFFER_ERROR_MESSAGE);return s.splice(...e)}class Message{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new PublicKey(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:bs58$1.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new MessageAccountKeys(this.staticAccountKeys)}static compile(e){const t=CompiledKeys.compile(e.instructions,e.payerKey),[o,a]=t.getMessageComponents(),d=new MessageAccountKeys(a).compileInstructions(e.instructions).map(g=>({programIdIndex:g.programIdIndex,accounts:g.accountKeyIndexes,data:bs58$1.encode(g.data)}));return new Message({header:o,accountKeys:a,recentBlockhash:e.recentBlockhash,instructions:d})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const o=e-t,c=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return o<c}else{const o=t-this.header.numReadonlySignedAccounts;return e<o}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];encodeLength(t,e);const o=this.instructions.map(S=>{const{accounts:A,programIdIndex:C}=S,N=Array.from(bs58$1.decode(S.data));let O=[];encodeLength(O,A.length);let I=[];return encodeLength(I,N.length),{programIdIndex:C,keyIndicesCount:buffer.Buffer.from(O),keyIndices:A,dataLength:buffer.Buffer.from(I),data:N}});let a=[];encodeLength(a,o.length);let c=buffer.Buffer.alloc(PACKET_DATA_SIZE);buffer.Buffer.from(a).copy(c);let d=a.length;o.forEach(S=>{const C=struct$1([u8$1("programIdIndex"),blob$1(S.keyIndicesCount.length,"keyIndicesCount"),seq(u8$1("keyIndex"),S.keyIndices.length,"keyIndices"),blob$1(S.dataLength.length,"dataLength"),seq(u8$1("userdatum"),S.data.length,"data")]).encode(S,c,d);d+=C}),c=c.slice(0,d);const g=struct$1([blob$1(1,"numRequiredSignatures"),blob$1(1,"numReadonlySignedAccounts"),blob$1(1,"numReadonlyUnsignedAccounts"),blob$1(t.length,"keyCount"),seq(publicKey$3("key"),e,"keys"),publicKey$3("recentBlockhash")]),y={numRequiredSignatures:buffer.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:buffer.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:buffer.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:buffer.Buffer.from(t),keys:this.accountKeys.map(S=>toBuffer$1(S.toBytes())),recentBlockhash:bs58$1.decode(this.recentBlockhash)};let _=buffer.Buffer.alloc(2048);const E=g.encode(y,_);return c.copy(_,E),_.slice(0,E+c.length)}static from(e){let t=[...e];const o=guardedShift(t);if(o!==(o&VERSION_PREFIX_MASK))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const a=guardedShift(t),c=guardedShift(t),d=decodeLength(t);let g=[];for(let A=0;A<d;A++){const C=guardedSplice(t,0,PUBLIC_KEY_LENGTH);g.push(new PublicKey(buffer.Buffer.from(C)))}const y=guardedSplice(t,0,PUBLIC_KEY_LENGTH),_=decodeLength(t);let E=[];for(let A=0;A<_;A++){const C=guardedShift(t),N=decodeLength(t),O=guardedSplice(t,0,N),I=decodeLength(t),P=guardedSplice(t,0,I),j=bs58$1.encode(buffer.Buffer.from(P));E.push({programIdIndex:C,accounts:O,data:j})}const S={header:{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c},recentBlockhash:bs58$1.encode(buffer.Buffer.from(y)),accountKeys:g,instructions:E};return new Message(S)}}class MessageV0{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new MessageAccountKeys(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,o=this.staticAccountKeys.length;if(e>=o){const a=e-o,c=this.addressTableLookups.reduce((d,g)=>d+g.writableIndexes.length,0);return a<c}else if(e>=this.header.numRequiredSignatures){const a=e-t,d=o-t-this.header.numReadonlyUnsignedAccounts;return a<d}else{const a=t-this.header.numReadonlySignedAccounts;return e<a}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const o of this.addressTableLookups){const a=e.find(c=>c.key.equals(o.accountKey));if(!a)throw new Error(`Failed to find address lookup table account for table key ${o.accountKey.toBase58()}`);for(const c of o.writableIndexes)if(c<a.state.addresses.length)t.writable.push(a.state.addresses[c]);else throw new Error(`Failed to find address for index ${c} in address lookup table ${o.accountKey.toBase58()}`);for(const c of o.readonlyIndexes)if(c<a.state.addresses.length)t.readonly.push(a.state.addresses[c]);else throw new Error(`Failed to find address for index ${c} in address lookup table ${o.accountKey.toBase58()}`)}return t}static compile(e){const t=CompiledKeys.compile(e.instructions,e.payerKey),o=new Array,a={writable:new Array,readonly:new Array},c=e.addressLookupTableAccounts||[];for(const E of c){const S=t.extractTableLookup(E);if(S!==void 0){const[A,{writable:C,readonly:N}]=S;o.push(A),a.writable.push(...C),a.readonly.push(...N)}}const[d,g]=t.getMessageComponents(),_=new MessageAccountKeys(g,a).compileInstructions(e.instructions);return new MessageV0({header:d,staticAccountKeys:g,recentBlockhash:e.recentBlockhash,compiledInstructions:_,addressTableLookups:o})}serialize(){const e=Array();encodeLength(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),o=Array();encodeLength(o,this.compiledInstructions.length);const a=this.serializeAddressTableLookups(),c=Array();encodeLength(c,this.addressTableLookups.length);const d=struct$1([u8$1("prefix"),struct$1([u8$1("numRequiredSignatures"),u8$1("numReadonlySignedAccounts"),u8$1("numReadonlyUnsignedAccounts")],"header"),blob$1(e.length,"staticAccountKeysLength"),seq(publicKey$3(),this.staticAccountKeys.length,"staticAccountKeys"),publicKey$3("recentBlockhash"),blob$1(o.length,"instructionsLength"),blob$1(t.length,"serializedInstructions"),blob$1(c.length,"addressTableLookupsLength"),blob$1(a.length,"serializedAddressTableLookups")]),g=new Uint8Array(PACKET_DATA_SIZE),y=128,_=d.encode({prefix:y,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(E=>E.toBytes()),recentBlockhash:bs58$1.decode(this.recentBlockhash),instructionsLength:new Uint8Array(o),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(c),serializedAddressTableLookups:a},g);return g.slice(0,_)}serializeInstructions(){let e=0;const t=new Uint8Array(PACKET_DATA_SIZE);for(const o of this.compiledInstructions){const a=Array();encodeLength(a,o.accountKeyIndexes.length);const c=Array();encodeLength(c,o.data.length);const d=struct$1([u8$1("programIdIndex"),blob$1(a.length,"encodedAccountKeyIndexesLength"),seq(u8$1(),o.accountKeyIndexes.length,"accountKeyIndexes"),blob$1(c.length,"encodedDataLength"),blob$1(o.data.length,"data")]);e+=d.encode({programIdIndex:o.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(a),accountKeyIndexes:o.accountKeyIndexes,encodedDataLength:new Uint8Array(c),data:o.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(PACKET_DATA_SIZE);for(const o of this.addressTableLookups){const a=Array();encodeLength(a,o.writableIndexes.length);const c=Array();encodeLength(c,o.readonlyIndexes.length);const d=struct$1([publicKey$3("accountKey"),blob$1(a.length,"encodedWritableIndexesLength"),seq(u8$1(),o.writableIndexes.length,"writableIndexes"),blob$1(c.length,"encodedReadonlyIndexesLength"),seq(u8$1(),o.readonlyIndexes.length,"readonlyIndexes")]);e+=d.encode({accountKey:o.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(a),writableIndexes:o.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(c),readonlyIndexes:o.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const o=guardedShift(t),a=o&VERSION_PREFIX_MASK;assert$1(o!==a,"Expected versioned message but received legacy message");const c=a;assert$1(c===0,`Expected versioned message with version 0 but found version ${c}`);const d={numRequiredSignatures:guardedShift(t),numReadonlySignedAccounts:guardedShift(t),numReadonlyUnsignedAccounts:guardedShift(t)},g=[],y=decodeLength(t);for(let N=0;N<y;N++)g.push(new PublicKey(guardedSplice(t,0,PUBLIC_KEY_LENGTH)));const _=bs58$1.encode(guardedSplice(t,0,PUBLIC_KEY_LENGTH)),E=decodeLength(t),S=[];for(let N=0;N<E;N++){const O=guardedShift(t),I=decodeLength(t),P=guardedSplice(t,0,I),j=decodeLength(t),B=new Uint8Array(guardedSplice(t,0,j));S.push({programIdIndex:O,accountKeyIndexes:P,data:B})}const A=decodeLength(t),C=[];for(let N=0;N<A;N++){const O=new PublicKey(guardedSplice(t,0,PUBLIC_KEY_LENGTH)),I=decodeLength(t),P=guardedSplice(t,0,I),j=decodeLength(t),B=guardedSplice(t,0,j);C.push({accountKey:O,writableIndexes:P,readonlyIndexes:B})}return new MessageV0({header:d,staticAccountKeys:g,recentBlockhash:_,compiledInstructions:S,addressTableLookups:C})}}const VersionedMessage={deserializeMessageVersion(s){const e=s[0],t=e&VERSION_PREFIX_MASK;return t===e?"legacy":t},deserialize:s=>{const e=VersionedMessage.deserializeMessageVersion(s);if(e==="legacy")return Message.from(s);if(e===0)return MessageV0.deserialize(s);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let TransactionStatus=function(s){return s[s.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",s[s.PROCESSED=1]="PROCESSED",s[s.TIMED_OUT=2]="TIMED_OUT",s[s.NONCE_INVALID=3]="NONCE_INVALID",s}({});const DEFAULT_SIGNATURE=buffer.Buffer.alloc(SIGNATURE_LENGTH_IN_BYTES).fill(0);class TransactionInstruction{constructor(e){this.keys=void 0,this.programId=void 0,this.data=buffer.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:o})=>({pubkey:e.toJSON(),isSigner:t,isWritable:o})),programId:this.programId.toJSON(),data:[...this.data]}}}class Transaction{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:o}=e;this.minNonceContextSlot=t,this.nonceInfo=o}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:o}=e;this.recentBlockhash=t,this.lastValidBlockHeight=o}else{const{recentBlockhash:t,nonceInfo:o}=e;o&&(this.nonceInfo=o),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new TransactionInstruction(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let o;if(this.feePayer)o=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)o=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let O=0;O<t.length;O++)if(t[O].programId===void 0)throw new Error(`Transaction instruction index ${O} has undefined program id`);const a=[],c=[];t.forEach(O=>{O.keys.forEach(P=>{c.push({...P})});const I=O.programId.toString();a.includes(I)||a.push(I)}),a.forEach(O=>{c.push({pubkey:new PublicKey(O),isSigner:!1,isWritable:!1})});const d=[];c.forEach(O=>{const I=O.pubkey.toString(),P=d.findIndex(j=>j.pubkey.toString()===I);P>-1?(d[P].isWritable=d[P].isWritable||O.isWritable,d[P].isSigner=d[P].isSigner||O.isSigner):d.push(O)}),d.sort(function(O,I){if(O.isSigner!==I.isSigner)return O.isSigner?-1:1;if(O.isWritable!==I.isWritable)return O.isWritable?-1:1;const P={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return O.pubkey.toBase58().localeCompare(I.pubkey.toBase58(),"en",P)});const g=d.findIndex(O=>O.pubkey.equals(o));if(g>-1){const[O]=d.splice(g,1);O.isSigner=!0,O.isWritable=!0,d.unshift(O)}else d.unshift({pubkey:o,isSigner:!0,isWritable:!0});for(const O of this.signatures){const I=d.findIndex(P=>P.pubkey.equals(O.publicKey));if(I>-1)d[I].isSigner||(d[I].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${O.publicKey.toString()}`)}let y=0,_=0,E=0;const S=[],A=[];d.forEach(({pubkey:O,isSigner:I,isWritable:P})=>{I?(S.push(O.toString()),y+=1,P||(_+=1)):(A.push(O.toString()),P||(E+=1))});const C=S.concat(A),N=t.map(O=>{const{data:I,programId:P}=O;return{programIdIndex:C.indexOf(P.toString()),accounts:O.keys.map(j=>C.indexOf(j.pubkey.toString())),data:bs58$1.encode(I)}});return N.forEach(O=>{assert$1(O.programIdIndex>=0),O.accounts.forEach(I=>assert$1(I>=0))}),new Message({header:{numRequiredSignatures:y,numReadonlySignedAccounts:_,numReadonlyUnsignedAccounts:E},accountKeys:C,recentBlockhash:e,instructions:N})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((a,c)=>t[c].equals(a.publicKey))||(this.signatures=t.map(o=>({signature:null,publicKey:o}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(o=>{const a=o.toString();return t.has(a)?!1:(t.add(a),!0)}).map(o=>({signature:null,publicKey:o}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,o=[];for(const c of e){const d=c.publicKey.toString();t.has(d)||(t.add(d),o.push(c))}this.signatures=o.map(c=>({signature:null,publicKey:c.publicKey}));const a=this._compile();this._partialSign(a,...o)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,o=[];for(const c of e){const d=c.publicKey.toString();t.has(d)||(t.add(d),o.push(c))}const a=this._compile();this._partialSign(a,...o)}_partialSign(e,...t){const o=e.serialize();t.forEach(a=>{const c=sign(o,a.secretKey);this._addSignature(a.publicKey,toBuffer$1(c))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){assert$1(t.length===64);const o=this.signatures.findIndex(a=>e.equals(a.publicKey));if(o<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[o].signature=buffer.Buffer.from(t)}verifySignatures(e=!0){return!this._getMessageSignednessErrors(this.serializeMessage(),e)}_getMessageSignednessErrors(e,t){const o={};for(const{signature:a,publicKey:c}of this.signatures)a===null?t&&(o.missing||(o.missing=[])).push(c):verify(a,e,c.toBytes())||(o.invalid||(o.invalid=[])).push(c);return o.invalid||o.missing?o:void 0}serialize(e){const{requireAllSignatures:t,verifySignatures:o}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),a=this.serializeMessage();if(o){const c=this._getMessageSignednessErrors(a,t);if(c){let d="Signature verification failed.";throw c.invalid&&(d+=`
Invalid signature for public key${c.invalid.length===1?"":"(s)"} [\`${c.invalid.map(g=>g.toBase58()).join("`, `")}\`].`),c.missing&&(d+=`
Missing signature for public key${c.missing.length===1?"":"(s)"} [\`${c.missing.map(g=>g.toBase58()).join("`, `")}\`].`),new Error(d)}}return this._serialize(a)}_serialize(e){const{signatures:t}=this,o=[];encodeLength(o,t.length);const a=o.length+t.length*64+e.length,c=buffer.Buffer.alloc(a);return assert$1(t.length<256),buffer.Buffer.from(o).copy(c,0),t.forEach(({signature:d},g)=>{d!==null&&(assert$1(d.length===64,"signature has invalid length"),buffer.Buffer.from(d).copy(c,o.length+g*64))}),e.copy(c,o.length+t.length*64),assert$1(c.length<=PACKET_DATA_SIZE,`Transaction too large: ${c.length} > ${PACKET_DATA_SIZE}`),c}get keys(){return assert$1(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return assert$1(this.instructions.length===1),this.instructions[0].programId}get data(){return assert$1(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const o=decodeLength(t);let a=[];for(let c=0;c<o;c++){const d=guardedSplice(t,0,SIGNATURE_LENGTH_IN_BYTES);a.push(bs58$1.encode(buffer.Buffer.from(d)))}return Transaction.populate(Message.from(t),a)}static populate(e,t=[]){const o=new Transaction;return o.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(o.feePayer=e.accountKeys[0]),t.forEach((a,c)=>{const d={signature:a==bs58$1.encode(DEFAULT_SIGNATURE)?null:bs58$1.decode(a),publicKey:e.accountKeys[c]};o.signatures.push(d)}),e.instructions.forEach(a=>{const c=a.accounts.map(d=>{const g=e.accountKeys[d];return{pubkey:g,isSigner:o.signatures.some(y=>y.publicKey.toString()===g.toString())||e.isAccountSigner(d),isWritable:e.isAccountWritable(d)}});o.instructions.push(new TransactionInstruction({keys:c,programId:e.accountKeys[a.programIdIndex],data:bs58$1.decode(a.data)}))}),o._message=e,o._json=o.toJSON(),o}}class TransactionMessage{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:o,compiledInstructions:a,recentBlockhash:c}=e,{numRequiredSignatures:d,numReadonlySignedAccounts:g,numReadonlyUnsignedAccounts:y}=o,_=d-g;assert$1(_>0,"Message header is invalid");const E=e.staticAccountKeys.length-d-y;assert$1(E>=0,"Message header is invalid");const S=e.getAccountKeys(t),A=S.get(0);if(A===void 0)throw new Error("Failed to decompile message because no account keys were found");const C=[];for(const N of a){const O=[];for(const P of N.accountKeyIndexes){const j=S.get(P);if(j===void 0)throw new Error(`Failed to find key for account key index ${P}`);const B=P<d;let H;B?H=P<_:P<S.staticAccountKeys.length?H=P-d<E:H=P-S.staticAccountKeys.length<S.accountKeysFromLookups.writable.length,O.push({pubkey:j,isSigner:P<o.numRequiredSignatures,isWritable:H})}const I=S.get(N.programIdIndex);if(I===void 0)throw new Error(`Failed to find program id for program id index ${N.programIdIndex}`);C.push(new TransactionInstruction({programId:I,data:toBuffer$1(N.data),keys:O}))}return new TransactionMessage({payerKey:A,instructions:C,recentBlockhash:c})}compileToLegacyMessage(){return Message.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return MessageV0.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class VersionedTransaction{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)assert$1(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const o=[];for(let a=0;a<e.header.numRequiredSignatures;a++)o.push(new Uint8Array(SIGNATURE_LENGTH_IN_BYTES));this.signatures=o}this.message=e}serialize(){const e=this.message.serialize(),t=Array();encodeLength(t,this.signatures.length);const o=struct$1([blob$1(t.length,"encodedSignaturesLength"),seq(signature(),this.signatures.length,"signatures"),blob$1(e.length,"serializedMessage")]),a=new Uint8Array(2048),c=o.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},a);return a.slice(0,c)}static deserialize(e){let t=[...e];const o=[],a=decodeLength(t);for(let d=0;d<a;d++)o.push(new Uint8Array(guardedSplice(t,0,SIGNATURE_LENGTH_IN_BYTES)));const c=VersionedMessage.deserialize(new Uint8Array(t));return new VersionedTransaction(c,o)}sign(e){const t=this.message.serialize(),o=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const a of e){const c=o.findIndex(d=>d.equals(a.publicKey));assert$1(c>=0,`Cannot sign with non signer key ${a.publicKey.toBase58()}`),this.signatures[c]=sign(t,a.secretKey)}}addSignature(e,t){assert$1(t.byteLength===64,"Signature must be 64 bytes long");const a=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(c=>c.equals(e));assert$1(a>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[a]=t}}const NUM_TICKS_PER_SECOND=160,DEFAULT_TICKS_PER_SLOT=64,NUM_SLOTS_PER_SECOND=NUM_TICKS_PER_SECOND/DEFAULT_TICKS_PER_SLOT,MS_PER_SLOT=1e3/NUM_SLOTS_PER_SECOND,SYSVAR_CLOCK_PUBKEY=new PublicKey("SysvarC1ock11111111111111111111111111111111"),SYSVAR_EPOCH_SCHEDULE_PUBKEY=new PublicKey("SysvarEpochSchedu1e111111111111111111111111"),SYSVAR_INSTRUCTIONS_PUBKEY=new PublicKey("Sysvar1nstructions1111111111111111111111111"),SYSVAR_RECENT_BLOCKHASHES_PUBKEY=new PublicKey("SysvarRecentB1ockHashes11111111111111111111"),SYSVAR_RENT_PUBKEY=new PublicKey("SysvarRent111111111111111111111111111111111"),SYSVAR_REWARDS_PUBKEY=new PublicKey("SysvarRewards111111111111111111111111111111"),SYSVAR_SLOT_HASHES_PUBKEY=new PublicKey("SysvarS1otHashes111111111111111111111111111"),SYSVAR_SLOT_HISTORY_PUBKEY=new PublicKey("SysvarS1otHistory11111111111111111111111111"),SYSVAR_STAKE_HISTORY_PUBKEY=new PublicKey("SysvarStakeHistory1111111111111111111111111");class SendTransactionError extends Error{constructor({action:e,signature:t,transactionMessage:o,logs:a}){const c=a?`Logs: 
${JSON.stringify(a.slice(-10),null,2)}. `:"",d="\nCatch the `SendTransactionError` and call `getLogs()` on it for full details.";let g;switch(e){case"send":g=`Transaction ${t} resulted in an error. 
${o}. `+c+d;break;case"simulate":g=`Simulation failed. 
Message: ${o}. 
`+c+d;break;default:g=`Unknown action '${(y=>y)(e)}'`}super(g),this.signature=void 0,this.transactionMessage=void 0,this.transactionLogs=void 0,this.signature=t,this.transactionMessage=o,this.transactionLogs=a||void 0}get transactionError(){return{message:this.transactionMessage,logs:Array.isArray(this.transactionLogs)?this.transactionLogs:void 0}}get logs(){const e=this.transactionLogs;if(!(e!=null&&typeof e=="object"&&"then"in e))return e}async getLogs(e){return Array.isArray(this.transactionLogs)||(this.transactionLogs=new Promise((t,o)=>{e.getTransaction(this.signature).then(a=>{if(a&&a.meta&&a.meta.logMessages){const c=a.meta.logMessages;this.transactionLogs=c,t(c)}else o(new Error("Log messages not found"))}).catch(o)})),await this.transactionLogs}}const SolanaJSONRPCErrorCode={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class SolanaJSONRPCError extends Error{constructor({code:e,message:t,data:o},a){super(a!=null?`${a}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=o,this.name="SolanaJSONRPCError"}}async function sendAndConfirmTransaction(s,e,t,o){const a=o&&{skipPreflight:o.skipPreflight,preflightCommitment:o.preflightCommitment||o.commitment,maxRetries:o.maxRetries,minContextSlot:o.minContextSlot},c=await s.sendTransaction(e,t,a);let d;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)d=(await s.confirmTransaction({abortSignal:o==null?void 0:o.abortSignal,signature:c,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},o&&o.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:g}=e.nonceInfo,y=g.keys[0].pubkey;d=(await s.confirmTransaction({abortSignal:o==null?void 0:o.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:y,nonceValue:e.nonceInfo.nonce,signature:c},o&&o.commitment)).value}else(o==null?void 0:o.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),d=(await s.confirmTransaction(c,o&&o.commitment)).value;if(d.err)throw c!=null?new SendTransactionError({action:"send",signature:c,transactionMessage:`Status: (${JSON.stringify(d)})`}):new Error(`Transaction ${c} failed (${JSON.stringify(d)})`);return c}function sleep(s){return new Promise(e=>setTimeout(e,s))}function encodeData(s,e){const t=s.layout.span>=0?s.layout.span:getAlloc(s,e),o=buffer.Buffer.alloc(t),a=Object.assign({instruction:s.index},e);return s.layout.encode(a,o),o}function decodeData$1(s,e){let t;try{t=s.layout.decode(e)}catch(o){throw new Error("invalid instruction; "+o)}if(t.instruction!==s.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${s.index}`);return t}const FeeCalculatorLayout=nu64$1("lamportsPerSignature"),NonceAccountLayout=struct$1([u32$1("version"),u32$1("state"),publicKey$3("authorizedPubkey"),publicKey$3("nonce"),struct$1([FeeCalculatorLayout],"feeCalculator")]),NONCE_ACCOUNT_LENGTH=NonceAccountLayout.span;class NonceAccount{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=NonceAccountLayout.decode(toBuffer$1(e),0);return new NonceAccount({authorizedPubkey:new PublicKey(t.authorizedPubkey),nonce:new PublicKey(t.nonce).toString(),feeCalculator:t.feeCalculator})}}function u64$1(s){const e=blob$1(8,s),t=e.decode.bind(e),o=e.encode.bind(e),a=e,c=getU64Codec();return a.decode=(d,g)=>{const y=t(d,g);return c.decode(y)},a.encode=(d,g,y)=>{const _=c.encode(d);return o(_,g,y)},a}class SystemInstruction{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const o=u32$1("instruction").decode(e.data);let a;for(const[c,d]of Object.entries(SYSTEM_INSTRUCTION_LAYOUTS))if(d.index==o){a=c;break}if(!a)throw new Error("Instruction type incorrect; not a SystemInstruction");return a}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:o,programId:a}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:o,programId:new PublicKey(a)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:o,programId:a}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:o,programId:new PublicKey(a)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:o,space:a,programId:c}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new PublicKey(t),seed:o,space:a,programId:new PublicKey(c)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new PublicKey(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:o,programId:a}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new PublicKey(t),seed:o,programId:new PublicKey(a)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:o,lamports:a,space:c,programId:d}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new PublicKey(t),seed:o,lamports:a,space:c,programId:new PublicKey(d)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new PublicKey(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=decodeData$1(SYSTEM_INSTRUCTION_LAYOUTS.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new PublicKey(t)}}static checkProgramId(e){if(!e.equals(SystemProgram.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const SYSTEM_INSTRUCTION_LAYOUTS=Object.freeze({Create:{index:0,layout:struct$1([u32$1("instruction"),ns64$1("lamports"),ns64$1("space"),publicKey$3("programId")])},Assign:{index:1,layout:struct$1([u32$1("instruction"),publicKey$3("programId")])},Transfer:{index:2,layout:struct$1([u32$1("instruction"),u64$1("lamports")])},CreateWithSeed:{index:3,layout:struct$1([u32$1("instruction"),publicKey$3("base"),rustString("seed"),ns64$1("lamports"),ns64$1("space"),publicKey$3("programId")])},AdvanceNonceAccount:{index:4,layout:struct$1([u32$1("instruction")])},WithdrawNonceAccount:{index:5,layout:struct$1([u32$1("instruction"),ns64$1("lamports")])},InitializeNonceAccount:{index:6,layout:struct$1([u32$1("instruction"),publicKey$3("authorized")])},AuthorizeNonceAccount:{index:7,layout:struct$1([u32$1("instruction"),publicKey$3("authorized")])},Allocate:{index:8,layout:struct$1([u32$1("instruction"),ns64$1("space")])},AllocateWithSeed:{index:9,layout:struct$1([u32$1("instruction"),publicKey$3("base"),rustString("seed"),ns64$1("space"),publicKey$3("programId")])},AssignWithSeed:{index:10,layout:struct$1([u32$1("instruction"),publicKey$3("base"),rustString("seed"),publicKey$3("programId")])},TransferWithSeed:{index:11,layout:struct$1([u32$1("instruction"),u64$1("lamports"),rustString("seed"),publicKey$3("programId")])},UpgradeNonceAccount:{index:12,layout:struct$1([u32$1("instruction")])}});class SystemProgram{constructor(){}static createAccount(e){const t=SYSTEM_INSTRUCTION_LAYOUTS.Create,o=encodeData(t,{lamports:e.lamports,space:e.space,programId:toBuffer$1(e.programId.toBuffer())});return new TransactionInstruction({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:o})}static transfer(e){let t,o;if("basePubkey"in e){const a=SYSTEM_INSTRUCTION_LAYOUTS.TransferWithSeed;t=encodeData(a,{lamports:BigInt(e.lamports),seed:e.seed,programId:toBuffer$1(e.programId.toBuffer())}),o=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const a=SYSTEM_INSTRUCTION_LAYOUTS.Transfer;t=encodeData(a,{lamports:BigInt(e.lamports)}),o=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new TransactionInstruction({keys:o,programId:this.programId,data:t})}static assign(e){let t,o;if("basePubkey"in e){const a=SYSTEM_INSTRUCTION_LAYOUTS.AssignWithSeed;t=encodeData(a,{base:toBuffer$1(e.basePubkey.toBuffer()),seed:e.seed,programId:toBuffer$1(e.programId.toBuffer())}),o=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const a=SYSTEM_INSTRUCTION_LAYOUTS.Assign;t=encodeData(a,{programId:toBuffer$1(e.programId.toBuffer())}),o=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new TransactionInstruction({keys:o,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=SYSTEM_INSTRUCTION_LAYOUTS.CreateWithSeed,o=encodeData(t,{base:toBuffer$1(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:toBuffer$1(e.programId.toBuffer())});let a=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey.equals(e.fromPubkey)||a.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new TransactionInstruction({keys:a,programId:this.programId,data:o})}static createNonceAccount(e){const t=new Transaction;"basePubkey"in e&&"seed"in e?t.add(SystemProgram.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:NONCE_ACCOUNT_LENGTH,programId:this.programId})):t.add(SystemProgram.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:NONCE_ACCOUNT_LENGTH,programId:this.programId}));const o={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(o)),t}static nonceInitialize(e){const t=SYSTEM_INSTRUCTION_LAYOUTS.InitializeNonceAccount,o=encodeData(t,{authorized:toBuffer$1(e.authorizedPubkey.toBuffer())}),a={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_RECENT_BLOCKHASHES_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:this.programId,data:o};return new TransactionInstruction(a)}static nonceAdvance(e){const t=SYSTEM_INSTRUCTION_LAYOUTS.AdvanceNonceAccount,o=encodeData(t),a={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_RECENT_BLOCKHASHES_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new TransactionInstruction(a)}static nonceWithdraw(e){const t=SYSTEM_INSTRUCTION_LAYOUTS.WithdrawNonceAccount,o=encodeData(t,{lamports:e.lamports});return new TransactionInstruction({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_RECENT_BLOCKHASHES_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static nonceAuthorize(e){const t=SYSTEM_INSTRUCTION_LAYOUTS.AuthorizeNonceAccount,o=encodeData(t,{authorized:toBuffer$1(e.newAuthorizedPubkey.toBuffer())});return new TransactionInstruction({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static allocate(e){let t,o;if("basePubkey"in e){const a=SYSTEM_INSTRUCTION_LAYOUTS.AllocateWithSeed;t=encodeData(a,{base:toBuffer$1(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:toBuffer$1(e.programId.toBuffer())}),o=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const a=SYSTEM_INSTRUCTION_LAYOUTS.Allocate;t=encodeData(a,{space:e.space}),o=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new TransactionInstruction({keys:o,programId:this.programId,data:t})}}SystemProgram.programId=new PublicKey("11111111111111111111111111111111");const CHUNK_SIZE=PACKET_DATA_SIZE-300;class Loader{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/Loader.chunkSize)+1+1)}static async load(e,t,o,a,c){{const S=await e.getMinimumBalanceForRentExemption(c.length),A=await e.getAccountInfo(o.publicKey,"confirmed");let C=null;if(A!==null){if(A.executable)return console.error("Program load failed, account is already executable"),!1;A.data.length!==c.length&&(C=C||new Transaction,C.add(SystemProgram.allocate({accountPubkey:o.publicKey,space:c.length}))),A.owner.equals(a)||(C=C||new Transaction,C.add(SystemProgram.assign({accountPubkey:o.publicKey,programId:a}))),A.lamports<S&&(C=C||new Transaction,C.add(SystemProgram.transfer({fromPubkey:t.publicKey,toPubkey:o.publicKey,lamports:S-A.lamports})))}else C=new Transaction().add(SystemProgram.createAccount({fromPubkey:t.publicKey,newAccountPubkey:o.publicKey,lamports:S>0?S:1,space:c.length,programId:a}));C!==null&&await sendAndConfirmTransaction(e,C,[t,o],{commitment:"confirmed"})}const d=struct$1([u32$1("instruction"),u32$1("offset"),u32$1("bytesLength"),u32$1("bytesLengthPadding"),seq(u8$1("byte"),offset$1(u32$1(),-8),"bytes")]),g=Loader.chunkSize;let y=0,_=c,E=[];for(;_.length>0;){const S=_.slice(0,g),A=buffer.Buffer.alloc(g+16);d.encode({instruction:0,offset:y,bytes:S,bytesLength:0,bytesLengthPadding:0},A);const C=new Transaction().add({keys:[{pubkey:o.publicKey,isSigner:!0,isWritable:!0}],programId:a,data:A});E.push(sendAndConfirmTransaction(e,C,[t,o],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await sleep(1e3/4),y+=g,_=_.slice(g)}await Promise.all(E);{const S=struct$1([u32$1("instruction")]),A=buffer.Buffer.alloc(S.span);S.encode({instruction:1},A);const C=new Transaction().add({keys:[{pubkey:o.publicKey,isSigner:!0,isWritable:!0},{pubkey:SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:a,data:A}),N="processed",O=await e.sendTransaction(C,[t,o],{preflightCommitment:N}),{context:I,value:P}=await e.confirmTransaction({signature:O,lastValidBlockHeight:C.lastValidBlockHeight,blockhash:C.recentBlockhash},N);if(P.err)throw new Error(`Transaction ${O} failed (${JSON.stringify(P)})`);for(;;){try{if(await e.getSlot({commitment:N})>I.slot)break}catch{}await new Promise(j=>setTimeout(j,Math.round(MS_PER_SLOT/2)))}}return!0}}Loader.chunkSize=CHUNK_SIZE;const BPF_LOADER_PROGRAM_ID=new PublicKey("BPFLoader2111111111111111111111111111111111");class BpfLoader{static getMinNumSignatures(e){return Loader.getMinNumSignatures(e)}static load(e,t,o,a,c){return Loader.load(e,t,o,c,a)}}function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var fastStableStringify$1,hasRequiredFastStableStringify;function requireFastStableStringify(){if(hasRequiredFastStableStringify)return fastStableStringify$1;hasRequiredFastStableStringify=1;var s=Object.prototype.toString,e=Object.keys||function(o){var a=[];for(var c in o)a.push(c);return a};function t(o,a){var c,d,g,y,_,E,S;if(o===!0)return"true";if(o===!1)return"false";switch(typeof o){case"object":if(o===null)return null;if(o.toJSON&&typeof o.toJSON=="function")return t(o.toJSON(),a);if(S=s.call(o),S==="[object Array]"){for(g="[",d=o.length-1,c=0;c<d;c++)g+=t(o[c],!0)+",";return d>-1&&(g+=t(o[c],!0)),g+"]"}else if(S==="[object Object]"){for(y=e(o).sort(),d=y.length,g="",c=0;c<d;)_=y[c],E=t(o[_],!1),E!==void 0&&(g&&(g+=","),g+=JSON.stringify(_)+":"+E),c++;return"{"+g+"}"}else return JSON.stringify(o);case"function":case"undefined":return a?null:void 0;case"string":return JSON.stringify(o);default:return isFinite(o)?o:null}}return fastStableStringify$1=function(o){var a=t(o,!1);if(a!==void 0)return""+a},fastStableStringify$1}var fastStableStringifyExports=requireFastStableStringify(),fastStableStringify=getDefaultExportFromCjs(fastStableStringifyExports);const MINIMUM_SLOT_PER_EPOCH=32;function trailingZeros(s){let e=0;for(;s>1;)s/=2,e++;return e}function nextPowerOfTwo(s){return s===0?1:(s--,s|=s>>1,s|=s>>2,s|=s>>4,s|=s>>8,s|=s>>16,s|=s>>32,s+1)}class EpochSchedule{constructor(e,t,o,a,c){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=o,this.firstNormalEpoch=a,this.firstNormalSlot=c}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=trailingZeros(nextPowerOfTwo(e+MINIMUM_SLOT_PER_EPOCH+1))-trailingZeros(MINIMUM_SLOT_PER_EPOCH)-1,o=this.getSlotsInEpoch(t),a=e-(o-MINIMUM_SLOT_PER_EPOCH);return[t,a]}else{const t=e-this.firstNormalSlot,o=Math.floor(t/this.slotsPerEpoch),a=this.firstNormalEpoch+o,c=t%this.slotsPerEpoch;return[a,c]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*MINIMUM_SLOT_PER_EPOCH:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+trailingZeros(MINIMUM_SLOT_PER_EPOCH)):this.slotsPerEpoch}}var fetchImpl=globalThis.fetch;class RpcWebSocketClient extends CommonClient{constructor(e,t,o){const a=c=>{const d=WebSocket(c,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in d?this.underlyingSocket=d.socket:this.underlyingSocket=d,d};super(a,e,t,o),this.underlyingSocket=void 0}call(...e){var o;const t=(o=this.underlyingSocket)==null?void 0:o.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var o;const t=(o=this.underlyingSocket)==null?void 0:o.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function decodeData(s,e){let t;try{t=s.layout.decode(e)}catch(o){throw new Error("invalid instruction; "+o)}if(t.typeIndex!==s.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${s.index}`);return t}const LOOKUP_TABLE_META_SIZE=56;class AddressLookupTableAccount{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=decodeData(LookupTableMetaLayout,e),o=e.length-LOOKUP_TABLE_META_SIZE;assert$1(o>=0,"lookup table is invalid"),assert$1(o%32===0,"lookup table is invalid");const a=o/32,{addresses:c}=struct$1([seq(publicKey$3(),a,"addresses")]).decode(e.slice(LOOKUP_TABLE_META_SIZE));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new PublicKey(t.authority[0]):void 0,addresses:c.map(d=>new PublicKey(d))}}}const LookupTableMetaLayout={index:1,layout:struct$1([u32$1("typeIndex"),u64$1("deactivationSlot"),nu64$1("lastExtendedSlot"),u8$1("lastExtendedStartIndex"),u8$1(),seq(publicKey$3(),offset$1(u8$1(),-1),"authority")])},URL_RE=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function makeWebsocketUrl(s){const e=s.match(URL_RE);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${s}\``);const[t,o,a,c]=e,d=s.startsWith("https:")?"wss:":"ws:",g=a==null?null:parseInt(a.slice(1),10),y=g==null?"":`:${g+1}`;return`${d}//${o}${y}${c}`}const PublicKeyFromString=coerce$1(instance$1(PublicKey),string$1(),s=>new PublicKey(s)),RawAccountDataResult=tuple([string$1(),literal$1("base64")]),BufferFromRawAccountData=coerce$1(instance$1(buffer.Buffer),RawAccountDataResult,s=>buffer.Buffer.from(s[0],"base64")),BLOCKHASH_CACHE_TIMEOUT_MS=30*1e3;function assertEndpointUrl(s){if(/^https?:/.test(s)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return s}function extractCommitmentFromConfig(s){let e,t;if(typeof s=="string")e=s;else if(s){const{commitment:o,...a}=s;e=o,t=a}return{commitment:e,config:t}}function applyDefaultMemcmpEncodingToFilters(s){return s.map(e=>"memcmp"in e?{...e,memcmp:{...e.memcmp,encoding:e.memcmp.encoding??"base58"}}:e)}function createRpcResult$1(s){return union$2([type$1({jsonrpc:literal$1("2.0"),id:string$1(),result:s}),type$1({jsonrpc:literal$1("2.0"),id:string$1(),error:type$1({code:unknown$1(),message:string$1(),data:optional$1(any$1())})})])}const UnknownRpcResult$1=createRpcResult$1(unknown$1());function jsonRpcResult$1(s){return coerce$1(createRpcResult$1(s),UnknownRpcResult$1,e=>"error"in e?e:{...e,result:create$1(e.result,s)})}function jsonRpcResultAndContext$1(s){return jsonRpcResult$1(type$1({context:type$1({slot:number$2()}),value:s}))}function notificationResultAndContext(s){return type$1({context:type$1({slot:number$2()}),value:s})}function versionedMessageFromResponse(s,e){return s===0?new MessageV0({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new PublicKey(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:bs58$1.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new Message(e)}const GetInflationGovernorResult=type$1({foundation:number$2(),foundationTerm:number$2(),initial:number$2(),taper:number$2(),terminal:number$2()}),GetInflationRewardResult=jsonRpcResult$1(array$1(nullable$1(type$1({epoch:number$2(),effectiveSlot:number$2(),amount:number$2(),postBalance:number$2(),commission:optional$1(nullable$1(number$2()))})))),GetRecentPrioritizationFeesResult=array$1(type$1({slot:number$2(),prioritizationFee:number$2()})),GetInflationRateResult=type$1({total:number$2(),validator:number$2(),foundation:number$2(),epoch:number$2()}),GetEpochInfoResult=type$1({epoch:number$2(),slotIndex:number$2(),slotsInEpoch:number$2(),absoluteSlot:number$2(),blockHeight:optional$1(number$2()),transactionCount:optional$1(number$2())}),GetEpochScheduleResult=type$1({slotsPerEpoch:number$2(),leaderScheduleSlotOffset:number$2(),warmup:boolean$1(),firstNormalEpoch:number$2(),firstNormalSlot:number$2()}),GetLeaderScheduleResult=record$1(string$1(),array$1(number$2())),TransactionErrorResult=nullable$1(union$2([type$1({}),string$1()])),SignatureStatusResult=type$1({err:TransactionErrorResult}),SignatureReceivedResult=literal$1("receivedSignature"),VersionResult=type$1({"solana-core":string$1(),"feature-set":optional$1(number$2())}),ParsedInstructionStruct=type$1({program:string$1(),programId:PublicKeyFromString,parsed:unknown$1()}),PartiallyDecodedInstructionStruct=type$1({programId:PublicKeyFromString,accounts:array$1(PublicKeyFromString),data:string$1()}),SimulatedTransactionResponseStruct$1=jsonRpcResultAndContext$1(type$1({err:nullable$1(union$2([type$1({}),string$1()])),logs:nullable$1(array$1(string$1())),accounts:optional$1(nullable$1(array$1(nullable$1(type$1({executable:boolean$1(),owner:string$1(),lamports:number$2(),data:array$1(string$1()),rentEpoch:optional$1(number$2())}))))),unitsConsumed:optional$1(number$2()),returnData:optional$1(nullable$1(type$1({programId:string$1(),data:tuple([string$1(),literal$1("base64")])}))),innerInstructions:optional$1(nullable$1(array$1(type$1({index:number$2(),instructions:array$1(union$2([ParsedInstructionStruct,PartiallyDecodedInstructionStruct]))}))))})),BlockProductionResponseStruct=jsonRpcResultAndContext$1(type$1({byIdentity:record$1(string$1(),array$1(number$2())),range:type$1({firstSlot:number$2(),lastSlot:number$2()})}));function createRpcClient(s,e,t,o,a,c){const d=t||fetchImpl;let g;c!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let y;return o&&(y=async(E,S)=>{const A=await new Promise((C,N)=>{try{o(E,S,(O,I)=>C([O,I]))}catch(O){N(O)}});return await d(...A)}),new RpcClient(async(E,S)=>{const A={method:"POST",body:E,agent:g,headers:Object.assign({"Content-Type":"application/json"},e||{},COMMON_HTTP_HEADERS)};try{let C=5,N,O=500;for(;y?N=await y(s,A):N=await d(s,A),!(N.status!==429||a===!0||(C-=1,C===0));)console.error(`Server responded with ${N.status} ${N.statusText}.  Retrying after ${O}ms delay...`),await sleep(O),O*=2;const I=await N.text();N.ok?S(null,I):S(new Error(`${N.status} ${N.statusText}: ${I}`))}catch(C){C instanceof Error&&S(C)}},{})}function createRpcRequest(s){return(e,t)=>new Promise((o,a)=>{s.request(e,t,(c,d)=>{if(c){a(c);return}o(d)})})}function createRpcBatchRequest(s){return e=>new Promise((t,o)=>{e.length===0&&t([]);const a=e.map(c=>s.request(c.methodName,c.args));s.request(a,(c,d)=>{if(c){o(c);return}t(d)})})}const GetInflationGovernorRpcResult=jsonRpcResult$1(GetInflationGovernorResult),GetInflationRateRpcResult=jsonRpcResult$1(GetInflationRateResult),GetRecentPrioritizationFeesRpcResult=jsonRpcResult$1(GetRecentPrioritizationFeesResult),GetEpochInfoRpcResult=jsonRpcResult$1(GetEpochInfoResult),GetEpochScheduleRpcResult=jsonRpcResult$1(GetEpochScheduleResult),GetLeaderScheduleRpcResult=jsonRpcResult$1(GetLeaderScheduleResult),SlotRpcResult=jsonRpcResult$1(number$2()),GetSupplyRpcResult=jsonRpcResultAndContext$1(type$1({total:number$2(),circulating:number$2(),nonCirculating:number$2(),nonCirculatingAccounts:array$1(PublicKeyFromString)})),TokenAmountResult=type$1({amount:string$1(),uiAmount:nullable$1(number$2()),decimals:number$2(),uiAmountString:optional$1(string$1())}),GetTokenLargestAccountsResult=jsonRpcResultAndContext$1(array$1(type$1({address:PublicKeyFromString,amount:string$1(),uiAmount:nullable$1(number$2()),decimals:number$2(),uiAmountString:optional$1(string$1())}))),GetTokenAccountsByOwner=jsonRpcResultAndContext$1(array$1(type$1({pubkey:PublicKeyFromString,account:type$1({executable:boolean$1(),owner:PublicKeyFromString,lamports:number$2(),data:BufferFromRawAccountData,rentEpoch:number$2()})}))),ParsedAccountDataResult=type$1({program:string$1(),parsed:unknown$1(),space:number$2()}),GetParsedTokenAccountsByOwner=jsonRpcResultAndContext$1(array$1(type$1({pubkey:PublicKeyFromString,account:type$1({executable:boolean$1(),owner:PublicKeyFromString,lamports:number$2(),data:ParsedAccountDataResult,rentEpoch:number$2()})}))),GetLargestAccountsRpcResult=jsonRpcResultAndContext$1(array$1(type$1({lamports:number$2(),address:PublicKeyFromString}))),AccountInfoResult=type$1({executable:boolean$1(),owner:PublicKeyFromString,lamports:number$2(),data:BufferFromRawAccountData,rentEpoch:number$2()}),KeyedAccountInfoResult=type$1({pubkey:PublicKeyFromString,account:AccountInfoResult}),ParsedOrRawAccountData=coerce$1(union$2([instance$1(buffer.Buffer),ParsedAccountDataResult]),union$2([RawAccountDataResult,ParsedAccountDataResult]),s=>Array.isArray(s)?create$1(s,BufferFromRawAccountData):s),ParsedAccountInfoResult=type$1({executable:boolean$1(),owner:PublicKeyFromString,lamports:number$2(),data:ParsedOrRawAccountData,rentEpoch:number$2()}),KeyedParsedAccountInfoResult=type$1({pubkey:PublicKeyFromString,account:ParsedAccountInfoResult}),StakeActivationResult=type$1({state:union$2([literal$1("active"),literal$1("inactive"),literal$1("activating"),literal$1("deactivating")]),active:number$2(),inactive:number$2()}),GetConfirmedSignaturesForAddress2RpcResult=jsonRpcResult$1(array$1(type$1({signature:string$1(),slot:number$2(),err:TransactionErrorResult,memo:nullable$1(string$1()),blockTime:optional$1(nullable$1(number$2()))}))),GetSignaturesForAddressRpcResult=jsonRpcResult$1(array$1(type$1({signature:string$1(),slot:number$2(),err:TransactionErrorResult,memo:nullable$1(string$1()),blockTime:optional$1(nullable$1(number$2()))}))),AccountNotificationResult=type$1({subscription:number$2(),result:notificationResultAndContext(AccountInfoResult)}),ProgramAccountInfoResult=type$1({pubkey:PublicKeyFromString,account:AccountInfoResult}),ProgramAccountNotificationResult=type$1({subscription:number$2(),result:notificationResultAndContext(ProgramAccountInfoResult)}),SlotInfoResult=type$1({parent:number$2(),slot:number$2(),root:number$2()}),SlotNotificationResult=type$1({subscription:number$2(),result:SlotInfoResult}),SlotUpdateResult=union$2([type$1({type:union$2([literal$1("firstShredReceived"),literal$1("completed"),literal$1("optimisticConfirmation"),literal$1("root")]),slot:number$2(),timestamp:number$2()}),type$1({type:literal$1("createdBank"),parent:number$2(),slot:number$2(),timestamp:number$2()}),type$1({type:literal$1("frozen"),slot:number$2(),timestamp:number$2(),stats:type$1({numTransactionEntries:number$2(),numSuccessfulTransactions:number$2(),numFailedTransactions:number$2(),maxTransactionsPerEntry:number$2()})}),type$1({type:literal$1("dead"),slot:number$2(),timestamp:number$2(),err:string$1()})]),SlotUpdateNotificationResult=type$1({subscription:number$2(),result:SlotUpdateResult}),SignatureNotificationResult=type$1({subscription:number$2(),result:notificationResultAndContext(union$2([SignatureStatusResult,SignatureReceivedResult]))}),RootNotificationResult=type$1({subscription:number$2(),result:number$2()}),ContactInfoResult=type$1({pubkey:string$1(),gossip:nullable$1(string$1()),tpu:nullable$1(string$1()),rpc:nullable$1(string$1()),version:nullable$1(string$1())}),VoteAccountInfoResult=type$1({votePubkey:string$1(),nodePubkey:string$1(),activatedStake:number$2(),epochVoteAccount:boolean$1(),epochCredits:array$1(tuple([number$2(),number$2(),number$2()])),commission:number$2(),lastVote:number$2(),rootSlot:nullable$1(number$2())}),GetVoteAccounts=jsonRpcResult$1(type$1({current:array$1(VoteAccountInfoResult),delinquent:array$1(VoteAccountInfoResult)})),ConfirmationStatus=union$2([literal$1("processed"),literal$1("confirmed"),literal$1("finalized")]),SignatureStatusResponse=type$1({slot:number$2(),confirmations:nullable$1(number$2()),err:TransactionErrorResult,confirmationStatus:optional$1(ConfirmationStatus)}),GetSignatureStatusesRpcResult=jsonRpcResultAndContext$1(array$1(nullable$1(SignatureStatusResponse))),GetMinimumBalanceForRentExemptionRpcResult=jsonRpcResult$1(number$2()),AddressTableLookupStruct=type$1({accountKey:PublicKeyFromString,writableIndexes:array$1(number$2()),readonlyIndexes:array$1(number$2())}),ConfirmedTransactionResult=type$1({signatures:array$1(string$1()),message:type$1({accountKeys:array$1(string$1()),header:type$1({numRequiredSignatures:number$2(),numReadonlySignedAccounts:number$2(),numReadonlyUnsignedAccounts:number$2()}),instructions:array$1(type$1({accounts:array$1(number$2()),data:string$1(),programIdIndex:number$2()})),recentBlockhash:string$1(),addressTableLookups:optional$1(array$1(AddressTableLookupStruct))})}),AnnotatedAccountKey=type$1({pubkey:PublicKeyFromString,signer:boolean$1(),writable:boolean$1(),source:optional$1(union$2([literal$1("transaction"),literal$1("lookupTable")]))}),ConfirmedTransactionAccountsModeResult=type$1({accountKeys:array$1(AnnotatedAccountKey),signatures:array$1(string$1())}),ParsedInstructionResult=type$1({parsed:unknown$1(),program:string$1(),programId:PublicKeyFromString}),RawInstructionResult=type$1({accounts:array$1(PublicKeyFromString),data:string$1(),programId:PublicKeyFromString}),InstructionResult=union$2([RawInstructionResult,ParsedInstructionResult]),UnknownInstructionResult=union$2([type$1({parsed:unknown$1(),program:string$1(),programId:string$1()}),type$1({accounts:array$1(string$1()),data:string$1(),programId:string$1()})]),ParsedOrRawInstruction=coerce$1(InstructionResult,UnknownInstructionResult,s=>"accounts"in s?create$1(s,RawInstructionResult):create$1(s,ParsedInstructionResult)),ParsedConfirmedTransactionResult=type$1({signatures:array$1(string$1()),message:type$1({accountKeys:array$1(AnnotatedAccountKey),instructions:array$1(ParsedOrRawInstruction),recentBlockhash:string$1(),addressTableLookups:optional$1(nullable$1(array$1(AddressTableLookupStruct)))})}),TokenBalanceResult=type$1({accountIndex:number$2(),mint:string$1(),owner:optional$1(string$1()),programId:optional$1(string$1()),uiTokenAmount:TokenAmountResult}),LoadedAddressesResult=type$1({writable:array$1(PublicKeyFromString),readonly:array$1(PublicKeyFromString)}),ConfirmedTransactionMetaResult=type$1({err:TransactionErrorResult,fee:number$2(),innerInstructions:optional$1(nullable$1(array$1(type$1({index:number$2(),instructions:array$1(type$1({accounts:array$1(number$2()),data:string$1(),programIdIndex:number$2()}))})))),preBalances:array$1(number$2()),postBalances:array$1(number$2()),logMessages:optional$1(nullable$1(array$1(string$1()))),preTokenBalances:optional$1(nullable$1(array$1(TokenBalanceResult))),postTokenBalances:optional$1(nullable$1(array$1(TokenBalanceResult))),loadedAddresses:optional$1(LoadedAddressesResult),computeUnitsConsumed:optional$1(number$2())}),ParsedConfirmedTransactionMetaResult=type$1({err:TransactionErrorResult,fee:number$2(),innerInstructions:optional$1(nullable$1(array$1(type$1({index:number$2(),instructions:array$1(ParsedOrRawInstruction)})))),preBalances:array$1(number$2()),postBalances:array$1(number$2()),logMessages:optional$1(nullable$1(array$1(string$1()))),preTokenBalances:optional$1(nullable$1(array$1(TokenBalanceResult))),postTokenBalances:optional$1(nullable$1(array$1(TokenBalanceResult))),loadedAddresses:optional$1(LoadedAddressesResult),computeUnitsConsumed:optional$1(number$2())}),TransactionVersionStruct=union$2([literal$1(0),literal$1("legacy")]),RewardsResult=type$1({pubkey:string$1(),lamports:number$2(),postBalance:nullable$1(number$2()),rewardType:nullable$1(string$1()),commission:optional$1(nullable$1(number$2()))}),GetBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),transactions:array$1(type$1({transaction:ConfirmedTransactionResult,meta:nullable$1(ConfirmedTransactionMetaResult),version:optional$1(TransactionVersionStruct)})),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2()),blockHeight:nullable$1(number$2())}))),GetNoneModeBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2()),blockHeight:nullable$1(number$2())}))),GetAccountsModeBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),transactions:array$1(type$1({transaction:ConfirmedTransactionAccountsModeResult,meta:nullable$1(ConfirmedTransactionMetaResult),version:optional$1(TransactionVersionStruct)})),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2()),blockHeight:nullable$1(number$2())}))),GetParsedBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),transactions:array$1(type$1({transaction:ParsedConfirmedTransactionResult,meta:nullable$1(ParsedConfirmedTransactionMetaResult),version:optional$1(TransactionVersionStruct)})),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2()),blockHeight:nullable$1(number$2())}))),GetParsedAccountsModeBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),transactions:array$1(type$1({transaction:ConfirmedTransactionAccountsModeResult,meta:nullable$1(ParsedConfirmedTransactionMetaResult),version:optional$1(TransactionVersionStruct)})),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2()),blockHeight:nullable$1(number$2())}))),GetParsedNoneModeBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2()),blockHeight:nullable$1(number$2())}))),GetConfirmedBlockRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),transactions:array$1(type$1({transaction:ConfirmedTransactionResult,meta:nullable$1(ConfirmedTransactionMetaResult)})),rewards:optional$1(array$1(RewardsResult)),blockTime:nullable$1(number$2())}))),GetBlockSignaturesRpcResult=jsonRpcResult$1(nullable$1(type$1({blockhash:string$1(),previousBlockhash:string$1(),parentSlot:number$2(),signatures:array$1(string$1()),blockTime:nullable$1(number$2())}))),GetTransactionRpcResult=jsonRpcResult$1(nullable$1(type$1({slot:number$2(),meta:nullable$1(ConfirmedTransactionMetaResult),blockTime:optional$1(nullable$1(number$2())),transaction:ConfirmedTransactionResult,version:optional$1(TransactionVersionStruct)}))),GetParsedTransactionRpcResult=jsonRpcResult$1(nullable$1(type$1({slot:number$2(),transaction:ParsedConfirmedTransactionResult,meta:nullable$1(ParsedConfirmedTransactionMetaResult),blockTime:optional$1(nullable$1(number$2())),version:optional$1(TransactionVersionStruct)}))),GetLatestBlockhashRpcResult=jsonRpcResultAndContext$1(type$1({blockhash:string$1(),lastValidBlockHeight:number$2()})),IsBlockhashValidRpcResult=jsonRpcResultAndContext$1(boolean$1()),PerfSampleResult=type$1({slot:number$2(),numTransactions:number$2(),numSlots:number$2(),samplePeriodSecs:number$2()}),GetRecentPerformanceSamplesRpcResult=jsonRpcResult$1(array$1(PerfSampleResult)),GetFeeCalculatorRpcResult=jsonRpcResultAndContext$1(nullable$1(type$1({feeCalculator:type$1({lamportsPerSignature:number$2()})}))),RequestAirdropRpcResult=jsonRpcResult$1(string$1()),SendTransactionRpcResult=jsonRpcResult$1(string$1()),LogsResult=type$1({err:TransactionErrorResult,logs:array$1(string$1()),signature:string$1()}),LogsNotificationResult=type$1({result:notificationResultAndContext(LogsResult),subscription:number$2()}),COMMON_HTTP_HEADERS={"solana-client":"js/1.0.0-maintenance"};class Connection{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const _={};return async E=>{const{commitment:S,config:A}=extractCommitmentFromConfig(E),C=this._buildArgs([],S,void 0,A),N=fastStableStringify(C);return _[N]=_[N]??(async()=>{try{const O=await this._rpcRequest("getBlockHeight",C),I=create$1(O,jsonRpcResult$1(number$2()));if("error"in I)throw new SolanaJSONRPCError(I.error,"failed to get block height information");return I.result}finally{delete _[N]}})(),await _[N]}})();let o,a,c,d,g,y;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,o=t.wsEndpoint,a=t.httpHeaders,c=t.fetch,d=t.fetchMiddleware,g=t.disableRetryOnRateLimit,y=t.httpAgent),this._rpcEndpoint=assertEndpointUrl(e),this._rpcWsEndpoint=o||makeWebsocketUrl(e),this._rpcClient=createRpcClient(e,a,c,d,g,y),this._rpcRequest=createRpcRequest(this._rpcClient),this._rpcBatchRequest=createRpcBatchRequest(this._rpcClient),this._rpcWebSocket=new RpcWebSocketClient(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgs([e.toBase58()],o,void 0,a),d=await this._rpcRequest("getBalance",c),g=create$1(d,jsonRpcResultAndContext$1(number$2()));if("error"in g)throw new SolanaJSONRPCError(g.error,`failed to get balance for ${e.toBase58()}`);return g.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(o=>o.value).catch(o=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+o)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),o=create$1(t,jsonRpcResult$1(nullable$1(number$2())));if("error"in o)throw new SolanaJSONRPCError(o.error,`failed to get block time for slot ${e}`);return o.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=create$1(e,jsonRpcResult$1(number$2()));if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=create$1(e,SlotRpcResult);if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const o=await this._rpcRequest("getSupply",[t]),a=create$1(o,GetSupplyRpcResult);if("error"in a)throw new SolanaJSONRPCError(a.error,"failed to get supply");return a.result}async getTokenSupply(e,t){const o=this._buildArgs([e.toBase58()],t),a=await this._rpcRequest("getTokenSupply",o),c=create$1(a,jsonRpcResultAndContext$1(TokenAmountResult));if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get token supply");return c.result}async getTokenAccountBalance(e,t){const o=this._buildArgs([e.toBase58()],t),a=await this._rpcRequest("getTokenAccountBalance",o),c=create$1(a,jsonRpcResultAndContext$1(TokenAmountResult));if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get token account balance");return c.result}async getTokenAccountsByOwner(e,t,o){const{commitment:a,config:c}=extractCommitmentFromConfig(o);let d=[e.toBase58()];"mint"in t?d.push({mint:t.mint.toBase58()}):d.push({programId:t.programId.toBase58()});const g=this._buildArgs(d,a,"base64",c),y=await this._rpcRequest("getTokenAccountsByOwner",g),_=create$1(y,GetTokenAccountsByOwner);if("error"in _)throw new SolanaJSONRPCError(_.error,`failed to get token accounts owned by account ${e.toBase58()}`);return _.result}async getParsedTokenAccountsByOwner(e,t,o){let a=[e.toBase58()];"mint"in t?a.push({mint:t.mint.toBase58()}):a.push({programId:t.programId.toBase58()});const c=this._buildArgs(a,o,"jsonParsed"),d=await this._rpcRequest("getTokenAccountsByOwner",c),g=create$1(d,GetParsedTokenAccountsByOwner);if("error"in g)throw new SolanaJSONRPCError(g.error,`failed to get token accounts owned by account ${e.toBase58()}`);return g.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},o=t.filter||t.commitment?[t]:[],a=await this._rpcRequest("getLargestAccounts",o),c=create$1(a,GetLargestAccountsRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get largest accounts");return c.result}async getTokenLargestAccounts(e,t){const o=this._buildArgs([e.toBase58()],t),a=await this._rpcRequest("getTokenLargestAccounts",o),c=create$1(a,GetTokenLargestAccountsResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get token largest accounts");return c.result}async getAccountInfoAndContext(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgs([e.toBase58()],o,"base64",a),d=await this._rpcRequest("getAccountInfo",c),g=create$1(d,jsonRpcResultAndContext$1(nullable$1(AccountInfoResult)));if("error"in g)throw new SolanaJSONRPCError(g.error,`failed to get info about account ${e.toBase58()}`);return g.result}async getParsedAccountInfo(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgs([e.toBase58()],o,"jsonParsed",a),d=await this._rpcRequest("getAccountInfo",c),g=create$1(d,jsonRpcResultAndContext$1(nullable$1(ParsedAccountInfoResult)));if("error"in g)throw new SolanaJSONRPCError(g.error,`failed to get info about account ${e.toBase58()}`);return g.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(o){throw new Error("failed to get info about account "+e.toBase58()+": "+o)}}async getMultipleParsedAccounts(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=e.map(_=>_.toBase58()),d=this._buildArgs([c],o,"jsonParsed",a),g=await this._rpcRequest("getMultipleAccounts",d),y=create$1(g,jsonRpcResultAndContext$1(array$1(nullable$1(ParsedAccountInfoResult))));if("error"in y)throw new SolanaJSONRPCError(y.error,`failed to get info for accounts ${c}`);return y.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=e.map(_=>_.toBase58()),d=this._buildArgs([c],o,"base64",a),g=await this._rpcRequest("getMultipleAccounts",d),y=create$1(g,jsonRpcResultAndContext$1(array$1(nullable$1(AccountInfoResult))));if("error"in y)throw new SolanaJSONRPCError(y.error,`failed to get info for accounts ${c}`);return y.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,o){const{commitment:a,config:c}=extractCommitmentFromConfig(t),d=this._buildArgs([e.toBase58()],a,void 0,{...c,epoch:o??(c==null?void 0:c.epoch)}),g=await this._rpcRequest("getStakeActivation",d),y=create$1(g,jsonRpcResult$1(StakeActivationResult));if("error"in y)throw new SolanaJSONRPCError(y.error,`failed to get Stake Activation ${e.toBase58()}`);return y.result}async getProgramAccounts(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),{encoding:c,...d}=a||{},g=this._buildArgs([e.toBase58()],o,c||"base64",{...d,...d.filters?{filters:applyDefaultMemcmpEncodingToFilters(d.filters)}:null}),y=await this._rpcRequest("getProgramAccounts",g),_=array$1(KeyedAccountInfoResult),E=d.withContext===!0?create$1(y,jsonRpcResultAndContext$1(_)):create$1(y,jsonRpcResult$1(_));if("error"in E)throw new SolanaJSONRPCError(E.error,`failed to get accounts owned by program ${e.toBase58()}`);return E.result}async getParsedProgramAccounts(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgs([e.toBase58()],o,"jsonParsed",a),d=await this._rpcRequest("getProgramAccounts",c),g=create$1(d,jsonRpcResult$1(array$1(KeyedParsedAccountInfoResult)));if("error"in g)throw new SolanaJSONRPCError(g.error,`failed to get accounts owned by program ${e.toBase58()}`);return g.result}async confirmTransaction(e,t){var c;let o;if(typeof e=="string")o=e;else{const d=e;if((c=d.abortSignal)!=null&&c.aborted)return Promise.reject(d.abortSignal.reason);o=d.signature}let a;try{a=bs58$1.decode(o)}catch{throw new Error("signature must be base58 encoded: "+o)}return assert$1(a.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:o}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,o)=>{e!=null&&(e.aborted?o(e.reason):e.addEventListener("abort",()=>{o(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let o,a,c=!1;const d=new Promise((y,_)=>{try{o=this.onSignature(t,(S,A)=>{o=void 0;const C={context:A,value:S};y({__type:TransactionStatus.PROCESSED,response:C})},e);const E=new Promise(S=>{o==null?S():a=this._onSubscriptionStateChange(o,A=>{A==="subscribed"&&S()})});(async()=>{if(await E,c)return;const S=await this.getSignatureStatus(t);if(c||S==null)return;const{context:A,value:C}=S;if(C!=null)if(C!=null&&C.err)_(C.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(C.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(C.confirmationStatus==="processed"||C.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}c=!0,y({__type:TransactionStatus.PROCESSED,response:{context:A,value:C}})}})()}catch(E){_(E)}});return{abortConfirmation:()=>{a&&(a(),a=void 0),o!=null&&(this.removeSignatureListener(o),o=void 0)},confirmationPromise:d}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:o,signature:a}}){let c=!1;const d=new Promise(S=>{const A=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let C=await A();if(!c){for(;C<=o;)if(await sleep(1e3),c||(C=await A(),c))return;S({__type:TransactionStatus.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:g,confirmationPromise:y}=this.getTransactionConfirmationPromise({commitment:e,signature:a}),_=this.getCancellationPromise(t);let E;try{const S=await Promise.race([_,y,d]);if(S.__type===TransactionStatus.PROCESSED)E=S.response;else throw new TransactionExpiredBlockheightExceededError(a)}finally{c=!0,g()}return E}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:o,nonceAccountPubkey:a,nonceValue:c,signature:d}}){let g=!1;const y=new Promise(C=>{let N=c,O=null;const I=async()=>{try{const{context:P,value:j}=await this.getNonceAndContext(a,{commitment:e,minContextSlot:o});return O=P.slot,j==null?void 0:j.nonce}catch{return N}};(async()=>{if(N=await I(),!g)for(;;){if(c!==N){C({__type:TransactionStatus.NONCE_INVALID,slotInWhichNonceDidAdvance:O});return}if(await sleep(2e3),g||(N=await I(),g))return}})()}),{abortConfirmation:_,confirmationPromise:E}=this.getTransactionConfirmationPromise({commitment:e,signature:d}),S=this.getCancellationPromise(t);let A;try{const C=await Promise.race([S,E,y]);if(C.__type===TransactionStatus.PROCESSED)A=C.response;else{let N;for(;;){const O=await this.getSignatureStatus(d);if(O==null)break;if(O.context.slot<(C.slotInWhichNonceDidAdvance??o)){await sleep(400);continue}N=O;break}if(N!=null&&N.value){const O=e||"finalized",{confirmationStatus:I}=N.value;switch(O){case"processed":case"recent":if(I!=="processed"&&I!=="confirmed"&&I!=="finalized")throw new TransactionExpiredNonceInvalidError(d);break;case"confirmed":case"single":case"singleGossip":if(I!=="confirmed"&&I!=="finalized")throw new TransactionExpiredNonceInvalidError(d);break;case"finalized":case"max":case"root":if(I!=="finalized")throw new TransactionExpiredNonceInvalidError(d);break;default:}A={context:N.context,value:{err:N.value.err}}}else throw new TransactionExpiredNonceInvalidError(d)}}finally{g=!0,_()}return A}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let o;const a=new Promise(y=>{let _=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{_=this._confirmTransactionInitialTimeout||3e4;break}}o=setTimeout(()=>y({__type:TransactionStatus.TIMED_OUT,timeoutMs:_}),_)}),{abortConfirmation:c,confirmationPromise:d}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let g;try{const y=await Promise.race([d,a]);if(y.__type===TransactionStatus.PROCESSED)g=y.response;else throw new TransactionExpiredTimeoutError(t,y.timeoutMs/1e3)}finally{clearTimeout(o),c()}return g}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=create$1(e,jsonRpcResult$1(array$1(ContactInfoResult)));if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),o=await this._rpcRequest("getVoteAccounts",t),a=create$1(o,GetVoteAccounts);if("error"in a)throw new SolanaJSONRPCError(a.error,"failed to get vote accounts");return a.result}async getSlot(e){const{commitment:t,config:o}=extractCommitmentFromConfig(e),a=this._buildArgs([],t,void 0,o),c=await this._rpcRequest("getSlot",a),d=create$1(c,jsonRpcResult$1(number$2()));if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get slot");return d.result}async getSlotLeader(e){const{commitment:t,config:o}=extractCommitmentFromConfig(e),a=this._buildArgs([],t,void 0,o),c=await this._rpcRequest("getSlotLeader",a),d=create$1(c,jsonRpcResult$1(string$1()));if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get slot leader");return d.result}async getSlotLeaders(e,t){const o=[e,t],a=await this._rpcRequest("getSlotLeaders",o),c=create$1(a,jsonRpcResult$1(array$1(PublicKeyFromString)));if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get slot leaders");return c.result}async getSignatureStatus(e,t){const{context:o,value:a}=await this.getSignatureStatuses([e],t);assert$1(a.length===1);const c=a[0];return{context:o,value:c}}async getSignatureStatuses(e,t){const o=[e];t&&o.push(t);const a=await this._rpcRequest("getSignatureStatuses",o),c=create$1(a,GetSignatureStatusesRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get signature status");return c.result}async getTransactionCount(e){const{commitment:t,config:o}=extractCommitmentFromConfig(e),a=this._buildArgs([],t,void 0,o),c=await this._rpcRequest("getTransactionCount",a),d=create$1(c,jsonRpcResult$1(number$2()));if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get transaction count");return d.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),o=await this._rpcRequest("getInflationGovernor",t),a=create$1(o,GetInflationGovernorRpcResult);if("error"in a)throw new SolanaJSONRPCError(a.error,"failed to get inflation");return a.result}async getInflationReward(e,t,o){const{commitment:a,config:c}=extractCommitmentFromConfig(o),d=this._buildArgs([e.map(_=>_.toBase58())],a,void 0,{...c,epoch:t??(c==null?void 0:c.epoch)}),g=await this._rpcRequest("getInflationReward",d),y=create$1(g,GetInflationRewardResult);if("error"in y)throw new SolanaJSONRPCError(y.error,"failed to get inflation reward");return y.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=create$1(e,GetInflationRateRpcResult);if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:o}=extractCommitmentFromConfig(e),a=this._buildArgs([],t,void 0,o),c=await this._rpcRequest("getEpochInfo",a),d=create$1(c,GetEpochInfoRpcResult);if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get epoch info");return d.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=create$1(e,GetEpochScheduleRpcResult);if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get epoch schedule");const o=t.result;return new EpochSchedule(o.slotsPerEpoch,o.leaderScheduleSlotOffset,o.warmup,o.firstNormalEpoch,o.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=create$1(e,GetLeaderScheduleRpcResult);if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const o=this._buildArgs([e],t),a=await this._rpcRequest("getMinimumBalanceForRentExemption",o),c=create$1(a,GetMinimumBalanceForRentExemptionRpcResult);return"error"in c?(console.warn("Unable to fetch minimum balance for rent exemption"),0):c.result}async getRecentBlockhashAndContext(e){const{context:t,value:{blockhash:o}}=await this.getLatestBlockhashAndContext(e);return{context:t,value:{blockhash:o,feeCalculator:{get lamportsPerSignature(){throw new Error("The capability to fetch `lamportsPerSignature` using the `getRecentBlockhash` API is no longer offered by the network. Use the `getFeeForMessage` API to obtain the fee for a given message.")},toJSON(){return{}}}}}}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),o=create$1(t,GetRecentPerformanceSamplesRpcResult);if("error"in o)throw new SolanaJSONRPCError(o.error,"failed to get recent performance samples");return o.result}async getFeeCalculatorForBlockhash(e,t){const o=this._buildArgs([e],t),a=await this._rpcRequest("getFeeCalculatorForBlockhash",o),c=create$1(a,GetFeeCalculatorRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get fee calculator");const{context:d,value:g}=c.result;return{context:d,value:g!==null?g.feeCalculator:null}}async getFeeForMessage(e,t){const o=toBuffer$1(e.serialize()).toString("base64"),a=this._buildArgs([o],t),c=await this._rpcRequest("getFeeForMessage",a),d=create$1(c,jsonRpcResultAndContext$1(nullable$1(number$2())));if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get fee for message");if(d.result===null)throw new Error("invalid blockhash");return d.result}async getRecentPrioritizationFees(e){var d;const t=(d=e==null?void 0:e.lockedWritableAccounts)==null?void 0:d.map(g=>g.toBase58()),o=t!=null&&t.length?[t]:[],a=await this._rpcRequest("getRecentPrioritizationFees",o),c=create$1(a,GetRecentPrioritizationFeesRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get recent prioritization fees");return c.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:o}=extractCommitmentFromConfig(e),a=this._buildArgs([],t,void 0,o),c=await this._rpcRequest("getLatestBlockhash",a),d=create$1(c,GetLatestBlockhashRpcResult);if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get latest blockhash");return d.result}async isBlockhashValid(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgs([e],o,void 0,a),d=await this._rpcRequest("isBlockhashValid",c),g=create$1(d,IsBlockhashValidRpcResult);if("error"in g)throw new SolanaJSONRPCError(g.error,"failed to determine if the blockhash `"+e+"`is valid");return g.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=create$1(e,jsonRpcResult$1(VersionResult));if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=create$1(e,jsonRpcResult$1(string$1()));if("error"in t)throw new SolanaJSONRPCError(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgsAtLeastConfirmed([e],o,void 0,a),d=await this._rpcRequest("getBlock",c);try{switch(a==null?void 0:a.transactionDetails){case"accounts":{const g=create$1(d,GetAccountsModeBlockRpcResult);if("error"in g)throw g.error;return g.result}case"none":{const g=create$1(d,GetNoneModeBlockRpcResult);if("error"in g)throw g.error;return g.result}default:{const g=create$1(d,GetBlockRpcResult);if("error"in g)throw g.error;const{result:y}=g;return y?{...y,transactions:y.transactions.map(({transaction:_,meta:E,version:S})=>({meta:E,transaction:{..._,message:versionedMessageFromResponse(S,_.message)},version:S}))}:null}}}catch(g){throw new SolanaJSONRPCError(g,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgsAtLeastConfirmed([e],o,"jsonParsed",a),d=await this._rpcRequest("getBlock",c);try{switch(a==null?void 0:a.transactionDetails){case"accounts":{const g=create$1(d,GetParsedAccountsModeBlockRpcResult);if("error"in g)throw g.error;return g.result}case"none":{const g=create$1(d,GetParsedNoneModeBlockRpcResult);if("error"in g)throw g.error;return g.result}default:{const g=create$1(d,GetParsedBlockRpcResult);if("error"in g)throw g.error;return g.result}}}catch(g){throw new SolanaJSONRPCError(g,"failed to get block")}}async getBlockProduction(e){let t,o;if(typeof e=="string")o=e;else if(e){const{commitment:g,...y}=e;o=g,t=y}const a=this._buildArgs([],o,"base64",t),c=await this._rpcRequest("getBlockProduction",a),d=create$1(c,BlockProductionResponseStruct);if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get block production information");return d.result}async getTransaction(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgsAtLeastConfirmed([e],o,void 0,a),d=await this._rpcRequest("getTransaction",c),g=create$1(d,GetTransactionRpcResult);if("error"in g)throw new SolanaJSONRPCError(g.error,"failed to get transaction");const y=g.result;return y&&{...y,transaction:{...y.transaction,message:versionedMessageFromResponse(y.version,y.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=this._buildArgsAtLeastConfirmed([e],o,"jsonParsed",a),d=await this._rpcRequest("getTransaction",c),g=create$1(d,GetParsedTransactionRpcResult);if("error"in g)throw new SolanaJSONRPCError(g.error,"failed to get transaction");return g.result}async getParsedTransactions(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=e.map(y=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([y],o,"jsonParsed",a)}));return(await this._rpcBatchRequest(c)).map(y=>{const _=create$1(y,GetParsedTransactionRpcResult);if("error"in _)throw new SolanaJSONRPCError(_.error,"failed to get transactions");return _.result})}async getTransactions(e,t){const{commitment:o,config:a}=extractCommitmentFromConfig(t),c=e.map(y=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([y],o,void 0,a)}));return(await this._rpcBatchRequest(c)).map(y=>{const _=create$1(y,GetTransactionRpcResult);if("error"in _)throw new SolanaJSONRPCError(_.error,"failed to get transactions");const E=_.result;return E&&{...E,transaction:{...E.transaction,message:versionedMessageFromResponse(E.version,E.transaction.message)}}})}async getConfirmedBlock(e,t){const o=this._buildArgsAtLeastConfirmed([e],t),a=await this._rpcRequest("getBlock",o),c=create$1(a,GetConfirmedBlockRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get confirmed block");const d=c.result;if(!d)throw new Error("Confirmed block "+e+" not found");const g={...d,transactions:d.transactions.map(({transaction:y,meta:_})=>{const E=new Message(y.message);return{meta:_,transaction:{...y,message:E}}})};return{...g,transactions:g.transactions.map(({transaction:y,meta:_})=>({meta:_,transaction:Transaction.populate(y.message,y.signatures)}))}}async getBlocks(e,t,o){const a=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],o),c=await this._rpcRequest("getBlocks",a),d=create$1(c,jsonRpcResult$1(array$1(number$2())));if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get blocks");return d.result}async getBlockSignatures(e,t){const o=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),a=await this._rpcRequest("getBlock",o),c=create$1(a,GetBlockSignaturesRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get block");const d=c.result;if(!d)throw new Error("Block "+e+" not found");return d}async getConfirmedBlockSignatures(e,t){const o=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),a=await this._rpcRequest("getBlock",o),c=create$1(a,GetBlockSignaturesRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get confirmed block");const d=c.result;if(!d)throw new Error("Confirmed block "+e+" not found");return d}async getConfirmedTransaction(e,t){const o=this._buildArgsAtLeastConfirmed([e],t),a=await this._rpcRequest("getTransaction",o),c=create$1(a,GetTransactionRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get transaction");const d=c.result;if(!d)return d;const g=new Message(d.transaction.message),y=d.transaction.signatures;return{...d,transaction:Transaction.populate(g,y)}}async getParsedConfirmedTransaction(e,t){const o=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),a=await this._rpcRequest("getTransaction",o),c=create$1(a,GetParsedTransactionRpcResult);if("error"in c)throw new SolanaJSONRPCError(c.error,"failed to get confirmed transaction");return c.result}async getParsedConfirmedTransactions(e,t){const o=e.map(d=>({methodName:"getTransaction",args:this._buildArgsAtLeastConfirmed([d],t,"jsonParsed")}));return(await this._rpcBatchRequest(o)).map(d=>{const g=create$1(d,GetParsedTransactionRpcResult);if("error"in g)throw new SolanaJSONRPCError(g.error,"failed to get confirmed transactions");return g.result})}async getConfirmedSignaturesForAddress(e,t,o){let a={},c=await this.getFirstAvailableBlock();for(;!("until"in a)&&(t--,!(t<=0||t<c));)try{const y=await this.getConfirmedBlockSignatures(t,"finalized");y.signatures.length>0&&(a.until=y.signatures[y.signatures.length-1].toString())}catch(y){if(y instanceof Error&&y.message.includes("skipped"))continue;throw y}let d=await this.getSlot("finalized");for(;!("before"in a)&&(o++,!(o>d));)try{const y=await this.getConfirmedBlockSignatures(o);y.signatures.length>0&&(a.before=y.signatures[y.signatures.length-1].toString())}catch(y){if(y instanceof Error&&y.message.includes("skipped"))continue;throw y}return(await this.getConfirmedSignaturesForAddress2(e,a)).map(y=>y.signature)}async getConfirmedSignaturesForAddress2(e,t,o){const a=this._buildArgsAtLeastConfirmed([e.toBase58()],o,void 0,t),c=await this._rpcRequest("getConfirmedSignaturesForAddress2",a),d=create$1(c,GetConfirmedSignaturesForAddress2RpcResult);if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get confirmed signatures for address");return d.result}async getSignaturesForAddress(e,t,o){const a=this._buildArgsAtLeastConfirmed([e.toBase58()],o,void 0,t),c=await this._rpcRequest("getSignaturesForAddress",a),d=create$1(c,GetSignaturesForAddressRpcResult);if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get signatures for address");return d.result}async getAddressLookupTable(e,t){const{context:o,value:a}=await this.getAccountInfoAndContext(e,t);let c=null;return a!==null&&(c=new AddressLookupTableAccount({key:e,state:AddressLookupTableAccount.deserialize(a.data)})),{context:o,value:c}}async getNonceAndContext(e,t){const{context:o,value:a}=await this.getAccountInfoAndContext(e,t);let c=null;return a!==null&&(c=NonceAccount.fromAccountData(a.data)),{context:o,value:c}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(o=>o.value).catch(o=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+o)})}async requestAirdrop(e,t){const o=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),a=create$1(o,RequestAirdropRpcResult);if("error"in a)throw new SolanaJSONRPCError(a.error,`airdrop to ${e.toBase58()} failed`);return a.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await sleep(100);const o=Date.now()-this._blockhashInfo.lastFetch>=BLOCKHASH_CACHE_TIMEOUT_MS;if(this._blockhashInfo.latestBlockhash!==null&&!o)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,o=t?t.blockhash:null;for(let a=0;a<50;a++){const c=await this.getLatestBlockhash("finalized");if(o!==c.blockhash)return this._blockhashInfo={latestBlockhash:c,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},c;await sleep(MS_PER_SLOT/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:o}=extractCommitmentFromConfig(e),a=this._buildArgs([],t,"base64",o),c=await this._rpcRequest("getStakeMinimumDelegation",a),d=create$1(c,jsonRpcResultAndContext$1(number$2()));if("error"in d)throw new SolanaJSONRPCError(d.error,"failed to get stake minimum delegation");return d.result}async simulateTransaction(e,t,o){if("message"in e){const O=e.serialize(),I=buffer.Buffer.from(O).toString("base64");if(Array.isArray(t)||o!==void 0)throw new Error("Invalid arguments");const P=t||{};P.encoding="base64","commitment"in P||(P.commitment=this.commitment),t&&typeof t=="object"&&"innerInstructions"in t&&(P.innerInstructions=t.innerInstructions);const j=[I,P],B=await this._rpcRequest("simulateTransaction",j),H=create$1(B,SimulatedTransactionResponseStruct$1);if("error"in H)throw new Error("failed to simulate transaction: "+H.error.message);return H.result}let a;if(e instanceof Transaction){let N=e;a=new Transaction,a.feePayer=N.feePayer,a.instructions=e.instructions,a.nonceInfo=N.nonceInfo,a.signatures=N.signatures}else a=Transaction.populate(e),a._message=a._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const c=t;if(a.nonceInfo&&c)a.sign(...c);else{let N=this._disableBlockhashCaching;for(;;){const O=await this._blockhashWithExpiryBlockHeight(N);if(a.lastValidBlockHeight=O.lastValidBlockHeight,a.recentBlockhash=O.blockhash,!c)break;if(a.sign(...c),!a.signature)throw new Error("!signature");const I=a.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(I)&&!this._blockhashInfo.transactionSignatures.includes(I)){this._blockhashInfo.simulatedSignatures.push(I);break}else N=!0}}const d=a._compile(),g=d.serialize(),_=a._serialize(g).toString("base64"),E={encoding:"base64",commitment:this.commitment};if(o){const N=(Array.isArray(o)?o:d.nonProgramIds()).map(O=>O.toBase58());E.accounts={encoding:"base64",addresses:N}}c&&(E.sigVerify=!0),t&&typeof t=="object"&&"innerInstructions"in t&&(E.innerInstructions=t.innerInstructions);const S=[_,E],A=await this._rpcRequest("simulateTransaction",S),C=create$1(A,SimulatedTransactionResponseStruct$1);if("error"in C){let N;if("data"in C.error&&(N=C.error.data.logs,N&&Array.isArray(N))){const O=`
    `,I=O+N.join(O);console.error(C.error.message,I)}throw new SendTransactionError({action:"simulate",signature:"",transactionMessage:C.error.message,logs:N})}return C.result}async sendTransaction(e,t,o){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const d=e.serialize();return await this.sendRawTransaction(d,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const a=t;if(e.nonceInfo)e.sign(...a);else{let d=this._disableBlockhashCaching;for(;;){const g=await this._blockhashWithExpiryBlockHeight(d);if(e.lastValidBlockHeight=g.lastValidBlockHeight,e.recentBlockhash=g.blockhash,e.sign(...a),!e.signature)throw new Error("!signature");const y=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(y))d=!0;else{this._blockhashInfo.transactionSignatures.push(y);break}}}const c=e.serialize();return await this.sendRawTransaction(c,o)}async sendRawTransaction(e,t){const o=toBuffer$1(e).toString("base64");return await this.sendEncodedTransaction(o,t)}async sendEncodedTransaction(e,t){const o={encoding:"base64"},a=t&&t.skipPreflight,c=a===!0?"processed":t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(o.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(o.minContextSlot=t.minContextSlot),a&&(o.skipPreflight=a),c&&(o.preflightCommitment=c);const d=[e,o],g=await this._rpcRequest("sendTransaction",d),y=create$1(g,SendTransactionRpcResult);if("error"in y){let _;throw"data"in y.error&&(_=y.error.data.logs),new SendTransactionError({action:a?"send":"simulate",signature:"",transactionMessage:y.error.message,logs:_})}return y.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,o])=>{this._setSubscription(t,{...o,state:"pending"})})}_setSubscription(e,t){var a;const o=(a=this._subscriptionsByHash[e])==null?void 0:a.state;if(this._subscriptionsByHash[e]=t,o!==t.state){const c=this._subscriptionStateChangeCallbacksByHash[e];c&&c.forEach(d=>{try{d(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){var c;const o=this._subscriptionHashByClientSubscriptionId[e];if(o==null)return()=>{};const a=(c=this._subscriptionStateChangeCallbacksByHash)[o]||(c[o]=new Set);return a.add(t),()=>{a.delete(t),a.size===0&&delete this._subscriptionStateChangeCallbacksByHash[o]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(o){o instanceof Error&&console.log(`Error when closing socket connection: ${o.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async o=>{const a=this._subscriptionsByHash[o];if(a!==void 0)switch(a.state){case"pending":case"unsubscribed":if(a.callbacks.size===0){delete this._subscriptionsByHash[o],a.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[a.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:c,method:d}=a;try{this._setSubscription(o,{...a,state:"subscribing"});const g=await this._rpcWebSocket.call(d,c);this._setSubscription(o,{...a,serverSubscriptionId:g,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[g]=a.callbacks,await this._updateSubscriptions()}catch(g){if(console.error(`Received ${g instanceof Error?"":"JSON-RPC "}error calling \`${d}\``,{args:c,error:g}),!t())return;this._setSubscription(o,{...a,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":a.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:c,unsubscribeMethod:d}=a;if(this._subscriptionsAutoDisposedByRpc.has(c))this._subscriptionsAutoDisposedByRpc.delete(c);else{this._setSubscription(o,{...a,state:"unsubscribing"}),this._setSubscription(o,{...a,state:"unsubscribing"});try{await this._rpcWebSocket.call(d,[c])}catch(g){if(g instanceof Error&&console.error(`${d} error:`,g.message),!t())return;this._setSubscription(o,{...a,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(o,{...a,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const o=this._subscriptionCallbacksByServerSubscriptionId[e];o!==void 0&&o.forEach(a=>{try{a(...t)}catch(c){console.error(c)}})}_wsOnAccountNotification(e){const{result:t,subscription:o}=create$1(e,AccountNotificationResult);this._handleServerNotification(o,[t.value,t.context])}_makeSubscription(e,t){const o=this._nextClientSubscriptionId++,a=fastStableStringify([e.method,t]),c=this._subscriptionsByHash[a];return c===void 0?this._subscriptionsByHash[a]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:c.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[o]=a,this._subscriptionDisposeFunctionsByClientSubscriptionId[o]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[o],delete this._subscriptionHashByClientSubscriptionId[o];const d=this._subscriptionsByHash[a];assert$1(d!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${o}`),d.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),o}onAccountChange(e,t,o){const{commitment:a,config:c}=extractCommitmentFromConfig(o),d=this._buildArgs([e.toBase58()],a||this._commitment||"finalized","base64",c);return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},d)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:o}=create$1(e,ProgramAccountNotificationResult);this._handleServerNotification(o,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,o,a){const{commitment:c,config:d}=extractCommitmentFromConfig(o),g=this._buildArgs([e.toBase58()],c||this._commitment||"finalized","base64",d||(a?{filters:applyDefaultMemcmpEncodingToFilters(a)}:void 0));return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},g)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,o){const a=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],o||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},a)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:o}=create$1(e,LogsNotificationResult);this._handleServerNotification(o,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:o}=create$1(e,SlotNotificationResult);this._handleServerNotification(o,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:o}=create$1(e,SlotUpdateNotificationResult);this._handleServerNotification(o,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const o=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];o?await o():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,o,a){const c=t||this._commitment;if(c||o||a){let d={};o&&(d.encoding=o),c&&(d.commitment=c),a&&(d=Object.assign(d,a)),e.push(d)}return e}_buildArgsAtLeastConfirmed(e,t,o,a){const c=t||this._commitment;if(c&&!["confirmed","finalized"].includes(c))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,o,a)}_wsOnSignatureNotification(e){const{result:t,subscription:o}=create$1(e,SignatureNotificationResult);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(o),this._handleServerNotification(o,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,o){const a=this._buildArgs([e],o||this._commitment||"finalized"),c=this._makeSubscription({callback:(d,g)=>{if(d.type==="status"){t(d.result,g);try{this.removeSignatureListener(c)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},a);return c}onSignatureWithOptions(e,t,o){const{commitment:a,...c}={...o,commitment:o&&o.commitment||this._commitment||"finalized"},d=this._buildArgs([e],a,void 0,c),g=this._makeSubscription({callback:(y,_)=>{t(y,_);try{this.removeSignatureListener(g)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},d);return g}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:o}=create$1(e,RootNotificationResult);this._handleServerNotification(o,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Keypair{constructor(e){this._keypair=void 0,this._keypair=e??generateKeypair()}static generate(){return new Keypair(generateKeypair())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const o=e.slice(32,64);if(!t||!t.skipValidation){const a=e.slice(0,32),c=getPublicKey(a);for(let d=0;d<32;d++)if(o[d]!==c[d])throw new Error("provided secretKey is invalid")}return new Keypair({publicKey:o,secretKey:e})}static fromSeed(e){const t=getPublicKey(e),o=new Uint8Array(64);return o.set(e),o.set(t,32),new Keypair({publicKey:t,secretKey:o})}get publicKey(){return new PublicKey(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const LOOKUP_TABLE_INSTRUCTION_LAYOUTS=Object.freeze({CreateLookupTable:{index:0,layout:struct$1([u32$1("instruction"),u64$1("recentSlot"),u8$1("bumpSeed")])},FreezeLookupTable:{index:1,layout:struct$1([u32$1("instruction")])},ExtendLookupTable:{index:2,layout:struct$1([u32$1("instruction"),u64$1(),seq(publicKey$3(),offset$1(u32$1(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:struct$1([u32$1("instruction")])},CloseLookupTable:{index:4,layout:struct$1([u32$1("instruction")])}});class AddressLookupTableInstruction{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const o=u32$1("instruction").decode(e.data);let a;for(const[c,d]of Object.entries(LOOKUP_TABLE_INSTRUCTION_LAYOUTS))if(d.index==o){a=c;break}if(!a)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return a}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=decodeData$1(LOOKUP_TABLE_INSTRUCTION_LAYOUTS.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=decodeData$1(LOOKUP_TABLE_INSTRUCTION_LAYOUTS.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(o=>new PublicKey(o))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(AddressLookupTableProgram.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class AddressLookupTableProgram{constructor(){}static createLookupTable(e){const[t,o]=PublicKey.findProgramAddressSync([e.authority.toBuffer(),getU64Encoder().encode(e.recentSlot)],this.programId),a=LOOKUP_TABLE_INSTRUCTION_LAYOUTS.CreateLookupTable,c=encodeData(a,{recentSlot:BigInt(e.recentSlot),bumpSeed:o}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:SystemProgram.programId,isSigner:!1,isWritable:!1}];return[new TransactionInstruction({programId:this.programId,keys:d,data:c}),t]}static freezeLookupTable(e){const t=LOOKUP_TABLE_INSTRUCTION_LAYOUTS.FreezeLookupTable,o=encodeData(t),a=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new TransactionInstruction({programId:this.programId,keys:a,data:o})}static extendLookupTable(e){const t=LOOKUP_TABLE_INSTRUCTION_LAYOUTS.ExtendLookupTable,o=encodeData(t,{addresses:e.addresses.map(c=>c.toBytes())}),a=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&a.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:SystemProgram.programId,isSigner:!1,isWritable:!1}),new TransactionInstruction({programId:this.programId,keys:a,data:o})}static deactivateLookupTable(e){const t=LOOKUP_TABLE_INSTRUCTION_LAYOUTS.DeactivateLookupTable,o=encodeData(t),a=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new TransactionInstruction({programId:this.programId,keys:a,data:o})}static closeLookupTable(e){const t=LOOKUP_TABLE_INSTRUCTION_LAYOUTS.CloseLookupTable,o=encodeData(t),a=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new TransactionInstruction({programId:this.programId,keys:a,data:o})}}AddressLookupTableProgram.programId=new PublicKey("AddressLookupTab1e1111111111111111111111111");class ComputeBudgetInstruction{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const o=u8$1("instruction").decode(e.data);let a;for(const[c,d]of Object.entries(COMPUTE_BUDGET_INSTRUCTION_LAYOUTS))if(d.index==o){a=c;break}if(!a)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return a}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:o}=decodeData$1(COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.RequestUnits,e.data);return{units:t,additionalFee:o}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=decodeData$1(COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=decodeData$1(COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=decodeData$1(COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(ComputeBudgetProgram.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const COMPUTE_BUDGET_INSTRUCTION_LAYOUTS=Object.freeze({RequestUnits:{index:0,layout:struct$1([u8$1("instruction"),u32$1("units"),u32$1("additionalFee")])},RequestHeapFrame:{index:1,layout:struct$1([u8$1("instruction"),u32$1("bytes")])},SetComputeUnitLimit:{index:2,layout:struct$1([u8$1("instruction"),u32$1("units")])},SetComputeUnitPrice:{index:3,layout:struct$1([u8$1("instruction"),u64$1("microLamports")])}});class ComputeBudgetProgram{constructor(){}static requestUnits(e){const t=COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.RequestUnits,o=encodeData(t,e);return new TransactionInstruction({keys:[],programId:this.programId,data:o})}static requestHeapFrame(e){const t=COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.RequestHeapFrame,o=encodeData(t,e);return new TransactionInstruction({keys:[],programId:this.programId,data:o})}static setComputeUnitLimit(e){const t=COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.SetComputeUnitLimit,o=encodeData(t,e);return new TransactionInstruction({keys:[],programId:this.programId,data:o})}static setComputeUnitPrice(e){const t=COMPUTE_BUDGET_INSTRUCTION_LAYOUTS.SetComputeUnitPrice,o=encodeData(t,{microLamports:BigInt(e.microLamports)});return new TransactionInstruction({keys:[],programId:this.programId,data:o})}}ComputeBudgetProgram.programId=new PublicKey("ComputeBudget111111111111111111111111111111");const PRIVATE_KEY_BYTES$1=64,PUBLIC_KEY_BYTES$1=32,SIGNATURE_BYTES=64,ED25519_INSTRUCTION_LAYOUT=struct$1([u8$1("numSignatures"),u8$1("padding"),u16("signatureOffset"),u16("signatureInstructionIndex"),u16("publicKeyOffset"),u16("publicKeyInstructionIndex"),u16("messageDataOffset"),u16("messageDataSize"),u16("messageInstructionIndex")]);class Ed25519Program{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:o,signature:a,instructionIndex:c}=e;assert$1(t.length===PUBLIC_KEY_BYTES$1,`Public Key must be ${PUBLIC_KEY_BYTES$1} bytes but received ${t.length} bytes`),assert$1(a.length===SIGNATURE_BYTES,`Signature must be ${SIGNATURE_BYTES} bytes but received ${a.length} bytes`);const d=ED25519_INSTRUCTION_LAYOUT.span,g=d+t.length,y=g+a.length,_=1,E=buffer.Buffer.alloc(y+o.length),S=c??65535;return ED25519_INSTRUCTION_LAYOUT.encode({numSignatures:_,padding:0,signatureOffset:g,signatureInstructionIndex:S,publicKeyOffset:d,publicKeyInstructionIndex:S,messageDataOffset:y,messageDataSize:o.length,messageInstructionIndex:S},E),E.fill(t,d),E.fill(a,g),E.fill(o,y),new TransactionInstruction({keys:[],programId:Ed25519Program.programId,data:E})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:o,instructionIndex:a}=e;assert$1(t.length===PRIVATE_KEY_BYTES$1,`Private key must be ${PRIVATE_KEY_BYTES$1} bytes but received ${t.length} bytes`);try{const c=Keypair.fromSecretKey(t),d=c.publicKey.toBytes(),g=sign(o,c.secretKey);return this.createInstructionWithPublicKey({publicKey:d,message:o,signature:g,instructionIndex:a})}catch(c){throw new Error(`Error creating instruction; ${c}`)}}}Ed25519Program.programId=new PublicKey("Ed25519SigVerify111111111111111111111111111");const ecdsaSign=(s,e)=>{const t=secp256k1.sign(s,e);return[t.toCompactRawBytes(),t.recovery]};secp256k1.utils.isValidPrivateKey;const publicKeyCreate=secp256k1.getPublicKey,PRIVATE_KEY_BYTES=32,ETHEREUM_ADDRESS_BYTES=20,PUBLIC_KEY_BYTES=64,SIGNATURE_OFFSETS_SERIALIZED_SIZE=11,SECP256K1_INSTRUCTION_LAYOUT=struct$1([u8$1("numSignatures"),u16("signatureOffset"),u8$1("signatureInstructionIndex"),u16("ethAddressOffset"),u8$1("ethAddressInstructionIndex"),u16("messageDataOffset"),u16("messageDataSize"),u8$1("messageInstructionIndex"),blob$1(20,"ethAddress"),blob$1(64,"signature"),u8$1("recoveryId")]);class Secp256k1Program{constructor(){}static publicKeyToEthAddress(e){assert$1(e.length===PUBLIC_KEY_BYTES,`Public key must be ${PUBLIC_KEY_BYTES} bytes but received ${e.length} bytes`);try{return buffer.Buffer.from(keccak_256(toBuffer$1(e))).slice(-ETHEREUM_ADDRESS_BYTES)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:o,signature:a,recoveryId:c,instructionIndex:d}=e;return Secp256k1Program.createInstructionWithEthAddress({ethAddress:Secp256k1Program.publicKeyToEthAddress(t),message:o,signature:a,recoveryId:c,instructionIndex:d})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:o,signature:a,recoveryId:c,instructionIndex:d=0}=e;let g;typeof t=="string"?t.startsWith("0x")?g=buffer.Buffer.from(t.substr(2),"hex"):g=buffer.Buffer.from(t,"hex"):g=t,assert$1(g.length===ETHEREUM_ADDRESS_BYTES,`Address must be ${ETHEREUM_ADDRESS_BYTES} bytes but received ${g.length} bytes`);const y=1+SIGNATURE_OFFSETS_SERIALIZED_SIZE,_=y,E=y+g.length,S=E+a.length+1,A=1,C=buffer.Buffer.alloc(SECP256K1_INSTRUCTION_LAYOUT.span+o.length);return SECP256K1_INSTRUCTION_LAYOUT.encode({numSignatures:A,signatureOffset:E,signatureInstructionIndex:d,ethAddressOffset:_,ethAddressInstructionIndex:d,messageDataOffset:S,messageDataSize:o.length,messageInstructionIndex:d,signature:toBuffer$1(a),ethAddress:toBuffer$1(g),recoveryId:c},C),C.fill(toBuffer$1(o),SECP256K1_INSTRUCTION_LAYOUT.span),new TransactionInstruction({keys:[],programId:Secp256k1Program.programId,data:C})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:o,instructionIndex:a}=e;assert$1(t.length===PRIVATE_KEY_BYTES,`Private key must be ${PRIVATE_KEY_BYTES} bytes but received ${t.length} bytes`);try{const c=toBuffer$1(t),d=publicKeyCreate(c,!1).slice(1),g=buffer.Buffer.from(keccak_256(toBuffer$1(o))),[y,_]=ecdsaSign(g,c);return this.createInstructionWithPublicKey({publicKey:d,message:o,signature:y,recoveryId:_,instructionIndex:a})}catch(c){throw new Error(`Error creating instruction; ${c}`)}}}Secp256k1Program.programId=new PublicKey("KeccakSecp256k11111111111111111111111111111");var _Lockup;const STAKE_CONFIG_ID=new PublicKey("StakeConfig11111111111111111111111111111111");class Authorized{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class Lockup{constructor(e,t,o){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=o}}_Lockup=Lockup;Lockup.default=new _Lockup(0,0,PublicKey.default);class StakeInstruction{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const o=u32$1("instruction").decode(e.data);let a;for(const[c,d]of Object.entries(STAKE_INSTRUCTION_LAYOUTS))if(d.index==o){a=c;break}if(!a)throw new Error("Instruction type incorrect; not a StakeInstruction");return a}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:o}=decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Authorized(new PublicKey(t.staker),new PublicKey(t.withdrawer)),lockup:new Lockup(o.unixTimestamp,o.epoch,new PublicKey(o.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:o}=decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Authorize,e.data),a={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new PublicKey(t),stakeAuthorizationType:{index:o}};return e.keys.length>3&&(a.custodianPubkey=e.keys[3].pubkey),a}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:o,authoritySeed:a,authorityOwner:c}=decodeData$1(STAKE_INSTRUCTION_LAYOUTS.AuthorizeWithSeed,e.data),d={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:a,authorityOwner:new PublicKey(c),newAuthorizedPubkey:new PublicKey(t),stakeAuthorizationType:{index:o}};return e.keys.length>3&&(d.custodianPubkey=e.keys[3].pubkey),d}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Withdraw,e.data),o={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(o.custodianPubkey=e.keys[5].pubkey),o}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),decodeData$1(STAKE_INSTRUCTION_LAYOUTS.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(StakeProgram.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const STAKE_INSTRUCTION_LAYOUTS=Object.freeze({Initialize:{index:0,layout:struct$1([u32$1("instruction"),authorized(),lockup()])},Authorize:{index:1,layout:struct$1([u32$1("instruction"),publicKey$3("newAuthorized"),u32$1("stakeAuthorizationType")])},Delegate:{index:2,layout:struct$1([u32$1("instruction")])},Split:{index:3,layout:struct$1([u32$1("instruction"),ns64$1("lamports")])},Withdraw:{index:4,layout:struct$1([u32$1("instruction"),ns64$1("lamports")])},Deactivate:{index:5,layout:struct$1([u32$1("instruction")])},Merge:{index:7,layout:struct$1([u32$1("instruction")])},AuthorizeWithSeed:{index:8,layout:struct$1([u32$1("instruction"),publicKey$3("newAuthorized"),u32$1("stakeAuthorizationType"),rustString("authoritySeed"),publicKey$3("authorityOwner")])}}),StakeAuthorizationLayout=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class StakeProgram{constructor(){}static initialize(e){const{stakePubkey:t,authorized:o,lockup:a}=e,c=a||Lockup.default,d=STAKE_INSTRUCTION_LAYOUTS.Initialize,g=encodeData(d,{authorized:{staker:toBuffer$1(o.staker.toBuffer()),withdrawer:toBuffer$1(o.withdrawer.toBuffer())},lockup:{unixTimestamp:c.unixTimestamp,epoch:c.epoch,custodian:toBuffer$1(c.custodian.toBuffer())}}),y={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:this.programId,data:g};return new TransactionInstruction(y)}static createAccountWithSeed(e){const t=new Transaction;t.add(SystemProgram.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:o,authorized:a,lockup:c}=e;return t.add(this.initialize({stakePubkey:o,authorized:a,lockup:c}))}static createAccount(e){const t=new Transaction;t.add(SystemProgram.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:o,authorized:a,lockup:c}=e;return t.add(this.initialize({stakePubkey:o,authorized:a,lockup:c}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:o,votePubkey:a}=e,c=STAKE_INSTRUCTION_LAYOUTS.Delegate,d=encodeData(c);return new Transaction().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:STAKE_CONFIG_ID,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1}],programId:this.programId,data:d})}static authorize(e){const{stakePubkey:t,authorizedPubkey:o,newAuthorizedPubkey:a,stakeAuthorizationType:c,custodianPubkey:d}=e,g=STAKE_INSTRUCTION_LAYOUTS.Authorize,y=encodeData(g,{newAuthorized:toBuffer$1(a.toBuffer()),stakeAuthorizationType:c.index}),_=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1}];return d&&_.push({pubkey:d,isSigner:!0,isWritable:!1}),new Transaction().add({keys:_,programId:this.programId,data:y})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:o,authoritySeed:a,authorityOwner:c,newAuthorizedPubkey:d,stakeAuthorizationType:g,custodianPubkey:y}=e,_=STAKE_INSTRUCTION_LAYOUTS.AuthorizeWithSeed,E=encodeData(_,{newAuthorized:toBuffer$1(d.toBuffer()),stakeAuthorizationType:g.index,authoritySeed:a,authorityOwner:toBuffer$1(c.toBuffer())}),S=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1}];return y&&S.push({pubkey:y,isSigner:!0,isWritable:!1}),new Transaction().add({keys:S,programId:this.programId,data:E})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:o,splitStakePubkey:a,lamports:c}=e,d=STAKE_INSTRUCTION_LAYOUTS.Split,g=encodeData(d,{lamports:c});return new TransactionInstruction({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1}],programId:this.programId,data:g})}static split(e,t){const o=new Transaction;return o.add(SystemProgram.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:t,space:this.space,programId:this.programId})),o.add(this.splitInstruction(e))}static splitWithSeed(e,t){const{stakePubkey:o,authorizedPubkey:a,splitStakePubkey:c,basePubkey:d,seed:g,lamports:y}=e,_=new Transaction;return _.add(SystemProgram.allocate({accountPubkey:c,basePubkey:d,seed:g,space:this.space,programId:this.programId})),t&&t>0&&_.add(SystemProgram.transfer({fromPubkey:e.authorizedPubkey,toPubkey:c,lamports:t})),_.add(this.splitInstruction({stakePubkey:o,authorizedPubkey:a,splitStakePubkey:c,lamports:y}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:o,authorizedPubkey:a}=e,c=STAKE_INSTRUCTION_LAYOUTS.Merge,d=encodeData(c);return new Transaction().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1}],programId:this.programId,data:d})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:o,toPubkey:a,lamports:c,custodianPubkey:d}=e,g=STAKE_INSTRUCTION_LAYOUTS.Withdraw,y=encodeData(g,{lamports:c}),_=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_STAKE_HISTORY_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1}];return d&&_.push({pubkey:d,isSigner:!0,isWritable:!1}),new Transaction().add({keys:_,programId:this.programId,data:y})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:o}=e,a=STAKE_INSTRUCTION_LAYOUTS.Deactivate,c=encodeData(a);return new Transaction().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1}],programId:this.programId,data:c})}}StakeProgram.programId=new PublicKey("Stake11111111111111111111111111111111111111");StakeProgram.space=200;class VoteInit{constructor(e,t,o,a){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=o,this.commission=a}}class VoteInstruction{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const o=u32$1("instruction").decode(e.data);let a;for(const[c,d]of Object.entries(VOTE_INSTRUCTION_LAYOUTS))if(d.index==o){a=c;break}if(!a)throw new Error("Instruction type incorrect; not a VoteInstruction");return a}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=decodeData$1(VOTE_INSTRUCTION_LAYOUTS.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new VoteInit(new PublicKey(t.nodePubkey),new PublicKey(t.authorizedVoter),new PublicKey(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:o}=decodeData$1(VOTE_INSTRUCTION_LAYOUTS.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new PublicKey(t),voteAuthorizationType:{index:o}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:o,newAuthorized:a,voteAuthorizationType:c}}=decodeData$1(VOTE_INSTRUCTION_LAYOUTS.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new PublicKey(t),currentAuthorityDerivedKeySeed:o,newAuthorizedPubkey:new PublicKey(a),voteAuthorizationType:{index:c},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=decodeData$1(VOTE_INSTRUCTION_LAYOUTS.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(VoteProgram.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const VOTE_INSTRUCTION_LAYOUTS=Object.freeze({InitializeAccount:{index:0,layout:struct$1([u32$1("instruction"),voteInit()])},Authorize:{index:1,layout:struct$1([u32$1("instruction"),publicKey$3("newAuthorized"),u32$1("voteAuthorizationType")])},Withdraw:{index:3,layout:struct$1([u32$1("instruction"),ns64$1("lamports")])},UpdateValidatorIdentity:{index:4,layout:struct$1([u32$1("instruction")])},AuthorizeWithSeed:{index:10,layout:struct$1([u32$1("instruction"),voteAuthorizeWithSeedArgs()])}}),VoteAuthorizationLayout=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class VoteProgram{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:o,voteInit:a}=e,c=VOTE_INSTRUCTION_LAYOUTS.InitializeAccount,d=encodeData(c,{voteInit:{nodePubkey:toBuffer$1(a.nodePubkey.toBuffer()),authorizedVoter:toBuffer$1(a.authorizedVoter.toBuffer()),authorizedWithdrawer:toBuffer$1(a.authorizedWithdrawer.toBuffer()),commission:a.commission}}),g={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1}],programId:this.programId,data:d};return new TransactionInstruction(g)}static createAccount(e){const t=new Transaction;return t.add(SystemProgram.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:o,newAuthorizedPubkey:a,voteAuthorizationType:c}=e,d=VOTE_INSTRUCTION_LAYOUTS.Authorize,g=encodeData(d,{newAuthorized:toBuffer$1(a.toBuffer()),voteAuthorizationType:c.index}),y=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1}];return new Transaction().add({keys:y,programId:this.programId,data:g})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:o,currentAuthorityDerivedKeySeed:a,newAuthorizedPubkey:c,voteAuthorizationType:d,votePubkey:g}=e,y=VOTE_INSTRUCTION_LAYOUTS.AuthorizeWithSeed,_=encodeData(y,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:toBuffer$1(o.toBuffer()),currentAuthorityDerivedKeySeed:a,newAuthorized:toBuffer$1(c.toBuffer()),voteAuthorizationType:d.index}}),E=[{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new Transaction().add({keys:E,programId:this.programId,data:_})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:o,lamports:a,toPubkey:c}=e,d=VOTE_INSTRUCTION_LAYOUTS.Withdraw,g=encodeData(d,{lamports:a}),y=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!0,isWritable:!1}];return new Transaction().add({keys:y,programId:this.programId,data:g})}static safeWithdraw(e,t,o){if(e.lamports>t-o)throw new Error("Withdraw will leave vote account with insufficient funds.");return VoteProgram.withdraw(e)}static updateValidatorIdentity(e){const{votePubkey:t,authorizedWithdrawerPubkey:o,nodePubkey:a}=e,c=VOTE_INSTRUCTION_LAYOUTS.UpdateValidatorIdentity,d=encodeData(c),g=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:o,isSigner:!0,isWritable:!1}];return new Transaction().add({keys:g,programId:this.programId,data:d})}}VoteProgram.programId=new PublicKey("Vote111111111111111111111111111111111111111");VoteProgram.space=3762;const VALIDATOR_INFO_KEY=new PublicKey("Va1idator1nfo111111111111111111111111111111"),InfoString=type$1({name:string$1(),website:optional$1(string$1()),details:optional$1(string$1()),iconUrl:optional$1(string$1()),keybaseUsername:optional$1(string$1())});class ValidatorInfo{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(decodeLength(t)!==2)return null;const a=[];for(let c=0;c<2;c++){const d=new PublicKey(guardedSplice(t,0,PUBLIC_KEY_LENGTH)),g=guardedShift(t)===1;a.push({publicKey:d,isSigner:g})}if(a[0].publicKey.equals(VALIDATOR_INFO_KEY)&&a[1].isSigner){const c=rustString().decode(buffer.Buffer.from(t)),d=JSON.parse(c);return assert$2(d,InfoString),new ValidatorInfo(a[1].publicKey,d)}return null}}const VOTE_PROGRAM_ID=new PublicKey("Vote111111111111111111111111111111111111111"),VoteAccountLayout=struct$1([publicKey$3("nodePubkey"),publicKey$3("authorizedWithdrawer"),u8$1("commission"),nu64$1(),seq(struct$1([nu64$1("slot"),u32$1("confirmationCount")]),offset$1(u32$1(),-8),"votes"),u8$1("rootSlotValid"),nu64$1("rootSlot"),nu64$1(),seq(struct$1([nu64$1("epoch"),publicKey$3("authorizedVoter")]),offset$1(u32$1(),-8),"authorizedVoters"),struct$1([seq(struct$1([publicKey$3("authorizedPubkey"),nu64$1("epochOfLastAuthorizedSwitch"),nu64$1("targetEpoch")]),32,"buf"),nu64$1("idx"),u8$1("isEmpty")],"priorVoters"),nu64$1(),seq(struct$1([nu64$1("epoch"),nu64$1("credits"),nu64$1("prevCredits")]),offset$1(u32$1(),-8),"epochCredits"),struct$1([nu64$1("slot"),nu64$1("timestamp")],"lastTimestamp")]);class VoteAccount{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const o=VoteAccountLayout.decode(toBuffer$1(e),4);let a=o.rootSlot;return o.rootSlotValid||(a=null),new VoteAccount({nodePubkey:new PublicKey(o.nodePubkey),authorizedWithdrawer:new PublicKey(o.authorizedWithdrawer),commission:o.commission,votes:o.votes,rootSlot:a,authorizedVoters:o.authorizedVoters.map(parseAuthorizedVoter),priorVoters:getPriorVoters(o.priorVoters),epochCredits:o.epochCredits,lastTimestamp:o.lastTimestamp})}}function parseAuthorizedVoter({authorizedVoter:s,epoch:e}){return{epoch:e,authorizedVoter:new PublicKey(s)}}function parsePriorVoters({authorizedPubkey:s,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new PublicKey(s),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function getPriorVoters({buf:s,idx:e,isEmpty:t}){return t?[]:[...s.slice(e+1).map(parsePriorVoters),...s.slice(0,e).map(parsePriorVoters)]}const endpoint={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function clusterApiUrl(s,e){const t=e===!1?"http":"https";if(!s)return endpoint[t].devnet;const o=endpoint[t][s];if(!o)throw new Error(`Unknown ${t} cluster: ${s}`);return o}async function sendAndConfirmRawTransaction$1(s,e,t,o){let a,c;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(a=t,c=o):c=t;const d=c&&{skipPreflight:c.skipPreflight,preflightCommitment:c.preflightCommitment||c.commitment,minContextSlot:c.minContextSlot},g=await s.sendRawTransaction(e,d),y=c&&c.commitment,E=(await(a?s.confirmTransaction(a,y):s.confirmTransaction(g,y))).value;if(E.err)throw g!=null?new SendTransactionError({action:d!=null&&d.skipPreflight?"send":"simulate",signature:g,transactionMessage:`Status: (${JSON.stringify(E)})`}):new Error(`Raw transaction ${g} failed (${JSON.stringify(E)})`);return g}const LAMPORTS_PER_SOL=1e9,index_browser_esm=Object.freeze(Object.defineProperty({__proto__:null,Account,AddressLookupTableAccount,AddressLookupTableInstruction,AddressLookupTableProgram,Authorized,BLOCKHASH_CACHE_TIMEOUT_MS,BPF_LOADER_DEPRECATED_PROGRAM_ID,BPF_LOADER_PROGRAM_ID,BpfLoader,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS,ComputeBudgetInstruction,ComputeBudgetProgram,Connection,Ed25519Program,Enum,EpochSchedule,FeeCalculatorLayout,Keypair,LAMPORTS_PER_SOL,LOOKUP_TABLE_INSTRUCTION_LAYOUTS,Loader,Lockup,MAX_SEED_LENGTH,Message,MessageAccountKeys,MessageV0,NONCE_ACCOUNT_LENGTH,NonceAccount,PACKET_DATA_SIZE,PUBLIC_KEY_LENGTH,PublicKey,SIGNATURE_LENGTH_IN_BYTES,SOLANA_SCHEMA,STAKE_CONFIG_ID,STAKE_INSTRUCTION_LAYOUTS,SYSTEM_INSTRUCTION_LAYOUTS,SYSVAR_CLOCK_PUBKEY,SYSVAR_EPOCH_SCHEDULE_PUBKEY,SYSVAR_INSTRUCTIONS_PUBKEY,SYSVAR_RECENT_BLOCKHASHES_PUBKEY,SYSVAR_RENT_PUBKEY,SYSVAR_REWARDS_PUBKEY,SYSVAR_SLOT_HASHES_PUBKEY,SYSVAR_SLOT_HISTORY_PUBKEY,SYSVAR_STAKE_HISTORY_PUBKEY,Secp256k1Program,SendTransactionError,SolanaJSONRPCError,SolanaJSONRPCErrorCode,StakeAuthorizationLayout,StakeInstruction,StakeProgram,Struct:Struct$1,SystemInstruction,SystemProgram,Transaction,TransactionExpiredBlockheightExceededError,TransactionExpiredNonceInvalidError,TransactionExpiredTimeoutError,TransactionInstruction,TransactionMessage,TransactionStatus,VALIDATOR_INFO_KEY,VERSION_PREFIX_MASK,VOTE_PROGRAM_ID,ValidatorInfo,VersionedMessage,VersionedTransaction,VoteAccount,VoteAuthorizationLayout,VoteInit,VoteInstruction,VoteProgram,clusterApiUrl,sendAndConfirmRawTransaction:sendAndConfirmRawTransaction$1,sendAndConfirmTransaction},Symbol.toStringTag,{value:"Module"}));var camelcase={exports:{}};const UPPERCASE=/[\p{Lu}]/u,LOWERCASE=/[\p{Ll}]/u,LEADING_CAPITAL=/^[\p{Lu}](?![\p{Lu}])/gu,IDENTIFIER=/([\p{Alpha}\p{N}_]|$)/u,SEPARATORS=/[_.\- ]+/,LEADING_SEPARATORS=new RegExp("^"+SEPARATORS.source),SEPARATORS_AND_IDENTIFIER=new RegExp(SEPARATORS.source+IDENTIFIER.source,"gu"),NUMBERS_AND_IDENTIFIER=new RegExp("\\d+"+IDENTIFIER.source,"gu"),preserveCamelCase=(s,e,t)=>{let o=!1,a=!1,c=!1;for(let d=0;d<s.length;d++){const g=s[d];o&&UPPERCASE.test(g)?(s=s.slice(0,d)+"-"+s.slice(d),o=!1,c=a,a=!0,d++):a&&c&&LOWERCASE.test(g)?(s=s.slice(0,d-1)+"-"+s.slice(d-1),c=a,a=!1,o=!0):(o=e(g)===g&&t(g)!==g,c=a,a=t(g)===g&&e(g)!==g)}return s},preserveConsecutiveUppercase=(s,e)=>(LEADING_CAPITAL.lastIndex=0,s.replace(LEADING_CAPITAL,t=>e(t))),postProcess=(s,e)=>(SEPARATORS_AND_IDENTIFIER.lastIndex=0,NUMBERS_AND_IDENTIFIER.lastIndex=0,s.replace(SEPARATORS_AND_IDENTIFIER,(t,o)=>e(o)).replace(NUMBERS_AND_IDENTIFIER,t=>e(t))),camelCase=(s,e)=>{if(!(typeof s=="string"||Array.isArray(s)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(s)?s=s.map(c=>c.trim()).filter(c=>c.length).join("-"):s=s.trim(),s.length===0)return"";const t=e.locale===!1?c=>c.toLowerCase():c=>c.toLocaleLowerCase(e.locale),o=e.locale===!1?c=>c.toUpperCase():c=>c.toLocaleUpperCase(e.locale);return s.length===1?e.pascalCase?o(s):t(s):(s!==t(s)&&(s=preserveCamelCase(s,t,o)),s=s.replace(LEADING_SEPARATORS,""),e.preserveConsecutiveUppercase?s=preserveConsecutiveUppercase(s,t):s=t(s),e.pascalCase&&(s=o(s.charAt(0))+s.slice(1)),postProcess(s,o))};camelcase.exports=camelCase;camelcase.exports.default=camelCase;var camelcaseExports=camelcase.exports;const camelCase$1=getDefaultExportFromCjs$1(camelcaseExports);var sha256={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.9.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */(function(module){(function(){var ERROR="input is invalid type",WINDOW=typeof window=="object",root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&typeof self=="object",NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;NODE_JS?root=globalThis:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&!0&&module.exports,ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];(root.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(s){return Object.prototype.toString.call(s)==="[object Array]"}),ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(s){return typeof s=="object"&&s.buffer&&s.buffer.constructor===ArrayBuffer});var createOutputMethod=function(s,e){return function(t){return new Sha256(e,!0).update(t)[s]()}},createMethod=function(s){var e=createOutputMethod("hex",s);NODE_JS&&(e=nodeWrap(e,s)),e.create=function(){return new Sha256(s)},e.update=function(a){return e.create().update(a)};for(var t=0;t<OUTPUT_TYPES.length;++t){var o=OUTPUT_TYPES[t];e[o]=createOutputMethod(o,s)}return e},nodeWrap=function(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function(s){if(typeof s=="string")return crypto.createHash(algorithm).update(s,"utf8").digest("hex");if(s==null)throw new Error(ERROR);return s.constructor===ArrayBuffer&&(s=new Uint8Array(s)),Array.isArray(s)||ArrayBuffer.isView(s)||s.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(s)).digest("hex"):method(s)};return nodeMethod},createHmacOutputMethod=function(s,e){return function(t,o){return new HmacSha256(t,e,!0).update(o)[s]()}},createHmacMethod=function(s){var e=createHmacOutputMethod("hex",s);e.create=function(a){return new HmacSha256(a,s)},e.update=function(a,c){return e.create(a).update(c)};for(var t=0;t<OUTPUT_TYPES.length;++t){var o=OUTPUT_TYPES[t];e[o]=createHmacOutputMethod(o,s)}return e};function Sha256(s,e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=s}Sha256.prototype.update=function(s){if(!this.finalized){var e,t=typeof s;if(t!=="string"){if(t==="object"){if(s===null)throw new Error(ERROR);if(ARRAY_BUFFER&&s.constructor===ArrayBuffer)s=new Uint8Array(s);else if(!Array.isArray(s)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(s)))throw new Error(ERROR)}else throw new Error(ERROR);e=!0}for(var o,a=0,c,d=s.length,g=this.blocks;a<d;){if(this.hashed&&(this.hashed=!1,g[0]=this.block,g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0),e)for(c=this.start;a<d&&c<64;++a)g[c>>2]|=s[a]<<SHIFT[c++&3];else for(c=this.start;a<d&&c<64;++a)o=s.charCodeAt(a),o<128?g[c>>2]|=o<<SHIFT[c++&3]:o<2048?(g[c>>2]|=(192|o>>6)<<SHIFT[c++&3],g[c>>2]|=(128|o&63)<<SHIFT[c++&3]):o<55296||o>=57344?(g[c>>2]|=(224|o>>12)<<SHIFT[c++&3],g[c>>2]|=(128|o>>6&63)<<SHIFT[c++&3],g[c>>2]|=(128|o&63)<<SHIFT[c++&3]):(o=65536+((o&1023)<<10|s.charCodeAt(++a)&1023),g[c>>2]|=(240|o>>18)<<SHIFT[c++&3],g[c>>2]|=(128|o>>12&63)<<SHIFT[c++&3],g[c>>2]|=(128|o>>6&63)<<SHIFT[c++&3],g[c>>2]|=(128|o&63)<<SHIFT[c++&3]);this.lastByteIndex=c,this.bytes+=c-this.start,c>=64?(this.block=g[16],this.start=c-64,this.hash(),this.hashed=!0):this.start=c}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var s=this.blocks,e=this.lastByteIndex;s[16]=this.block,s[e>>2]|=EXTRA[e&3],this.block=s[16],e>=56&&(this.hashed||this.hash(),s[0]=this.block,s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),s[14]=this.hBytes<<3|this.bytes>>>29,s[15]=this.bytes<<3,this.hash()}},Sha256.prototype.hash=function(){var s=this.h0,e=this.h1,t=this.h2,o=this.h3,a=this.h4,c=this.h5,d=this.h6,g=this.h7,y=this.blocks,_,E,S,A,C,N,O,I,P,j,B;for(_=16;_<64;++_)C=y[_-15],E=(C>>>7|C<<25)^(C>>>18|C<<14)^C>>>3,C=y[_-2],S=(C>>>17|C<<15)^(C>>>19|C<<13)^C>>>10,y[_]=y[_-16]+E+y[_-7]+S<<0;for(B=e&t,_=0;_<64;_+=4)this.first?(this.is224?(I=300032,C=y[0]-1413257819,g=C-150054599<<0,o=C+24177077<<0):(I=704751109,C=y[0]-210244248,g=C-1521486534<<0,o=C+143694565<<0),this.first=!1):(E=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),S=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7),I=s&e,A=I^s&t^B,O=a&c^~a&d,C=g+S+O+K[_]+y[_],N=E+A,g=o+C<<0,o=C+N<<0),E=(o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10),S=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),P=o&s,A=P^o&e^I,O=g&a^~g&c,C=d+S+O+K[_+1]+y[_+1],N=E+A,d=t+C<<0,t=C+N<<0,E=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10),S=(d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7),j=t&o,A=j^t&s^P,O=d&g^~d&a,C=c+S+O+K[_+2]+y[_+2],N=E+A,c=e+C<<0,e=C+N<<0,E=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10),S=(c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7),B=e&t,A=B^e&o^j,O=c&d^~c&g,C=a+S+O+K[_+3]+y[_+3],N=E+A,a=s+C<<0,s=C+N<<0;this.h0=this.h0+s<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+o<<0,this.h4=this.h4+a<<0,this.h5=this.h5+c<<0,this.h6=this.h6+d<<0,this.h7=this.h7+g<<0},Sha256.prototype.hex=function(){this.finalize();var s=this.h0,e=this.h1,t=this.h2,o=this.h3,a=this.h4,c=this.h5,d=this.h6,g=this.h7,y=HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[s&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[c>>28&15]+HEX_CHARS[c>>24&15]+HEX_CHARS[c>>20&15]+HEX_CHARS[c>>16&15]+HEX_CHARS[c>>12&15]+HEX_CHARS[c>>8&15]+HEX_CHARS[c>>4&15]+HEX_CHARS[c&15]+HEX_CHARS[d>>28&15]+HEX_CHARS[d>>24&15]+HEX_CHARS[d>>20&15]+HEX_CHARS[d>>16&15]+HEX_CHARS[d>>12&15]+HEX_CHARS[d>>8&15]+HEX_CHARS[d>>4&15]+HEX_CHARS[d&15];return this.is224||(y+=HEX_CHARS[g>>28&15]+HEX_CHARS[g>>24&15]+HEX_CHARS[g>>20&15]+HEX_CHARS[g>>16&15]+HEX_CHARS[g>>12&15]+HEX_CHARS[g>>8&15]+HEX_CHARS[g>>4&15]+HEX_CHARS[g&15]),y},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var s=this.h0,e=this.h1,t=this.h2,o=this.h3,a=this.h4,c=this.h5,d=this.h6,g=this.h7,y=[s>>24&255,s>>16&255,s>>8&255,s&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,o>>24&255,o>>16&255,o>>8&255,o&255,a>>24&255,a>>16&255,a>>8&255,a&255,c>>24&255,c>>16&255,c>>8&255,c&255,d>>24&255,d>>16&255,d>>8&255,d&255];return this.is224||y.push(g>>24&255,g>>16&255,g>>8&255,g&255),y},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var s=new ArrayBuffer(this.is224?28:32),e=new DataView(s);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),e.setUint32(20,this.h5),e.setUint32(24,this.h6),this.is224||e.setUint32(28,this.h7),s};function HmacSha256(s,e,t){var o,a=typeof s;if(a==="string"){var c=[],d=s.length,g=0,y;for(o=0;o<d;++o)y=s.charCodeAt(o),y<128?c[g++]=y:y<2048?(c[g++]=192|y>>6,c[g++]=128|y&63):y<55296||y>=57344?(c[g++]=224|y>>12,c[g++]=128|y>>6&63,c[g++]=128|y&63):(y=65536+((y&1023)<<10|s.charCodeAt(++o)&1023),c[g++]=240|y>>18,c[g++]=128|y>>12&63,c[g++]=128|y>>6&63,c[g++]=128|y&63);s=c}else if(a==="object"){if(s===null)throw new Error(ERROR);if(ARRAY_BUFFER&&s.constructor===ArrayBuffer)s=new Uint8Array(s);else if(!Array.isArray(s)&&(!ARRAY_BUFFER||!ArrayBuffer.isView(s)))throw new Error(ERROR)}else throw new Error(ERROR);s.length>64&&(s=new Sha256(e,!0).update(s).array());var _=[],E=[];for(o=0;o<64;++o){var S=s[o]||0;_[o]=92^S,E[o]=54^S}Sha256.call(this,e,t),this.update(E),this.oKeyPad=_,this.inner=!0,this.sharedMemory=t}HmacSha256.prototype=new Sha256,HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var s=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(s),Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224)})()})(sha256);var sha256Exports=sha256.exports,dist={},Layout$2={};let Layout$1=class{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,o){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}};Layout$2.Layout=Layout$1;function nameWithProperty$1(s,e){return e.property?s+"["+e.property+"]":s}Layout$2.nameWithProperty=nameWithProperty$1;function bindConstructorLayout(s,e){if(typeof s!="function")throw new TypeError("Class must be constructor");if(s.hasOwnProperty("layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof Layout$1))throw new TypeError("layout must be a Layout");if(e.hasOwnProperty("boundConstructor_"))throw new Error("layout is already bound to a constructor");s.layout_=e,e.boundConstructor_=s,e.makeDestinationObject=()=>new s,Object.defineProperty(s.prototype,"encode",{value:function(t,o){return e.encode(this,t,o)},writable:!0}),Object.defineProperty(s,"decode",{value:function(t,o){return e.decode(t,o)},writable:!0})}Layout$2.bindConstructorLayout=bindConstructorLayout;let ExternalLayout$1=class extends Layout$1{isCount(){throw new Error("ExternalLayout is abstract")}};class GreedyCount extends ExternalLayout$1{constructor(e,t){if(e===void 0&&(e=1),!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");super(-1,t),this.elementSpan=e}isCount(){return!0}decode(e,t){t===void 0&&(t=0);const o=e.length-t;return Math.floor(o/this.elementSpan)}encode(e,t,o){return 0}}let OffsetLayout$1=class extends ExternalLayout$1{constructor(e,t,o){if(!(e instanceof Layout$1))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,o||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof UInt$1||this.layout instanceof UIntBE$1}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,o){return o===void 0&&(o=0),this.layout.encode(e,t,o+this.offset)}},UInt$1=class extends Layout$1{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,o){return o===void 0&&(o=0),t.writeUIntLE(e,o,this.span),this.span}},UIntBE$1=class extends Layout$1{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,o){return o===void 0&&(o=0),t.writeUIntBE(e,o,this.span),this.span}};class Int extends Layout$1{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readIntLE(t,this.span)}encode(e,t,o){return o===void 0&&(o=0),t.writeIntLE(e,o,this.span),this.span}}class IntBE extends Layout$1{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readIntBE(t,this.span)}encode(e,t,o){return o===void 0&&(o=0),t.writeIntBE(e,o,this.span),this.span}}const V2E32$1=Math.pow(2,32);function divmodInt64$1(s){const e=Math.floor(s/V2E32$1),t=s-e*V2E32$1;return{hi32:e,lo32:t}}function roundedInt64$1(s,e){return s*V2E32$1+e}let NearUInt64$1=class extends Layout$1{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const o=e.readUInt32LE(t),a=e.readUInt32LE(t+4);return roundedInt64$1(a,o)}encode(e,t,o){o===void 0&&(o=0);const a=divmodInt64$1(e);return t.writeUInt32LE(a.lo32,o),t.writeUInt32LE(a.hi32,o+4),8}};class NearUInt64BE extends Layout$1{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const o=e.readUInt32BE(t),a=e.readUInt32BE(t+4);return roundedInt64$1(o,a)}encode(e,t,o){o===void 0&&(o=0);const a=divmodInt64$1(e);return t.writeUInt32BE(a.hi32,o),t.writeUInt32BE(a.lo32,o+4),8}}let NearInt64$1=class extends Layout$1{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const o=e.readUInt32LE(t),a=e.readInt32LE(t+4);return roundedInt64$1(a,o)}encode(e,t,o){o===void 0&&(o=0);const a=divmodInt64$1(e);return t.writeUInt32LE(a.lo32,o),t.writeInt32LE(a.hi32,o+4),8}};class NearInt64BE extends Layout$1{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const o=e.readInt32BE(t),a=e.readUInt32BE(t+4);return roundedInt64$1(o,a)}encode(e,t,o){o===void 0&&(o=0);const a=divmodInt64$1(e);return t.writeInt32BE(a.hi32,o),t.writeUInt32BE(a.lo32,o+4),8}}class Float extends Layout$1{constructor(e){super(4,e)}decode(e,t){return t===void 0&&(t=0),e.readFloatLE(t)}encode(e,t,o){return o===void 0&&(o=0),t.writeFloatLE(e,o),4}}class FloatBE extends Layout$1{constructor(e){super(4,e)}decode(e,t){return t===void 0&&(t=0),e.readFloatBE(t)}encode(e,t,o){return o===void 0&&(o=0),t.writeFloatBE(e,o),4}}class Double extends Layout$1{constructor(e){super(8,e)}decode(e,t){return t===void 0&&(t=0),e.readDoubleLE(t)}encode(e,t,o){return o===void 0&&(o=0),t.writeDoubleLE(e,o),8}}class DoubleBE extends Layout$1{constructor(e){super(8,e)}decode(e,t){return t===void 0&&(t=0),e.readDoubleBE(t)}encode(e,t,o){return o===void 0&&(o=0),t.writeDoubleBE(e,o),8}}class Sequence extends Layout$1{constructor(e,t,o){if(!(e instanceof Layout$1))throw new TypeError("elementLayout must be a Layout");if(!(t instanceof ExternalLayout$1&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let a=-1;!(t instanceof ExternalLayout$1)&&0<e.span&&(a=t*e.span),super(a,o),this.elementLayout=e,this.count=t}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let o=0,a=this.count;if(a instanceof ExternalLayout$1&&(a=a.decode(e,t)),0<this.elementLayout.span)o=a*this.elementLayout.span;else{let c=0;for(;c<a;)o+=this.elementLayout.getSpan(e,t+o),++c}return o}decode(e,t){t===void 0&&(t=0);const o=[];let a=0,c=this.count;for(c instanceof ExternalLayout$1&&(c=c.decode(e,t));a<c;)o.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),a+=1;return o}encode(e,t,o){o===void 0&&(o=0);const a=this.elementLayout,c=e.reduce((d,g)=>d+a.encode(g,t,o+d),0);return this.count instanceof ExternalLayout$1&&this.count.encode(e.length,t,o),c}}let Structure$1=class extends Layout$1{constructor(e,t,o){if(!(Array.isArray(e)&&e.reduce((c,d)=>c&&d instanceof Layout$1,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&o===void 0&&(o=t,t=void 0);for(const c of e)if(0>c.span&&c.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let a=-1;try{a=e.reduce((c,d)=>c+d.getSpan(),0)}catch{}super(a,t),this.fields=e,this.decodePrefixes=!!o}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let o=0;try{o=this.fields.reduce((a,c)=>{const d=c.getSpan(e,t);return t+=d,a+d},0)}catch{throw new RangeError("indeterminate span")}return o}decode(e,t){t===void 0&&(t=0);const o=this.makeDestinationObject();for(const a of this.fields)if(a.property!==void 0&&(o[a.property]=a.decode(e,t)),t+=a.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return o}encode(e,t,o){o===void 0&&(o=0);const a=o;let c=0,d=0;for(const g of this.fields){let y=g.span;if(d=0<y?y:0,g.property!==void 0){const _=e[g.property];_!==void 0&&(d=g.encode(_,t,o),0>y&&(y=g.getSpan(t,o)))}c=o,o+=y}return c+d-a}fromArray(e){const t=this.makeDestinationObject();for(const o of this.fields)o.property!==void 0&&0<e.length&&(t[o.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const o of this.fields){if(o.property===e)return t;0>o.span?t=-1:0<=t&&(t+=o.span)}}},UnionDiscriminator$1=class{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}},UnionLayoutDiscriminator$1=class extends UnionDiscriminator$1{constructor(e,t){if(!(e instanceof ExternalLayout$1&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,o){return this.layout.encode(e,t,o)}},Union$1=class extends Layout$1{constructor(e,t,o){const a=e instanceof UInt$1||e instanceof UIntBE$1;if(a)e=new UnionLayoutDiscriminator$1(new OffsetLayout$1(e));else if(e instanceof ExternalLayout$1&&e.isCount())e=new UnionLayoutDiscriminator$1(e);else if(!(e instanceof UnionDiscriminator$1))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Layout$1))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let c=-1;t&&(c=t.span,0<=c&&a&&(c+=e.layout.span)),super(c,o),this.discriminator=e,this.usesPrefixDiscriminator=a,this.defaultLayout=t,this.registry={};let d=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(g){return d(g)},this.configGetSourceVariant=function(g){d=g.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const o=this.getVariant(e,t);if(!o)throw new Error("unable to determine span for unrecognized variant");return o.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const o=this.registry[t];if(e.hasOwnProperty(o.property))return o}throw new Error("unable to infer src variant")}decode(e,t){t===void 0&&(t=0);let o;const a=this.discriminator,c=a.decode(e,t);let d=this.registry[c];if(d===void 0){let g=0;d=this.defaultLayout,this.usesPrefixDiscriminator&&(g=a.layout.span),o=this.makeDestinationObject(),o[a.property]=c,o[d.property]=this.defaultLayout.decode(e,t+g)}else o=d.decode(e,t);return o}encode(e,t,o){o===void 0&&(o=0);const a=this.getSourceVariant(e);if(a===void 0){const c=this.discriminator,d=this.defaultLayout;let g=0;return this.usesPrefixDiscriminator&&(g=c.layout.span),c.encode(e[c.property],t,o),g+d.encode(e[d.property],t,o+g)}return a.encode(e,t,o)}addVariant(e,t,o){const a=new VariantLayout$1(this,e,t,o);return this.registry[e]=a,a}getVariant(e,t){let o=e;return Buffer.isBuffer(e)&&(t===void 0&&(t=0),o=this.discriminator.decode(e,t)),this.registry[o]}},VariantLayout$1=class extends Layout$1{constructor(e,t,o,a){if(!(e instanceof Union$1))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof o=="string"&&a===void 0&&(a=o,o=null),o){if(!(o instanceof Layout$1))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=o.span&&o.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof a!="string")throw new TypeError("variant must have a String property")}let c=e.span;0>e.span&&(c=o?o.span:0,0<=c&&e.usesPrefixDiscriminator&&(c+=e.discriminator.layout.span)),super(c,a),this.union=e,this.variant=t,this.layout=o||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let o=0;return this.union.usesPrefixDiscriminator&&(o=this.union.discriminator.layout.span),o+this.layout.getSpan(e,t+o)}decode(e,t){const o=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let a=0;return this.union.usesPrefixDiscriminator&&(a=this.union.discriminator.layout.span),this.layout?o[this.property]=this.layout.decode(e,t+a):this.property?o[this.property]=!0:this.union.usesPrefixDiscriminator&&(o[this.union.discriminator.property]=this.variant),o}encode(e,t,o){o===void 0&&(o=0);let a=0;if(this.union.usesPrefixDiscriminator&&(a=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,o);let c=a;if(this.layout&&(this.layout.encode(e[this.property],t,o+a),c+=this.layout.getSpan(t,o+a),0<=this.union.span&&c>this.union.span))throw new Error("encoded variant overruns containing union");return c}fromArray(e){if(this.layout)return this.layout.fromArray(e)}};function fixBitwiseResult(s){return 0>s&&(s+=4294967296),s}class BitStructure extends Layout$1{constructor(e,t,o){if(!(e instanceof UInt$1||e instanceof UIntBE$1))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof t=="string"&&o===void 0&&(o=t,t=void 0),4<e.span)throw new RangeError("word cannot exceed 32 bits");super(e.span,o),this.word=e,this.msb=!!t,this.fields=[];let a=0;this._packedSetValue=function(c){return a=fixBitwiseResult(c),this},this._packedGetValue=function(){return a}}decode(e,t){const o=this.makeDestinationObject();t===void 0&&(t=0);const a=this.word.decode(e,t);this._packedSetValue(a);for(const c of this.fields)c.property!==void 0&&(o[c.property]=c.decode(a));return o}encode(e,t,o){o===void 0&&(o=0);const a=this.word.decode(t,o);this._packedSetValue(a);for(const c of this.fields)if(c.property!==void 0){const d=e[c.property];d!==void 0&&c.encode(d)}return this.word.encode(this._packedGetValue(),t,o)}addField(e,t){const o=new BitField(this,e,t);return this.fields.push(o),o}addBoolean(e){const t=new Boolean$1(this,e);return this.fields.push(t),t}fieldFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}}class BitField{constructor(e,t,o){if(!(e instanceof BitStructure))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(t)||0>=t)throw new TypeError("bits must be positive integer");const a=8*e.span,c=e.fields.reduce((d,g)=>d+g.bits,0);if(t+c>a)throw new Error("bits too long for span remainder ("+(a-c)+" of "+a+" remain)");this.container=e,this.bits=t,this.valueMask=(1<<t)-1,t===32&&(this.valueMask=4294967295),this.start=c,this.container.msb&&(this.start=a-c-t),this.wordMask=fixBitwiseResult(this.valueMask<<this.start),this.property=o}decode(){const e=this.container._packedGetValue();return fixBitwiseResult(e&this.wordMask)>>>this.start}encode(e){if(!Number.isInteger(e)||e!==fixBitwiseResult(e&this.valueMask))throw new TypeError(nameWithProperty$1("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const t=this.container._packedGetValue(),o=fixBitwiseResult(e<<this.start);this.container._packedSetValue(fixBitwiseResult(t&~this.wordMask)|o)}}let Boolean$1=class extends BitField{constructor(e,t){super(e,1,t)}decode(e,t){return!!BitField.prototype.decode.call(this,e,t)}encode(e){return typeof e=="boolean"&&(e=+e),BitField.prototype.encode.call(this,e)}},Blob$2=class extends Layout$1{constructor(e,t){if(!(e instanceof ExternalLayout$1&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let o=-1;e instanceof ExternalLayout$1||(o=e),super(o,t),this.length=e}getSpan(e,t){let o=this.span;return 0>o&&(o=this.length.decode(e,t)),o}decode(e,t){t===void 0&&(t=0);let o=this.span;return 0>o&&(o=this.length.decode(e,t)),e.slice(t,t+o)}encode(e,t,o){let a=this.length;if(this.length instanceof ExternalLayout$1&&(a=e.length),!(Buffer.isBuffer(e)&&a===e.length))throw new TypeError(nameWithProperty$1("Blob.encode",this)+" requires (length "+a+") Buffer as src");if(o+a>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),o,a,"hex"),this.length instanceof ExternalLayout$1&&this.length.encode(a,t,o),a}};class CString extends Layout$1{constructor(e){super(-1,e)}getSpan(e,t){if(!Buffer.isBuffer(e))throw new TypeError("b must be a Buffer");t===void 0&&(t=0);let o=t;for(;o<e.length&&e[o]!==0;)o+=1;return 1+o-t}decode(e,t,o){t===void 0&&(t=0);let a=this.getSpan(e,t);return e.slice(t,t+a-1).toString("utf-8")}encode(e,t,o){o===void 0&&(o=0),typeof e!="string"&&(e=e.toString());const a=new Buffer(e,"utf8"),c=a.length;if(o+c>t.length)throw new RangeError("encoding overruns Buffer");return a.copy(t,o),t[o+c]=0,c+1}}class UTF8 extends Layout$1{constructor(e,t){if(typeof e=="string"&&t===void 0&&(t=e,e=void 0),e===void 0)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");super(-1,t),this.maxSpan=e}getSpan(e,t){if(!Buffer.isBuffer(e))throw new TypeError("b must be a Buffer");return t===void 0&&(t=0),e.length-t}decode(e,t,o){t===void 0&&(t=0);let a=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<a)throw new RangeError("text length exceeds maxSpan");return e.slice(t,t+a).toString("utf-8")}encode(e,t,o){o===void 0&&(o=0),typeof e!="string"&&(e=e.toString());const a=new Buffer(e,"utf8"),c=a.length;if(0<=this.maxSpan&&this.maxSpan<c)throw new RangeError("text length exceeds maxSpan");if(o+c>t.length)throw new RangeError("encoding overruns Buffer");return a.copy(t,o),c}}class Constant extends Layout$1{constructor(e,t){super(0,t),this.value=e}decode(e,t,o){return this.value}encode(e,t,o){return 0}}Layout$2.ExternalLayout=ExternalLayout$1;Layout$2.GreedyCount=GreedyCount;Layout$2.OffsetLayout=OffsetLayout$1;Layout$2.UInt=UInt$1;Layout$2.UIntBE=UIntBE$1;Layout$2.Int=Int;Layout$2.IntBE=IntBE;Layout$2.Float=Float;Layout$2.FloatBE=FloatBE;Layout$2.Double=Double;Layout$2.DoubleBE=DoubleBE;Layout$2.Sequence=Sequence;Layout$2.Structure=Structure$1;Layout$2.UnionDiscriminator=UnionDiscriminator$1;Layout$2.UnionLayoutDiscriminator=UnionLayoutDiscriminator$1;Layout$2.Union=Union$1;Layout$2.VariantLayout=VariantLayout$1;Layout$2.BitStructure=BitStructure;Layout$2.BitField=BitField;Layout$2.Boolean=Boolean$1;Layout$2.Blob=Blob$2;Layout$2.CString=CString;Layout$2.UTF8=UTF8;Layout$2.Constant=Constant;Layout$2.greedy=(s,e)=>new GreedyCount(s,e);Layout$2.offset=(s,e,t)=>new OffsetLayout$1(s,e,t);Layout$2.u8=s=>new UInt$1(1,s);Layout$2.u16=s=>new UInt$1(2,s);Layout$2.u24=s=>new UInt$1(3,s);Layout$2.u32=s=>new UInt$1(4,s);Layout$2.u40=s=>new UInt$1(5,s);Layout$2.u48=s=>new UInt$1(6,s);Layout$2.nu64=s=>new NearUInt64$1(s);Layout$2.u16be=s=>new UIntBE$1(2,s);Layout$2.u24be=s=>new UIntBE$1(3,s);Layout$2.u32be=s=>new UIntBE$1(4,s);Layout$2.u40be=s=>new UIntBE$1(5,s);Layout$2.u48be=s=>new UIntBE$1(6,s);Layout$2.nu64be=s=>new NearUInt64BE(s);Layout$2.s8=s=>new Int(1,s);Layout$2.s16=s=>new Int(2,s);Layout$2.s24=s=>new Int(3,s);Layout$2.s32=s=>new Int(4,s);Layout$2.s40=s=>new Int(5,s);Layout$2.s48=s=>new Int(6,s);Layout$2.ns64=s=>new NearInt64$1(s);Layout$2.s16be=s=>new IntBE(2,s);Layout$2.s24be=s=>new IntBE(3,s);Layout$2.s32be=s=>new IntBE(4,s);Layout$2.s40be=s=>new IntBE(5,s);Layout$2.s48be=s=>new IntBE(6,s);Layout$2.ns64be=s=>new NearInt64BE(s);Layout$2.f32=s=>new Float(s);Layout$2.f32be=s=>new FloatBE(s);Layout$2.f64=s=>new Double(s);Layout$2.f64be=s=>new DoubleBE(s);Layout$2.struct=(s,e,t)=>new Structure$1(s,e,t);Layout$2.bits=(s,e,t)=>new BitStructure(s,e,t);Layout$2.seq=(s,e,t)=>new Sequence(s,e,t);Layout$2.union=(s,e,t)=>new Union$1(s,e,t);Layout$2.unionLayoutDiscriminator=(s,e)=>new UnionLayoutDiscriminator$1(s,e);Layout$2.blob=(s,e)=>new Blob$2(s,e);Layout$2.cstr=s=>new CString(s);Layout$2.utf8=(s,e)=>new UTF8(s,e);Layout$2.const=(s,e)=>new Constant(s,e);const require$$1=getAugmentedNamespace(index_browser_esm);(function(s){var e=commonjsGlobal&&commonjsGlobal.__importDefault||function(me){return me&&me.__esModule?me:{default:me}};Object.defineProperty(s,"__esModule",{value:!0}),s.map=s.array=s.rustEnum=s.str=s.vecU8=s.tagged=s.vec=s.bool=s.option=s.publicKey=s.i256=s.u256=s.i128=s.u128=s.i64=s.u64=s.struct=s.f64=s.f32=s.i32=s.u32=s.i16=s.u16=s.i8=s.u8=void 0;const t=Layout$2,o=require$$1,a=e(bnExports);var c=Layout$2;Object.defineProperty(s,"u8",{enumerable:!0,get:function(){return c.u8}}),Object.defineProperty(s,"i8",{enumerable:!0,get:function(){return c.s8}}),Object.defineProperty(s,"u16",{enumerable:!0,get:function(){return c.u16}}),Object.defineProperty(s,"i16",{enumerable:!0,get:function(){return c.s16}}),Object.defineProperty(s,"u32",{enumerable:!0,get:function(){return c.u32}}),Object.defineProperty(s,"i32",{enumerable:!0,get:function(){return c.s32}}),Object.defineProperty(s,"f32",{enumerable:!0,get:function(){return c.f32}}),Object.defineProperty(s,"f64",{enumerable:!0,get:function(){return c.f64}}),Object.defineProperty(s,"struct",{enumerable:!0,get:function(){return c.struct}});class d extends t.Layout{constructor(V,R,L){super(V,L),this.blob=(0,t.blob)(V),this.signed=R}decode(V,R=0){const L=new a.default(this.blob.decode(V,R),10,"le");return this.signed?L.fromTwos(this.span*8).clone():L}encode(V,R,L=0){return this.signed&&(V=V.toTwos(this.span*8)),this.blob.encode(V.toArrayLike(Buffer,"le",this.span),R,L)}}function g(me){return new d(8,!1,me)}s.u64=g;function y(me){return new d(8,!0,me)}s.i64=y;function _(me){return new d(16,!1,me)}s.u128=_;function E(me){return new d(16,!0,me)}s.i128=E;function S(me){return new d(32,!1,me)}s.u256=S;function A(me){return new d(32,!0,me)}s.i256=A;class C extends t.Layout{constructor(V,R,L,z){super(V.span,z),this.layout=V,this.decoder=R,this.encoder=L}decode(V,R){return this.decoder(this.layout.decode(V,R))}encode(V,R,L){return this.layout.encode(this.encoder(V),R,L)}getSpan(V,R){return this.layout.getSpan(V,R)}}function N(me){return new C((0,t.blob)(32),V=>new o.PublicKey(V),V=>V.toBuffer(),me)}s.publicKey=N;class O extends t.Layout{constructor(V,R){super(-1,R),this.layout=V,this.discriminator=(0,t.u8)()}encode(V,R,L=0){return V==null?this.discriminator.encode(0,R,L):(this.discriminator.encode(1,R,L),this.layout.encode(V,R,L+1)+1)}decode(V,R=0){const L=this.discriminator.decode(V,R);if(L===0)return null;if(L===1)return this.layout.decode(V,R+1);throw new Error("Invalid option "+this.property)}getSpan(V,R=0){const L=this.discriminator.decode(V,R);if(L===0)return 1;if(L===1)return this.layout.getSpan(V,R+1)+1;throw new Error("Invalid option "+this.property)}}function I(me,V){return new O(me,V)}s.option=I;function P(me){return new C((0,t.u8)(),j,B,me)}s.bool=P;function j(me){if(me===0)return!1;if(me===1)return!0;throw new Error("Invalid bool: "+me)}function B(me){return me?1:0}function H(me,V){const R=(0,t.u32)("length"),L=(0,t.struct)([R,(0,t.seq)(me,(0,t.offset)(R,-R.span),"values")]);return new C(L,({values:z})=>z,z=>({values:z}),V)}s.vec=H;function se(me,V,R){const L=(0,t.struct)([g("tag"),V.replicate("data")]);function z({tag:Y,data:W}){if(!Y.eq(me))throw new Error("Invalid tag, expected: "+me.toString("hex")+", got: "+Y.toString("hex"));return W}return new C(L,z,Y=>({tag:me,data:Y}),R)}s.tagged=se;function oe(me){const V=(0,t.u32)("length"),R=(0,t.struct)([V,(0,t.blob)((0,t.offset)(V,-V.span),"data")]);return new C(R,({data:L})=>L,L=>({data:L}),me)}s.vecU8=oe;function Q(me){return new C(oe(),V=>V.toString("utf-8"),V=>Buffer.from(V,"utf-8"),me)}s.str=Q;function fe(me,V,R){const L=(0,t.union)(R??(0,t.u8)(),V);return me.forEach((z,Y)=>L.addVariant(Y,z,z.property)),L}s.rustEnum=fe;function Z(me,V,R){const L=(0,t.struct)([(0,t.seq)(me,V,"values")]);return new C(L,({values:z})=>z,z=>({values:z}),R)}s.array=Z;class ce extends t.Layout{constructor(V,R,L){super(V.span+R.span,L),this.keyLayout=V,this.valueLayout=R}decode(V,R){R=R||0;const L=this.keyLayout.decode(V,R),z=this.valueLayout.decode(V,R+this.keyLayout.getSpan(V,R));return[L,z]}encode(V,R,L){L=L||0;const z=this.keyLayout.encode(V[0],R,L),Y=this.valueLayout.encode(V[1],R,L+z);return z+Y}getSpan(V,R){return this.keyLayout.getSpan(V,R)+this.valueLayout.getSpan(V,R)}}function ge(me,V,R){const L=(0,t.u32)("length"),z=(0,t.struct)([L,(0,t.seq)(new ce(me,V),(0,t.offset)(L,-L.span),"values")]);return new C(z,({values:Y})=>new Map(Y),Y=>({values:Array.from(Y.entries())}),R)}s.map=ge})(dist);/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(s){let e=s.length;for(;--e>=0;)s[e]=0}const STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),extra_dbits=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),extra_blbits=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bl_order=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(s,e,t,o,a){this.static_tree=s,this.extra_bits=e,this.extra_base=t,this.elems=o,this.max_length=a,this.has_stree=s&&s.length}let static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(s,e){this.dyn_tree=s,this.max_code=0,this.stat_desc=e}const d_code=s=>s<256?_dist_code[s]:_dist_code[256+(s>>>7)],put_short=(s,e)=>{s.pending_buf[s.pending++]=e&255,s.pending_buf[s.pending++]=e>>>8&255},send_bits=(s,e,t)=>{s.bi_valid>Buf_size-t?(s.bi_buf|=e<<s.bi_valid&65535,put_short(s,s.bi_buf),s.bi_buf=e>>Buf_size-s.bi_valid,s.bi_valid+=t-Buf_size):(s.bi_buf|=e<<s.bi_valid&65535,s.bi_valid+=t)},send_code=(s,e,t)=>{send_bits(s,t[e*2],t[e*2+1])},bi_reverse=(s,e)=>{let t=0;do t|=s&1,s>>>=1,t<<=1;while(--e>0);return t>>>1},bi_flush=s=>{s.bi_valid===16?(put_short(s,s.bi_buf),s.bi_buf=0,s.bi_valid=0):s.bi_valid>=8&&(s.pending_buf[s.pending++]=s.bi_buf&255,s.bi_buf>>=8,s.bi_valid-=8)},gen_bitlen=(s,e)=>{const t=e.dyn_tree,o=e.max_code,a=e.stat_desc.static_tree,c=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,g=e.stat_desc.extra_base,y=e.stat_desc.max_length;let _,E,S,A,C,N,O=0;for(A=0;A<=MAX_BITS$1;A++)s.bl_count[A]=0;for(t[s.heap[s.heap_max]*2+1]=0,_=s.heap_max+1;_<HEAP_SIZE$1;_++)E=s.heap[_],A=t[t[E*2+1]*2+1]+1,A>y&&(A=y,O++),t[E*2+1]=A,!(E>o)&&(s.bl_count[A]++,C=0,E>=g&&(C=d[E-g]),N=t[E*2],s.opt_len+=N*(A+C),c&&(s.static_len+=N*(a[E*2+1]+C)));if(O!==0){do{for(A=y-1;s.bl_count[A]===0;)A--;s.bl_count[A]--,s.bl_count[A+1]+=2,s.bl_count[y]--,O-=2}while(O>0);for(A=y;A!==0;A--)for(E=s.bl_count[A];E!==0;)S=s.heap[--_],!(S>o)&&(t[S*2+1]!==A&&(s.opt_len+=(A-t[S*2+1])*t[S*2],t[S*2+1]=A),E--)}},gen_codes=(s,e,t)=>{const o=new Array(MAX_BITS$1+1);let a=0,c,d;for(c=1;c<=MAX_BITS$1;c++)a=a+t[c-1]<<1,o[c]=a;for(d=0;d<=e;d++){let g=s[d*2+1];g!==0&&(s[d*2]=bi_reverse(o[g]++,g))}},tr_static_init=()=>{let s,e,t,o,a;const c=new Array(MAX_BITS$1+1);for(t=0,o=0;o<LENGTH_CODES$1-1;o++)for(base_length[o]=t,s=0;s<1<<extra_lbits[o];s++)_length_code[t++]=o;for(_length_code[t-1]=o,a=0,o=0;o<16;o++)for(base_dist[o]=a,s=0;s<1<<extra_dbits[o];s++)_dist_code[a++]=o;for(a>>=7;o<D_CODES$1;o++)for(base_dist[o]=a<<7,s=0;s<1<<extra_dbits[o]-7;s++)_dist_code[256+a++]=o;for(e=0;e<=MAX_BITS$1;e++)c[e]=0;for(s=0;s<=143;)static_ltree[s*2+1]=8,s++,c[8]++;for(;s<=255;)static_ltree[s*2+1]=9,s++,c[9]++;for(;s<=279;)static_ltree[s*2+1]=7,s++,c[7]++;for(;s<=287;)static_ltree[s*2+1]=8,s++,c[8]++;for(gen_codes(static_ltree,L_CODES$1+1,c),s=0;s<D_CODES$1;s++)static_dtree[s*2+1]=5,static_dtree[s*2]=bi_reverse(s,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)},init_block=s=>{let e;for(e=0;e<L_CODES$1;e++)s.dyn_ltree[e*2]=0;for(e=0;e<D_CODES$1;e++)s.dyn_dtree[e*2]=0;for(e=0;e<BL_CODES$1;e++)s.bl_tree[e*2]=0;s.dyn_ltree[END_BLOCK*2]=1,s.opt_len=s.static_len=0,s.sym_next=s.matches=0},bi_windup=s=>{s.bi_valid>8?put_short(s,s.bi_buf):s.bi_valid>0&&(s.pending_buf[s.pending++]=s.bi_buf),s.bi_buf=0,s.bi_valid=0},smaller=(s,e,t,o)=>{const a=e*2,c=t*2;return s[a]<s[c]||s[a]===s[c]&&o[e]<=o[t]},pqdownheap=(s,e,t)=>{const o=s.heap[t];let a=t<<1;for(;a<=s.heap_len&&(a<s.heap_len&&smaller(e,s.heap[a+1],s.heap[a],s.depth)&&a++,!smaller(e,o,s.heap[a],s.depth));)s.heap[t]=s.heap[a],t=a,a<<=1;s.heap[t]=o},compress_block=(s,e,t)=>{let o,a,c=0,d,g;if(s.sym_next!==0)do o=s.pending_buf[s.sym_buf+c++]&255,o+=(s.pending_buf[s.sym_buf+c++]&255)<<8,a=s.pending_buf[s.sym_buf+c++],o===0?send_code(s,a,e):(d=_length_code[a],send_code(s,d+LITERALS$1+1,e),g=extra_lbits[d],g!==0&&(a-=base_length[d],send_bits(s,a,g)),o--,d=d_code(o),send_code(s,d,t),g=extra_dbits[d],g!==0&&(o-=base_dist[d],send_bits(s,o,g)));while(c<s.sym_next);send_code(s,END_BLOCK,e)},build_tree=(s,e)=>{const t=e.dyn_tree,o=e.stat_desc.static_tree,a=e.stat_desc.has_stree,c=e.stat_desc.elems;let d,g,y=-1,_;for(s.heap_len=0,s.heap_max=HEAP_SIZE$1,d=0;d<c;d++)t[d*2]!==0?(s.heap[++s.heap_len]=y=d,s.depth[d]=0):t[d*2+1]=0;for(;s.heap_len<2;)_=s.heap[++s.heap_len]=y<2?++y:0,t[_*2]=1,s.depth[_]=0,s.opt_len--,a&&(s.static_len-=o[_*2+1]);for(e.max_code=y,d=s.heap_len>>1;d>=1;d--)pqdownheap(s,t,d);_=c;do d=s.heap[1],s.heap[1]=s.heap[s.heap_len--],pqdownheap(s,t,1),g=s.heap[1],s.heap[--s.heap_max]=d,s.heap[--s.heap_max]=g,t[_*2]=t[d*2]+t[g*2],s.depth[_]=(s.depth[d]>=s.depth[g]?s.depth[d]:s.depth[g])+1,t[d*2+1]=t[g*2+1]=_,s.heap[1]=_++,pqdownheap(s,t,1);while(s.heap_len>=2);s.heap[--s.heap_max]=s.heap[1],gen_bitlen(s,e),gen_codes(t,y,s.bl_count)},scan_tree=(s,e,t)=>{let o,a=-1,c,d=e[0*2+1],g=0,y=7,_=4;for(d===0&&(y=138,_=3),e[(t+1)*2+1]=65535,o=0;o<=t;o++)c=d,d=e[(o+1)*2+1],!(++g<y&&c===d)&&(g<_?s.bl_tree[c*2]+=g:c!==0?(c!==a&&s.bl_tree[c*2]++,s.bl_tree[REP_3_6*2]++):g<=10?s.bl_tree[REPZ_3_10*2]++:s.bl_tree[REPZ_11_138*2]++,g=0,a=c,d===0?(y=138,_=3):c===d?(y=6,_=3):(y=7,_=4))},send_tree=(s,e,t)=>{let o,a=-1,c,d=e[0*2+1],g=0,y=7,_=4;for(d===0&&(y=138,_=3),o=0;o<=t;o++)if(c=d,d=e[(o+1)*2+1],!(++g<y&&c===d)){if(g<_)do send_code(s,c,s.bl_tree);while(--g!==0);else c!==0?(c!==a&&(send_code(s,c,s.bl_tree),g--),send_code(s,REP_3_6,s.bl_tree),send_bits(s,g-3,2)):g<=10?(send_code(s,REPZ_3_10,s.bl_tree),send_bits(s,g-3,3)):(send_code(s,REPZ_11_138,s.bl_tree),send_bits(s,g-11,7));g=0,a=c,d===0?(y=138,_=3):c===d?(y=6,_=3):(y=7,_=4)}},build_bl_tree=s=>{let e;for(scan_tree(s,s.dyn_ltree,s.l_desc.max_code),scan_tree(s,s.dyn_dtree,s.d_desc.max_code),build_tree(s,s.bl_desc),e=BL_CODES$1-1;e>=3&&s.bl_tree[bl_order[e]*2+1]===0;e--);return s.opt_len+=3*(e+1)+5+5+4,e},send_all_trees=(s,e,t,o)=>{let a;for(send_bits(s,e-257,5),send_bits(s,t-1,5),send_bits(s,o-4,4),a=0;a<o;a++)send_bits(s,s.bl_tree[bl_order[a]*2+1],3);send_tree(s,s.dyn_ltree,e-1),send_tree(s,s.dyn_dtree,t-1)},detect_data_type=s=>{let e=4093624447,t;for(t=0;t<=31;t++,e>>>=1)if(e&1&&s.dyn_ltree[t*2]!==0)return Z_BINARY;if(s.dyn_ltree[9*2]!==0||s.dyn_ltree[10*2]!==0||s.dyn_ltree[13*2]!==0)return Z_TEXT;for(t=32;t<LITERALS$1;t++)if(s.dyn_ltree[t*2]!==0)return Z_TEXT;return Z_BINARY};let static_init_done=!1;const _tr_init$1=s=>{static_init_done||(tr_static_init(),static_init_done=!0),s.l_desc=new TreeDesc(s.dyn_ltree,static_l_desc),s.d_desc=new TreeDesc(s.dyn_dtree,static_d_desc),s.bl_desc=new TreeDesc(s.bl_tree,static_bl_desc),s.bi_buf=0,s.bi_valid=0,init_block(s)},_tr_stored_block$1=(s,e,t,o)=>{send_bits(s,(STORED_BLOCK<<1)+(o?1:0),3),bi_windup(s),put_short(s,t),put_short(s,~t),t&&s.pending_buf.set(s.window.subarray(e,e+t),s.pending),s.pending+=t},_tr_align$1=s=>{send_bits(s,STATIC_TREES<<1,3),send_code(s,END_BLOCK,static_ltree),bi_flush(s)},_tr_flush_block$1=(s,e,t,o)=>{let a,c,d=0;s.level>0?(s.strm.data_type===Z_UNKNOWN$1&&(s.strm.data_type=detect_data_type(s)),build_tree(s,s.l_desc),build_tree(s,s.d_desc),d=build_bl_tree(s),a=s.opt_len+3+7>>>3,c=s.static_len+3+7>>>3,c<=a&&(a=c)):a=c=t+5,t+4<=a&&e!==-1?_tr_stored_block$1(s,e,t,o):s.strategy===Z_FIXED$1||c===a?(send_bits(s,(STATIC_TREES<<1)+(o?1:0),3),compress_block(s,static_ltree,static_dtree)):(send_bits(s,(DYN_TREES<<1)+(o?1:0),3),send_all_trees(s,s.l_desc.max_code+1,s.d_desc.max_code+1,d+1),compress_block(s,s.dyn_ltree,s.dyn_dtree)),init_block(s),o&&bi_windup(s)},_tr_tally$1=(s,e,t)=>(s.pending_buf[s.sym_buf+s.sym_next++]=e,s.pending_buf[s.sym_buf+s.sym_next++]=e>>8,s.pending_buf[s.sym_buf+s.sym_next++]=t,e===0?s.dyn_ltree[t*2]++:(s.matches++,e--,s.dyn_ltree[(_length_code[t]+LITERALS$1+1)*2]++,s.dyn_dtree[d_code(e)*2]++),s.sym_next===s.sym_end);var _tr_init_1=_tr_init$1,_tr_stored_block_1=_tr_stored_block$1,_tr_flush_block_1=_tr_flush_block$1,_tr_tally_1=_tr_tally$1,_tr_align_1=_tr_align$1,trees={_tr_init:_tr_init_1,_tr_stored_block:_tr_stored_block_1,_tr_flush_block:_tr_flush_block_1,_tr_tally:_tr_tally_1,_tr_align:_tr_align_1};const adler32=(s,e,t,o)=>{let a=s&65535|0,c=s>>>16&65535|0,d=0;for(;t!==0;){d=t>2e3?2e3:t,t-=d;do a=a+e[o++]|0,c=c+a|0;while(--d);a%=65521,c%=65521}return a|c<<16|0};var adler32_1=adler32;const makeTable=()=>{let s,e=[];for(var t=0;t<256;t++){s=t;for(var o=0;o<8;o++)s=s&1?3988292384^s>>>1:s>>>1;e[t]=s}return e},crcTable=new Uint32Array(makeTable()),crc32=(s,e,t,o)=>{const a=crcTable,c=o+t;s^=-1;for(let d=o;d<c;d++)s=s>>>8^a[(s^e[d])&255];return s^-1};var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init,_tr_stored_block,_tr_flush_block,_tr_tally,_tr_align}=trees,{Z_NO_FLUSH:Z_NO_FLUSH$2,Z_PARTIAL_FLUSH,Z_FULL_FLUSH:Z_FULL_FLUSH$1,Z_FINISH:Z_FINISH$3,Z_BLOCK:Z_BLOCK$1,Z_OK:Z_OK$3,Z_STREAM_END:Z_STREAM_END$3,Z_STREAM_ERROR:Z_STREAM_ERROR$2,Z_DATA_ERROR:Z_DATA_ERROR$2,Z_BUF_ERROR:Z_BUF_ERROR$1,Z_DEFAULT_COMPRESSION:Z_DEFAULT_COMPRESSION$1,Z_FILTERED,Z_HUFFMAN_ONLY,Z_RLE,Z_FIXED,Z_DEFAULT_STRATEGY:Z_DEFAULT_STRATEGY$1,Z_UNKNOWN,Z_DEFLATED:Z_DEFLATED$2}=constants$2,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,GZIP_STATE=57,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3,err=(s,e)=>(s.msg=messages[e],e),rank=s=>s*2-(s>4?9:0),zero=s=>{let e=s.length;for(;--e>=0;)s[e]=0},slide_hash=s=>{let e,t,o,a=s.w_size;e=s.hash_size,o=e;do t=s.head[--o],s.head[o]=t>=a?t-a:0;while(--e);e=a,o=e;do t=s.prev[--o],s.prev[o]=t>=a?t-a:0;while(--e)};let HASH_ZLIB=(s,e,t)=>(e<<s.hash_shift^t)&s.hash_mask,HASH=HASH_ZLIB;const flush_pending=s=>{const e=s.state;let t=e.pending;t>s.avail_out&&(t=s.avail_out),t!==0&&(s.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+t),s.next_out),s.next_out+=t,e.pending_out+=t,s.total_out+=t,s.avail_out-=t,e.pending-=t,e.pending===0&&(e.pending_out=0))},flush_block_only=(s,e)=>{_tr_flush_block(s,s.block_start>=0?s.block_start:-1,s.strstart-s.block_start,e),s.block_start=s.strstart,flush_pending(s.strm)},put_byte=(s,e)=>{s.pending_buf[s.pending++]=e},putShortMSB=(s,e)=>{s.pending_buf[s.pending++]=e>>>8&255,s.pending_buf[s.pending++]=e&255},read_buf=(s,e,t,o)=>{let a=s.avail_in;return a>o&&(a=o),a===0?0:(s.avail_in-=a,e.set(s.input.subarray(s.next_in,s.next_in+a),t),s.state.wrap===1?s.adler=adler32_1(s.adler,e,a,t):s.state.wrap===2&&(s.adler=crc32_1(s.adler,e,a,t)),s.next_in+=a,s.total_in+=a,a)},longest_match=(s,e)=>{let t=s.max_chain_length,o=s.strstart,a,c,d=s.prev_length,g=s.nice_match;const y=s.strstart>s.w_size-MIN_LOOKAHEAD?s.strstart-(s.w_size-MIN_LOOKAHEAD):0,_=s.window,E=s.w_mask,S=s.prev,A=s.strstart+MAX_MATCH;let C=_[o+d-1],N=_[o+d];s.prev_length>=s.good_match&&(t>>=2),g>s.lookahead&&(g=s.lookahead);do if(a=e,!(_[a+d]!==N||_[a+d-1]!==C||_[a]!==_[o]||_[++a]!==_[o+1])){o+=2,a++;do;while(_[++o]===_[++a]&&_[++o]===_[++a]&&_[++o]===_[++a]&&_[++o]===_[++a]&&_[++o]===_[++a]&&_[++o]===_[++a]&&_[++o]===_[++a]&&_[++o]===_[++a]&&o<A);if(c=MAX_MATCH-(A-o),o=A-MAX_MATCH,c>d){if(s.match_start=e,d=c,c>=g)break;C=_[o+d-1],N=_[o+d]}}while((e=S[e&E])>y&&--t!==0);return d<=s.lookahead?d:s.lookahead},fill_window=s=>{const e=s.w_size;let t,o,a;do{if(o=s.window_size-s.lookahead-s.strstart,s.strstart>=e+(e-MIN_LOOKAHEAD)&&(s.window.set(s.window.subarray(e,e+e-o),0),s.match_start-=e,s.strstart-=e,s.block_start-=e,s.insert>s.strstart&&(s.insert=s.strstart),slide_hash(s),o+=e),s.strm.avail_in===0)break;if(t=read_buf(s.strm,s.window,s.strstart+s.lookahead,o),s.lookahead+=t,s.lookahead+s.insert>=MIN_MATCH)for(a=s.strstart-s.insert,s.ins_h=s.window[a],s.ins_h=HASH(s,s.ins_h,s.window[a+1]);s.insert&&(s.ins_h=HASH(s,s.ins_h,s.window[a+MIN_MATCH-1]),s.prev[a&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=a,a++,s.insert--,!(s.lookahead+s.insert<MIN_MATCH)););}while(s.lookahead<MIN_LOOKAHEAD&&s.strm.avail_in!==0)},deflate_stored=(s,e)=>{let t=s.pending_buf_size-5>s.w_size?s.w_size:s.pending_buf_size-5,o,a,c,d=0,g=s.strm.avail_in;do{if(o=65535,c=s.bi_valid+42>>3,s.strm.avail_out<c||(c=s.strm.avail_out-c,a=s.strstart-s.block_start,o>a+s.strm.avail_in&&(o=a+s.strm.avail_in),o>c&&(o=c),o<t&&(o===0&&e!==Z_FINISH$3||e===Z_NO_FLUSH$2||o!==a+s.strm.avail_in)))break;d=e===Z_FINISH$3&&o===a+s.strm.avail_in?1:0,_tr_stored_block(s,0,0,d),s.pending_buf[s.pending-4]=o,s.pending_buf[s.pending-3]=o>>8,s.pending_buf[s.pending-2]=~o,s.pending_buf[s.pending-1]=~o>>8,flush_pending(s.strm),a&&(a>o&&(a=o),s.strm.output.set(s.window.subarray(s.block_start,s.block_start+a),s.strm.next_out),s.strm.next_out+=a,s.strm.avail_out-=a,s.strm.total_out+=a,s.block_start+=a,o-=a),o&&(read_buf(s.strm,s.strm.output,s.strm.next_out,o),s.strm.next_out+=o,s.strm.avail_out-=o,s.strm.total_out+=o)}while(d===0);return g-=s.strm.avail_in,g&&(g>=s.w_size?(s.matches=2,s.window.set(s.strm.input.subarray(s.strm.next_in-s.w_size,s.strm.next_in),0),s.strstart=s.w_size,s.insert=s.strstart):(s.window_size-s.strstart<=g&&(s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,s.insert>s.strstart&&(s.insert=s.strstart)),s.window.set(s.strm.input.subarray(s.strm.next_in-g,s.strm.next_in),s.strstart),s.strstart+=g,s.insert+=g>s.w_size-s.insert?s.w_size-s.insert:g),s.block_start=s.strstart),s.high_water<s.strstart&&(s.high_water=s.strstart),d?BS_FINISH_DONE:e!==Z_NO_FLUSH$2&&e!==Z_FINISH$3&&s.strm.avail_in===0&&s.strstart===s.block_start?BS_BLOCK_DONE:(c=s.window_size-s.strstart,s.strm.avail_in>c&&s.block_start>=s.w_size&&(s.block_start-=s.w_size,s.strstart-=s.w_size,s.window.set(s.window.subarray(s.w_size,s.w_size+s.strstart),0),s.matches<2&&s.matches++,c+=s.w_size,s.insert>s.strstart&&(s.insert=s.strstart)),c>s.strm.avail_in&&(c=s.strm.avail_in),c&&(read_buf(s.strm,s.window,s.strstart,c),s.strstart+=c,s.insert+=c>s.w_size-s.insert?s.w_size-s.insert:c),s.high_water<s.strstart&&(s.high_water=s.strstart),c=s.bi_valid+42>>3,c=s.pending_buf_size-c>65535?65535:s.pending_buf_size-c,t=c>s.w_size?s.w_size:c,a=s.strstart-s.block_start,(a>=t||(a||e===Z_FINISH$3)&&e!==Z_NO_FLUSH$2&&s.strm.avail_in===0&&a<=c)&&(o=a>c?c:a,d=e===Z_FINISH$3&&s.strm.avail_in===0&&o===a?1:0,_tr_stored_block(s,s.block_start,o,d),s.block_start+=o,flush_pending(s.strm)),d?BS_FINISH_STARTED:BS_NEED_MORE)},deflate_fast=(s,e)=>{let t,o;for(;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&e===Z_NO_FLUSH$2)return BS_NEED_MORE;if(s.lookahead===0)break}if(t=0,s.lookahead>=MIN_MATCH&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),t=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),t!==0&&s.strstart-t<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,t)),s.match_length>=MIN_MATCH)if(o=_tr_tally(s,s.strstart-s.match_start,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.match_length<=s.max_lazy_match&&s.lookahead>=MIN_MATCH){s.match_length--;do s.strstart++,s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),t=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart;while(--s.match_length!==0);s.strstart++}else s.strstart+=s.match_length,s.match_length=0,s.ins_h=s.window[s.strstart],s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+1]);else o=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++;if(o&&(flush_block_only(s,!1),s.strm.avail_out===0))return BS_NEED_MORE}return s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,e===Z_FINISH$3?(flush_block_only(s,!0),s.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s.sym_next&&(flush_block_only(s,!1),s.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_slow=(s,e)=>{let t,o,a;for(;;){if(s.lookahead<MIN_LOOKAHEAD){if(fill_window(s),s.lookahead<MIN_LOOKAHEAD&&e===Z_NO_FLUSH$2)return BS_NEED_MORE;if(s.lookahead===0)break}if(t=0,s.lookahead>=MIN_MATCH&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),t=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart),s.prev_length=s.match_length,s.prev_match=s.match_start,s.match_length=MIN_MATCH-1,t!==0&&s.prev_length<s.max_lazy_match&&s.strstart-t<=s.w_size-MIN_LOOKAHEAD&&(s.match_length=longest_match(s,t),s.match_length<=5&&(s.strategy===Z_FILTERED||s.match_length===MIN_MATCH&&s.strstart-s.match_start>4096)&&(s.match_length=MIN_MATCH-1)),s.prev_length>=MIN_MATCH&&s.match_length<=s.prev_length){a=s.strstart+s.lookahead-MIN_MATCH,o=_tr_tally(s,s.strstart-1-s.prev_match,s.prev_length-MIN_MATCH),s.lookahead-=s.prev_length-1,s.prev_length-=2;do++s.strstart<=a&&(s.ins_h=HASH(s,s.ins_h,s.window[s.strstart+MIN_MATCH-1]),t=s.prev[s.strstart&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=s.strstart);while(--s.prev_length!==0);if(s.match_available=0,s.match_length=MIN_MATCH-1,s.strstart++,o&&(flush_block_only(s,!1),s.strm.avail_out===0))return BS_NEED_MORE}else if(s.match_available){if(o=_tr_tally(s,0,s.window[s.strstart-1]),o&&flush_block_only(s,!1),s.strstart++,s.lookahead--,s.strm.avail_out===0)return BS_NEED_MORE}else s.match_available=1,s.strstart++,s.lookahead--}return s.match_available&&(o=_tr_tally(s,0,s.window[s.strstart-1]),s.match_available=0),s.insert=s.strstart<MIN_MATCH-1?s.strstart:MIN_MATCH-1,e===Z_FINISH$3?(flush_block_only(s,!0),s.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s.sym_next&&(flush_block_only(s,!1),s.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_rle=(s,e)=>{let t,o,a,c;const d=s.window;for(;;){if(s.lookahead<=MAX_MATCH){if(fill_window(s),s.lookahead<=MAX_MATCH&&e===Z_NO_FLUSH$2)return BS_NEED_MORE;if(s.lookahead===0)break}if(s.match_length=0,s.lookahead>=MIN_MATCH&&s.strstart>0&&(a=s.strstart-1,o=d[a],o===d[++a]&&o===d[++a]&&o===d[++a])){c=s.strstart+MAX_MATCH;do;while(o===d[++a]&&o===d[++a]&&o===d[++a]&&o===d[++a]&&o===d[++a]&&o===d[++a]&&o===d[++a]&&o===d[++a]&&a<c);s.match_length=MAX_MATCH-(c-a),s.match_length>s.lookahead&&(s.match_length=s.lookahead)}if(s.match_length>=MIN_MATCH?(t=_tr_tally(s,1,s.match_length-MIN_MATCH),s.lookahead-=s.match_length,s.strstart+=s.match_length,s.match_length=0):(t=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++),t&&(flush_block_only(s,!1),s.strm.avail_out===0))return BS_NEED_MORE}return s.insert=0,e===Z_FINISH$3?(flush_block_only(s,!0),s.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s.sym_next&&(flush_block_only(s,!1),s.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE},deflate_huff=(s,e)=>{let t;for(;;){if(s.lookahead===0&&(fill_window(s),s.lookahead===0)){if(e===Z_NO_FLUSH$2)return BS_NEED_MORE;break}if(s.match_length=0,t=_tr_tally(s,0,s.window[s.strstart]),s.lookahead--,s.strstart++,t&&(flush_block_only(s,!1),s.strm.avail_out===0))return BS_NEED_MORE}return s.insert=0,e===Z_FINISH$3?(flush_block_only(s,!0),s.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):s.sym_next&&(flush_block_only(s,!1),s.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE};function Config(s,e,t,o,a){this.good_length=s,this.max_lazy=e,this.nice_length=t,this.max_chain=o,this.func=a}const configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],lm_init=s=>{s.window_size=2*s.w_size,zero(s.head),s.max_lazy_match=configuration_table[s.level].max_lazy,s.good_match=configuration_table[s.level].good_length,s.nice_match=configuration_table[s.level].nice_length,s.max_chain_length=configuration_table[s.level].max_chain,s.strstart=0,s.block_start=0,s.lookahead=0,s.insert=0,s.match_length=s.prev_length=MIN_MATCH-1,s.match_available=0,s.ins_h=0};function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(HEAP_SIZE*2),this.dyn_dtree=new Uint16Array((2*D_CODES+1)*2),this.bl_tree=new Uint16Array((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(MAX_BITS+1),this.heap=new Uint16Array(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*L_CODES+1),zero(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const deflateStateCheck=s=>{if(!s)return 1;const e=s.state;return!e||e.strm!==s||e.status!==INIT_STATE&&e.status!==GZIP_STATE&&e.status!==EXTRA_STATE&&e.status!==NAME_STATE&&e.status!==COMMENT_STATE&&e.status!==HCRC_STATE&&e.status!==BUSY_STATE&&e.status!==FINISH_STATE?1:0},deflateResetKeep=s=>{if(deflateStateCheck(s))return err(s,Z_STREAM_ERROR$2);s.total_in=s.total_out=0,s.data_type=Z_UNKNOWN;const e=s.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap===2?GZIP_STATE:e.wrap?INIT_STATE:BUSY_STATE,s.adler=e.wrap===2?0:1,e.last_flush=-2,_tr_init(e),Z_OK$3},deflateReset=s=>{const e=deflateResetKeep(s);return e===Z_OK$3&&lm_init(s.state),e},deflateSetHeader=(s,e)=>deflateStateCheck(s)||s.state.wrap!==2?Z_STREAM_ERROR$2:(s.state.gzhead=e,Z_OK$3),deflateInit2=(s,e,t,o,a,c)=>{if(!s)return Z_STREAM_ERROR$2;let d=1;if(e===Z_DEFAULT_COMPRESSION$1&&(e=6),o<0?(d=0,o=-o):o>15&&(d=2,o-=16),a<1||a>MAX_MEM_LEVEL||t!==Z_DEFLATED$2||o<8||o>15||e<0||e>9||c<0||c>Z_FIXED||o===8&&d!==1)return err(s,Z_STREAM_ERROR$2);o===8&&(o=9);const g=new DeflateState;return s.state=g,g.strm=s,g.status=INIT_STATE,g.wrap=d,g.gzhead=null,g.w_bits=o,g.w_size=1<<g.w_bits,g.w_mask=g.w_size-1,g.hash_bits=a+7,g.hash_size=1<<g.hash_bits,g.hash_mask=g.hash_size-1,g.hash_shift=~~((g.hash_bits+MIN_MATCH-1)/MIN_MATCH),g.window=new Uint8Array(g.w_size*2),g.head=new Uint16Array(g.hash_size),g.prev=new Uint16Array(g.w_size),g.lit_bufsize=1<<a+6,g.pending_buf_size=g.lit_bufsize*4,g.pending_buf=new Uint8Array(g.pending_buf_size),g.sym_buf=g.lit_bufsize,g.sym_end=(g.lit_bufsize-1)*3,g.level=e,g.strategy=c,g.method=t,deflateReset(s)},deflateInit=(s,e)=>deflateInit2(s,e,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1),deflate$2=(s,e)=>{if(deflateStateCheck(s)||e>Z_BLOCK$1||e<0)return s?err(s,Z_STREAM_ERROR$2):Z_STREAM_ERROR$2;const t=s.state;if(!s.output||s.avail_in!==0&&!s.input||t.status===FINISH_STATE&&e!==Z_FINISH$3)return err(s,s.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$2);const o=t.last_flush;if(t.last_flush=e,t.pending!==0){if(flush_pending(s),s.avail_out===0)return t.last_flush=-1,Z_OK$3}else if(s.avail_in===0&&rank(e)<=rank(o)&&e!==Z_FINISH$3)return err(s,Z_BUF_ERROR$1);if(t.status===FINISH_STATE&&s.avail_in!==0)return err(s,Z_BUF_ERROR$1);if(t.status===INIT_STATE&&t.wrap===0&&(t.status=BUSY_STATE),t.status===INIT_STATE){let a=Z_DEFLATED$2+(t.w_bits-8<<4)<<8,c=-1;if(t.strategy>=Z_HUFFMAN_ONLY||t.level<2?c=0:t.level<6?c=1:t.level===6?c=2:c=3,a|=c<<6,t.strstart!==0&&(a|=PRESET_DICT),a+=31-a%31,putShortMSB(t,a),t.strstart!==0&&(putShortMSB(t,s.adler>>>16),putShortMSB(t,s.adler&65535)),s.adler=1,t.status=BUSY_STATE,flush_pending(s),t.pending!==0)return t.last_flush=-1,Z_OK$3}if(t.status===GZIP_STATE){if(s.adler=0,put_byte(t,31),put_byte(t,139),put_byte(t,8),t.gzhead)put_byte(t,(t.gzhead.text?1:0)+(t.gzhead.hcrc?2:0)+(t.gzhead.extra?4:0)+(t.gzhead.name?8:0)+(t.gzhead.comment?16:0)),put_byte(t,t.gzhead.time&255),put_byte(t,t.gzhead.time>>8&255),put_byte(t,t.gzhead.time>>16&255),put_byte(t,t.gzhead.time>>24&255),put_byte(t,t.level===9?2:t.strategy>=Z_HUFFMAN_ONLY||t.level<2?4:0),put_byte(t,t.gzhead.os&255),t.gzhead.extra&&t.gzhead.extra.length&&(put_byte(t,t.gzhead.extra.length&255),put_byte(t,t.gzhead.extra.length>>8&255)),t.gzhead.hcrc&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending,0)),t.gzindex=0,t.status=EXTRA_STATE;else if(put_byte(t,0),put_byte(t,0),put_byte(t,0),put_byte(t,0),put_byte(t,0),put_byte(t,t.level===9?2:t.strategy>=Z_HUFFMAN_ONLY||t.level<2?4:0),put_byte(t,OS_CODE),t.status=BUSY_STATE,flush_pending(s),t.pending!==0)return t.last_flush=-1,Z_OK$3}if(t.status===EXTRA_STATE){if(t.gzhead.extra){let a=t.pending,c=(t.gzhead.extra.length&65535)-t.gzindex;for(;t.pending+c>t.pending_buf_size;){let g=t.pending_buf_size-t.pending;if(t.pending_buf.set(t.gzhead.extra.subarray(t.gzindex,t.gzindex+g),t.pending),t.pending=t.pending_buf_size,t.gzhead.hcrc&&t.pending>a&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending-a,a)),t.gzindex+=g,flush_pending(s),t.pending!==0)return t.last_flush=-1,Z_OK$3;a=0,c-=g}let d=new Uint8Array(t.gzhead.extra);t.pending_buf.set(d.subarray(t.gzindex,t.gzindex+c),t.pending),t.pending+=c,t.gzhead.hcrc&&t.pending>a&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=NAME_STATE}if(t.status===NAME_STATE){if(t.gzhead.name){let a=t.pending,c;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending-a,a)),flush_pending(s),t.pending!==0)return t.last_flush=-1,Z_OK$3;a=0}t.gzindex<t.gzhead.name.length?c=t.gzhead.name.charCodeAt(t.gzindex++)&255:c=0,put_byte(t,c)}while(c!==0);t.gzhead.hcrc&&t.pending>a&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending-a,a)),t.gzindex=0}t.status=COMMENT_STATE}if(t.status===COMMENT_STATE){if(t.gzhead.comment){let a=t.pending,c;do{if(t.pending===t.pending_buf_size){if(t.gzhead.hcrc&&t.pending>a&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending-a,a)),flush_pending(s),t.pending!==0)return t.last_flush=-1,Z_OK$3;a=0}t.gzindex<t.gzhead.comment.length?c=t.gzhead.comment.charCodeAt(t.gzindex++)&255:c=0,put_byte(t,c)}while(c!==0);t.gzhead.hcrc&&t.pending>a&&(s.adler=crc32_1(s.adler,t.pending_buf,t.pending-a,a))}t.status=HCRC_STATE}if(t.status===HCRC_STATE){if(t.gzhead.hcrc){if(t.pending+2>t.pending_buf_size&&(flush_pending(s),t.pending!==0))return t.last_flush=-1,Z_OK$3;put_byte(t,s.adler&255),put_byte(t,s.adler>>8&255),s.adler=0}if(t.status=BUSY_STATE,flush_pending(s),t.pending!==0)return t.last_flush=-1,Z_OK$3}if(s.avail_in!==0||t.lookahead!==0||e!==Z_NO_FLUSH$2&&t.status!==FINISH_STATE){let a=t.level===0?deflate_stored(t,e):t.strategy===Z_HUFFMAN_ONLY?deflate_huff(t,e):t.strategy===Z_RLE?deflate_rle(t,e):configuration_table[t.level].func(t,e);if((a===BS_FINISH_STARTED||a===BS_FINISH_DONE)&&(t.status=FINISH_STATE),a===BS_NEED_MORE||a===BS_FINISH_STARTED)return s.avail_out===0&&(t.last_flush=-1),Z_OK$3;if(a===BS_BLOCK_DONE&&(e===Z_PARTIAL_FLUSH?_tr_align(t):e!==Z_BLOCK$1&&(_tr_stored_block(t,0,0,!1),e===Z_FULL_FLUSH$1&&(zero(t.head),t.lookahead===0&&(t.strstart=0,t.block_start=0,t.insert=0))),flush_pending(s),s.avail_out===0))return t.last_flush=-1,Z_OK$3}return e!==Z_FINISH$3?Z_OK$3:t.wrap<=0?Z_STREAM_END$3:(t.wrap===2?(put_byte(t,s.adler&255),put_byte(t,s.adler>>8&255),put_byte(t,s.adler>>16&255),put_byte(t,s.adler>>24&255),put_byte(t,s.total_in&255),put_byte(t,s.total_in>>8&255),put_byte(t,s.total_in>>16&255),put_byte(t,s.total_in>>24&255)):(putShortMSB(t,s.adler>>>16),putShortMSB(t,s.adler&65535)),flush_pending(s),t.wrap>0&&(t.wrap=-t.wrap),t.pending!==0?Z_OK$3:Z_STREAM_END$3)},deflateEnd=s=>{if(deflateStateCheck(s))return Z_STREAM_ERROR$2;const e=s.state.status;return s.state=null,e===BUSY_STATE?err(s,Z_DATA_ERROR$2):Z_OK$3},deflateSetDictionary=(s,e)=>{let t=e.length;if(deflateStateCheck(s))return Z_STREAM_ERROR$2;const o=s.state,a=o.wrap;if(a===2||a===1&&o.status!==INIT_STATE||o.lookahead)return Z_STREAM_ERROR$2;if(a===1&&(s.adler=adler32_1(s.adler,e,t,0)),o.wrap=0,t>=o.w_size){a===0&&(zero(o.head),o.strstart=0,o.block_start=0,o.insert=0);let y=new Uint8Array(o.w_size);y.set(e.subarray(t-o.w_size,t),0),e=y,t=o.w_size}const c=s.avail_in,d=s.next_in,g=s.input;for(s.avail_in=t,s.next_in=0,s.input=e,fill_window(o);o.lookahead>=MIN_MATCH;){let y=o.strstart,_=o.lookahead-(MIN_MATCH-1);do o.ins_h=HASH(o,o.ins_h,o.window[y+MIN_MATCH-1]),o.prev[y&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=y,y++;while(--_);o.strstart=y,o.lookahead=MIN_MATCH-1,fill_window(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=MIN_MATCH-1,o.match_available=0,s.next_in=d,s.input=g,s.avail_in=c,o.wrap=a,Z_OK$3};var deflateInit_1=deflateInit,deflateInit2_1=deflateInit2,deflateReset_1=deflateReset,deflateResetKeep_1=deflateResetKeep,deflateSetHeader_1=deflateSetHeader,deflate_2$1=deflate$2,deflateEnd_1=deflateEnd,deflateSetDictionary_1=deflateSetDictionary,deflateInfo="pako deflate (from Nodeca project)",deflate_1$2={deflateInit:deflateInit_1,deflateInit2:deflateInit2_1,deflateReset:deflateReset_1,deflateResetKeep:deflateResetKeep_1,deflateSetHeader:deflateSetHeader_1,deflate:deflate_2$1,deflateEnd:deflateEnd_1,deflateSetDictionary:deflateSetDictionary_1,deflateInfo};const _has=(s,e)=>Object.prototype.hasOwnProperty.call(s,e);var assign=function(s){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const t=e.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(const o in t)_has(t,o)&&(s[o]=t[o])}}return s},flattenChunks=s=>{let e=0;for(let o=0,a=s.length;o<a;o++)e+=s[o].length;const t=new Uint8Array(e);for(let o=0,a=0,c=s.length;o<c;o++){let d=s[o];t.set(d,a),a+=d.length}return t},common$1={assign,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(s){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let s=0;s<256;s++)_utf8len[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=s=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(s);let e,t,o,a,c,d=s.length,g=0;for(a=0;a<d;a++)t=s.charCodeAt(a),(t&64512)===55296&&a+1<d&&(o=s.charCodeAt(a+1),(o&64512)===56320&&(t=65536+(t-55296<<10)+(o-56320),a++)),g+=t<128?1:t<2048?2:t<65536?3:4;for(e=new Uint8Array(g),c=0,a=0;c<g;a++)t=s.charCodeAt(a),(t&64512)===55296&&a+1<d&&(o=s.charCodeAt(a+1),(o&64512)===56320&&(t=65536+(t-55296<<10)+(o-56320),a++)),t<128?e[c++]=t:t<2048?(e[c++]=192|t>>>6,e[c++]=128|t&63):t<65536?(e[c++]=224|t>>>12,e[c++]=128|t>>>6&63,e[c++]=128|t&63):(e[c++]=240|t>>>18,e[c++]=128|t>>>12&63,e[c++]=128|t>>>6&63,e[c++]=128|t&63);return e};const buf2binstring=(s,e)=>{if(e<65534&&s.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,s.length===e?s:s.subarray(0,e));let t="";for(let o=0;o<e;o++)t+=String.fromCharCode(s[o]);return t};var buf2string=(s,e)=>{const t=e||s.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(s.subarray(0,e));let o,a;const c=new Array(t*2);for(a=0,o=0;o<t;){let d=s[o++];if(d<128){c[a++]=d;continue}let g=_utf8len[d];if(g>4){c[a++]=65533,o+=g-1;continue}for(d&=g===2?31:g===3?15:7;g>1&&o<t;)d=d<<6|s[o++]&63,g--;if(g>1){c[a++]=65533;continue}d<65536?c[a++]=d:(d-=65536,c[a++]=55296|d>>10&1023,c[a++]=56320|d&1023)}return buf2binstring(c,a)},utf8border=(s,e)=>{e=e||s.length,e>s.length&&(e=s.length);let t=e-1;for(;t>=0&&(s[t]&192)===128;)t--;return t<0||t===0?e:t+_utf8len[s[t]]>e?t:e},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const toString$1=Object.prototype.toString,{Z_NO_FLUSH:Z_NO_FLUSH$1,Z_SYNC_FLUSH,Z_FULL_FLUSH,Z_FINISH:Z_FINISH$2,Z_OK:Z_OK$2,Z_STREAM_END:Z_STREAM_END$2,Z_DEFAULT_COMPRESSION,Z_DEFAULT_STRATEGY,Z_DEFLATED:Z_DEFLATED$1}=constants$2;function Deflate$1(s){this.options=common$1.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY},s||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let t=deflate_1$2.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(t!==Z_OK$2)throw new Error(messages[t]);if(e.header&&deflate_1$2.deflateSetHeader(this.strm,e.header),e.dictionary){let o;if(typeof e.dictionary=="string"?o=strings.string2buf(e.dictionary):toString$1.call(e.dictionary)==="[object ArrayBuffer]"?o=new Uint8Array(e.dictionary):o=e.dictionary,t=deflate_1$2.deflateSetDictionary(this.strm,o),t!==Z_OK$2)throw new Error(messages[t]);this._dict_set=!0}}Deflate$1.prototype.push=function(s,e){const t=this.strm,o=this.options.chunkSize;let a,c;if(this.ended)return!1;for(e===~~e?c=e:c=e===!0?Z_FINISH$2:Z_NO_FLUSH$1,typeof s=="string"?t.input=strings.string2buf(s):toString$1.call(s)==="[object ArrayBuffer]"?t.input=new Uint8Array(s):t.input=s,t.next_in=0,t.avail_in=t.input.length;;){if(t.avail_out===0&&(t.output=new Uint8Array(o),t.next_out=0,t.avail_out=o),(c===Z_SYNC_FLUSH||c===Z_FULL_FLUSH)&&t.avail_out<=6){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(a=deflate_1$2.deflate(t,c),a===Z_STREAM_END$2)return t.next_out>0&&this.onData(t.output.subarray(0,t.next_out)),a=deflate_1$2.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Z_OK$2;if(t.avail_out===0){this.onData(t.output);continue}if(c>0&&t.next_out>0){this.onData(t.output.subarray(0,t.next_out)),t.avail_out=0;continue}if(t.avail_in===0)break}return!0};Deflate$1.prototype.onData=function(s){this.chunks.push(s)};Deflate$1.prototype.onEnd=function(s){s===Z_OK$2&&(this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};const BAD$1=16209,TYPE$1=16191;var inffast=function s(e,t){let o,a,c,d,g,y,_,E,S,A,C,N,O,I,P,j,B,H,se,oe,Q,fe,Z,ce;const ge=e.state;o=e.next_in,Z=e.input,a=o+(e.avail_in-5),c=e.next_out,ce=e.output,d=c-(t-e.avail_out),g=c+(e.avail_out-257),y=ge.dmax,_=ge.wsize,E=ge.whave,S=ge.wnext,A=ge.window,C=ge.hold,N=ge.bits,O=ge.lencode,I=ge.distcode,P=(1<<ge.lenbits)-1,j=(1<<ge.distbits)-1;e:do{N<15&&(C+=Z[o++]<<N,N+=8,C+=Z[o++]<<N,N+=8),B=O[C&P];t:for(;;){if(H=B>>>24,C>>>=H,N-=H,H=B>>>16&255,H===0)ce[c++]=B&65535;else if(H&16){se=B&65535,H&=15,H&&(N<H&&(C+=Z[o++]<<N,N+=8),se+=C&(1<<H)-1,C>>>=H,N-=H),N<15&&(C+=Z[o++]<<N,N+=8,C+=Z[o++]<<N,N+=8),B=I[C&j];n:for(;;){if(H=B>>>24,C>>>=H,N-=H,H=B>>>16&255,H&16){if(oe=B&65535,H&=15,N<H&&(C+=Z[o++]<<N,N+=8,N<H&&(C+=Z[o++]<<N,N+=8)),oe+=C&(1<<H)-1,oe>y){e.msg="invalid distance too far back",ge.mode=BAD$1;break e}if(C>>>=H,N-=H,H=c-d,oe>H){if(H=oe-H,H>E&&ge.sane){e.msg="invalid distance too far back",ge.mode=BAD$1;break e}if(Q=0,fe=A,S===0){if(Q+=_-H,H<se){se-=H;do ce[c++]=A[Q++];while(--H);Q=c-oe,fe=ce}}else if(S<H){if(Q+=_+S-H,H-=S,H<se){se-=H;do ce[c++]=A[Q++];while(--H);if(Q=0,S<se){H=S,se-=H;do ce[c++]=A[Q++];while(--H);Q=c-oe,fe=ce}}}else if(Q+=S-H,H<se){se-=H;do ce[c++]=A[Q++];while(--H);Q=c-oe,fe=ce}for(;se>2;)ce[c++]=fe[Q++],ce[c++]=fe[Q++],ce[c++]=fe[Q++],se-=3;se&&(ce[c++]=fe[Q++],se>1&&(ce[c++]=fe[Q++]))}else{Q=c-oe;do ce[c++]=ce[Q++],ce[c++]=ce[Q++],ce[c++]=ce[Q++],se-=3;while(se>2);se&&(ce[c++]=ce[Q++],se>1&&(ce[c++]=ce[Q++]))}}else if(H&64){e.msg="invalid distance code",ge.mode=BAD$1;break e}else{B=I[(B&65535)+(C&(1<<H)-1)];continue n}break}}else if(H&64)if(H&32){ge.mode=TYPE$1;break e}else{e.msg="invalid literal/length code",ge.mode=BAD$1;break e}else{B=O[(B&65535)+(C&(1<<H)-1)];continue t}break}}while(o<a&&c<g);se=N>>3,o-=se,N-=se<<3,C&=(1<<N)-1,e.next_in=o,e.next_out=c,e.avail_in=o<a?5+(a-o):5-(o-a),e.avail_out=c<g?257+(g-c):257-(c-g),ge.hold=C,ge.bits=N};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(s,e,t,o,a,c,d,g)=>{const y=g.bits;let _=0,E=0,S=0,A=0,C=0,N=0,O=0,I=0,P=0,j=0,B,H,se,oe,Q,fe=null,Z;const ce=new Uint16Array(MAXBITS+1),ge=new Uint16Array(MAXBITS+1);let me=null,V,R,L;for(_=0;_<=MAXBITS;_++)ce[_]=0;for(E=0;E<o;E++)ce[e[t+E]]++;for(C=y,A=MAXBITS;A>=1&&ce[A]===0;A--);if(C>A&&(C=A),A===0)return a[c++]=1<<24|64<<16|0,a[c++]=1<<24|64<<16|0,g.bits=1,0;for(S=1;S<A&&ce[S]===0;S++);for(C<S&&(C=S),I=1,_=1;_<=MAXBITS;_++)if(I<<=1,I-=ce[_],I<0)return-1;if(I>0&&(s===CODES$1||A!==1))return-1;for(ge[1]=0,_=1;_<MAXBITS;_++)ge[_+1]=ge[_]+ce[_];for(E=0;E<o;E++)e[t+E]!==0&&(d[ge[e[t+E]]++]=E);if(s===CODES$1?(fe=me=d,Z=20):s===LENS$1?(fe=lbase,me=lext,Z=257):(fe=dbase,me=dext,Z=0),j=0,E=0,_=S,Q=c,N=C,O=0,se=-1,P=1<<C,oe=P-1,s===LENS$1&&P>ENOUGH_LENS$1||s===DISTS$1&&P>ENOUGH_DISTS$1)return 1;for(;;){V=_-O,d[E]+1<Z?(R=0,L=d[E]):d[E]>=Z?(R=me[d[E]-Z],L=fe[d[E]-Z]):(R=32+64,L=0),B=1<<_-O,H=1<<N,S=H;do H-=B,a[Q+(j>>O)+H]=V<<24|R<<16|L|0;while(H!==0);for(B=1<<_-1;j&B;)B>>=1;if(B!==0?(j&=B-1,j+=B):j=0,E++,--ce[_]===0){if(_===A)break;_=e[t+d[E]]}if(_>C&&(j&oe)!==se){for(O===0&&(O=C),Q+=S,N=_-O,I=1<<N;N+O<A&&(I-=ce[N+O],!(I<=0));)N++,I<<=1;if(P+=1<<N,s===LENS$1&&P>ENOUGH_LENS$1||s===DISTS$1&&P>ENOUGH_DISTS$1)return 1;se=j&oe,a[se]=C<<24|N<<16|Q-c|0}}return j!==0&&(a[Q+j]=_-O<<24|64<<16|0),g.bits=C,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=s=>(s>>>24&255)+(s>>>8&65280)+((s&65280)<<8)+((s&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=s=>{if(!s)return 1;const e=s.state;return!e||e.strm!==s||e.mode<HEAD||e.mode>SYNC?1:0},inflateResetKeep=s=>{if(inflateStateCheck(s))return Z_STREAM_ERROR$1;const e=s.state;return s.total_in=s.total_out=e.total=0,s.msg="",e.wrap&&(s.adler=e.wrap&1),e.mode=HEAD,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(ENOUGH_LENS),e.distcode=e.distdyn=new Int32Array(ENOUGH_DISTS),e.sane=1,e.back=-1,Z_OK$1},inflateReset=s=>{if(inflateStateCheck(s))return Z_STREAM_ERROR$1;const e=s.state;return e.wsize=0,e.whave=0,e.wnext=0,inflateResetKeep(s)},inflateReset2=(s,e)=>{let t;if(inflateStateCheck(s))return Z_STREAM_ERROR$1;const o=s.state;return e<0?(t=0,e=-e):(t=(e>>4)+5,e<48&&(e&=15)),e&&(e<8||e>15)?Z_STREAM_ERROR$1:(o.window!==null&&o.wbits!==e&&(o.window=null),o.wrap=t,o.wbits=e,inflateReset(s))},inflateInit2=(s,e)=>{if(!s)return Z_STREAM_ERROR$1;const t=new InflateState;s.state=t,t.strm=s,t.window=null,t.mode=HEAD;const o=inflateReset2(s,e);return o!==Z_OK$1&&(s.state=null),o},inflateInit=s=>inflateInit2(s,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=s=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let e=0;for(;e<144;)s.lens[e++]=8;for(;e<256;)s.lens[e++]=9;for(;e<280;)s.lens[e++]=7;for(;e<288;)s.lens[e++]=8;for(inftrees(LENS,s.lens,0,288,lenfix,0,s.work,{bits:9}),e=0;e<32;)s.lens[e++]=5;inftrees(DISTS,s.lens,0,32,distfix,0,s.work,{bits:5}),virgin=!1}s.lencode=lenfix,s.lenbits=9,s.distcode=distfix,s.distbits=5},updatewindow=(s,e,t,o)=>{let a;const c=s.state;return c.window===null&&(c.wsize=1<<c.wbits,c.wnext=0,c.whave=0,c.window=new Uint8Array(c.wsize)),o>=c.wsize?(c.window.set(e.subarray(t-c.wsize,t),0),c.wnext=0,c.whave=c.wsize):(a=c.wsize-c.wnext,a>o&&(a=o),c.window.set(e.subarray(t-o,t-o+a),c.wnext),o-=a,o?(c.window.set(e.subarray(t-o,t),0),c.wnext=o,c.whave=c.wsize):(c.wnext+=a,c.wnext===c.wsize&&(c.wnext=0),c.whave<c.wsize&&(c.whave+=a))),0},inflate$2=(s,e)=>{let t,o,a,c,d,g,y,_,E,S,A,C,N,O,I=0,P,j,B,H,se,oe,Q,fe;const Z=new Uint8Array(4);let ce,ge;const me=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(s)||!s.output||!s.input&&s.avail_in!==0)return Z_STREAM_ERROR$1;t=s.state,t.mode===TYPE&&(t.mode=TYPEDO),d=s.next_out,a=s.output,y=s.avail_out,c=s.next_in,o=s.input,g=s.avail_in,_=t.hold,E=t.bits,S=g,A=y,fe=Z_OK$1;e:for(;;)switch(t.mode){case HEAD:if(t.wrap===0){t.mode=TYPEDO;break}for(;E<16;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(t.wrap&2&&_===35615){t.wbits===0&&(t.wbits=15),t.check=0,Z[0]=_&255,Z[1]=_>>>8&255,t.check=crc32_1(t.check,Z,2,0),_=0,E=0,t.mode=FLAGS;break}if(t.head&&(t.head.done=!1),!(t.wrap&1)||(((_&255)<<8)+(_>>8))%31){s.msg="incorrect header check",t.mode=BAD;break}if((_&15)!==Z_DEFLATED){s.msg="unknown compression method",t.mode=BAD;break}if(_>>>=4,E-=4,Q=(_&15)+8,t.wbits===0&&(t.wbits=Q),Q>15||Q>t.wbits){s.msg="invalid window size",t.mode=BAD;break}t.dmax=1<<t.wbits,t.flags=0,s.adler=t.check=1,t.mode=_&512?DICTID:TYPE,_=0,E=0;break;case FLAGS:for(;E<16;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(t.flags=_,(t.flags&255)!==Z_DEFLATED){s.msg="unknown compression method",t.mode=BAD;break}if(t.flags&57344){s.msg="unknown header flags set",t.mode=BAD;break}t.head&&(t.head.text=_>>8&1),t.flags&512&&t.wrap&4&&(Z[0]=_&255,Z[1]=_>>>8&255,t.check=crc32_1(t.check,Z,2,0)),_=0,E=0,t.mode=TIME;case TIME:for(;E<32;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}t.head&&(t.head.time=_),t.flags&512&&t.wrap&4&&(Z[0]=_&255,Z[1]=_>>>8&255,Z[2]=_>>>16&255,Z[3]=_>>>24&255,t.check=crc32_1(t.check,Z,4,0)),_=0,E=0,t.mode=OS;case OS:for(;E<16;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}t.head&&(t.head.xflags=_&255,t.head.os=_>>8),t.flags&512&&t.wrap&4&&(Z[0]=_&255,Z[1]=_>>>8&255,t.check=crc32_1(t.check,Z,2,0)),_=0,E=0,t.mode=EXLEN;case EXLEN:if(t.flags&1024){for(;E<16;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}t.length=_,t.head&&(t.head.extra_len=_),t.flags&512&&t.wrap&4&&(Z[0]=_&255,Z[1]=_>>>8&255,t.check=crc32_1(t.check,Z,2,0)),_=0,E=0}else t.head&&(t.head.extra=null);t.mode=EXTRA;case EXTRA:if(t.flags&1024&&(C=t.length,C>g&&(C=g),C&&(t.head&&(Q=t.head.extra_len-t.length,t.head.extra||(t.head.extra=new Uint8Array(t.head.extra_len)),t.head.extra.set(o.subarray(c,c+C),Q)),t.flags&512&&t.wrap&4&&(t.check=crc32_1(t.check,o,C,c)),g-=C,c+=C,t.length-=C),t.length))break e;t.length=0,t.mode=NAME;case NAME:if(t.flags&2048){if(g===0)break e;C=0;do Q=o[c+C++],t.head&&Q&&t.length<65536&&(t.head.name+=String.fromCharCode(Q));while(Q&&C<g);if(t.flags&512&&t.wrap&4&&(t.check=crc32_1(t.check,o,C,c)),g-=C,c+=C,Q)break e}else t.head&&(t.head.name=null);t.length=0,t.mode=COMMENT;case COMMENT:if(t.flags&4096){if(g===0)break e;C=0;do Q=o[c+C++],t.head&&Q&&t.length<65536&&(t.head.comment+=String.fromCharCode(Q));while(Q&&C<g);if(t.flags&512&&t.wrap&4&&(t.check=crc32_1(t.check,o,C,c)),g-=C,c+=C,Q)break e}else t.head&&(t.head.comment=null);t.mode=HCRC;case HCRC:if(t.flags&512){for(;E<16;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(t.wrap&4&&_!==(t.check&65535)){s.msg="header crc mismatch",t.mode=BAD;break}_=0,E=0}t.head&&(t.head.hcrc=t.flags>>9&1,t.head.done=!0),s.adler=t.check=0,t.mode=TYPE;break;case DICTID:for(;E<32;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}s.adler=t.check=zswap32(_),_=0,E=0,t.mode=DICT;case DICT:if(t.havedict===0)return s.next_out=d,s.avail_out=y,s.next_in=c,s.avail_in=g,t.hold=_,t.bits=E,Z_NEED_DICT$1;s.adler=t.check=1,t.mode=TYPE;case TYPE:if(e===Z_BLOCK||e===Z_TREES)break e;case TYPEDO:if(t.last){_>>>=E&7,E-=E&7,t.mode=CHECK;break}for(;E<3;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}switch(t.last=_&1,_>>>=1,E-=1,_&3){case 0:t.mode=STORED;break;case 1:if(fixedtables(t),t.mode=LEN_,e===Z_TREES){_>>>=2,E-=2;break e}break;case 2:t.mode=TABLE;break;case 3:s.msg="invalid block type",t.mode=BAD}_>>>=2,E-=2;break;case STORED:for(_>>>=E&7,E-=E&7;E<32;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if((_&65535)!==(_>>>16^65535)){s.msg="invalid stored block lengths",t.mode=BAD;break}if(t.length=_&65535,_=0,E=0,t.mode=COPY_,e===Z_TREES)break e;case COPY_:t.mode=COPY;case COPY:if(C=t.length,C){if(C>g&&(C=g),C>y&&(C=y),C===0)break e;a.set(o.subarray(c,c+C),d),g-=C,c+=C,y-=C,d+=C,t.length-=C;break}t.mode=TYPE;break;case TABLE:for(;E<14;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(t.nlen=(_&31)+257,_>>>=5,E-=5,t.ndist=(_&31)+1,_>>>=5,E-=5,t.ncode=(_&15)+4,_>>>=4,E-=4,t.nlen>286||t.ndist>30){s.msg="too many length or distance symbols",t.mode=BAD;break}t.have=0,t.mode=LENLENS;case LENLENS:for(;t.have<t.ncode;){for(;E<3;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}t.lens[me[t.have++]]=_&7,_>>>=3,E-=3}for(;t.have<19;)t.lens[me[t.have++]]=0;if(t.lencode=t.lendyn,t.lenbits=7,ce={bits:t.lenbits},fe=inftrees(CODES,t.lens,0,19,t.lencode,0,t.work,ce),t.lenbits=ce.bits,fe){s.msg="invalid code lengths set",t.mode=BAD;break}t.have=0,t.mode=CODELENS;case CODELENS:for(;t.have<t.nlen+t.ndist;){for(;I=t.lencode[_&(1<<t.lenbits)-1],P=I>>>24,j=I>>>16&255,B=I&65535,!(P<=E);){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(B<16)_>>>=P,E-=P,t.lens[t.have++]=B;else{if(B===16){for(ge=P+2;E<ge;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(_>>>=P,E-=P,t.have===0){s.msg="invalid bit length repeat",t.mode=BAD;break}Q=t.lens[t.have-1],C=3+(_&3),_>>>=2,E-=2}else if(B===17){for(ge=P+3;E<ge;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}_>>>=P,E-=P,Q=0,C=3+(_&7),_>>>=3,E-=3}else{for(ge=P+7;E<ge;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}_>>>=P,E-=P,Q=0,C=11+(_&127),_>>>=7,E-=7}if(t.have+C>t.nlen+t.ndist){s.msg="invalid bit length repeat",t.mode=BAD;break}for(;C--;)t.lens[t.have++]=Q}}if(t.mode===BAD)break;if(t.lens[256]===0){s.msg="invalid code -- missing end-of-block",t.mode=BAD;break}if(t.lenbits=9,ce={bits:t.lenbits},fe=inftrees(LENS,t.lens,0,t.nlen,t.lencode,0,t.work,ce),t.lenbits=ce.bits,fe){s.msg="invalid literal/lengths set",t.mode=BAD;break}if(t.distbits=6,t.distcode=t.distdyn,ce={bits:t.distbits},fe=inftrees(DISTS,t.lens,t.nlen,t.ndist,t.distcode,0,t.work,ce),t.distbits=ce.bits,fe){s.msg="invalid distances set",t.mode=BAD;break}if(t.mode=LEN_,e===Z_TREES)break e;case LEN_:t.mode=LEN;case LEN:if(g>=6&&y>=258){s.next_out=d,s.avail_out=y,s.next_in=c,s.avail_in=g,t.hold=_,t.bits=E,inffast(s,A),d=s.next_out,a=s.output,y=s.avail_out,c=s.next_in,o=s.input,g=s.avail_in,_=t.hold,E=t.bits,t.mode===TYPE&&(t.back=-1);break}for(t.back=0;I=t.lencode[_&(1<<t.lenbits)-1],P=I>>>24,j=I>>>16&255,B=I&65535,!(P<=E);){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(j&&!(j&240)){for(H=P,se=j,oe=B;I=t.lencode[oe+((_&(1<<H+se)-1)>>H)],P=I>>>24,j=I>>>16&255,B=I&65535,!(H+P<=E);){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}_>>>=H,E-=H,t.back+=H}if(_>>>=P,E-=P,t.back+=P,t.length=B,j===0){t.mode=LIT;break}if(j&32){t.back=-1,t.mode=TYPE;break}if(j&64){s.msg="invalid literal/length code",t.mode=BAD;break}t.extra=j&15,t.mode=LENEXT;case LENEXT:if(t.extra){for(ge=t.extra;E<ge;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}t.length+=_&(1<<t.extra)-1,_>>>=t.extra,E-=t.extra,t.back+=t.extra}t.was=t.length,t.mode=DIST;case DIST:for(;I=t.distcode[_&(1<<t.distbits)-1],P=I>>>24,j=I>>>16&255,B=I&65535,!(P<=E);){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(!(j&240)){for(H=P,se=j,oe=B;I=t.distcode[oe+((_&(1<<H+se)-1)>>H)],P=I>>>24,j=I>>>16&255,B=I&65535,!(H+P<=E);){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}_>>>=H,E-=H,t.back+=H}if(_>>>=P,E-=P,t.back+=P,j&64){s.msg="invalid distance code",t.mode=BAD;break}t.offset=B,t.extra=j&15,t.mode=DISTEXT;case DISTEXT:if(t.extra){for(ge=t.extra;E<ge;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}t.offset+=_&(1<<t.extra)-1,_>>>=t.extra,E-=t.extra,t.back+=t.extra}if(t.offset>t.dmax){s.msg="invalid distance too far back",t.mode=BAD;break}t.mode=MATCH;case MATCH:if(y===0)break e;if(C=A-y,t.offset>C){if(C=t.offset-C,C>t.whave&&t.sane){s.msg="invalid distance too far back",t.mode=BAD;break}C>t.wnext?(C-=t.wnext,N=t.wsize-C):N=t.wnext-C,C>t.length&&(C=t.length),O=t.window}else O=a,N=d-t.offset,C=t.length;C>y&&(C=y),y-=C,t.length-=C;do a[d++]=O[N++];while(--C);t.length===0&&(t.mode=LEN);break;case LIT:if(y===0)break e;a[d++]=t.length,y--,t.mode=LEN;break;case CHECK:if(t.wrap){for(;E<32;){if(g===0)break e;g--,_|=o[c++]<<E,E+=8}if(A-=y,s.total_out+=A,t.total+=A,t.wrap&4&&A&&(s.adler=t.check=t.flags?crc32_1(t.check,a,A,d-A):adler32_1(t.check,a,A,d-A)),A=y,t.wrap&4&&(t.flags?_:zswap32(_))!==t.check){s.msg="incorrect data check",t.mode=BAD;break}_=0,E=0}t.mode=LENGTH;case LENGTH:if(t.wrap&&t.flags){for(;E<32;){if(g===0)break e;g--,_+=o[c++]<<E,E+=8}if(t.wrap&4&&_!==(t.total&4294967295)){s.msg="incorrect length check",t.mode=BAD;break}_=0,E=0}t.mode=DONE;case DONE:fe=Z_STREAM_END$1;break e;case BAD:fe=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return s.next_out=d,s.avail_out=y,s.next_in=c,s.avail_in=g,t.hold=_,t.bits=E,(t.wsize||A!==s.avail_out&&t.mode<BAD&&(t.mode<CHECK||e!==Z_FINISH$1))&&updatewindow(s,s.output,s.next_out,A-s.avail_out),S-=s.avail_in,A-=s.avail_out,s.total_in+=S,s.total_out+=A,t.total+=A,t.wrap&4&&A&&(s.adler=t.check=t.flags?crc32_1(t.check,a,A,s.next_out-A):adler32_1(t.check,a,A,s.next_out-A)),s.data_type=t.bits+(t.last?64:0)+(t.mode===TYPE?128:0)+(t.mode===LEN_||t.mode===COPY_?256:0),(S===0&&A===0||e===Z_FINISH$1)&&fe===Z_OK$1&&(fe=Z_BUF_ERROR),fe},inflateEnd=s=>{if(inflateStateCheck(s))return Z_STREAM_ERROR$1;let e=s.state;return e.window&&(e.window=null),s.state=null,Z_OK$1},inflateGetHeader=(s,e)=>{if(inflateStateCheck(s))return Z_STREAM_ERROR$1;const t=s.state;return t.wrap&2?(t.head=e,e.done=!1,Z_OK$1):Z_STREAM_ERROR$1},inflateSetDictionary=(s,e)=>{const t=e.length;let o,a,c;return inflateStateCheck(s)||(o=s.state,o.wrap!==0&&o.mode!==DICT)?Z_STREAM_ERROR$1:o.mode===DICT&&(a=1,a=adler32_1(a,e,t,0),a!==o.check)?Z_DATA_ERROR$1:(c=updatewindow(s,e,t,t),c?(o.mode=MEM,Z_MEM_ERROR$1):(o.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(s){this.options=common$1.assign({chunkSize:1024*64,windowBits:15,to:""},s||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(s&&s.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let t=inflate_1$2.inflateInit2(this.strm,e.windowBits);if(t!==Z_OK)throw new Error(messages[t]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=strings.string2buf(e.dictionary):toString.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(t=inflate_1$2.inflateSetDictionary(this.strm,e.dictionary),t!==Z_OK)))throw new Error(messages[t])}Inflate$1.prototype.push=function(s,e){const t=this.strm,o=this.options.chunkSize,a=this.options.dictionary;let c,d,g;if(this.ended)return!1;for(e===~~e?d=e:d=e===!0?Z_FINISH:Z_NO_FLUSH,toString.call(s)==="[object ArrayBuffer]"?t.input=new Uint8Array(s):t.input=s,t.next_in=0,t.avail_in=t.input.length;;){for(t.avail_out===0&&(t.output=new Uint8Array(o),t.next_out=0,t.avail_out=o),c=inflate_1$2.inflate(t,d),c===Z_NEED_DICT&&a&&(c=inflate_1$2.inflateSetDictionary(t,a),c===Z_OK?c=inflate_1$2.inflate(t,d):c===Z_DATA_ERROR&&(c=Z_NEED_DICT));t.avail_in>0&&c===Z_STREAM_END&&t.state.wrap>0&&s[t.next_in]!==0;)inflate_1$2.inflateReset(t),c=inflate_1$2.inflate(t,d);switch(c){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(c),this.ended=!0,!1}if(g=t.avail_out,t.next_out&&(t.avail_out===0||c===Z_STREAM_END))if(this.options.to==="string"){let y=strings.utf8border(t.output,t.next_out),_=t.next_out-y,E=strings.buf2string(t.output,y);t.next_out=_,t.avail_out=o-_,_&&t.output.set(t.output.subarray(y,y+_),0),this.onData(E)}else this.onData(t.output.length===t.next_out?t.output:t.output.subarray(0,t.next_out));if(!(c===Z_OK&&g===0)){if(c===Z_STREAM_END)return c=inflate_1$2.inflateEnd(this.strm),this.onEnd(c),this.ended=!0,!0;if(t.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(s){this.chunks.push(s)};Inflate$1.prototype.onEnd=function(s){s===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common$1.flattenChunks(this.chunks)),this.chunks=[],this.err=s,this.msg=this.strm.msg};function inflate$1(s,e){const t=new Inflate$1(e);if(t.push(s),t.err)throw t.msg||messages[t.err];return t.result}function inflateRaw$1(s,e){return e=e||{},e.raw=!0,inflate$1(s,e)}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflateRaw_1$1=inflateRaw$1,ungzip$1=inflate$1,constants=constants$2,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2,inflateRaw:inflateRaw_1$1,ungzip:ungzip$1,constants};const{Inflate,inflate,inflateRaw,ungzip}=inflate_1$1;var inflate_1=inflate,eventemitter3={exports:{}};(function(s){var e=Object.prototype.hasOwnProperty,t="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(t=!1));function a(y,_,E){this.fn=y,this.context=_,this.once=E||!1}function c(y,_,E,S,A){if(typeof E!="function")throw new TypeError("The listener must be a function");var C=new a(E,S||y,A),N=t?t+_:_;return y._events[N]?y._events[N].fn?y._events[N]=[y._events[N],C]:y._events[N].push(C):(y._events[N]=C,y._eventsCount++),y}function d(y,_){--y._eventsCount===0?y._events=new o:delete y._events[_]}function g(){this._events=new o,this._eventsCount=0}g.prototype.eventNames=function(){var _=[],E,S;if(this._eventsCount===0)return _;for(S in E=this._events)e.call(E,S)&&_.push(t?S.slice(1):S);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(E)):_},g.prototype.listeners=function(_){var E=t?t+_:_,S=this._events[E];if(!S)return[];if(S.fn)return[S.fn];for(var A=0,C=S.length,N=new Array(C);A<C;A++)N[A]=S[A].fn;return N},g.prototype.listenerCount=function(_){var E=t?t+_:_,S=this._events[E];return S?S.fn?1:S.length:0},g.prototype.emit=function(_,E,S,A,C,N){var O=t?t+_:_;if(!this._events[O])return!1;var I=this._events[O],P=arguments.length,j,B;if(I.fn){switch(I.once&&this.removeListener(_,I.fn,void 0,!0),P){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,E),!0;case 3:return I.fn.call(I.context,E,S),!0;case 4:return I.fn.call(I.context,E,S,A),!0;case 5:return I.fn.call(I.context,E,S,A,C),!0;case 6:return I.fn.call(I.context,E,S,A,C,N),!0}for(B=1,j=new Array(P-1);B<P;B++)j[B-1]=arguments[B];I.fn.apply(I.context,j)}else{var H=I.length,se;for(B=0;B<H;B++)switch(I[B].once&&this.removeListener(_,I[B].fn,void 0,!0),P){case 1:I[B].fn.call(I[B].context);break;case 2:I[B].fn.call(I[B].context,E);break;case 3:I[B].fn.call(I[B].context,E,S);break;case 4:I[B].fn.call(I[B].context,E,S,A);break;default:if(!j)for(se=1,j=new Array(P-1);se<P;se++)j[se-1]=arguments[se];I[B].fn.apply(I[B].context,j)}}return!0},g.prototype.on=function(_,E,S){return c(this,_,E,S,!1)},g.prototype.once=function(_,E,S){return c(this,_,E,S,!0)},g.prototype.removeListener=function(_,E,S,A){var C=t?t+_:_;if(!this._events[C])return this;if(!E)return d(this,C),this;var N=this._events[C];if(N.fn)N.fn===E&&(!A||N.once)&&(!S||N.context===S)&&d(this,C);else{for(var O=0,I=[],P=N.length;O<P;O++)(N[O].fn!==E||A&&!N[O].once||S&&N[O].context!==S)&&I.push(N[O]);I.length?this._events[C]=I.length===1?I[0]:I:d(this,C)}return this},g.prototype.removeAllListeners=function(_){var E;return _?(E=t?t+_:_,this._events[E]&&d(this,E)):(this._events=new o,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=t,g.EventEmitter=g,s.exports=g})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter$1=getDefaultExportFromCjs$1(eventemitter3Exports);function chunks(s,e){return Array.apply(0,new Array(Math.ceil(s.length/e))).map((t,o)=>s.slice(o*e,(o+1)*e))}function decode$2(s){return new TextDecoder("utf-8").decode(s)}function encode$2(s){return new TextEncoder().encode(s)}function encode$1(s){return bs58$1.encode(s)}function decode(s){return buffer.Buffer.from(toByteArray_1(s))}function parseIdlErrors(s){const e=new Map;return s.errors&&s.errors.forEach(t=>{var o;let a=(o=t.msg)!==null&&o!==void 0?o:t.name;e.set(t.code,a)}),e}function toInstruction(s,...e){if(s.args.length!=e.length)throw new Error("Invalid argument length");const t={};let o=0;return s.args.forEach(a=>{t[a.name]=e[o],o+=1}),t}function validateAccounts(s,e={}){s.forEach(t=>{if("accounts"in t)validateAccounts(t.accounts,e[t.name]);else if(e[t.name]===void 0)throw new Error(`Invalid arguments: ${t.name} not provided.`)})}function translateAddress(s){return s instanceof PublicKey?s:new PublicKey(s)}class StructError extends TypeError{constructor(e,t){let o;const{message:a,...c}=e,{path:d}=e,g=d.length===0?a:"At path: "+d.join(".")+" -- "+a;super(g),this.value=void 0,this.key=void 0,this.type=void 0,this.refinement=void 0,this.path=void 0,this.branch=void 0,this.failures=void 0,Object.assign(this,c),this.name=this.constructor.name,this.failures=()=>{var y;return(y=o)!=null?y:o=[e,...t()]}}}function isIterable(s){return isObject(s)&&typeof s[Symbol.iterator]=="function"}function isObject(s){return typeof s=="object"&&s!=null}function print(s){return typeof s=="string"?JSON.stringify(s):""+s}function shiftIterator(s){const{done:e,value:t}=s.next();return e?void 0:t}function toFailure(s,e,t,o){if(s===!0)return;s===!1?s={}:typeof s=="string"&&(s={message:s});const{path:a,branch:c}=e,{type:d}=t,{refinement:g,message:y="Expected a value of type `"+d+"`"+(g?" with refinement `"+g+"`":"")+", but received: `"+print(o)+"`"}=s;return{value:o,type:d,refinement:g,key:a[a.length-1],path:a,branch:c,...s,message:y}}function*toFailures(s,e,t,o){isIterable(s)||(s=[s]);for(const a of s){const c=toFailure(a,e,t,o);c&&(yield c)}}function*run(s,e,t){t===void 0&&(t={});const{path:o=[],branch:a=[s],coerce:c=!1,mask:d=!1}=t,g={path:o,branch:a};if(c&&(s=e.coercer(s,g),d&&e.type!=="type"&&isObject(e.schema)&&isObject(s)&&!Array.isArray(s)))for(const _ in s)e.schema[_]===void 0&&delete s[_];let y=!0;for(const _ of e.validator(s,g))y=!1,yield[_,void 0];for(let[_,E,S]of e.entries(s,g)){const A=run(E,S,{path:_===void 0?o:[...o,_],branch:_===void 0?a:[...a,E],coerce:c,mask:d});for(const C of A)C[0]?(y=!1,yield[C[0],void 0]):c&&(E=C[1],_===void 0?s=E:s instanceof Map?s.set(_,E):s instanceof Set?s.add(E):isObject(s)&&(s[_]=E))}if(y)for(const _ of e.refiner(s,g))y=!1,yield[_,void 0];y&&(yield[void 0,s])}class Struct{constructor(e){this.TYPE=void 0,this.type=void 0,this.schema=void 0,this.coercer=void 0,this.validator=void 0,this.refiner=void 0,this.entries=void 0;const{type:t,schema:o,validator:a,refiner:c,coercer:d=y=>y,entries:g=function*(){}}=e;this.type=t,this.schema=o,this.entries=g,this.coercer=d,a?this.validator=(y,_)=>{const E=a(y,_);return toFailures(E,_,this,y)}:this.validator=()=>[],c?this.refiner=(y,_)=>{const E=c(y,_);return toFailures(E,_,this,y)}:this.refiner=()=>[]}assert(e){return assert(e,this)}create(e){return create(e,this)}is(e){return is(e,this)}mask(e){return mask(e,this)}validate(e,t){return t===void 0&&(t={}),validate(e,this,t)}}function assert(s,e){const t=validate(s,e);if(t[0])throw t[0]}function create(s,e){const t=validate(s,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function mask(s,e){const t=validate(s,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function is(s,e){return!validate(s,e)[0]}function validate(s,e,t){t===void 0&&(t={});const o=run(s,e,t),a=shiftIterator(o);return a[0]?[new StructError(a[0],function*(){for(const d of o)d[0]&&(yield d[0])}),void 0]:[void 0,a[1]]}function define(s,e){return new Struct({type:s,schema:null,validator:e})}function any(){return define("any",()=>!0)}function array(s){return new Struct({type:"array",schema:s,*entries(e){if(s&&Array.isArray(e))for(const[t,o]of e.entries())yield[t,o,s]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+print(e)}})}function boolean(){return define("boolean",s=>typeof s=="boolean")}function literal(s){const e=print(s),t=typeof s;return new Struct({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?s:null,validator(o){return o===s||"Expected the literal `"+e+"`, but received: "+print(o)}})}function nullable(s){return new Struct({...s,validator:(e,t)=>e===null||s.validator(e,t),refiner:(e,t)=>e===null||s.refiner(e,t)})}function number$1(){return define("number",s=>typeof s=="number"&&!isNaN(s)||"Expected a number, but received: "+print(s))}function optional(s){return new Struct({...s,validator:(e,t)=>e===void 0||s.validator(e,t),refiner:(e,t)=>e===void 0||s.refiner(e,t)})}function string(){return define("string",s=>typeof s=="string"||"Expected a string, but received: "+print(s))}function type(s){const e=Object.keys(s);return new Struct({type:"type",schema:s,*entries(t){if(isObject(t))for(const o of e)yield[o,t[o],s[o]]},validator(t){return isObject(t)||"Expected an object, but received: "+print(t)}})}function union$1(s){const e=s.map(t=>t.type).join(" | ");return new Struct({type:"union",schema:null,coercer(t,o){return(s.find(c=>{const[d]=c.validate(t,{coerce:!0});return!d})||unknown()).coercer(t,o)},validator(t,o){const a=[];for(const c of s){const[...d]=run(t,c,o),[g]=d;if(g[0])for(const[y]of d)y&&a.push(y);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+print(t),...a]}})}function unknown(){return define("unknown",()=>!0)}function coerce(s,e,t){return new Struct({...s,coercer:(o,a)=>is(o,e)?s.coercer(t(o,a),a):s.coercer(o,a)})}const GET_MULTIPLE_ACCOUNTS_LIMIT=99;async function getMultipleAccountsAndContext(s,e,t){if(e.length<=GET_MULTIPLE_ACCOUNTS_LIMIT)return await getMultipleAccountsAndContextCore(s,e,t);{const o=chunks(e,GET_MULTIPLE_ACCOUNTS_LIMIT);return(await Promise.all(o.map(c=>getMultipleAccountsAndContextCore(s,c,t)))).flat()}}async function getMultipleAccountsAndContextCore(s,e,t){const o=t??s.commitment,{value:a,context:c}=await s.getMultipleAccountsInfoAndContext(e,o);return a.map((g,y)=>g===null?null:{publicKey:e[y],account:g,context:c})}async function simulateTransaction(s,e,t,o,a){t&&t.length>0&&e.sign(...t);const c=e._compile(),d=c.serialize(),y=e._serialize(d).toString("base64"),_={encoding:"base64",commitment:o??s.commitment};if(a){const C=(Array.isArray(a)?a:c.nonProgramIds()).map(N=>N.toBase58());_.accounts={encoding:"base64",addresses:C}}t&&(_.sigVerify=!0);const E=[y,_],S=await s._rpcRequest("simulateTransaction",E),A=create(S,SimulatedTransactionResponseStruct);if("error"in A){let C;if("data"in A.error&&(C=A.error.data.logs,C&&Array.isArray(C))){const N=`
    `,O=N+C.join(N);console.error(A.error.message,O)}throw new SendTransactionError("failed to simulate transaction: "+A.error.message,C)}return A.result}function jsonRpcResult(s){return coerce(createRpcResult(s),UnknownRpcResult,e=>"error"in e?e:{...e,result:create(e.result,s)})}const UnknownRpcResult=createRpcResult(unknown());function createRpcResult(s){return union$1([type({jsonrpc:literal("2.0"),id:string(),result:s}),type({jsonrpc:literal("2.0"),id:string(),error:type({code:unknown(),message:string(),data:optional(any())})})])}function jsonRpcResultAndContext(s){return jsonRpcResult(type({context:type({slot:number$1()}),value:s}))}const SimulatedTransactionResponseStruct=jsonRpcResultAndContext(type({err:nullable(union$1([type({}),string()])),logs:nullable(array(string())),accounts:optional(nullable(array(nullable(type({executable:boolean(),owner:string(),lamports:number$1(),data:array(string()),rentEpoch:optional(number$1())}))))),unitsConsumed:optional(number$1())}));class AnchorProvider{constructor(e,t,o){this.connection=e,this.wallet=t,this.opts=o,this.publicKey=t==null?void 0:t.publicKey}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,o){var a;o===void 0&&(o=this.opts),e.feePayer=e.feePayer||this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(o.preflightCommitment)).blockhash,e=await this.wallet.signTransaction(e),(t??[]).forEach(d=>{e.partialSign(d)});const c=e.serialize();try{return await sendAndConfirmRawTransaction(this.connection,c,o)}catch(d){if(d instanceof ConfirmError){const g=await this.connection.getTransaction(encode$1(e.signature),{commitment:"confirmed"});if(g){const y=(a=g.meta)===null||a===void 0?void 0:a.logMessages;throw y?new SendTransactionError(d.message,y):d}else throw d}else throw d}}async sendAll(e,t){var o;t===void 0&&(t=this.opts);const a=await this.connection.getLatestBlockhash(t.preflightCommitment);let c=e.map(y=>{var _;let E=y.tx,S=(_=y.signers)!==null&&_!==void 0?_:[];return E.feePayer=E.feePayer||this.wallet.publicKey,E.recentBlockhash=a.blockhash,S.forEach(A=>{E.partialSign(A)}),E});const d=await this.wallet.signAllTransactions(c),g=[];for(let y=0;y<c.length;y+=1){const _=d[y],E=_.serialize();try{g.push(await sendAndConfirmRawTransaction(this.connection,E,t))}catch(S){if(S instanceof ConfirmError){const A=await this.connection.getTransaction(encode$1(_.signature),{commitment:"confirmed"});if(A){const C=(o=A.meta)===null||o===void 0?void 0:o.logMessages;throw C?new SendTransactionError(S.message,C):S}else throw S}else throw S}}return g}async simulate(e,t,o,a){e.feePayer=e.feePayer||this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(o??this.connection.commitment)).blockhash,e=await this.wallet.signTransaction(e);const c=await simulateTransaction(this.connection,e,t,o,a);if(c.value.err)throw new SimulateError(c.value);return c.value}}class SimulateError extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function sendAndConfirmRawTransaction(s,e,t){const o=t&&{skipPreflight:t.skipPreflight,preflightCommitment:t.preflightCommitment||t.commitment},a=await s.sendRawTransaction(e,o),c=(await s.confirmTransaction(a,t&&t.commitment)).value;if(c.err)throw new ConfirmError(`Raw transaction ${a} failed (${JSON.stringify(c)})`);return a}class ConfirmError extends Error{constructor(e){super(e)}}function getProvider(){return AnchorProvider.local()}const _FEATURES=new Map;function isSet(s){return _FEATURES.get(s)!==void 0}class IdlError extends Error{constructor(e){super(e),this.name="IdlError"}}class ProgramErrorStack{constructor(e){this.stack=e}static parse(e){var t;const o=/^Program (\w*) invoke/,a=/^Program \w* success/,c=[];for(let d=0;d<e.length;d++){if(a.exec(e[d])){c.pop();continue}const g=(t=o.exec(e[d]))===null||t===void 0?void 0:t[1];g&&c.push(new PublicKey(g))}return new ProgramErrorStack(c)}}class AnchorError extends Error{constructor(e,t,o,a,c,d){super(o.join(`
`).replace("Program log: ","")),this.errorLogs=o,this.logs=a,this.error={errorCode:e,errorMessage:t,comparedValues:d,origin:c},this._programErrorStack=ProgramErrorStack.parse(a)}static parse(e){if(!e)return null;const t=e.findIndex(A=>A.startsWith("Program log: AnchorError"));if(t===-1)return null;const o=e[t],a=[o];let c;if(t+1<e.length){if(e[t+1]==="Program log: Left:"){const A=/^Program log: (.*)$/,C=A.exec(e[t+2])[1],N=A.exec(e[t+4])[1];c=[new PublicKey(C),new PublicKey(N)],a.push(...e.slice(t+1,t+5))}else if(e[t+1].startsWith("Program log: Left:")){const A=/^Program log: (Left|Right): (.*)$/,C=A.exec(e[t+1])[2],N=A.exec(e[t+2])[2];a.push(...e.slice(t+1,t+3)),c=[C,N]}}const g=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(o),_=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(o),S=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(o);if(g){const[A,C,N]=g.slice(1,4),O={code:A,number:parseInt(C)};return new AnchorError(O,N,a,e,void 0,c)}else if(_){const[A,C,N,O,I]=_.slice(1,6),P={code:N,number:parseInt(O)},j={file:A,line:parseInt(C)};return new AnchorError(P,I,a,e,j,c)}else if(S){const[A,C,N,O]=S.slice(1,5),I=A,P={code:C,number:parseInt(N)};return new AnchorError(P,O,a,e,I,c)}else return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class ProgramError extends Error{constructor(e,t,o){super(),this.code=e,this.msg=t,this.logs=o,o&&(this._programErrorStack=ProgramErrorStack.parse(o))}static parse(e,t){const o=e.toString();let a;if(o.includes("custom program error:")){let g=o.split("custom program error: ");if(g.length!==2)return null;a=g[1]}else{const g=o.match(/"Custom":([0-9]+)}/g);if(!g||g.length>1)return null;a=g[0].match(/([0-9]+)/g)[0]}let c;try{c=parseInt(a)}catch{return null}let d=t.get(c);return d!==void 0?new ProgramError(c,d,e.logs):(d=LangErrorMessage.get(c),d!==void 0?new ProgramError(c,d,e.logs):null)}get program(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack}toString(){return this.msg}}function translateError(s,e){isSet("debug-logs")&&console.log("Translating error:",s);const t=AnchorError.parse(s.logs);if(t)return t;const o=ProgramError.parse(s,e);if(o)return o;if(s.logs){const a={get:function(c,d){return d==="programErrorStack"?c.programErrorStack.stack:d==="program"?c.programErrorStack.stack[s.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return s.programErrorStack=ProgramErrorStack.parse(s.logs),new Proxy(s,a)}return s}const LangErrorCode={InstructionMissing:100,InstructionFallbackNotFound:101,InstructionDidNotDeserialize:102,InstructionDidNotSerialize:103,IdlInstructionStub:1e3,IdlInstructionInvalidProgram:1001,ConstraintMut:2e3,ConstraintHasOne:2001,ConstraintSigner:2002,ConstraintRaw:2003,ConstraintOwner:2004,ConstraintRentExempt:2005,ConstraintSeeds:2006,ConstraintExecutable:2007,ConstraintState:2008,ConstraintAssociated:2009,ConstraintAssociatedInit:2010,ConstraintClose:2011,ConstraintAddress:2012,ConstraintZero:2013,ConstraintTokenMint:2014,ConstraintTokenOwner:2015,ConstraintMintMintAuthority:2016,ConstraintMintFreezeAuthority:2017,ConstraintMintDecimals:2018,ConstraintSpace:2019,ConstraintAccountIsNone:2020,RequireViolated:2500,RequireEqViolated:2501,RequireKeysEqViolated:2502,RequireNeqViolated:2503,RequireKeysNeqViolated:2504,RequireGtViolated:2505,RequireGteViolated:2506,AccountDiscriminatorAlreadySet:3e3,AccountDiscriminatorNotFound:3001,AccountDiscriminatorMismatch:3002,AccountDidNotDeserialize:3003,AccountDidNotSerialize:3004,AccountNotEnoughKeys:3005,AccountNotMutable:3006,AccountOwnedByWrongProgram:3007,InvalidProgramId:3008,InvalidProgramExecutable:3009,AccountNotSigner:3010,AccountNotSystemOwned:3011,AccountNotInitialized:3012,AccountNotProgramData:3013,AccountNotAssociatedTokenAccount:3014,AccountSysvarMismatch:3015,AccountReallocExceedsLimit:3016,AccountDuplicateReallocs:3017,StateInvalidAddress:4e3,DeclaredProgramIdMismatch:4100,Deprecated:5e3},LangErrorMessage=new Map([[LangErrorCode.InstructionMissing,"8 byte instruction identifier not provided"],[LangErrorCode.InstructionFallbackNotFound,"Fallback functions are not supported"],[LangErrorCode.InstructionDidNotDeserialize,"The program could not deserialize the given instruction"],[LangErrorCode.InstructionDidNotSerialize,"The program could not serialize the given instruction"],[LangErrorCode.IdlInstructionStub,"The program was compiled without idl instructions"],[LangErrorCode.IdlInstructionInvalidProgram,"The transaction was given an invalid program for the IDL instruction"],[LangErrorCode.ConstraintMut,"A mut constraint was violated"],[LangErrorCode.ConstraintHasOne,"A has one constraint was violated"],[LangErrorCode.ConstraintSigner,"A signer constraint was violated"],[LangErrorCode.ConstraintRaw,"A raw constraint was violated"],[LangErrorCode.ConstraintOwner,"An owner constraint was violated"],[LangErrorCode.ConstraintRentExempt,"A rent exemption constraint was violated"],[LangErrorCode.ConstraintSeeds,"A seeds constraint was violated"],[LangErrorCode.ConstraintExecutable,"An executable constraint was violated"],[LangErrorCode.ConstraintState,"A state constraint was violated"],[LangErrorCode.ConstraintAssociated,"An associated constraint was violated"],[LangErrorCode.ConstraintAssociatedInit,"An associated init constraint was violated"],[LangErrorCode.ConstraintClose,"A close constraint was violated"],[LangErrorCode.ConstraintAddress,"An address constraint was violated"],[LangErrorCode.ConstraintZero,"Expected zero account discriminant"],[LangErrorCode.ConstraintTokenMint,"A token mint constraint was violated"],[LangErrorCode.ConstraintTokenOwner,"A token owner constraint was violated"],[LangErrorCode.ConstraintMintMintAuthority,"A mint mint authority constraint was violated"],[LangErrorCode.ConstraintMintFreezeAuthority,"A mint freeze authority constraint was violated"],[LangErrorCode.ConstraintMintDecimals,"A mint decimals constraint was violated"],[LangErrorCode.ConstraintSpace,"A space constraint was violated"],[LangErrorCode.ConstraintAccountIsNone,"A required account for the constraint is None"],[LangErrorCode.RequireViolated,"A require expression was violated"],[LangErrorCode.RequireEqViolated,"A require_eq expression was violated"],[LangErrorCode.RequireKeysEqViolated,"A require_keys_eq expression was violated"],[LangErrorCode.RequireNeqViolated,"A require_neq expression was violated"],[LangErrorCode.RequireKeysNeqViolated,"A require_keys_neq expression was violated"],[LangErrorCode.RequireGtViolated,"A require_gt expression was violated"],[LangErrorCode.RequireGteViolated,"A require_gte expression was violated"],[LangErrorCode.AccountDiscriminatorAlreadySet,"The account discriminator was already set on this account"],[LangErrorCode.AccountDiscriminatorNotFound,"No 8 byte discriminator was found on the account"],[LangErrorCode.AccountDiscriminatorMismatch,"8 byte discriminator did not match what was expected"],[LangErrorCode.AccountDidNotDeserialize,"Failed to deserialize the account"],[LangErrorCode.AccountDidNotSerialize,"Failed to serialize the account"],[LangErrorCode.AccountNotEnoughKeys,"Not enough account keys given to the instruction"],[LangErrorCode.AccountNotMutable,"The given account is not mutable"],[LangErrorCode.AccountOwnedByWrongProgram,"The given account is owned by a different program than expected"],[LangErrorCode.InvalidProgramId,"Program ID was not as expected"],[LangErrorCode.InvalidProgramExecutable,"Program account is not executable"],[LangErrorCode.AccountNotSigner,"The given account did not sign"],[LangErrorCode.AccountNotSystemOwned,"The given account is not owned by the system program"],[LangErrorCode.AccountNotInitialized,"The program expected this account to be already initialized"],[LangErrorCode.AccountNotProgramData,"The given account is not a program data account"],[LangErrorCode.AccountNotAssociatedTokenAccount,"The given account is not the associated token account"],[LangErrorCode.AccountSysvarMismatch,"The given public key does not match the required sysvar"],[LangErrorCode.AccountReallocExceedsLimit,"The account reallocation exceeds the MAX_PERMITTED_DATA_INCREASE limit"],[LangErrorCode.AccountDuplicateReallocs,"The account was duplicated for more than one reallocation"],[LangErrorCode.StateInvalidAddress,"The given state account does not have the correct address"],[LangErrorCode.DeclaredProgramIdMismatch,"The declared program id does not match the actual program id"],[LangErrorCode.Deprecated,"The API being used is deprecated and should no longer be used"]]);var __assign$1=function(){return __assign$1=Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++){t=arguments[o];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},__assign$1.apply(this,arguments)},__assign=function(){return __assign=Object.assign||function(e){for(var t,o=1,a=arguments.length;o<a;o++){t=arguments[o];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},__assign.apply(this,arguments)};function lowerCase(s){return s.toLowerCase()}var DEFAULT_SPLIT_REGEXP=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],DEFAULT_STRIP_REGEXP=/[^A-Z0-9]+/gi;function noCase(s,e){e===void 0&&(e={});for(var t=e.splitRegexp,o=t===void 0?DEFAULT_SPLIT_REGEXP:t,a=e.stripRegexp,c=a===void 0?DEFAULT_STRIP_REGEXP:a,d=e.transform,g=d===void 0?lowerCase:d,y=e.delimiter,_=y===void 0?" ":y,E=replace(replace(s,o,"$1\0$2"),c,"\0"),S=0,A=E.length;E.charAt(S)==="\0";)S++;for(;E.charAt(A-1)==="\0";)A--;return E.slice(S,A).split("\0").map(g).join(_)}function replace(s,e,t){return e instanceof RegExp?s.replace(e,t):e.reduce(function(o,a){return o.replace(a,t)},s)}function dotCase(s,e){return e===void 0&&(e={}),noCase(s,__assign({delimiter:"."},e))}function snakeCase(s,e){return e===void 0&&(e={}),dotCase(s,__assign$1({delimiter:"_"},e))}class IdlCoder{static fieldLayout(e,t){const o=e.name!==void 0?camelCase$1(e.name):void 0;switch(e.type){case"bool":return dist.bool(o);case"u8":return dist.u8(o);case"i8":return dist.i8(o);case"u16":return dist.u16(o);case"i16":return dist.i16(o);case"u32":return dist.u32(o);case"i32":return dist.i32(o);case"f32":return dist.f32(o);case"u64":return dist.u64(o);case"i64":return dist.i64(o);case"f64":return dist.f64(o);case"u128":return dist.u128(o);case"i128":return dist.i128(o);case"u256":return dist.u256(o);case"i256":return dist.i256(o);case"bytes":return dist.vecU8(o);case"string":return dist.str(o);case"publicKey":return dist.publicKey(o);default:{if("vec"in e.type)return dist.vec(IdlCoder.fieldLayout({name:void 0,type:e.type.vec},t),o);if("option"in e.type)return dist.option(IdlCoder.fieldLayout({name:void 0,type:e.type.option},t),o);if("defined"in e.type){const a=e.type.defined;if(t===void 0)throw new IdlError("User defined types not provided");const c=t.filter(d=>d.name===a);if(c.length!==1)throw new IdlError(`Type not found: ${JSON.stringify(e)}`);return IdlCoder.typeDefLayout(c[0],t,o)}else if("array"in e.type){let a=e.type.array[0],c=e.type.array[1],d=IdlCoder.fieldLayout({name:void 0,type:a},t);return dist.array(d,c,o)}else throw new Error(`Not yet implemented: ${e}`)}}}static typeDefLayout(e,t=[],o){if(e.type.kind==="struct"){const a=e.type.fields.map(c=>IdlCoder.fieldLayout(c,t));return dist.struct(a,o)}else if(e.type.kind==="enum"){let a=e.type.variants.map(c=>{const d=camelCase$1(c.name);if(c.fields===void 0)return dist.struct([],d);const g=c.fields.map((y,_)=>y.hasOwnProperty("name")?IdlCoder.fieldLayout(y,t):IdlCoder.fieldLayout({type:y,name:_.toString()},t));return dist.struct(g,d)});return o!==void 0?dist.rustEnum(a).replicate(o):dist.rustEnum(a,o)}else throw new Error(`Unknown type kint: ${e}`)}}const SIGHASH_STATE_NAMESPACE="state",SIGHASH_GLOBAL_NAMESPACE="globalThis";class BorshInstructionCoder{constructor(e){this.idl=e,this.ixLayout=BorshInstructionCoder.parseIxLayout(e);const t=new Map;e.instructions.forEach(o=>{const a=sighash(SIGHASH_GLOBAL_NAMESPACE,o.name);t.set(bs58$1.encode(a),{layout:this.ixLayout.get(o.name),name:o.name})}),e.state&&e.state.methods.map(o=>{const a=sighash(SIGHASH_STATE_NAMESPACE,o.name);t.set(bs58$1.encode(a),{layout:this.ixLayout.get(o.name),name:o.name})}),this.sighashLayouts=t}encode(e,t){return this._encode(SIGHASH_GLOBAL_NAMESPACE,e,t)}encodeState(e,t){return this._encode(SIGHASH_STATE_NAMESPACE,e,t)}_encode(e,t,o){const a=buffer.Buffer.alloc(1e3),c=camelCase$1(t),d=this.ixLayout.get(c);if(!d)throw new Error(`Unknown method: ${c}`);const g=d.encode(o,a),y=a.slice(0,g);return buffer.Buffer.concat([sighash(e,t),y])}static parseIxLayout(e){const o=(e.state?e.state.methods:[]).map(a=>{let c=a.args.map(g=>{var y,_;return IdlCoder.fieldLayout(g,Array.from([...(y=e.accounts)!==null&&y!==void 0?y:[],...(_=e.types)!==null&&_!==void 0?_:[]]))});const d=camelCase$1(a.name);return[d,dist.struct(c,d)]}).concat(e.instructions.map(a=>{let c=a.args.map(g=>{var y,_;return IdlCoder.fieldLayout(g,Array.from([...(y=e.accounts)!==null&&y!==void 0?y:[],...(_=e.types)!==null&&_!==void 0?_:[]]))});const d=camelCase$1(a.name);return[d,dist.struct(c,d)]}));return new Map(o)}decode(e,t="hex"){typeof e=="string"&&(e=t==="hex"?buffer.Buffer.from(e,"hex"):bs58$1.decode(e));let o=bs58$1.encode(e.slice(0,8)),a=e.slice(8);const c=this.sighashLayouts.get(o);return c?{data:c.layout.decode(a),name:c.name}:null}format(e,t){return InstructionFormatter.format(e,t,this.idl)}}class InstructionFormatter{static format(e,t,o){const a=o.instructions.filter(y=>e.name===y.name)[0];if(a===void 0)return console.error("Invalid instruction given"),null;const c=a.args.map(y=>({name:y.name,type:InstructionFormatter.formatIdlType(y.type),data:InstructionFormatter.formatIdlData(y,e.data[y.name],o.types)})),d=InstructionFormatter.flattenIdlAccounts(a.accounts),g=t.map((y,_)=>_<d.length?{name:d[_].name,...y}:{name:void 0,...y});return{args:c,accounts:g}}static formatIdlType(e){if(typeof e=="string")return e;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("defined"in e)return e.defined;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,o){if(typeof e.type=="string")return t.toString();if(e.type.hasOwnProperty("vec"))return"["+t.map(a=>this.formatIdlData({name:"",type:e.type.vec},a)).join(", ")+"]";if(e.type.hasOwnProperty("option"))return t===null?"null":this.formatIdlData({name:"",type:e.type.option},t,o);if(e.type.hasOwnProperty("defined")){if(o===void 0)throw new Error("User defined types not provided");const a=o.filter(c=>c.name===e.type.defined);if(a.length!==1)throw new Error(`Type not found: ${e.type.defined}`);return InstructionFormatter.formatIdlDataDefined(a[0],t,o)}return"unknown"}static formatIdlDataDefined(e,t,o){if(e.type.kind==="struct"){const a=e.type;return"{ "+Object.keys(t).map(d=>{const g=a.fields.filter(y=>y.name===d)[0];if(g===void 0)throw new Error("Unable to find type");return d+": "+InstructionFormatter.formatIdlData(g,t[d],o)}).join(", ")+" }"}else{if(e.type.variants.length===0)return"{}";if(e.type.variants[0].name){const a=e.type.variants,c=Object.keys(t)[0],d=t[c],g=Object.keys(d).map(_=>{var E;const S=d[_],A=(E=a[c])===null||E===void 0?void 0:E.filter(C=>C.name===_)[0];if(A===void 0)throw new Error("Unable to find variant");return _+": "+InstructionFormatter.formatIdlData(A,S,o)}).join(", "),y=camelCase$1(c,{pascalCase:!0});return g.length===0?y:`${y} { ${g} }`}else return"Tuple formatting not yet implemented"}}static flattenIdlAccounts(e,t){return e.map(o=>{const a=sentenceCase(o.name);if(o.hasOwnProperty("accounts")){const c=t?`${t} > ${a}`:a;return InstructionFormatter.flattenIdlAccounts(o.accounts,c)}else return{...o,name:t?`${t} > ${a}`:a}}).flat()}}function sentenceCase(s){const e=s.replace(/([A-Z])/g," $1");return e.charAt(0).toUpperCase()+e.slice(1)}function sighash(s,e){let t=snakeCase(e),o=`${s}:${t}`;return buffer.Buffer.from(sha256Exports.sha256.digest(o)).slice(0,8)}function accountSize(s,e){if(e.type.kind==="enum"){let t=e.type.variants.map(o=>o.fields===void 0?0:o.fields.map(a=>{if(!(typeof a=="object"&&"name"in a))throw new Error("Tuple enum variants not yet implemented.");return typeSize(s,a.type)}).reduce((a,c)=>a+c));return Math.max(...t)+1}return e.type.fields===void 0?0:e.type.fields.map(t=>typeSize(s,t.type)).reduce((t,o)=>t+o,0)}function typeSize(s,e){var t,o;switch(e){case"bool":return 1;case"u8":return 1;case"i8":return 1;case"i16":return 2;case"u16":return 2;case"u32":return 4;case"i32":return 4;case"f32":return 4;case"u64":return 8;case"i64":return 8;case"f64":return 8;case"u128":return 16;case"i128":return 16;case"u256":return 32;case"i256":return 32;case"bytes":return 1;case"string":return 1;case"publicKey":return 32;default:if("vec"in e)return 1;if("option"in e)return 1+typeSize(s,e.option);if("coption"in e)return 4+typeSize(s,e.coption);if("defined"in e){const a=(o=(t=s.types)===null||t===void 0?void 0:t.filter(d=>d.name===e.defined))!==null&&o!==void 0?o:[];if(a.length!==1)throw new IdlError(`Type not found: ${JSON.stringify(e)}`);let c=a[0];return accountSize(s,c)}if("array"in e){let a=e.array[0],c=e.array[1];return typeSize(s,a)*c}throw new Error(`Invalid type ${JSON.stringify(e)}`)}}const ACCOUNT_DISCRIMINATOR_SIZE=8;class BorshAccountsCoder{constructor(e){if(e.accounts===void 0){this.accountLayouts=new Map;return}const t=e.accounts.map(o=>[o.name,IdlCoder.typeDefLayout(o,e.types)]);this.accountLayouts=new Map(t),this.idl=e}async encode(e,t){const o=buffer.Buffer.alloc(1e3),a=this.accountLayouts.get(e);if(!a)throw new Error(`Unknown account: ${e}`);const c=a.encode(t,o);let d=o.slice(0,c),g=BorshAccountsCoder.accountDiscriminator(e);return buffer.Buffer.concat([g,d])}decode(e,t){if(BorshAccountsCoder.accountDiscriminator(e).compare(t.slice(0,8)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeAny(e){const t=e.slice(0,8),o=Array.from(this.accountLayouts.keys()).find(a=>BorshAccountsCoder.accountDiscriminator(a).equals(t));if(!o)throw new Error("Account descriminator not found");return this.decodeUnchecked(o,e)}decodeUnchecked(e,t){const o=t.slice(ACCOUNT_DISCRIMINATOR_SIZE),a=this.accountLayouts.get(e);if(!a)throw new Error(`Unknown account: ${e}`);return a.decode(o)}memcmp(e,t){const o=BorshAccountsCoder.accountDiscriminator(e);return{offset:0,bytes:bs58$1.encode(t?buffer.Buffer.concat([o,t]):o)}}size(e){var t;return ACCOUNT_DISCRIMINATOR_SIZE+((t=accountSize(this.idl,e))!==null&&t!==void 0?t:0)}static accountDiscriminator(e){return buffer.Buffer.from(sha256Exports.sha256.digest(`account:${camelCase$1(e,{pascalCase:!0,preserveConsecutiveUppercase:!0})}`)).slice(0,ACCOUNT_DISCRIMINATOR_SIZE)}}class BorshEventCoder{constructor(e){if(e.events===void 0){this.layouts=new Map;return}const t=e.events.map(o=>{let a={name:o.name,type:{kind:"struct",fields:o.fields.map(c=>({name:c.name,type:c.type}))}};return[o.name,IdlCoder.typeDefLayout(a,e.types)]});this.layouts=new Map(t),this.discriminators=new Map(e.events===void 0?[]:e.events.map(o=>[fromByteArray_1(eventDiscriminator(o.name)),o.name]))}decode(e){let t;try{t=buffer.Buffer.from(toByteArray_1(e))}catch{return null}const o=fromByteArray_1(t.slice(0,8)),a=this.discriminators.get(o);if(a===void 0)return null;const c=this.layouts.get(a);if(!c)throw new Error(`Unknown event: ${a}`);return{data:c.decode(t.slice(8)),name:a}}}function eventDiscriminator(s){return buffer.Buffer.from(sha256Exports.sha256.digest(`event:${s}`)).slice(0,8)}class BorshStateCoder{constructor(e){if(e.state===void 0)throw new Error("Idl state not defined.");this.layout=IdlCoder.typeDefLayout(e.state.struct,e.types)}async encode(e,t){const o=buffer.Buffer.alloc(1e3),a=this.layout.encode(t,o),c=await stateDiscriminator(e),d=o.slice(0,a);return buffer.Buffer.concat([c,d])}decode(e){const t=e.slice(8);return this.layout.decode(t)}}async function stateDiscriminator(s){let e=isSet("anchor-deprecated-state")?"account":"state";return buffer.Buffer.from(sha256Exports.sha256.digest(`${e}:${s}`)).slice(0,8)}class BorshTypesCoder{constructor(e){if(e.types===void 0){this.typeLayouts=new Map;return}const t=e.types.map(o=>[o.name,IdlCoder.typeDefLayout(o,e.types)]);this.typeLayouts=new Map(t),this.idl=e}encode(e,t){const o=buffer.Buffer.alloc(1e3),a=this.typeLayouts.get(e);if(!a)throw new Error(`Unknown type: ${e}`);const c=a.encode(t,o);return o.slice(0,c)}decode(e,t){const o=this.typeLayouts.get(e);if(!o)throw new Error(`Unknown type: ${e}`);return o.decode(t)}}class BorshCoder{constructor(e){this.instruction=new BorshInstructionCoder(e),this.accounts=new BorshAccountsCoder(e),this.events=new BorshEventCoder(e),e.state&&(this.state=new BorshStateCoder(e)),this.types=new BorshTypesCoder(e)}}class Layout{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,o){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Layout_2=Layout;function nameWithProperty(s,e){return e.property?s+"["+e.property+"]":s}class ExternalLayout extends Layout{isCount(){throw new Error("ExternalLayout is abstract")}}class OffsetLayout extends ExternalLayout{constructor(e,t,o){if(!(e instanceof Layout))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,o||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof UInt||this.layout instanceof UIntBE}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,o){return o===void 0&&(o=0),this.layout.encode(e,t,o+this.offset)}}class UInt extends Layout{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,o){return o===void 0&&(o=0),t.writeUIntLE(e,o,this.span),this.span}}class UIntBE extends Layout{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,o){return o===void 0&&(o=0),t.writeUIntBE(e,o,this.span),this.span}}const V2E32=Math.pow(2,32);function divmodInt64(s){const e=Math.floor(s/V2E32),t=s-e*V2E32;return{hi32:e,lo32:t}}function roundedInt64(s,e){return s*V2E32+e}class NearUInt64 extends Layout{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const o=e.readUInt32LE(t),a=e.readUInt32LE(t+4);return roundedInt64(a,o)}encode(e,t,o){o===void 0&&(o=0);const a=divmodInt64(e);return t.writeUInt32LE(a.lo32,o),t.writeUInt32LE(a.hi32,o+4),8}}class NearInt64 extends Layout{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const o=e.readUInt32LE(t),a=e.readInt32LE(t+4);return roundedInt64(a,o)}encode(e,t,o){o===void 0&&(o=0);const a=divmodInt64(e);return t.writeUInt32LE(a.lo32,o),t.writeInt32LE(a.hi32,o+4),8}}class Structure extends Layout{constructor(e,t,o){if(!(Array.isArray(e)&&e.reduce((c,d)=>c&&d instanceof Layout,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&o===void 0&&(o=t,t=void 0);for(const c of e)if(0>c.span&&c.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let a=-1;try{a=e.reduce((c,d)=>c+d.getSpan(),0)}catch{}super(a,t),this.fields=e,this.decodePrefixes=!!o}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let o=0;try{o=this.fields.reduce((a,c)=>{const d=c.getSpan(e,t);return t+=d,a+d},0)}catch{throw new RangeError("indeterminate span")}return o}decode(e,t){t===void 0&&(t=0);const o=this.makeDestinationObject();for(const a of this.fields)if(a.property!==void 0&&(o[a.property]=a.decode(e,t)),t+=a.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return o}encode(e,t,o){o===void 0&&(o=0);const a=o;let c=0,d=0;for(const g of this.fields){let y=g.span;if(d=0<y?y:0,g.property!==void 0){const _=e[g.property];_!==void 0&&(d=g.encode(_,t,o),0>y&&(y=g.getSpan(t,o)))}c=o,o+=y}return c+d-a}fromArray(e){const t=this.makeDestinationObject();for(const o of this.fields)o.property!==void 0&&0<e.length&&(t[o.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const o of this.fields){if(o.property===e)return t;0>o.span?t=-1:0<=t&&(t+=o.span)}}}class UnionDiscriminator{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class UnionLayoutDiscriminator extends UnionDiscriminator{constructor(e,t){if(!(e instanceof ExternalLayout&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,o){return this.layout.encode(e,t,o)}}class Union extends Layout{constructor(e,t,o){const a=e instanceof UInt||e instanceof UIntBE;if(a)e=new UnionLayoutDiscriminator(new OffsetLayout(e));else if(e instanceof ExternalLayout&&e.isCount())e=new UnionLayoutDiscriminator(e);else if(!(e instanceof UnionDiscriminator))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Layout))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let c=-1;t&&(c=t.span,0<=c&&a&&(c+=e.layout.span)),super(c,o),this.discriminator=e,this.usesPrefixDiscriminator=a,this.defaultLayout=t,this.registry={};let d=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(g){return d(g)},this.configGetSourceVariant=function(g){d=g.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const o=this.getVariant(e,t);if(!o)throw new Error("unable to determine span for unrecognized variant");return o.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const o=this.registry[t];if(e.hasOwnProperty(o.property))return o}throw new Error("unable to infer src variant")}decode(e,t){t===void 0&&(t=0);let o;const a=this.discriminator,c=a.decode(e,t);let d=this.registry[c];if(d===void 0){let g=0;d=this.defaultLayout,this.usesPrefixDiscriminator&&(g=a.layout.span),o=this.makeDestinationObject(),o[a.property]=c,o[d.property]=this.defaultLayout.decode(e,t+g)}else o=d.decode(e,t);return o}encode(e,t,o){o===void 0&&(o=0);const a=this.getSourceVariant(e);if(a===void 0){const c=this.discriminator,d=this.defaultLayout;let g=0;return this.usesPrefixDiscriminator&&(g=c.layout.span),c.encode(e[c.property],t,o),g+d.encode(e[d.property],t,o+g)}return a.encode(e,t,o)}addVariant(e,t,o){const a=new VariantLayout(this,e,t,o);return this.registry[e]=a,a}getVariant(e,t){let o=e;return Buffer.isBuffer(e)&&(t===void 0&&(t=0),o=this.discriminator.decode(e,t)),this.registry[o]}}class VariantLayout extends Layout{constructor(e,t,o,a){if(!(e instanceof Union))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof o=="string"&&a===void 0&&(a=o,o=null),o){if(!(o instanceof Layout))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=o.span&&o.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof a!="string")throw new TypeError("variant must have a String property")}let c=e.span;0>e.span&&(c=o?o.span:0,0<=c&&e.usesPrefixDiscriminator&&(c+=e.discriminator.layout.span)),super(c,a),this.union=e,this.variant=t,this.layout=o||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let o=0;return this.union.usesPrefixDiscriminator&&(o=this.union.discriminator.layout.span),o+this.layout.getSpan(e,t+o)}decode(e,t){const o=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let a=0;return this.union.usesPrefixDiscriminator&&(a=this.union.discriminator.layout.span),this.layout?o[this.property]=this.layout.decode(e,t+a):this.property?o[this.property]=!0:this.union.usesPrefixDiscriminator&&(o[this.union.discriminator.property]=this.variant),o}encode(e,t,o){o===void 0&&(o=0);let a=0;if(this.union.usesPrefixDiscriminator&&(a=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,o);let c=a;if(this.layout&&(this.layout.encode(e[this.property],t,o+a),c+=this.layout.getSpan(t,o+a),0<=this.union.span&&c>this.union.span))throw new Error("encoded variant overruns containing union");return c}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class Blob$1 extends Layout{constructor(e,t){if(!(e instanceof ExternalLayout&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let o=-1;e instanceof ExternalLayout||(o=e),super(o,t),this.length=e}getSpan(e,t){let o=this.span;return 0>o&&(o=this.length.decode(e,t)),o}decode(e,t){t===void 0&&(t=0);let o=this.span;return 0>o&&(o=this.length.decode(e,t)),e.slice(t,t+o)}encode(e,t,o){let a=this.length;if(this.length instanceof ExternalLayout&&(a=e.length),!(Buffer.isBuffer(e)&&a===e.length))throw new TypeError(nameWithProperty("Blob.encode",this)+" requires (length "+a+") Buffer as src");if(o+a>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),o,a,"hex"),this.length instanceof ExternalLayout&&this.length.encode(a,t,o),a}}var offset=(s,e,t)=>new OffsetLayout(s,e,t),u8=s=>new UInt(1,s),u32=s=>new UInt(4,s),nu64=s=>new NearUInt64(s),ns64=s=>new NearInt64(s),struct=(s,e,t)=>new Structure(s,e,t),union=(s,e,t)=>new Union(s,e,t),blob=(s,e)=>new Blob$1(s,e);class RustStringLayout extends Layout_2{constructor(e){super(-1,e),this.property=e,this.layout=struct([u32("length"),u32("lengthPadding"),blob(offset(u32(),-8),"chars")],this.property)}encode(e,t,o=0){if(e==null)return this.layout.span;const a={chars:Buffer.from(e,"utf8")};return this.layout.encode(a,t,o)}decode(e,t=0){return this.layout.decode(e,t).chars.toString()}getSpan(e,t=0){return u32().span+u32().span+new BN(new Uint8Array(e).slice(t,t+4),10,"le").toNumber()}}function rustStringLayout(s){return new RustStringLayout(s)}function publicKey$2(s){return blob(32,s)}const LAYOUT=union(u32("instruction"));LAYOUT.addVariant(0,struct([ns64("lamports"),ns64("space"),publicKey$2("owner")]),"createAccount");LAYOUT.addVariant(1,struct([publicKey$2("owner")]),"assign");LAYOUT.addVariant(2,struct([ns64("lamports")]),"transfer");LAYOUT.addVariant(3,struct([publicKey$2("base"),rustStringLayout("seed"),ns64("lamports"),ns64("space"),publicKey$2("owner")]),"createAccountWithSeed");LAYOUT.addVariant(4,struct([publicKey$2("authorized")]),"advanceNonceAccount");LAYOUT.addVariant(5,struct([ns64("lamports")]),"withdrawNonceAccount");LAYOUT.addVariant(6,struct([publicKey$2("authorized")]),"initializeNonceAccount");LAYOUT.addVariant(7,struct([publicKey$2("authorized")]),"authorizeNonceAccount");LAYOUT.addVariant(8,struct([ns64("space")]),"allocate");LAYOUT.addVariant(9,struct([publicKey$2("base"),rustStringLayout("seed"),ns64("space"),publicKey$2("owner")]),"allocateWithSeed");LAYOUT.addVariant(10,struct([publicKey$2("base"),rustStringLayout("seed"),publicKey$2("owner")]),"assignWithSeed");LAYOUT.addVariant(11,struct([ns64("lamports"),rustStringLayout("seed"),publicKey$2("owner")]),"transferWithSeed");Math.max(...Object.values(LAYOUT.registry).map(s=>s.span));class WrappedLayout$1 extends Layout_2{constructor(e,t,o,a){super(e.span,a),this.layout=e,this.decoder=t,this.encoder=o}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,o){return this.layout.encode(this.encoder(e),t,o)}getSpan(e,t){return this.layout.getSpan(e,t)}}function publicKey$1(s){return new WrappedLayout$1(blob(32),e=>new PublicKey(e),e=>e.toBuffer(),s)}struct([u32("version"),u32("state"),publicKey$1("authorizedPubkey"),publicKey$1("nonce"),struct([nu64("lamportsPerSignature")],"feeCalculator")]);function createWithSeedSync(s,e,t){const o=buffer.Buffer.concat([s.toBuffer(),buffer.Buffer.from(e),t.toBuffer()]),a=sha256Exports.sha256.digest(o);return new PublicKey(buffer.Buffer.from(a))}function createProgramAddressSync(s,e){let o=buffer.Buffer.alloc(0);s.forEach(function(d){if(d.length>32)throw new TypeError("Max seed length exceeded");o=buffer.Buffer.concat([o,toBuffer(d)])}),o=buffer.Buffer.concat([o,e.toBuffer(),buffer.Buffer.from("ProgramDerivedAddress")]);let a=sha256Exports.sha256(new Uint8Array(o)),c=new BN(a,16).toArray(void 0,32);if(PublicKey.isOnCurve(new Uint8Array(c)))throw new Error("Invalid seeds, address must fall off the curve");return new PublicKey(c)}function findProgramAddressSync(s,e){let t=255,o;for(;t!=0;){try{const a=s.concat(buffer.Buffer.from([t]));o=createProgramAddressSync(a,e)}catch(a){if(a instanceof TypeError)throw a;t--;continue}return[o,t]}throw new Error("Unable to find a viable program address nonce")}const toBuffer=s=>s instanceof buffer.Buffer?s:s instanceof Uint8Array?buffer.Buffer.from(s.buffer,s.byteOffset,s.byteLength):buffer.Buffer.from(s);async function associated(s,...e){let t=[buffer.Buffer.from([97,110,99,104,111,114])];e.forEach(a=>{t.push(a instanceof buffer.Buffer?a:translateAddress(a).toBuffer())});const[o]=await PublicKey.findProgramAddress(t,translateAddress(s));return o}const TOKEN_PROGRAM_ID=new PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),ASSOCIATED_PROGRAM_ID=new PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var browserPonyfill={exports:{}};(function(s,e){var t=function(){function a(){this.fetch=!1,this.DOMException=globalThis.DOMException}return a.prototype=globalThis,new a}();(function(a){(function(c){var d={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function g(V){return V&&DataView.prototype.isPrototypeOf(V)}if(d.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(V){return V&&y.indexOf(Object.prototype.toString.call(V))>-1};function E(V){if(typeof V!="string"&&(V=String(V)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(V))throw new TypeError("Invalid character in header field name");return V.toLowerCase()}function S(V){return typeof V!="string"&&(V=String(V)),V}function A(V){var R={next:function(){var L=V.shift();return{done:L===void 0,value:L}}};return d.iterable&&(R[Symbol.iterator]=function(){return R}),R}function C(V){this.map={},V instanceof C?V.forEach(function(R,L){this.append(L,R)},this):Array.isArray(V)?V.forEach(function(R){this.append(R[0],R[1])},this):V&&Object.getOwnPropertyNames(V).forEach(function(R){this.append(R,V[R])},this)}C.prototype.append=function(V,R){V=E(V),R=S(R);var L=this.map[V];this.map[V]=L?L+", "+R:R},C.prototype.delete=function(V){delete this.map[E(V)]},C.prototype.get=function(V){return V=E(V),this.has(V)?this.map[V]:null},C.prototype.has=function(V){return this.map.hasOwnProperty(E(V))},C.prototype.set=function(V,R){this.map[E(V)]=S(R)},C.prototype.forEach=function(V,R){for(var L in this.map)this.map.hasOwnProperty(L)&&V.call(R,this.map[L],L,this)},C.prototype.keys=function(){var V=[];return this.forEach(function(R,L){V.push(L)}),A(V)},C.prototype.values=function(){var V=[];return this.forEach(function(R){V.push(R)}),A(V)},C.prototype.entries=function(){var V=[];return this.forEach(function(R,L){V.push([L,R])}),A(V)},d.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function N(V){if(V.bodyUsed)return Promise.reject(new TypeError("Already read"));V.bodyUsed=!0}function O(V){return new Promise(function(R,L){V.onload=function(){R(V.result)},V.onerror=function(){L(V.error)}})}function I(V){var R=new FileReader,L=O(R);return R.readAsArrayBuffer(V),L}function P(V){var R=new FileReader,L=O(R);return R.readAsText(V),L}function j(V){for(var R=new Uint8Array(V),L=new Array(R.length),z=0;z<R.length;z++)L[z]=String.fromCharCode(R[z]);return L.join("")}function B(V){if(V.slice)return V.slice(0);var R=new Uint8Array(V.byteLength);return R.set(new Uint8Array(V)),R.buffer}function H(){return this.bodyUsed=!1,this._initBody=function(V){this._bodyInit=V,V?typeof V=="string"?this._bodyText=V:d.blob&&Blob.prototype.isPrototypeOf(V)?this._bodyBlob=V:d.formData&&FormData.prototype.isPrototypeOf(V)?this._bodyFormData=V:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(V)?this._bodyText=V.toString():d.arrayBuffer&&d.blob&&g(V)?(this._bodyArrayBuffer=B(V.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(V)||_(V))?this._bodyArrayBuffer=B(V):this._bodyText=V=Object.prototype.toString.call(V):this._bodyText="",this.headers.get("content-type")||(typeof V=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(V)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var V=N(this);if(V)return V;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?N(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(I)}),this.text=function(){var V=N(this);if(V)return V;if(this._bodyBlob)return P(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(j(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(fe)}),this.json=function(){return this.text().then(JSON.parse)},this}var se=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function oe(V){var R=V.toUpperCase();return se.indexOf(R)>-1?R:V}function Q(V,R){R=R||{};var L=R.body;if(V instanceof Q){if(V.bodyUsed)throw new TypeError("Already read");this.url=V.url,this.credentials=V.credentials,R.headers||(this.headers=new C(V.headers)),this.method=V.method,this.mode=V.mode,this.signal=V.signal,!L&&V._bodyInit!=null&&(L=V._bodyInit,V.bodyUsed=!0)}else this.url=String(V);if(this.credentials=R.credentials||this.credentials||"same-origin",(R.headers||!this.headers)&&(this.headers=new C(R.headers)),this.method=oe(R.method||this.method||"GET"),this.mode=R.mode||this.mode||null,this.signal=R.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&L)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(L)}Q.prototype.clone=function(){return new Q(this,{body:this._bodyInit})};function fe(V){var R=new FormData;return V.trim().split("&").forEach(function(L){if(L){var z=L.split("="),Y=z.shift().replace(/\+/g," "),W=z.join("=").replace(/\+/g," ");R.append(decodeURIComponent(Y),decodeURIComponent(W))}}),R}function Z(V){var R=new C,L=V.replace(/\r?\n[\t ]+/g," ");return L.split(/\r?\n/).forEach(function(z){var Y=z.split(":"),W=Y.shift().trim();if(W){var ee=Y.join(":").trim();R.append(W,ee)}}),R}H.call(Q.prototype);function ce(V,R){R||(R={}),this.type="default",this.status=R.status===void 0?200:R.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in R?R.statusText:"OK",this.headers=new C(R.headers),this.url=R.url||"",this._initBody(V)}H.call(ce.prototype),ce.prototype.clone=function(){return new ce(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},ce.error=function(){var V=new ce(null,{status:0,statusText:""});return V.type="error",V};var ge=[301,302,303,307,308];ce.redirect=function(V,R){if(ge.indexOf(R)===-1)throw new RangeError("Invalid status code");return new ce(null,{status:R,headers:{location:V}})},c.DOMException=a.DOMException;try{new c.DOMException}catch{c.DOMException=function(R,L){this.message=R,this.name=L;var z=Error(R);this.stack=z.stack},c.DOMException.prototype=Object.create(Error.prototype),c.DOMException.prototype.constructor=c.DOMException}function me(V,R){return new Promise(function(L,z){var Y=new Q(V,R);if(Y.signal&&Y.signal.aborted)return z(new c.DOMException("Aborted","AbortError"));var W=new XMLHttpRequest;function ee(){W.abort()}W.onload=function(){var ie={status:W.status,statusText:W.statusText,headers:Z(W.getAllResponseHeaders()||"")};ie.url="responseURL"in W?W.responseURL:ie.headers.get("X-Request-URL");var X="response"in W?W.response:W.responseText;L(new ce(X,ie))},W.onerror=function(){z(new TypeError("Network request failed"))},W.ontimeout=function(){z(new TypeError("Network request failed"))},W.onabort=function(){z(new c.DOMException("Aborted","AbortError"))},W.open(Y.method,Y.url,!0),Y.credentials==="include"?W.withCredentials=!0:Y.credentials==="omit"&&(W.withCredentials=!1),"responseType"in W&&d.blob&&(W.responseType="blob"),Y.headers.forEach(function(ie,X){W.setRequestHeader(X,ie)}),Y.signal&&(Y.signal.addEventListener("abort",ee),W.onreadystatechange=function(){W.readyState===4&&Y.signal.removeEventListener("abort",ee)}),W.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return me.polyfill=!0,a.fetch||(a.fetch=me,a.Headers=C,a.Request=Q,a.Response=ce),c.Headers=C,c.Request=Q,c.Response=ce,c.fetch=me,Object.defineProperty(c,"__esModule",{value:!0}),c})({})})(t),t.fetch.ponyfill=!0,delete t.fetch.polyfill;var o=t;e=o.fetch,e.default=o.fetch,e.fetch=o.fetch,e.Headers=o.Headers,e.Request=o.Request,e.Response=o.Response,s.exports=e})(browserPonyfill,browserPonyfill.exports);dist.rustEnum([dist.struct([],"uninitialized"),dist.struct([dist.option(dist.publicKey(),"authorityAddress")],"buffer"),dist.struct([dist.publicKey("programdataAddress")],"program"),dist.struct([dist.u64("slot"),dist.option(dist.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,dist.u32());function isIdlAccounts(s){return"accounts"in s}async function idlAddress(s){const e=(await PublicKey.findProgramAddress([],s))[0];return await PublicKey.createWithSeed(e,seed(),s)}function seed(){return"anchor:idl"}const IDL_ACCOUNT_LAYOUT=dist.struct([dist.publicKey("authority"),dist.vecU8("data")]);function decodeIdlAccount(s){return IDL_ACCOUNT_LAYOUT.decode(s)}function splitArgsAndCtx(s,e){var t,o;let a={};const c=s.args?s.args.length:0;if(e.length>c){if(e.length!==c+1)throw new Error(`provided too many arguments ${e} to instruction ${s==null?void 0:s.name} expecting: ${(o=(t=s.args)===null||t===void 0?void 0:t.map(d=>d.name))!==null&&o!==void 0?o:[]}`);a=e.pop()}return[e,a]}class InstructionNamespaceFactory{static build(e,t,o){if(e.name==="_inner")throw new IdlError("the _inner name is reserved");const a=(...c)=>{const[d,g]=splitArgsAndCtx(e,[...c]);validateAccounts(e.accounts,g.accounts),validateInstruction(e,...c);const y=a.accounts(g.accounts);return g.remainingAccounts!==void 0&&y.push(...g.remainingAccounts),isSet("debug-logs")&&console.log("Outgoing account metas:",y),new TransactionInstruction({keys:y,programId:o,data:t(e.name,toInstruction(e,...d))})};return a.accounts=c=>InstructionNamespaceFactory.accountsArray(c,e.accounts,o,e.name),a}static accountsArray(e,t,o,a){return e?t.map(c=>{if(("accounts"in c?c.accounts:void 0)!==void 0){const g=e[c.name];return InstructionNamespaceFactory.accountsArray(g,c.accounts,o,a).flat()}else{const g=c;let y;try{y=translateAddress(e[c.name])}catch{throw new Error(`Wrong input type for account "${c.name}" in the instruction accounts object${a!==void 0?' for instruction "'+a+'"':""}. Expected PublicKey or string.`)}const _=g.isOptional&&y.equals(o),E=g.isMut&&!_,S=g.isSigner&&!_;return{pubkey:y,isWritable:E,isSigner:S}}}).flat():[]}}function validateInstruction(s,...e){}class RpcFactory{static build(e,t,o,a){return async(...d)=>{var g;const y=t(...d),[,_]=splitArgsAndCtx(e,[...d]);if(a.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await a.sendAndConfirm(y,(g=_.signers)!==null&&g!==void 0?g:[],_.options)}catch(E){throw translateError(E,o)}}}}class TransactionFactory{static build(e,t){return(...a)=>{var c,d,g;const[,y]=splitArgsAndCtx(e,[...a]),_=new Transaction;if(y.preInstructions&&y.instructions)throw new Error("instructions is deprecated, use preInstructions");return(c=y.preInstructions)===null||c===void 0||c.forEach(E=>_.add(E)),(d=y.instructions)===null||d===void 0||d.forEach(E=>_.add(E)),_.add(t(...a)),(g=y.postInstructions)===null||g===void 0||g.forEach(E=>_.add(E)),_}}}class StateFactory{static build(e,t,o,a){if(e.state!==void 0)return new StateClient(e,o,a,t)}}class StateClient{get programId(){return this._programId}constructor(e,t,o=getProvider(),a=new BorshCoder(e)){this.provider=o,this.coder=a,this._idl=e,this._programId=t,this._address=programStateAddress(t),this._sub=null;const[c,d,g]=(()=>{var y;let _={},E={},S={};return(y=e.state)===null||y===void 0||y.methods.forEach(A=>{const C=InstructionNamespaceFactory.build(A,(P,j)=>a.instruction.encodeState(P,j),t);C.accounts=P=>stateInstructionKeys(t,o,A,P).concat(InstructionNamespaceFactory.accountsArray(P,A.accounts,t,A.name));const N=TransactionFactory.build(A,C),O=RpcFactory.build(A,N,parseIdlErrors(e),o),I=camelCase$1(A.name);_[I]=C,E[I]=N,S[I]=O}),[_,E,S]})();this.instruction=c,this.transaction=d,this.rpc=g}async fetch(){const e=this.address(),t=await this.provider.connection.getAccountInfo(e);if(t===null)throw new Error(`Account does not exist ${e.toString()}`);const o=this._idl.state;if(!o)throw new Error("State is not specified in IDL.");if((await stateDiscriminator(o.struct.name)).compare(t.data.slice(0,8)))throw new Error("Invalid account discriminator");return this.coder.state.decode(t.data)}address(){return this._address}subscribe(e){if(this._sub!==null)return this._sub.ee;const t=new EventEmitter$1,o=this.provider.connection.onAccountChange(this.address(),a=>{const c=this.coder.state.decode(a.data);t.emit("change",c)},e);return this._sub={ee:t,listener:o},t}unsubscribe(){this._sub!==null&&this.provider.connection.removeAccountChangeListener(this._sub.listener).then(async()=>{this._sub=null}).catch(console.error)}}function programStateAddress(s){let[e]=findProgramAddressSync([],s);return createWithSeedSync(e,"unversioned",s)}function stateInstructionKeys(s,e,t,o){if(t.name==="new"){const[a]=findProgramAddressSync([],s);if(e.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return[{pubkey:e.wallet.publicKey,isWritable:!1,isSigner:!0},{pubkey:programStateAddress(s),isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:SystemProgram.programId,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1}]}else return validateAccounts(t.accounts,o),[{pubkey:programStateAddress(s),isWritable:!0,isSigner:!1}]}class AccountFactory{static build(e,t,o,a){var c;const d={};return(c=e.accounts)===null||c===void 0||c.forEach(g=>{const y=camelCase$1(g.name);d[y]=new AccountClient(e,g,o,a,t)}),d}}class AccountClient{get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}constructor(e,t,o,a,c){this._idlAccount=t,this._programId=o,this._provider=a??getProvider(),this._coder=c??new BorshCoder(e),this._size=this._coder.accounts.size(t)}async fetchNullable(e,t){const{data:o}=await this.fetchNullableAndContext(e,t);return o}async fetchNullableAndContext(e,t){const o=await this.getAccountInfoAndContext(e,t),{value:a,context:c}=o;return{data:a&&a.data.length!==0?this._coder.accounts.decode(this._idlAccount.name,a.data):null,context:c}}async fetch(e,t){const{data:o}=await this.fetchNullableAndContext(e,t);if(o===null)throw new Error(`Account does not exist or has no data ${e.toString()}`);return o}async fetchAndContext(e,t){const{data:o,context:a}=await this.fetchNullableAndContext(e,t);if(o===null)throw new Error(`Account does not exist ${e.toString()}`);return{data:o,context:a}}async fetchMultiple(e,t){return(await this.fetchMultipleAndContext(e,t)).map(a=>a?a.data:null)}async fetchMultipleAndContext(e,t){return(await getMultipleAccountsAndContext(this._provider.connection,e.map(a=>translateAddress(a)),t)).map(a=>{if(a==null)return null;const{account:c,context:d}=a;return{data:this._coder.accounts.decode(this._idlAccount.name,c.data),context:d}})}async all(e){const t=this.coder.accounts.memcmp(this._idlAccount.name,e instanceof Buffer?e:void 0),o=[];return(t==null?void 0:t.offset)!=null&&(t==null?void 0:t.bytes)!=null&&o.push({memcmp:{offset:t.offset,bytes:t.bytes}}),(t==null?void 0:t.dataSize)!=null&&o.push({dataSize:t.dataSize}),(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[...o,...Array.isArray(e)?e:[]]})).map(({pubkey:c,account:d})=>({publicKey:c,account:this._coder.accounts.decode(this._idlAccount.name,d.data)}))}subscribe(e,t){const o=subscriptions.get(e.toString());if(o)return o.ee;const a=new EventEmitter$1;e=translateAddress(e);const c=this._provider.connection.onAccountChange(e,d=>{const g=this._coder.accounts.decode(this._idlAccount.name,d.data);a.emit("change",g)},t);return subscriptions.set(e.toString(),{ee:a,listener:c}),a}async unsubscribe(e){let t=subscriptions.get(e.toString());if(!t){console.warn("Address is not subscribed");return}subscriptions&&await this._provider.connection.removeAccountChangeListener(t.listener).then(()=>{subscriptions.delete(e.toString())}).catch(console.error)}async createInstruction(e,t){const o=this.size;if(this._provider.publicKey===void 0)throw new Error("This function requires the Provider interface implementor to have a 'publicKey' field.");return SystemProgram.createAccount({fromPubkey:this._provider.publicKey,newAccountPubkey:e.publicKey,space:t??o,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(t??o),programId:this._programId})}async associated(...e){const t=await this.associatedAddress(...e);return await this.fetch(t)}async associatedAddress(...e){return await associated(this._programId,...e)}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(translateAddress(e),t)}async getAccountInfoAndContext(e,t){return await this._provider.connection.getAccountInfoAndContext(translateAddress(e),t)}}const subscriptions=new Map,PROGRAM_LOG="Program log: ",PROGRAM_DATA="Program data: ",PROGRAM_LOG_START_INDEX=PROGRAM_LOG.length,PROGRAM_DATA_START_INDEX=PROGRAM_DATA.length;class EventManager{constructor(e,t,o){this._programId=e,this._provider=t,this._eventParser=new EventParser(e,o),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t){var o;let a=this._listenerIdCount;return this._listenerIdCount+=1,this._eventListeners.has(e)||this._eventListeners.set(e,[]),this._eventListeners.set(e,((o=this._eventListeners.get(e))!==null&&o!==void 0?o:[]).concat(a)),this._eventCallbacks.set(a,[e,t]),this._onLogsSubscriptionId!==void 0||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,(c,d)=>{if(!c.err)for(const g of this._eventParser.parseLogs(c.logs)){const y=this._eventListeners.get(g.name);y&&y.forEach(_=>{const E=this._eventCallbacks.get(_);if(E){const[,S]=E;S(g.data,d.slot,c.signature)}})}})),a}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[o]=t;let a=this._eventListeners.get(o);if(!a)throw new Error(`Event listeners don't exist for ${o}!`);this._eventCallbacks.delete(e),a=a.filter(c=>c!==e),this._eventListeners.set(o,a),a.length===0&&this._eventListeners.delete(o),this._eventCallbacks.size==0&&((void 0)(this._eventListeners.size===0),this._onLogsSubscriptionId!==void 0&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0))}}class EventParser{constructor(e,t){this.coder=t,this.programId=e}*parseLogs(e,t=!1){const o=new LogScanner(e),a=new ExecutionContext;let c=o.next();for(;c!==null;){let[d,g,y]=this.handleLog(a,c,t);d&&(yield d),g&&a.push(g),y&&a.pop(),c=o.next()}}handleLog(e,t,o){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t,o):[null,...this.handleSystemLog(t)]}handleProgramLog(e,t){if(e.startsWith(PROGRAM_LOG)||e.startsWith(PROGRAM_DATA)){const o=e.startsWith(PROGRAM_LOG)?e.slice(PROGRAM_LOG_START_INDEX):e.slice(PROGRAM_DATA_START_INDEX),a=this.coder.events.decode(o);if(t&&a===null)throw new Error(`Unable to decode event ${o}`);return[a,null,!1]}else return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return t.match(/^Program (.*) success/g)!==null?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class ExecutionContext{constructor(){this.stack=[]}program(){return(void 0)(this.stack.length>0),this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){(void 0)(this.stack.length>0),this.stack.pop()}}class LogScanner{constructor(e){this.logs=e}next(){if(this.logs.length===0)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}class SimulateFactory{static build(e,t,o,a,c,d,g){return async(..._)=>{var E;const S=t(..._),[,A]=splitArgsAndCtx(e,[..._]);let C;if(a.simulate===void 0)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{C=await a.simulate(S,A.signers,(E=A.options)===null||E===void 0?void 0:E.commitment)}catch(I){throw translateError(I,o)}if(C===void 0)throw new Error("Unable to simulate transaction");const N=C.logs;if(!N)throw new Error("Simulated logs not found");const O=[];if(g.events){let I=new EventParser(d,c);for(const P of I.parseLogs(N))O.push(P)}return{events:O,raw:N}}}}function uint64(s){return new WrappedLayout(blob(8),e=>u64.fromBuffer(e),e=>e.toBuffer(),s)}function publicKey(s){return new WrappedLayout(blob(32),e=>new PublicKey(e),e=>e.toBuffer(),s)}function coption(s,e){return new COptionLayout(s,e)}class WrappedLayout extends Layout_2{constructor(e,t,o,a){super(e.span,a),this.layout=e,this.decoder=t,this.encoder=o}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,o){return this.layout.encode(this.encoder(e),t,o)}getSpan(e,t){return this.layout.getSpan(e,t)}}class COptionLayout extends Layout_2{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=u32()}encode(e,t,o=0){return e==null?this.layout.span+this.discriminator.encode(0,t,o):(this.discriminator.encode(1,t,o),this.layout.encode(e,t,o+4)+4)}decode(e,t=0){const o=this.discriminator.decode(e,t);if(o===0)return null;if(o===1)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}class u64 extends BN{toBuffer(){const e=super.toArray().reverse(),t=Buffer.from(e);if(t.length===8)return t;if(t.length>=8)throw new Error("u64 too large");const o=Buffer.alloc(8);return t.copy(o),o}static fromBuffer(e){if(e.length!==8)throw new Error(`Invalid buffer length: ${e.length}`);return new u64([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}const TOKEN_ACCOUNT_LAYOUT=struct([publicKey("mint"),publicKey("owner"),uint64("amount"),coption(publicKey(),"delegate"),(s=>{const e=union(u8("discriminator"),null,s);return e.addVariant(0,struct([]),"uninitialized"),e.addVariant(1,struct([]),"initialized"),e.addVariant(2,struct([]),"frozen"),e})("state"),coption(uint64(),"isNative"),uint64("delegatedAmount"),coption(publicKey(),"closeAuthority")]);function decodeTokenAccount(s){return TOKEN_ACCOUNT_LAYOUT.decode(s)}class AccountsResolver{constructor(e,t,o,a,c,d,g,y){this._accounts=t,this._provider=o,this._programId=a,this._idlIx=c,this._idlTypes=g,this._customResolver=y,this._args=e,this._accountStore=new AccountStore(o,d,this._programId)}args(e){this._args=e}async resolve(){for(await this.resolveConst(this._idlIx.accounts);await this.resolvePdas(this._idlIx.accounts)+await this.resolveRelations(this._idlIx.accounts)+await this.resolveCustom()>0;);}async resolveCustom(){if(this._customResolver){const{accounts:e,resolved:t}=await this._customResolver({args:this._args,accounts:this._accounts,provider:this._provider,programId:this._programId,idlIx:this._idlIx});return this._accounts=e,t}return 0}resolveOptionalsHelper(e,t){const o={};for(const a of t){const c=a.name,d=e[c];d!==void 0&&(isPartialAccounts(d)?isIdlAccounts(a)?o[c]=this.resolveOptionalsHelper(d,a.accounts):o[c]=flattenPartialAccounts(d,!0):d!==null?o[c]=translateAddress(d):a.isOptional&&(o[c]=this._programId))}return o}resolveOptionals(e){Object.assign(this._accounts,this.resolveOptionalsHelper(e,this._idlIx.accounts))}get(e){const t=e.reduce((o,a)=>o&&o[a],this._accounts);if(t&&t.toBase58)return t}set(e,t){let o=this._accounts;e.forEach((a,c)=>{c==e.length-1&&(o[a]=t),o[a]=o[a]||{},o=o[a]})}async resolveConst(e,t=[]){for(let o=0;o<e.length;o+=1){const a=e[o],c=a.accounts;c&&await this.resolveConst(c,[...t,camelCase$1(a.name)]);const d=a,g=camelCase$1(a.name);if(d.isSigner&&!this.get([...t,g])){if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");this.set([...t,g],this._provider.wallet.publicKey)}Reflect.has(AccountsResolver.CONST_ACCOUNTS,g)&&!this.get([...t,g])&&this.set([...t,g],AccountsResolver.CONST_ACCOUNTS[g])}}async resolvePdas(e,t=[]){let o=0;for(let a=0;a<e.length;a+=1){const c=e[a],d=c.accounts;d&&(o+=await this.resolvePdas(d,[...t,camelCase$1(c.name)]));const g=c,y=camelCase$1(c.name);g.pda&&g.pda.seeds.length>0&&!this.get([...t,y])&&await this.autoPopulatePda(g,t)&&(o+=1)}return o}async resolveRelations(e,t=[]){let o=0;for(let a=0;a<e.length;a+=1){const c=e[a],d=c.accounts;d&&(o+=await this.resolveRelations(d,[...t,camelCase$1(c.name)]));const g=c.relations||[],y=camelCase$1(c.name),_=[...t,y],E=this.get(_);if(E){const S=g.filter(A=>!this.get([...t,camelCase$1(A)]));if(o+=S.length,S.length>0){const A=await this._accountStore.fetchAccount({publicKey:E});await Promise.all(S.map(async C=>{const N=camelCase$1(C);return this.set([...t,N],A[N]),A[N]}))}}}return o}async autoPopulatePda(e,t=[]){if(!e.pda||!e.pda.seeds)throw new Error("Must have seeds");const o=await Promise.all(e.pda.seeds.map(d=>this.toBuffer(d,t)));if(o.some(d=>typeof d>"u"))return;const a=await this.parseProgramId(e,t);if(!a)return;const[c]=await PublicKey.findProgramAddress(o,a);this.set([...t,camelCase$1(e.name)],c)}async parseProgramId(e,t=[]){var o;if(!(!((o=e.pda)===null||o===void 0)&&o.programId))return this._programId;switch(e.pda.programId.kind){case"const":return new PublicKey(this.toBufferConst(e.pda.programId.value));case"arg":return this.argValue(e.pda.programId);case"account":return await this.accountValue(e.pda.programId,t);default:throw new Error(`Unexpected program seed kind: ${e.pda.programId.kind}`)}}async toBuffer(e,t=[]){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e,t);default:throw new Error(`Unexpected seed kind: ${e.kind}`)}}getType(e,t=[]){if(t.length>0&&e.defined){const o=this._idlTypes.find(d=>d.name===e.defined);if(!o)throw new Error(`Cannot find type ${e.defined}`);const c=o.type.fields.find(d=>d.name===t[0]);return this.getType(c.type,t.slice(1))}return e}toBufferConst(e){return this.toBufferValue(this.getType(e.type,(e.path||"").split(".").slice(1)),e.value)}async toBufferArg(e){const t=this.argValue(e);if(!(typeof t>"u"))return this.toBufferValue(this.getType(e.type,(e.path||"").split(".").slice(1)),t)}argValue(e){const t=e.path.split("."),o=camelCase$1(t[0]),a=this._idlIx.args.findIndex(c=>c.name===o);if(a===-1)throw new Error(`Unable to find argument for seed: ${o}`);return t.slice(1).reduce((c,d)=>(c||{})[d],this._args[a])}async toBufferAccount(e,t=[]){const o=await this.accountValue(e,t);if(o)return this.toBufferValue(e.type,o)}async accountValue(e,t=[]){const o=e.path.split("."),a=o[0],c=this.get([...t,camelCase$1(a)]);if(c===null)throw new Error("fieldPubkey is null");if(o.length===1)return c;const d=await this._accountStore.fetchAccount({publicKey:c,name:e.account});return this.parseAccountValue(d,o.slice(1))}parseAccountValue(e,t){let o;for(;t.length>0;)o=e[camelCase$1(t[0])],t=t.slice(1);return o}toBufferValue(e,t){switch(e){case"u8":return Buffer.from([t]);case"u16":let o=Buffer.alloc(2);return o.writeUInt16LE(t),o;case"u32":let a=Buffer.alloc(4);return a.writeUInt32LE(t),a;case"u64":let c=Buffer.alloc(8);return c.writeBigUInt64LE(BigInt(t)),c;case"string":return Buffer.from(encode$2(t));case"publicKey":return t.toBuffer();default:if(e.array)return Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}}}AccountsResolver.CONST_ACCOUNTS={associatedTokenProgram:ASSOCIATED_PROGRAM_ID,rent:SYSVAR_RENT_PUBKEY,systemProgram:SystemProgram.programId,tokenProgram:TOKEN_PROGRAM_ID,clock:SYSVAR_CLOCK_PUBKEY};class AccountStore{constructor(e,t,o){this._provider=e,this._programId=o,this._cache=new Map,this._idls={},this._idls[o.toBase58()]=t}async ensureIdl(e){if(!this._idls[e.toBase58()]){const t=await Program.fetchIdl(e,this._provider);if(t){const o=new Program(t,e,this._provider);this._idls[e.toBase58()]=o.account}}return this._idls[e.toBase58()]}async fetchAccount({publicKey:e,name:t,programId:o=this._programId}){const a=e.toString();if(!this._cache.has(a))if(t==="TokenAccount"){const c=await this._provider.connection.getAccountInfo(e);if(c===null)throw new Error(`invalid account info for ${a}`);const d=decodeTokenAccount(c.data);this._cache.set(a,d)}else if(t){const c=await this.ensureIdl(o);if(c){const d=c[camelCase$1(t)];if(d){const g=await d.fetch(e);this._cache.set(a,g)}}}else{const c=await this._provider.connection.getAccountInfo(e);if(c===null)throw new Error(`invalid account info for ${a}`);const d=c.data,g=await this.ensureIdl(c.owner);if(g){const y=Object.values(g)[0];if(!y)throw new Error("No accounts for this program");const _=y.coder.accounts.decodeAny(d);this._cache.set(a,_)}}return this._cache.get(a)}}class MethodsBuilderFactory{static build(e,t,o,a,c,d,g,y,_,E,S){return(...A)=>new MethodsBuilder(A,a,c,d,g,y,e,t,o,_,E,S)}}function isPartialAccounts(s){return typeof s=="object"&&s!==null&&!("_bn"in s)}function flattenPartialAccounts(s,e){const t={};for(const o in s){const a=s[o];if(a===null){if(e)throw new Error("Failed to resolve optionals due to IDL type mismatch with input accounts!");continue}t[o]=isPartialAccounts(a)?flattenPartialAccounts(a,!0):translateAddress(a)}return t}class MethodsBuilder{constructor(e,t,o,a,c,d,g,y,_,E,S,A){this._ixFn=t,this._txFn=o,this._rpcFn=a,this._simulateFn=c,this._viewFn=d,this._programId=y,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._autoResolveAccounts=!0,this._args=e,this._accountsResolver=new AccountsResolver(e,this._accounts,g,y,_,E,S,A)}args(e){this._args=e,this._accountsResolver.args(e)}async pubkeys(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._accounts}accounts(e){return this._autoResolveAccounts=!0,this._accountsResolver.resolveOptionals(e),this}accountsStrict(e){return this._autoResolveAccounts=!1,this._accountsResolver.resolveOptionals(e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e){return this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async rpc(e){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async rpcAndKeys(e){return{pubkeys:await this.pubkeys(),signature:await this.rpc(e)}}async view(e){if(this._autoResolveAccounts&&await this._accountsResolver.resolve(),!this._viewFn)throw new Error("Method does not support views");return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async simulate(e){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async instruction(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async prepare(){return{instruction:await this.instruction(),pubkeys:await this.pubkeys(),signers:await this._signers}}async transaction(){return this._autoResolveAccounts&&await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}}class ViewFactory{static build(e,t,o,a){const c=t.accounts.find(y=>y.isMut),d=!!t.returns;return c||!d?void 0:async(...y)=>{var _,E;let S=await o(...y);const A=`Program return: ${e} `;let C=S.raw.find(P=>P.startsWith(A));if(!C)throw new Error("View expected return log");let N=decode(C.slice(A.length)),O=t.returns;if(!O)throw new Error("View expected return type");return IdlCoder.fieldLayout({type:O},Array.from([...(_=a.accounts)!==null&&_!==void 0?_:[],...(E=a.types)!==null&&E!==void 0?E:[]])).decode(N)}}}class NamespaceFactory{static build(e,t,o,a,c){const d={},g={},y={},_={},E={},S={},A=parseIdlErrors(e),C=e.accounts?AccountFactory.build(e,t,o,a):{},N=StateFactory.build(e,t,o,a);return e.instructions.forEach(O=>{const I=InstructionNamespaceFactory.build(O,(Q,fe)=>t.instruction.encode(Q,fe),o),P=TransactionFactory.build(O,I),j=RpcFactory.build(O,P,A,a),B=SimulateFactory.build(O,P,A,a,t,o,e),H=ViewFactory.build(o,O,B,e),se=MethodsBuilderFactory.build(a,o,O,I,P,j,B,H,C,e.types||[],c&&c(O)),oe=camelCase$1(O.name);g[oe]=I,y[oe]=P,d[oe]=j,_[oe]=B,E[oe]=se,H&&(S[oe]=H)}),[d,g,y,C,_,E,N,S]}}class Program{get programId(){return this._programId}get idl(){return this._idl}get coder(){return this._coder}get provider(){return this._provider}constructor(e,t,o,a,c){t=translateAddress(t),o||(o=getProvider()),this._idl=e,this._provider=o,this._programId=t,this._coder=a??new BorshCoder(e),this._events=new EventManager(this._programId,o,this._coder);const[d,g,y,_,E,S,A,C]=NamespaceFactory.build(e,this._coder,t,o,c??(()=>{}));this.rpc=d,this.instruction=g,this.transaction=y,this.account=_,this.simulate=E,this.methods=S,this.state=A,this.views=C}static async at(e,t){const o=translateAddress(e),a=await Program.fetchIdl(o,t);if(!a)throw new Error(`IDL not found for program: ${e.toString()}`);return new Program(a,o,t)}static async fetchIdl(e,t){t=t??getProvider();const o=translateAddress(e),a=await idlAddress(o),c=await t.connection.getAccountInfo(a);if(!c)return null;let d=decodeIdlAccount(c.data.slice(8));const g=inflate_1(d.data);return JSON.parse(decode$2(g))}addEventListener(e,t){return this._events.addEventListener(e,t)}async removeEventListener(e){return await this._events.removeEventListener(e)}}new PublicKey("11111111111111111111111111111111");/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$2(){return _extends$2=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o])}return s},_extends$2.apply(this,arguments)}var Action;(function(s){s.Pop="POP",s.Push="PUSH",s.Replace="REPLACE"})(Action||(Action={}));const PopStateEventType="popstate";function createBrowserHistory(s){s===void 0&&(s={});function e(o,a){let{pathname:c,search:d,hash:g}=o.location;return createLocation("",{pathname:c,search:d,hash:g},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(o,a){return typeof a=="string"?a:createPath(a)}return getUrlBasedHistory(e,t,null,s)}function invariant$1(s,e){if(s===!1||s===null||typeof s>"u")throw new Error(e)}function warning$1(s,e){if(!s){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function createKey(){return Math.random().toString(36).substr(2,8)}function getHistoryState(s,e){return{usr:s.state,key:s.key,idx:e}}function createLocation(s,e,t,o){return t===void 0&&(t=null),_extends$2({pathname:typeof s=="string"?s:s.pathname,search:"",hash:""},typeof e=="string"?parsePath(e):e,{state:t,key:e&&e.key||o||createKey()})}function createPath(s){let{pathname:e="/",search:t="",hash:o=""}=s;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),o&&o!=="#"&&(e+=o.charAt(0)==="#"?o:"#"+o),e}function parsePath(s){let e={};if(s){let t=s.indexOf("#");t>=0&&(e.hash=s.substr(t),s=s.substr(0,t));let o=s.indexOf("?");o>=0&&(e.search=s.substr(o),s=s.substr(0,o)),s&&(e.pathname=s)}return e}function getUrlBasedHistory(s,e,t,o){o===void 0&&(o={});let{window:a=document.defaultView,v5Compat:c=!1}=o,d=a.history,g=Action.Pop,y=null,_=E();_==null&&(_=0,d.replaceState(_extends$2({},d.state,{idx:_}),""));function E(){return(d.state||{idx:null}).idx}function S(){g=Action.Pop;let I=E(),P=I==null?null:I-_;_=I,y&&y({action:g,location:O.location,delta:P})}function A(I,P){g=Action.Push;let j=createLocation(O.location,I,P);t&&t(j,I),_=E()+1;let B=getHistoryState(j,_),H=O.createHref(j);try{d.pushState(B,"",H)}catch(se){if(se instanceof DOMException&&se.name==="DataCloneError")throw se;a.location.assign(H)}c&&y&&y({action:g,location:O.location,delta:1})}function C(I,P){g=Action.Replace;let j=createLocation(O.location,I,P);t&&t(j,I),_=E();let B=getHistoryState(j,_),H=O.createHref(j);d.replaceState(B,"",H),c&&y&&y({action:g,location:O.location,delta:0})}function N(I){let P=a.location.origin!=="null"?a.location.origin:a.location.href,j=typeof I=="string"?I:createPath(I);return j=j.replace(/ $/,"%20"),invariant$1(P,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,P)}let O={get action(){return g},get location(){return s(a,d)},listen(I){if(y)throw new Error("A history only accepts one active listener");return a.addEventListener(PopStateEventType,S),y=I,()=>{a.removeEventListener(PopStateEventType,S),y=null}},createHref(I){return e(a,I)},createURL:N,encodeLocation(I){let P=N(I);return{pathname:P.pathname,search:P.search,hash:P.hash}},push:A,replace:C,go(I){return d.go(I)}};return O}var ResultType;(function(s){s.data="data",s.deferred="deferred",s.redirect="redirect",s.error="error"})(ResultType||(ResultType={}));function matchRoutes(s,e,t){return t===void 0&&(t="/"),matchRoutesImpl(s,e,t,!1)}function matchRoutesImpl(s,e,t,o){let a=typeof e=="string"?parsePath(e):e,c=stripBasename(a.pathname||"/",t);if(c==null)return null;let d=flattenRoutes(s);rankRouteBranches(d);let g=null;for(let y=0;g==null&&y<d.length;++y){let _=decodePath(c);g=matchRouteBranch(d[y],_,o)}return g}function flattenRoutes(s,e,t,o){e===void 0&&(e=[]),t===void 0&&(t=[]),o===void 0&&(o="");let a=(c,d,g)=>{let y={relativePath:g===void 0?c.path||"":g,caseSensitive:c.caseSensitive===!0,childrenIndex:d,route:c};y.relativePath.startsWith("/")&&(invariant$1(y.relativePath.startsWith(o),'Absolute route path "'+y.relativePath+'" nested under path '+('"'+o+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),y.relativePath=y.relativePath.slice(o.length));let _=joinPaths([o,y.relativePath]),E=t.concat(y);c.children&&c.children.length>0&&(invariant$1(c.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+_+'".')),flattenRoutes(c.children,e,E,_)),!(c.path==null&&!c.index)&&e.push({path:_,score:computeScore(_,c.index),routesMeta:E})};return s.forEach((c,d)=>{var g;if(c.path===""||!((g=c.path)!=null&&g.includes("?")))a(c,d);else for(let y of explodeOptionalSegments(c.path))a(c,d,y)}),e}function explodeOptionalSegments(s){let e=s.split("/");if(e.length===0)return[];let[t,...o]=e,a=t.endsWith("?"),c=t.replace(/\?$/,"");if(o.length===0)return a?[c,""]:[c];let d=explodeOptionalSegments(o.join("/")),g=[];return g.push(...d.map(y=>y===""?c:[c,y].join("/"))),a&&g.push(...d),g.map(y=>s.startsWith("/")&&y===""?"/":y)}function rankRouteBranches(s){s.sort((e,t)=>e.score!==t.score?t.score-e.score:compareIndexes(e.routesMeta.map(o=>o.childrenIndex),t.routesMeta.map(o=>o.childrenIndex)))}const paramRe=/^:[\w-]+$/,dynamicSegmentValue=3,indexRouteValue=2,emptySegmentValue=1,staticSegmentValue=10,splatPenalty=-2,isSplat=s=>s==="*";function computeScore(s,e){let t=s.split("/"),o=t.length;return t.some(isSplat)&&(o+=splatPenalty),e&&(o+=indexRouteValue),t.filter(a=>!isSplat(a)).reduce((a,c)=>a+(paramRe.test(c)?dynamicSegmentValue:c===""?emptySegmentValue:staticSegmentValue),o)}function compareIndexes(s,e){return s.length===e.length&&s.slice(0,-1).every((o,a)=>o===e[a])?s[s.length-1]-e[e.length-1]:0}function matchRouteBranch(s,e,t){t===void 0&&(t=!1);let{routesMeta:o}=s,a={},c="/",d=[];for(let g=0;g<o.length;++g){let y=o[g],_=g===o.length-1,E=c==="/"?e:e.slice(c.length)||"/",S=matchPath({path:y.relativePath,caseSensitive:y.caseSensitive,end:_},E),A=y.route;if(!S&&_&&t&&!o[o.length-1].route.index&&(S=matchPath({path:y.relativePath,caseSensitive:y.caseSensitive,end:!1},E)),!S)return null;Object.assign(a,S.params),d.push({params:a,pathname:joinPaths([c,S.pathname]),pathnameBase:normalizePathname(joinPaths([c,S.pathnameBase])),route:A}),S.pathnameBase!=="/"&&(c=joinPaths([c,S.pathnameBase]))}return d}function matchPath(s,e){typeof s=="string"&&(s={path:s,caseSensitive:!1,end:!0});let[t,o]=compilePath(s.path,s.caseSensitive,s.end),a=e.match(t);if(!a)return null;let c=a[0],d=c.replace(/(.)\/+$/,"$1"),g=a.slice(1);return{params:o.reduce((_,E,S)=>{let{paramName:A,isOptional:C}=E;if(A==="*"){let O=g[S]||"";d=c.slice(0,c.length-O.length).replace(/(.)\/+$/,"$1")}const N=g[S];return C&&!N?_[A]=void 0:_[A]=(N||"").replace(/%2F/g,"/"),_},{}),pathname:c,pathnameBase:d,pattern:s}}function compilePath(s,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),warning$1(s==="*"||!s.endsWith("*")||s.endsWith("/*"),'Route path "'+s+'" will be treated as if it were '+('"'+s.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+s.replace(/\*$/,"/*")+'".'));let o=[],a="^"+s.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(d,g,y)=>(o.push({paramName:g,isOptional:y!=null}),y?"/?([^\\/]+)?":"/([^\\/]+)"));return s.endsWith("*")?(o.push({paramName:"*"}),a+=s==="*"||s==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?a+="\\/*$":s!==""&&s!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),o]}function decodePath(s){try{return s.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return warning$1(!1,'The URL path "'+s+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),s}}function stripBasename(s,e){if(e==="/")return s;if(!s.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,o=s.charAt(t);return o&&o!=="/"?null:s.slice(t)||"/"}function resolvePath(s,e){e===void 0&&(e="/");let{pathname:t,search:o="",hash:a=""}=typeof s=="string"?parsePath(s):s;return{pathname:t?t.startsWith("/")?t:resolvePathname(t,e):e,search:normalizeSearch(o),hash:normalizeHash(a)}}function resolvePathname(s,e){let t=e.replace(/\/+$/,"").split("/");return s.split("/").forEach(a=>{a===".."?t.length>1&&t.pop():a!=="."&&t.push(a)}),t.length>1?t.join("/"):"/"}function getInvalidPathError(s,e,t,o){return"Cannot include a '"+s+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(o)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function getPathContributingMatches(s){return s.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function getResolveToMatches(s,e){let t=getPathContributingMatches(s);return e?t.map((o,a)=>a===t.length-1?o.pathname:o.pathnameBase):t.map(o=>o.pathnameBase)}function resolveTo(s,e,t,o){o===void 0&&(o=!1);let a;typeof s=="string"?a=parsePath(s):(a=_extends$2({},s),invariant$1(!a.pathname||!a.pathname.includes("?"),getInvalidPathError("?","pathname","search",a)),invariant$1(!a.pathname||!a.pathname.includes("#"),getInvalidPathError("#","pathname","hash",a)),invariant$1(!a.search||!a.search.includes("#"),getInvalidPathError("#","search","hash",a)));let c=s===""||a.pathname==="",d=c?"/":a.pathname,g;if(d==null)g=t;else{let S=e.length-1;if(!o&&d.startsWith("..")){let A=d.split("/");for(;A[0]==="..";)A.shift(),S-=1;a.pathname=A.join("/")}g=S>=0?e[S]:"/"}let y=resolvePath(a,g),_=d&&d!=="/"&&d.endsWith("/"),E=(c||d===".")&&t.endsWith("/");return!y.pathname.endsWith("/")&&(_||E)&&(y.pathname+="/"),y}const joinPaths=s=>s.join("/").replace(/\/\/+/g,"/"),normalizePathname=s=>s.replace(/\/+$/,"").replace(/^\/*/,"/"),normalizeSearch=s=>!s||s==="?"?"":s.startsWith("?")?s:"?"+s,normalizeHash=s=>!s||s==="#"?"":s.startsWith("#")?s:"#"+s;function isRouteErrorResponse(s){return s!=null&&typeof s.status=="number"&&typeof s.statusText=="string"&&typeof s.internal=="boolean"&&"data"in s}const validMutationMethodsArr=["post","put","patch","delete"];new Set(validMutationMethodsArr);const validRequestMethodsArr=["get",...validMutationMethodsArr];new Set(validRequestMethodsArr);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o])}return s},_extends$1.apply(this,arguments)}const DataRouterContext=reactExports.createContext(null),DataRouterStateContext=reactExports.createContext(null),NavigationContext=reactExports.createContext(null),LocationContext=reactExports.createContext(null),RouteContext=reactExports.createContext({outlet:null,matches:[],isDataRoute:!1}),RouteErrorContext=reactExports.createContext(null);function useHref(s,e){let{relative:t}=e===void 0?{}:e;useInRouterContext()||invariant$1(!1);let{basename:o,navigator:a}=reactExports.useContext(NavigationContext),{hash:c,pathname:d,search:g}=useResolvedPath(s,{relative:t}),y=d;return o!=="/"&&(y=d==="/"?o:joinPaths([o,d])),a.createHref({pathname:y,search:g,hash:c})}function useInRouterContext(){return reactExports.useContext(LocationContext)!=null}function useLocation(){return useInRouterContext()||invariant$1(!1),reactExports.useContext(LocationContext).location}function useIsomorphicLayoutEffect$1(s){reactExports.useContext(NavigationContext).static||reactExports.useLayoutEffect(s)}function useNavigate(){let{isDataRoute:s}=reactExports.useContext(RouteContext);return s?useNavigateStable():useNavigateUnstable()}function useNavigateUnstable(){useInRouterContext()||invariant$1(!1);let s=reactExports.useContext(DataRouterContext),{basename:e,future:t,navigator:o}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(a,t.v7_relativeSplatPath)),g=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{g.current=!0}),reactExports.useCallback(function(_,E){if(E===void 0&&(E={}),!g.current)return;if(typeof _=="number"){o.go(_);return}let S=resolveTo(_,JSON.parse(d),c,E.relative==="path");s==null&&e!=="/"&&(S.pathname=S.pathname==="/"?e:joinPaths([e,S.pathname])),(E.replace?o.replace:o.push)(S,E.state,E)},[e,o,d,c,s])}function useResolvedPath(s,e){let{relative:t}=e===void 0?{}:e,{future:o}=reactExports.useContext(NavigationContext),{matches:a}=reactExports.useContext(RouteContext),{pathname:c}=useLocation(),d=JSON.stringify(getResolveToMatches(a,o.v7_relativeSplatPath));return reactExports.useMemo(()=>resolveTo(s,JSON.parse(d),c,t==="path"),[s,d,c,t])}function useRoutes(s,e){return useRoutesImpl(s,e)}function useRoutesImpl(s,e,t,o){useInRouterContext()||invariant$1(!1);let{navigator:a}=reactExports.useContext(NavigationContext),{matches:c}=reactExports.useContext(RouteContext),d=c[c.length-1],g=d?d.params:{};d&&d.pathname;let y=d?d.pathnameBase:"/";d&&d.route;let _=useLocation(),E;if(e){var S;let I=typeof e=="string"?parsePath(e):e;y==="/"||(S=I.pathname)!=null&&S.startsWith(y)||invariant$1(!1),E=I}else E=_;let A=E.pathname||"/",C=A;if(y!=="/"){let I=y.replace(/^\//,"").split("/");C="/"+A.replace(/^\//,"").split("/").slice(I.length).join("/")}let N=matchRoutes(s,{pathname:C}),O=_renderMatches(N&&N.map(I=>Object.assign({},I,{params:Object.assign({},g,I.params),pathname:joinPaths([y,a.encodeLocation?a.encodeLocation(I.pathname).pathname:I.pathname]),pathnameBase:I.pathnameBase==="/"?y:joinPaths([y,a.encodeLocation?a.encodeLocation(I.pathnameBase).pathname:I.pathnameBase])})),c,t,o);return e&&O?reactExports.createElement(LocationContext.Provider,{value:{location:_extends$1({pathname:"/",search:"",hash:"",state:null,key:"default"},E),navigationType:Action.Pop}},O):O}function DefaultErrorComponent(){let s=useRouteError(),e=isRouteErrorResponse(s)?s.status+" "+s.statusText:s instanceof Error?s.message:JSON.stringify(s),t=s instanceof Error?s.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},c=null;return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("h2",null,"Unexpected Application Error!"),reactExports.createElement("h3",{style:{fontStyle:"italic"}},e),t?reactExports.createElement("pre",{style:a},t):null,c)}const defaultErrorElement=reactExports.createElement(DefaultErrorComponent,null);class RenderErrorBoundary extends reactExports.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?reactExports.createElement(RouteContext.Provider,{value:this.props.routeContext},reactExports.createElement(RouteErrorContext.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function RenderedRoute(s){let{routeContext:e,match:t,children:o}=s,a=reactExports.useContext(DataRouterContext);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),reactExports.createElement(RouteContext.Provider,{value:e},o)}function _renderMatches(s,e,t,o){var a;if(e===void 0&&(e=[]),t===void 0&&(t=null),o===void 0&&(o=null),s==null){var c;if(!t)return null;if(t.errors)s=t.matches;else if((c=o)!=null&&c.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)s=t.matches;else return null}let d=s,g=(a=t)==null?void 0:a.errors;if(g!=null){let E=d.findIndex(S=>S.route.id&&(g==null?void 0:g[S.route.id])!==void 0);E>=0||invariant$1(!1),d=d.slice(0,Math.min(d.length,E+1))}let y=!1,_=-1;if(t&&o&&o.v7_partialHydration)for(let E=0;E<d.length;E++){let S=d[E];if((S.route.HydrateFallback||S.route.hydrateFallbackElement)&&(_=E),S.route.id){let{loaderData:A,errors:C}=t,N=S.route.loader&&A[S.route.id]===void 0&&(!C||C[S.route.id]===void 0);if(S.route.lazy||N){y=!0,_>=0?d=d.slice(0,_+1):d=[d[0]];break}}}return d.reduceRight((E,S,A)=>{let C,N=!1,O=null,I=null;t&&(C=g&&S.route.id?g[S.route.id]:void 0,O=S.route.errorElement||defaultErrorElement,y&&(_<0&&A===0?(warningOnce("route-fallback",!1),N=!0,I=null):_===A&&(N=!0,I=S.route.hydrateFallbackElement||null)));let P=e.concat(d.slice(0,A+1)),j=()=>{let B;return C?B=O:N?B=I:S.route.Component?B=reactExports.createElement(S.route.Component,null):S.route.element?B=S.route.element:B=E,reactExports.createElement(RenderedRoute,{match:S,routeContext:{outlet:E,matches:P,isDataRoute:t!=null},children:B})};return t&&(S.route.ErrorBoundary||S.route.errorElement||A===0)?reactExports.createElement(RenderErrorBoundary,{location:t.location,revalidation:t.revalidation,component:O,error:C,children:j(),routeContext:{outlet:null,matches:P,isDataRoute:!0}}):j()},null)}var DataRouterHook$1=function(s){return s.UseBlocker="useBlocker",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s}(DataRouterHook$1||{}),DataRouterStateHook$1=function(s){return s.UseBlocker="useBlocker",s.UseLoaderData="useLoaderData",s.UseActionData="useActionData",s.UseRouteError="useRouteError",s.UseNavigation="useNavigation",s.UseRouteLoaderData="useRouteLoaderData",s.UseMatches="useMatches",s.UseRevalidator="useRevalidator",s.UseNavigateStable="useNavigate",s.UseRouteId="useRouteId",s}(DataRouterStateHook$1||{});function useDataRouterContext(s){let e=reactExports.useContext(DataRouterContext);return e||invariant$1(!1),e}function useDataRouterState(s){let e=reactExports.useContext(DataRouterStateContext);return e||invariant$1(!1),e}function useRouteContext(s){let e=reactExports.useContext(RouteContext);return e||invariant$1(!1),e}function useCurrentRouteId(s){let e=useRouteContext(),t=e.matches[e.matches.length-1];return t.route.id||invariant$1(!1),t.route.id}function useRouteError(){var s;let e=reactExports.useContext(RouteErrorContext),t=useDataRouterState(DataRouterStateHook$1.UseRouteError),o=useCurrentRouteId(DataRouterStateHook$1.UseRouteError);return e!==void 0?e:(s=t.errors)==null?void 0:s[o]}function useNavigateStable(){let{router:s}=useDataRouterContext(DataRouterHook$1.UseNavigateStable),e=useCurrentRouteId(DataRouterStateHook$1.UseNavigateStable),t=reactExports.useRef(!1);return useIsomorphicLayoutEffect$1(()=>{t.current=!0}),reactExports.useCallback(function(a,c){c===void 0&&(c={}),t.current&&(typeof a=="number"?s.navigate(a):s.navigate(a,_extends$1({fromRouteId:e},c)))},[s,e])}const alreadyWarned$1={};function warningOnce(s,e,t){!e&&!alreadyWarned$1[s]&&(alreadyWarned$1[s]=!0)}function logV6DeprecationWarnings(s,e){s==null||s.v7_startTransition,(s==null?void 0:s.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function Navigate(s){let{to:e,replace:t,state:o,relative:a}=s;useInRouterContext()||invariant$1(!1);let{future:c,static:d}=reactExports.useContext(NavigationContext),{matches:g}=reactExports.useContext(RouteContext),{pathname:y}=useLocation(),_=useNavigate(),E=resolveTo(e,getResolveToMatches(g,c.v7_relativeSplatPath),y,a==="path"),S=JSON.stringify(E);return reactExports.useEffect(()=>_(JSON.parse(S),{replace:t,state:o,relative:a}),[_,S,a,t,o]),null}function Route(s){invariant$1(!1)}function Router(s){let{basename:e="/",children:t=null,location:o,navigationType:a=Action.Pop,navigator:c,static:d=!1,future:g}=s;useInRouterContext()&&invariant$1(!1);let y=e.replace(/^\/*/,"/"),_=reactExports.useMemo(()=>({basename:y,navigator:c,static:d,future:_extends$1({v7_relativeSplatPath:!1},g)}),[y,g,c,d]);typeof o=="string"&&(o=parsePath(o));let{pathname:E="/",search:S="",hash:A="",state:C=null,key:N="default"}=o,O=reactExports.useMemo(()=>{let I=stripBasename(E,y);return I==null?null:{location:{pathname:I,search:S,hash:A,state:C,key:N},navigationType:a}},[y,E,S,A,C,N,a]);return O==null?null:reactExports.createElement(NavigationContext.Provider,{value:_},reactExports.createElement(LocationContext.Provider,{children:t,value:O}))}function Routes(s){let{children:e,location:t}=s;return useRoutes(createRoutesFromChildren(e),t)}new Promise(()=>{});function createRoutesFromChildren(s,e){e===void 0&&(e=[]);let t=[];return reactExports.Children.forEach(s,(o,a)=>{if(!reactExports.isValidElement(o))return;let c=[...e,a];if(o.type===reactExports.Fragment){t.push.apply(t,createRoutesFromChildren(o.props.children,c));return}o.type!==Route&&invariant$1(!1),!o.props.index||!o.props.children||invariant$1(!1);let d={id:o.props.id||c.join("-"),caseSensitive:o.props.caseSensitive,element:o.props.element,Component:o.props.Component,index:o.props.index,path:o.props.path,loader:o.props.loader,action:o.props.action,errorElement:o.props.errorElement,ErrorBoundary:o.props.ErrorBoundary,hasErrorBoundary:o.props.ErrorBoundary!=null||o.props.errorElement!=null,shouldRevalidate:o.props.shouldRevalidate,handle:o.props.handle,lazy:o.props.lazy};o.props.children&&(d.children=createRoutesFromChildren(o.props.children,c)),t.push(d)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _extends(){return _extends=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(s[o]=t[o])}return s},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(s,e){if(s==null)return{};var t={},o=Object.keys(s),a,c;for(c=0;c<o.length;c++)a=o[c],!(e.indexOf(a)>=0)&&(t[a]=s[a]);return t}function isModifiedEvent(s){return!!(s.metaKey||s.altKey||s.ctrlKey||s.shiftKey)}function shouldProcessLinkClick(s,e){return s.button===0&&(!e||e==="_self")&&!isModifiedEvent(s)}const _excluded=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],REACT_ROUTER_VERSION="6";try{window.__reactRouterVersion=REACT_ROUTER_VERSION}catch(s){}const START_TRANSITION="startTransition",startTransitionImpl=React[START_TRANSITION];function BrowserRouter(s){let{basename:e,children:t,future:o,window:a}=s,c=reactExports.useRef();c.current==null&&(c.current=createBrowserHistory({window:a,v5Compat:!0}));let d=c.current,[g,y]=reactExports.useState({action:d.action,location:d.location}),{v7_startTransition:_}=o||{},E=reactExports.useCallback(S=>{_&&startTransitionImpl?startTransitionImpl(()=>y(S)):y(S)},[y,_]);return reactExports.useLayoutEffect(()=>d.listen(E),[d,E]),reactExports.useEffect(()=>logV6DeprecationWarnings(o),[o]),reactExports.createElement(Router,{basename:e,children:t,location:g.location,navigationType:g.action,navigator:d,future:o})}const isBrowser$1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",ABSOLUTE_URL_REGEX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Link=reactExports.forwardRef(function s(e,t){let{onClick:o,relative:a,reloadDocument:c,replace:d,state:g,target:y,to:_,preventScrollReset:E,viewTransition:S}=e,A=_objectWithoutPropertiesLoose(e,_excluded),{basename:C}=reactExports.useContext(NavigationContext),N,O=!1;if(typeof _=="string"&&ABSOLUTE_URL_REGEX.test(_)&&(N=_,isBrowser$1))try{let B=new URL(window.location.href),H=_.startsWith("//")?new URL(B.protocol+_):new URL(_),se=stripBasename(H.pathname,C);H.origin===B.origin&&se!=null?_=se+H.search+H.hash:O=!0}catch{}let I=useHref(_,{relative:a}),P=useLinkClickHandler(_,{replace:d,state:g,target:y,preventScrollReset:E,relative:a,viewTransition:S});function j(B){o&&o(B),B.defaultPrevented||P(B)}return reactExports.createElement("a",_extends({},A,{href:N||I,onClick:O||c?o:j,ref:t,target:y}))});var DataRouterHook;(function(s){s.UseScrollRestoration="useScrollRestoration",s.UseSubmit="useSubmit",s.UseSubmitFetcher="useSubmitFetcher",s.UseFetcher="useFetcher",s.useViewTransitionState="useViewTransitionState"})(DataRouterHook||(DataRouterHook={}));var DataRouterStateHook;(function(s){s.UseFetcher="useFetcher",s.UseFetchers="useFetchers",s.UseScrollRestoration="useScrollRestoration"})(DataRouterStateHook||(DataRouterStateHook={}));function useLinkClickHandler(s,e){let{target:t,replace:o,state:a,preventScrollReset:c,relative:d,viewTransition:g}=e===void 0?{}:e,y=useNavigate(),_=useLocation(),E=useResolvedPath(s,{relative:d});return reactExports.useCallback(S=>{if(shouldProcessLinkClick(S,t)){S.preventDefault();let A=o!==void 0?o:createPath(_)===createPath(E);y(s,{replace:A,state:a,preventScrollReset:c,relative:d,viewTransition:g})}},[_,y,E,o,a,t,s,c,d,g])}const MotionConfigContext=reactExports.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"}),MotionContext=reactExports.createContext({}),PresenceContext=reactExports.createContext(null),isBrowser=typeof document<"u",useIsomorphicLayoutEffect=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,LazyContext=reactExports.createContext({strict:!1}),camelToDash=s=>s.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId);function useVisualElement(s,e,t,o){const{visualElement:a}=reactExports.useContext(MotionContext),c=reactExports.useContext(LazyContext),d=reactExports.useContext(PresenceContext),g=reactExports.useContext(MotionConfigContext).reducedMotion,y=reactExports.useRef();o=o||c.renderer,!y.current&&o&&(y.current=o(s,{visualState:e,parent:a,props:t,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:g}));const _=y.current;reactExports.useInsertionEffect(()=>{_&&_.update(t,d)});const E=reactExports.useRef(!!(t[optimizedAppearDataAttribute]&&!window.HandoffComplete));return useIsomorphicLayoutEffect(()=>{_&&(_.render(),E.current&&_.animationState&&_.animationState.animateChanges())}),reactExports.useEffect(()=>{_&&(_.updateFeatures(),!E.current&&_.animationState&&_.animationState.animateChanges(),E.current&&(E.current=!1,window.HandoffComplete=!0))}),_}function isRefObject(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function useMotionRef(s,e,t){return reactExports.useCallback(o=>{o&&s.mount&&s.mount(o),e&&(o?e.mount(o):e.unmount()),t&&(typeof t=="function"?t(o):isRefObject(t)&&(t.current=o))},[e])}function isVariantLabel(s){return typeof s=="string"||Array.isArray(s)}function isAnimationControls(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(s){return isAnimationControls(s.animate)||variantProps.some(e=>isVariantLabel(s[e]))}function isVariantNode(s){return!!(isControllingVariants(s)||s.variants)}function getCurrentTreeVariants(s,e){if(isControllingVariants(s)){const{initial:t,animate:o}=s;return{initial:t===!1||isVariantLabel(t)?t:void 0,animate:isVariantLabel(o)?o:void 0}}return s.inherit!==!1?e:{}}function useCreateMotionContext(s){const{initial:e,animate:t}=getCurrentTreeVariants(s,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:e,animate:t}),[variantLabelsAsDependency(e),variantLabelsAsDependency(t)])}function variantLabelsAsDependency(s){return Array.isArray(s)?s.join(" "):s}const featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const s in featureProps)featureDefinitions[s]={isEnabled:e=>featureProps[s].some(t=>!!e[t])};function loadFeatures(s){for(const e in s)featureDefinitions[e]={...featureDefinitions[e],...s[e]}}const LayoutGroupContext=reactExports.createContext({}),SwitchLayoutGroupContext=reactExports.createContext({}),motionComponentSymbol=Symbol.for("motionComponentSymbol");function createMotionComponent({preloadedFeatures:s,createVisualElement:e,useRender:t,useVisualState:o,Component:a}){s&&loadFeatures(s);function c(g,y){let _;const E={...reactExports.useContext(MotionConfigContext),...g,layoutId:useLayoutId(g)},{isStatic:S}=E,A=useCreateMotionContext(g),C=o(g,S);if(!S&&isBrowser){A.visualElement=useVisualElement(a,C,E,e);const N=reactExports.useContext(SwitchLayoutGroupContext),O=reactExports.useContext(LazyContext).strict;A.visualElement&&(_=A.visualElement.loadFeatures(E,O,s,N))}return reactExports.createElement(MotionContext.Provider,{value:A},_&&A.visualElement?reactExports.createElement(_,{visualElement:A.visualElement,...E}):null,t(a,g,useMotionRef(C,A.visualElement,y),C,S,A.visualElement))}const d=reactExports.forwardRef(c);return d[motionComponentSymbol]=a,d}function useLayoutId({layoutId:s}){const e=reactExports.useContext(LayoutGroupContext).id;return e&&s!==void 0?e+"-"+s:s}function createMotionProxy(s){function e(o,a={}){return createMotionComponent(s(o,a))}if(typeof Proxy>"u")return e;const t=new Map;return new Proxy(e,{get:(o,a)=>(t.has(a)||t.set(a,e(a)),t.get(a))})}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(s){return typeof s!="string"||s.includes("-")?!1:!!(lowercaseSVGElements.indexOf(s)>-1||/[A-Z]/.test(s))}const scaleCorrectors={};function addScaleCorrector(s){Object.assign(scaleCorrectors,s)}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder);function isForcedMotionValue(s,{layout:e,layoutId:t}){return transformProps.has(s)||s.startsWith("origin")||(e||t!==void 0)&&(!!scaleCorrectors[s]||s==="opacity")}const isMotionValue=s=>!!(s&&s.getVelocity),translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(s,{enableHardwareAcceleration:e=!0,allowTransformNone:t=!0},o,a){let c="";for(let d=0;d<numTransforms;d++){const g=transformPropOrder[d];if(s[g]!==void 0){const y=translateAlias[g]||g;c+=`${y}(${s[g]}) `}}return e&&!s.z&&(c+="translateZ(0)"),c=c.trim(),a?c=a(s,o?"":c):t&&o&&(c="none"),c}const checkStringStartsWith=s=>e=>typeof e=="string"&&e.startsWith(s),isCSSVariableName=checkStringStartsWith("--"),isCSSVariableToken=checkStringStartsWith("var(--"),cssVariableRegex=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,getValueAsType=(s,e)=>e&&typeof s=="number"?e.transform(s):s,clamp$1=(s,e,t)=>Math.min(Math.max(t,s),e),number={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},alpha={...number,transform:s=>clamp$1(0,1,s)},scale={...number,default:1},sanitize=s=>Math.round(s*1e5)/1e5,floatRegex=/(-)?([\d]*\.?[\d])+/g,colorRegex=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,singleColorRegex=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function isString$1(s){return typeof s=="string"}const createUnitType=s=>({test:e=>isString$1(e)&&e.endsWith(s)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${s}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:s=>percent.parse(s)/100,transform:s=>percent.transform(s*100)},int={...number,transform:Math.round},numberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,size:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px,zIndex:int,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int};function buildHTMLStyles(s,e,t,o){const{style:a,vars:c,transform:d,transformOrigin:g}=s;let y=!1,_=!1,E=!0;for(const S in e){const A=e[S];if(isCSSVariableName(S)){c[S]=A;continue}const C=numberValueTypes[S],N=getValueAsType(A,C);if(transformProps.has(S)){if(y=!0,d[S]=N,!E)continue;A!==(C.default||0)&&(E=!1)}else S.startsWith("origin")?(_=!0,g[S]=N):a[S]=N}if(e.transform||(y||o?a.transform=buildTransform(s.transform,t,E,o):a.transform&&(a.transform="none")),_){const{originX:S="50%",originY:A="50%",originZ:C=0}=g;a.transformOrigin=`${S} ${A} ${C}`}}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(s,e,t){for(const o in e)!isMotionValue(e[o])&&!isForcedMotionValue(o,t)&&(s[o]=e[o])}function useInitialMotionValues({transformTemplate:s},e,t){return reactExports.useMemo(()=>{const o=createHtmlRenderState();return buildHTMLStyles(o,e,{enableHardwareAcceleration:!t},s),Object.assign({},o.vars,o.style)},[e])}function useStyle(s,e,t){const o=s.style||{},a={};return copyRawValuesOnly(a,o,s),Object.assign(a,useInitialMotionValues(s,e,t)),s.transformValues?s.transformValues(a):a}function useHTMLProps(s,e,t){const o={},a=useStyle(s,e,t);return s.drag&&s.dragListener!==!1&&(o.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(o.tabIndex=0),o.style=a,o}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||validMotionProps.has(s)}let shouldForward=s=>!isValidMotionProp(s);function loadExternalIsValidProp(s){s&&(shouldForward=e=>e.startsWith("on")?!isValidMotionProp(e):s(e))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch(s){}function filterProps(s,e,t){const o={};for(const a in s)a==="values"&&typeof s.values=="object"||(shouldForward(a)||t===!0&&isValidMotionProp(a)||!e&&!isValidMotionProp(a)||s.draggable&&a.startsWith("onDrag"))&&(o[a]=s[a]);return o}function calcOrigin$1(s,e,t){return typeof s=="string"?s:px.transform(e+t*s)}function calcSVGTransformOrigin(s,e,t){const o=calcOrigin$1(e,s.x,s.width),a=calcOrigin$1(t,s.y,s.height);return`${o} ${a}`}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(s,e,t=1,o=0,a=!0){s.pathLength=1;const c=a?dashKeys:camelKeys;s[c.offset]=px.transform(-o);const d=px.transform(e),g=px.transform(t);s[c.array]=`${d} ${g}`}function buildSVGAttrs(s,{attrX:e,attrY:t,attrScale:o,originX:a,originY:c,pathLength:d,pathSpacing:g=1,pathOffset:y=0,..._},E,S,A){if(buildHTMLStyles(s,_,E,A),S){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:C,style:N,dimensions:O}=s;C.transform&&(O&&(N.transform=C.transform),delete C.transform),O&&(a!==void 0||c!==void 0||N.transform)&&(N.transformOrigin=calcSVGTransformOrigin(O,a!==void 0?a:.5,c!==void 0?c:.5)),e!==void 0&&(C.x=e),t!==void 0&&(C.y=t),o!==void 0&&(C.scale=o),d!==void 0&&buildSVGPath(C,d,g,y,!1)}const createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=s=>typeof s=="string"&&s.toLowerCase()==="svg";function useSVGProps(s,e,t,o){const a=reactExports.useMemo(()=>{const c=createSvgRenderState();return buildSVGAttrs(c,e,{enableHardwareAcceleration:!1},isSVGTag(o),s.transformTemplate),{...c.attrs,style:{...c.style}}},[e]);if(s.style){const c={};copyRawValuesOnly(c,s.style,s),a.style={...c,...a.style}}return a}function createUseRender(s=!1){return(t,o,a,{latestValues:c},d)=>{const y=(isSVGComponent(t)?useSVGProps:useHTMLProps)(o,c,d,t),E={...filterProps(o,typeof t=="string",s),...y,ref:a},{children:S}=o,A=reactExports.useMemo(()=>isMotionValue(S)?S.get():S,[S]);return reactExports.createElement(t,{...E,children:A})}}function renderHTML(s,{style:e,vars:t},o,a){Object.assign(s.style,e,a&&a.getProjectionStyles(o));for(const c in t)s.style.setProperty(c,t[c])}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(s,e,t,o){renderHTML(s,e,void 0,o);for(const a in e.attrs)s.setAttribute(camelCaseAttributes.has(a)?a:camelToDash(a),e.attrs[a])}function scrapeMotionValuesFromProps$1(s,e){const{style:t}=s,o={};for(const a in t)(isMotionValue(t[a])||e.style&&isMotionValue(e.style[a])||isForcedMotionValue(a,s))&&(o[a]=t[a]);return o}function scrapeMotionValuesFromProps(s,e){const t=scrapeMotionValuesFromProps$1(s,e);for(const o in s)if(isMotionValue(s[o])||isMotionValue(e[o])){const a=transformPropOrder.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;t[a]=s[o]}return t}function resolveVariantFromProps(s,e,t,o={},a={}){return typeof e=="function"&&(e=e(t!==void 0?t:s.custom,o,a)),typeof e=="string"&&(e=s.variants&&s.variants[e]),typeof e=="function"&&(e=e(t!==void 0?t:s.custom,o,a)),e}function useConstant(s){const e=reactExports.useRef(null);return e.current===null&&(e.current=s()),e.current}const isKeyframesTarget=s=>Array.isArray(s),isCustomValue=s=>!!(s&&typeof s=="object"&&s.mix&&s.toValue),resolveFinalValueInKeyframes=s=>isKeyframesTarget(s)?s[s.length-1]||0:s;function resolveMotionValue(s){const e=isMotionValue(s)?s.get():s;return isCustomValue(e)?e.toValue():e}function makeState({scrapeMotionValuesFromProps:s,createRenderState:e,onMount:t},o,a,c){const d={latestValues:makeLatestValues(o,a,c,s),renderState:e()};return t&&(d.mount=g=>t(o,g,d)),d}const makeUseVisualState=s=>(e,t)=>{const o=reactExports.useContext(MotionContext),a=reactExports.useContext(PresenceContext),c=()=>makeState(s,e,o,a);return t?c():useConstant(c)};function makeLatestValues(s,e,t,o){const a={},c=o(s,{});for(const A in c)a[A]=resolveMotionValue(c[A]);let{initial:d,animate:g}=s;const y=isControllingVariants(s),_=isVariantNode(s);e&&_&&!y&&s.inherit!==!1&&(d===void 0&&(d=e.initial),g===void 0&&(g=e.animate));let E=t?t.initial===!1:!1;E=E||d===!1;const S=E?g:d;return S&&typeof S!="boolean"&&!isAnimationControls(S)&&(Array.isArray(S)?S:[S]).forEach(C=>{const N=resolveVariantFromProps(s,C);if(!N)return;const{transitionEnd:O,transition:I,...P}=N;for(const j in P){let B=P[j];if(Array.isArray(B)){const H=E?B.length-1:0;B=B[H]}B!==null&&(a[j]=B)}for(const j in O)a[j]=O[j]}),a}const noop$1=s=>s;class Queue{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const t=this.order.indexOf(e);t!==-1&&(this.order.splice(t,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function createRenderStep(s){let e=new Queue,t=new Queue,o=0,a=!1,c=!1;const d=new WeakSet,g={schedule:(y,_=!1,E=!1)=>{const S=E&&a,A=S?e:t;return _&&d.add(y),A.add(y)&&S&&a&&(o=e.order.length),y},cancel:y=>{t.remove(y),d.delete(y)},process:y=>{if(a){c=!0;return}if(a=!0,[e,t]=[t,e],t.clear(),o=e.order.length,o)for(let _=0;_<o;_++){const E=e.order[_];E(y),d.has(E)&&(g.schedule(E),s())}a=!1,c&&(c=!1,g.process(y))}};return g}const stepsOrder=["prepare","read","update","preRender","render","postRender"],maxElapsed=40;function createRenderBatcher(s,e){let t=!1,o=!0;const a={delta:0,timestamp:0,isProcessing:!1},c=stepsOrder.reduce((S,A)=>(S[A]=createRenderStep(()=>t=!0),S),{}),d=S=>c[S].process(a),g=()=>{const S=performance.now();t=!1,a.delta=o?1e3/60:Math.max(Math.min(S-a.timestamp,maxElapsed),1),a.timestamp=S,a.isProcessing=!0,stepsOrder.forEach(d),a.isProcessing=!1,t&&e&&(o=!1,s(g))},y=()=>{t=!0,o=!0,a.isProcessing||s(g)};return{schedule:stepsOrder.reduce((S,A)=>{const C=c[A];return S[A]=(N,O=!1,I=!1)=>(t||y(),C.schedule(N,O,I)),S},{}),cancel:S=>stepsOrder.forEach(A=>c[A].cancel(S)),state:a,steps:c}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop$1,!0),svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onMount:(s,e,{renderState:t,latestValues:o})=>{frame.read(()=>{try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}),frame.render(()=>{buildSVGAttrs(t,o,{enableHardwareAcceleration:!1},isSVGTag(e.tagName),s.transformTemplate),renderSVG(e,t)})}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function createDomMotionConfig(s,{forwardMotionProps:e=!1},t,o){return{...isSVGComponent(s)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:t,useRender:createUseRender(e),createVisualElement:o,Component:s}}function addDomEvent(s,e,t,o={passive:!0}){return s.addEventListener(e,t,o),()=>s.removeEventListener(e,t)}const isPrimaryPointer=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1;function extractEventInfo(s,e="page"){return{point:{x:s[e+"X"],y:s[e+"Y"]}}}const addPointerInfo=s=>e=>isPrimaryPointer(e)&&s(e,extractEventInfo(e));function addPointerEvent(s,e,t,o){return addDomEvent(s,e,addPointerInfo(t),o)}const combineFunctions=(s,e)=>t=>e(s(t)),pipe=(...s)=>s.reduce(combineFunctions);function createLock(s){let e=null;return()=>{const t=()=>{e=null};return e===null?(e=s,t):!1}}const globalHorizontalLock=createLock("dragHorizontal"),globalVerticalLock=createLock("dragVertical");function getGlobalLock(s){let e=!1;if(s==="y")e=globalVerticalLock();else if(s==="x")e=globalHorizontalLock();else{const t=globalHorizontalLock(),o=globalVerticalLock();t&&o?e=()=>{t(),o()}:(t&&t(),o&&o())}return e}function isDragActive(){const s=getGlobalLock(!0);return s?(s(),!1):!0}class Feature{constructor(e){this.isMounted=!1,this.node=e}update(){}}function addHoverEvent(s,e){const t="pointer"+(e?"enter":"leave"),o="onHover"+(e?"Start":"End"),a=(c,d)=>{if(c.pointerType==="touch"||isDragActive())return;const g=s.getProps();s.animationState&&g.whileHover&&s.animationState.setActive("whileHover",e),g[o]&&frame.update(()=>g[o](c,d))};return addPointerEvent(s.current,t,a,{passive:!s.getProps()[o]})}class HoverGesture extends Feature{mount(){this.unmount=pipe(addHoverEvent(this.node,!0),addHoverEvent(this.node,!1))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const isNodeOrChild=(s,e)=>e?s===e?!0:isNodeOrChild(s,e.parentElement):!1;function fireSyntheticPointerEvent(s,e){if(!e)return;const t=new PointerEvent("pointer"+s);e(t,extractEventInfo(t))}class PressGesture extends Feature{constructor(){super(...arguments),this.removeStartListeners=noop$1,this.removeEndListeners=noop$1,this.removeAccessibleListeners=noop$1,this.startPointerPress=(e,t)=>{if(this.isPressing)return;this.removeEndListeners();const o=this.node.getProps(),c=addPointerEvent(window,"pointerup",(g,y)=>{if(!this.checkPressEnd())return;const{onTap:_,onTapCancel:E,globalTapTarget:S}=this.node.getProps();frame.update(()=>{!S&&!isNodeOrChild(this.node.current,g.target)?E&&E(g,y):_&&_(g,y)})},{passive:!(o.onTap||o.onPointerUp)}),d=addPointerEvent(window,"pointercancel",(g,y)=>this.cancelPress(g,y),{passive:!(o.onTapCancel||o.onPointerCancel)});this.removeEndListeners=pipe(c,d),this.startPress(e,t)},this.startAccessiblePress=()=>{const e=c=>{if(c.key!=="Enter"||this.isPressing)return;const d=g=>{g.key!=="Enter"||!this.checkPressEnd()||fireSyntheticPointerEvent("up",(y,_)=>{const{onTap:E}=this.node.getProps();E&&frame.update(()=>E(y,_))})};this.removeEndListeners(),this.removeEndListeners=addDomEvent(this.node.current,"keyup",d),fireSyntheticPointerEvent("down",(g,y)=>{this.startPress(g,y)})},t=addDomEvent(this.node.current,"keydown",e),o=()=>{this.isPressing&&fireSyntheticPointerEvent("cancel",(c,d)=>this.cancelPress(c,d))},a=addDomEvent(this.node.current,"blur",o);this.removeAccessibleListeners=pipe(t,a)}}startPress(e,t){this.isPressing=!0;const{onTapStart:o,whileTap:a}=this.node.getProps();a&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),o&&frame.update(()=>o(e,t))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!isDragActive()}cancelPress(e,t){if(!this.checkPressEnd())return;const{onTapCancel:o}=this.node.getProps();o&&frame.update(()=>o(e,t))}mount(){const e=this.node.getProps(),t=addPointerEvent(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),o=addDomEvent(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pipe(t,o)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=s=>{const e=observerCallbacks.get(s.target);e&&e(s)},fireAllObserverCallbacks=s=>{s.forEach(fireObserverCallback)};function initIntersectionObserver({root:s,...e}){const t=s||document;observers.has(t)||observers.set(t,{});const o=observers.get(t),a=JSON.stringify(e);return o[a]||(o[a]=new IntersectionObserver(fireAllObserverCallbacks,{root:s,...e})),o[a]}function observeIntersection(s,e,t){const o=initIntersectionObserver(e);return observerCallbacks.set(s,t),o.observe(s),()=>{observerCallbacks.delete(s),o.unobserve(s)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:o,amount:a="some",once:c}=e,d={root:t?t.current:void 0,rootMargin:o,threshold:typeof a=="number"?a:thresholdNames[a]},g=y=>{const{isIntersecting:_}=y;if(this.isInView===_||(this.isInView=_,c&&!_&&this.hasEnteredView))return;_&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",_);const{onViewportEnter:E,onViewportLeave:S}=this.node.getProps(),A=_?E:S;A&&A(y)};return observeIntersection(this.node.current,d,g)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(e,t))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:s={}},{viewport:e={}}={}){return t=>s[t]!==e[t]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}};function shallowCompare(s,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==s.length)return!1;for(let o=0;o<t;o++)if(e[o]!==s[o])return!1;return!0}function getCurrent(s){const e={};return s.values.forEach((t,o)=>e[o]=t.get()),e}function getVelocity$1(s){const e={};return s.values.forEach((t,o)=>e[o]=t.getVelocity()),e}function resolveVariant(s,e,t){const o=s.getProps();return resolveVariantFromProps(o,e,t!==void 0?t:o.custom,getCurrent(s),getVelocity$1(s))}let warning=noop$1,invariant=noop$1;const secondsToMilliseconds=s=>s*1e3,millisecondsToSeconds=s=>s/1e3,instantAnimationState={current:!1},isBezierDefinition=s=>Array.isArray(s)&&typeof s[0]=="number";function isWaapiSupportedEasing(s){return!!(!s||typeof s=="string"&&supportedWaapiEasing[s]||isBezierDefinition(s)||Array.isArray(s)&&s.every(isWaapiSupportedEasing))}const cubicBezierAsString=([s,e,t,o])=>`cubic-bezier(${s}, ${e}, ${t}, ${o})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(s){if(s)return isBezierDefinition(s)?cubicBezierAsString(s):Array.isArray(s)?s.map(mapEasingToNativeEasing):supportedWaapiEasing[s]}function animateStyle(s,e,t,{delay:o=0,duration:a,repeat:c=0,repeatType:d="loop",ease:g,times:y}={}){const _={[e]:t};y&&(_.offset=y);const E=mapEasingToNativeEasing(g);return Array.isArray(E)&&(_.easing=E),s.animate(_,{delay:o,duration:a,easing:Array.isArray(E)?"linear":E,fill:"both",iterations:c+1,direction:d==="reverse"?"alternate":"normal"})}function getFinalKeyframe(s,{repeat:e,repeatType:t="loop"}){const o=e&&t!=="loop"&&e%2===1?0:s.length-1;return s[o]}const calcBezier=(s,e,t)=>(((1-3*t+3*e)*s+(3*t-6*e))*s+3*e)*s,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(s,e,t,o,a){let c,d,g=0;do d=e+(t-e)/2,c=calcBezier(d,o,a)-s,c>0?t=d:e=d;while(Math.abs(c)>subdivisionPrecision&&++g<subdivisionMaxIterations);return d}function cubicBezier(s,e,t,o){if(s===e&&t===o)return noop$1;const a=c=>binarySubdivide(c,0,1,s,t);return c=>c===0||c===1?c:calcBezier(a(c),e,o)}const easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=s=>Array.isArray(s)&&typeof s[0]!="number",mirrorEasing=s=>e=>e<=.5?s(2*e)/2:(2-s(2*(1-e)))/2,reverseEasing=s=>e=>1-s(1-e),circIn=s=>1-Math.sin(Math.acos(s)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=s=>(s*=2)<1?.5*backIn(s):.5*(2-Math.pow(2,-10*(s-1))),easingLookup={linear:noop$1,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},easingDefinitionToFunction=s=>{if(Array.isArray(s)){invariant(s.length===4);const[e,t,o,a]=s;return cubicBezier(e,t,o,a)}else if(typeof s=="string")return easingLookup[s];return s},isColorString=(s,e)=>t=>!!(isString$1(t)&&singleColorRegex.test(t)&&t.startsWith(s)||e&&Object.prototype.hasOwnProperty.call(t,e)),splitColor=(s,e,t)=>o=>{if(!isString$1(o))return o;const[a,c,d,g]=o.match(floatRegex);return{[s]:parseFloat(a),[e]:parseFloat(c),[t]:parseFloat(d),alpha:g!==void 0?parseFloat(g):1}},clampRgbUnit=s=>clamp$1(0,255,s),rgbUnit={...number,transform:s=>Math.round(clampRgbUnit(s))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:s,green:e,blue:t,alpha:o=1})=>"rgba("+rgbUnit.transform(s)+", "+rgbUnit.transform(e)+", "+rgbUnit.transform(t)+", "+sanitize(alpha.transform(o))+")"};function parseHex(s){let e="",t="",o="",a="";return s.length>5?(e=s.substring(1,3),t=s.substring(3,5),o=s.substring(5,7),a=s.substring(7,9)):(e=s.substring(1,2),t=s.substring(2,3),o=s.substring(3,4),a=s.substring(4,5),e+=e,t+=t,o+=o,a+=a),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(o,16),alpha:a?parseInt(a,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:s,saturation:e,lightness:t,alpha:o=1})=>"hsla("+Math.round(s)+", "+percent.transform(sanitize(e))+", "+percent.transform(sanitize(t))+", "+sanitize(alpha.transform(o))+")"},color={test:s=>rgba.test(s)||hex.test(s)||hsla.test(s),parse:s=>rgba.test(s)?rgba.parse(s):hsla.test(s)?hsla.parse(s):hex.parse(s),transform:s=>isString$1(s)?s:s.hasOwnProperty("red")?rgba.transform(s):hsla.transform(s)},mix=(s,e,t)=>-t*s+t*e+s;function hueToRgb(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*(2/3-t)*6:s}function hslaToRgba({hue:s,saturation:e,lightness:t,alpha:o}){s/=360,e/=100,t/=100;let a=0,c=0,d=0;if(!e)a=c=d=t;else{const g=t<.5?t*(1+e):t+e-t*e,y=2*t-g;a=hueToRgb(y,g,s+1/3),c=hueToRgb(y,g,s),d=hueToRgb(y,g,s-1/3)}return{red:Math.round(a*255),green:Math.round(c*255),blue:Math.round(d*255),alpha:o}}const mixLinearColor=(s,e,t)=>{const o=s*s;return Math.sqrt(Math.max(0,t*(e*e-o)+o))},colorTypes=[hex,rgba,hsla],getColorType=s=>colorTypes.find(e=>e.test(s));function asRGBA(s){const e=getColorType(s);let t=e.parse(s);return e===hsla&&(t=hslaToRgba(t)),t}const mixColor=(s,e)=>{const t=asRGBA(s),o=asRGBA(e),a={...t};return c=>(a.red=mixLinearColor(t.red,o.red,c),a.green=mixLinearColor(t.green,o.green,c),a.blue=mixLinearColor(t.blue,o.blue,c),a.alpha=mix(t.alpha,o.alpha,c),rgba.transform(a))};function test(s){var e,t;return isNaN(s)&&isString$1(s)&&(((e=s.match(floatRegex))===null||e===void 0?void 0:e.length)||0)+(((t=s.match(colorRegex))===null||t===void 0?void 0:t.length)||0)>0}const cssVarTokeniser={regex:cssVariableRegex,countKey:"Vars",token:"${v}",parse:noop$1},colorTokeniser={regex:colorRegex,countKey:"Colors",token:"${c}",parse:color.parse},numberTokeniser={regex:floatRegex,countKey:"Numbers",token:"${n}",parse:number.parse};function tokenise(s,{regex:e,countKey:t,token:o,parse:a}){const c=s.tokenised.match(e);c&&(s["num"+t]=c.length,s.tokenised=s.tokenised.replace(e,o),s.values.push(...c.map(a)))}function analyseComplexValue(s){const e=s.toString(),t={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return t.value.includes("var(--")&&tokenise(t,cssVarTokeniser),tokenise(t,colorTokeniser),tokenise(t,numberTokeniser),t}function parseComplexValue(s){return analyseComplexValue(s).values}function createTransformer(s){const{values:e,numColors:t,numVars:o,tokenised:a}=analyseComplexValue(s),c=e.length;return d=>{let g=a;for(let y=0;y<c;y++)y<o?g=g.replace(cssVarTokeniser.token,d[y]):y<o+t?g=g.replace(colorTokeniser.token,color.transform(d[y])):g=g.replace(numberTokeniser.token,sanitize(d[y]));return g}}const convertNumbersToZero=s=>typeof s=="number"?0:s;function getAnimatableNone$1(s){const e=parseComplexValue(s);return createTransformer(s)(e.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1},mixImmediate=(s,e)=>t=>`${t>0?e:s}`;function getMixer(s,e){return typeof s=="number"?t=>mix(s,e,t):color.test(s)?mixColor(s,e):s.startsWith("var(")?mixImmediate(s,e):mixComplex(s,e)}const mixArray=(s,e)=>{const t=[...s],o=t.length,a=s.map((c,d)=>getMixer(c,e[d]));return c=>{for(let d=0;d<o;d++)t[d]=a[d](c);return t}},mixObject=(s,e)=>{const t={...s,...e},o={};for(const a in t)s[a]!==void 0&&e[a]!==void 0&&(o[a]=getMixer(s[a],e[a]));return a=>{for(const c in o)t[c]=o[c](a);return t}},mixComplex=(s,e)=>{const t=complex.createTransformer(e),o=analyseComplexValue(s),a=analyseComplexValue(e);return o.numVars===a.numVars&&o.numColors===a.numColors&&o.numNumbers>=a.numNumbers?pipe(mixArray(o.values,a.values),t):mixImmediate(s,e)},progress=(s,e,t)=>{const o=e-s;return o===0?1:(t-s)/o},mixNumber=(s,e)=>t=>mix(s,e,t);function detectMixerFactory(s){return typeof s=="number"?mixNumber:typeof s=="string"?color.test(s)?mixColor:mixComplex:Array.isArray(s)?mixArray:typeof s=="object"?mixObject:mixNumber}function createMixers(s,e,t){const o=[],a=t||detectMixerFactory(s[0]),c=s.length-1;for(let d=0;d<c;d++){let g=a(s[d],s[d+1]);if(e){const y=Array.isArray(e)?e[d]||noop$1:e;g=pipe(y,g)}o.push(g)}return o}function interpolate(s,e,{clamp:t=!0,ease:o,mixer:a}={}){const c=s.length;if(invariant(c===e.length),c===1)return()=>e[0];s[0]>s[c-1]&&(s=[...s].reverse(),e=[...e].reverse());const d=createMixers(e,o,a),g=d.length,y=_=>{let E=0;if(g>1)for(;E<s.length-2&&!(_<s[E+1]);E++);const S=progress(s[E],s[E+1],_);return d[E](S)};return t?_=>y(clamp$1(s[0],s[c-1],_)):y}function fillOffset(s,e){const t=s[s.length-1];for(let o=1;o<=e;o++){const a=progress(0,e,o);s.push(mix(t,1,a))}}function defaultOffset(s){const e=[0];return fillOffset(e,s.length-1),e}function convertOffsetToTimes(s,e){return s.map(t=>t*e)}function defaultEasing(s,e){return s.map(()=>e||easeInOut).splice(0,s.length-1)}function keyframes({duration:s=300,keyframes:e,times:t,ease:o="easeInOut"}){const a=isEasingArray(o)?o.map(easingDefinitionToFunction):easingDefinitionToFunction(o),c={done:!1,value:e[0]},d=convertOffsetToTimes(t&&t.length===e.length?t:defaultOffset(e),s),g=interpolate(d,e,{ease:Array.isArray(a)?a:defaultEasing(e,a)});return{calculatedDuration:s,next:y=>(c.value=g(y),c.done=y>=s,c)}}function velocityPerSecond(s,e){return e?s*(1e3/e):0}const velocitySampleDuration=5;function calcGeneratorVelocity(s,e,t){const o=Math.max(e-velocitySampleDuration,0);return velocityPerSecond(t-s(o),e-o)}const safeMin=.001,minDuration=.01,maxDuration$1=10,minDamping=.05,maxDamping=1;function findSpring({duration:s=800,bounce:e=.25,velocity:t=0,mass:o=1}){let a,c;warning(s<=secondsToMilliseconds(maxDuration$1));let d=1-e;d=clamp$1(minDamping,maxDamping,d),s=clamp$1(minDuration,maxDuration$1,millisecondsToSeconds(s)),d<1?(a=_=>{const E=_*d,S=E*s,A=E-t,C=calcAngularFreq(_,d),N=Math.exp(-S);return safeMin-A/C*N},c=_=>{const S=_*d*s,A=S*t+t,C=Math.pow(d,2)*Math.pow(_,2)*s,N=Math.exp(-S),O=calcAngularFreq(Math.pow(_,2),d);return(-a(_)+safeMin>0?-1:1)*((A-C)*N)/O}):(a=_=>{const E=Math.exp(-_*s),S=(_-t)*s+1;return-safeMin+E*S},c=_=>{const E=Math.exp(-_*s),S=(t-_)*(s*s);return E*S});const g=5/s,y=approximateRoot(a,c,g);if(s=secondsToMilliseconds(s),isNaN(y))return{stiffness:100,damping:10,duration:s};{const _=Math.pow(y,2)*o;return{stiffness:_,damping:d*2*Math.sqrt(o*_),duration:s}}}const rootIterations=12;function approximateRoot(s,e,t){let o=t;for(let a=1;a<rootIterations;a++)o=o-s(o)/e(o);return o}function calcAngularFreq(s,e){return s*Math.sqrt(1-e*e)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(s,e){return e.some(t=>s[t]!==void 0)}function getSpringOptions(s){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...s};if(!isSpringType(s,physicsKeys)&&isSpringType(s,durationKeys)){const t=findSpring(s);e={...e,...t,mass:1},e.isResolvedFromDuration=!0}return e}function spring({keyframes:s,restDelta:e,restSpeed:t,...o}){const a=s[0],c=s[s.length-1],d={done:!1,value:a},{stiffness:g,damping:y,mass:_,duration:E,velocity:S,isResolvedFromDuration:A}=getSpringOptions({...o,velocity:-millisecondsToSeconds(o.velocity||0)}),C=S||0,N=y/(2*Math.sqrt(g*_)),O=c-a,I=millisecondsToSeconds(Math.sqrt(g/_)),P=Math.abs(O)<5;t||(t=P?.01:2),e||(e=P?.005:.5);let j;if(N<1){const B=calcAngularFreq(I,N);j=H=>{const se=Math.exp(-N*I*H);return c-se*((C+N*I*O)/B*Math.sin(B*H)+O*Math.cos(B*H))}}else if(N===1)j=B=>c-Math.exp(-I*B)*(O+(C+I*O)*B);else{const B=I*Math.sqrt(N*N-1);j=H=>{const se=Math.exp(-N*I*H),oe=Math.min(B*H,300);return c-se*((C+N*I*O)*Math.sinh(oe)+B*O*Math.cosh(oe))/B}}return{calculatedDuration:A&&E||null,next:B=>{const H=j(B);if(A)d.done=B>=E;else{let se=C;B!==0&&(N<1?se=calcGeneratorVelocity(j,B,H):se=0);const oe=Math.abs(se)<=t,Q=Math.abs(c-H)<=e;d.done=oe&&Q}return d.value=d.done?c:H,d}}}function inertia({keyframes:s,velocity:e=0,power:t=.8,timeConstant:o=325,bounceDamping:a=10,bounceStiffness:c=500,modifyTarget:d,min:g,max:y,restDelta:_=.5,restSpeed:E}){const S=s[0],A={done:!1,value:S},C=fe=>g!==void 0&&fe<g||y!==void 0&&fe>y,N=fe=>g===void 0?y:y===void 0||Math.abs(g-fe)<Math.abs(y-fe)?g:y;let O=t*e;const I=S+O,P=d===void 0?I:d(I);P!==I&&(O=P-S);const j=fe=>-O*Math.exp(-fe/o),B=fe=>P+j(fe),H=fe=>{const Z=j(fe),ce=B(fe);A.done=Math.abs(Z)<=_,A.value=A.done?P:ce};let se,oe;const Q=fe=>{C(A.value)&&(se=fe,oe=spring({keyframes:[A.value,N(A.value)],velocity:calcGeneratorVelocity(B,fe,A.value),damping:a,stiffness:c,restDelta:_,restSpeed:E}))};return Q(0),{calculatedDuration:null,next:fe=>{let Z=!1;return!oe&&se===void 0&&(Z=!0,H(fe),Q(fe)),se!==void 0&&fe>se?oe.next(fe-se):(!Z&&H(fe),A)}}}const frameloopDriver=s=>{const e=({timestamp:t})=>s(t);return{start:()=>frame.update(e,!0),stop:()=>cancelFrame(e),now:()=>frameData.isProcessing?frameData.timestamp:performance.now()}},maxGeneratorDuration=2e4;function calcGeneratorDuration(s){let e=0;const t=50;let o=s.next(e);for(;!o.done&&e<maxGeneratorDuration;)e+=t,o=s.next(e);return e>=maxGeneratorDuration?1/0:e}const types={decay:inertia,inertia,tween:keyframes,keyframes,spring};function animateValue({autoplay:s=!0,delay:e=0,driver:t=frameloopDriver,keyframes:o,type:a="keyframes",repeat:c=0,repeatDelay:d=0,repeatType:g="loop",onPlay:y,onStop:_,onComplete:E,onUpdate:S,...A}){let C=1,N=!1,O,I;const P=()=>{I=new Promise(X=>{O=X})};P();let j;const B=types[a]||keyframes;let H;B!==keyframes&&typeof o[0]!="number"&&(H=interpolate([0,100],o,{clamp:!1}),o=[0,100]);const se=B({...A,keyframes:o});let oe;g==="mirror"&&(oe=B({...A,keyframes:[...o].reverse(),velocity:-(A.velocity||0)}));let Q="idle",fe=null,Z=null,ce=null;se.calculatedDuration===null&&c&&(se.calculatedDuration=calcGeneratorDuration(se));const{calculatedDuration:ge}=se;let me=1/0,V=1/0;ge!==null&&(me=ge+d,V=me*(c+1)-d);let R=0;const L=X=>{if(Z===null)return;C>0&&(Z=Math.min(Z,X)),C<0&&(Z=Math.min(X-V/C,Z)),fe!==null?R=fe:R=Math.round(X-Z)*C;const F=R-e*(C>=0?1:-1),J=C>=0?F<0:F>V;R=Math.max(F,0),Q==="finished"&&fe===null&&(R=V);let Ee=R,Re=se;if(c){const Ke=Math.min(R,V)/me;let it=Math.floor(Ke),Ye=Ke%1;!Ye&&Ke>=1&&(Ye=1),Ye===1&&it--,it=Math.min(it,c+1),!!(it%2)&&(g==="reverse"?(Ye=1-Ye,d&&(Ye-=d/me)):g==="mirror"&&(Re=oe)),Ee=clamp$1(0,1,Ye)*me}const Te=J?{done:!1,value:o[0]}:Re.next(Ee);H&&(Te.value=H(Te.value));let{done:Ue}=Te;!J&&ge!==null&&(Ue=C>=0?R>=V:R<=0);const ze=fe===null&&(Q==="finished"||Q==="running"&&Ue);return S&&S(Te.value),ze&&W(),Te},z=()=>{j&&j.stop(),j=void 0},Y=()=>{Q="idle",z(),O(),P(),Z=ce=null},W=()=>{Q="finished",E&&E(),z(),O()},ee=()=>{if(N)return;j||(j=t(L));const X=j.now();y&&y(),fe!==null?Z=X-fe:(!Z||Q==="finished")&&(Z=X),Q==="finished"&&P(),ce=Z,fe=null,Q="running",j.start()};s&&ee();const ie={then(X,F){return I.then(X,F)},get time(){return millisecondsToSeconds(R)},set time(X){X=secondsToMilliseconds(X),R=X,fe!==null||!j||C===0?fe=X:Z=j.now()-X/C},get duration(){const X=se.calculatedDuration===null?calcGeneratorDuration(se):se.calculatedDuration;return millisecondsToSeconds(X)},get speed(){return C},set speed(X){X===C||!j||(C=X,ie.time=millisecondsToSeconds(R))},get state(){return Q},play:ee,pause:()=>{Q="paused",fe=R},stop:()=>{N=!0,Q!=="idle"&&(Q="idle",_&&_(),Y())},cancel:()=>{ce!==null&&L(ce),Y()},complete:()=>{Q="finished"},sample:X=>(Z=0,L(X))};return ie}function memo(s){let e;return()=>(e===void 0&&(e=s()),e)}const supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),acceleratedValues=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),sampleDelta=10,maxDuration=2e4,requiresPregeneratedKeyframes=(s,e)=>e.type==="spring"||s==="backgroundColor"||!isWaapiSupportedEasing(e.ease);function createAcceleratedAnimation(s,e,{onUpdate:t,onComplete:o,...a}){if(!(supportsWaapi()&&acceleratedValues.has(e)&&!a.repeatDelay&&a.repeatType!=="mirror"&&a.damping!==0&&a.type!=="inertia"))return!1;let d=!1,g,y,_=!1;const E=()=>{y=new Promise(B=>{g=B})};E();let{keyframes:S,duration:A=300,ease:C,times:N}=a;if(requiresPregeneratedKeyframes(e,a)){const B=animateValue({...a,repeat:0,delay:0});let H={done:!1,value:S[0]};const se=[];let oe=0;for(;!H.done&&oe<maxDuration;)H=B.sample(oe),se.push(H.value),oe+=sampleDelta;N=void 0,S=se,A=oe-sampleDelta,C="linear"}const O=animateStyle(s.owner.current,e,S,{...a,duration:A,ease:C,times:N}),I=()=>{_=!1,O.cancel()},P=()=>{_=!0,frame.update(I),g(),E()};return O.onfinish=()=>{_||(s.set(getFinalKeyframe(S,a)),o&&o(),P())},{then(B,H){return y.then(B,H)},attachTimeline(B){return O.timeline=B,O.onfinish=null,noop$1},get time(){return millisecondsToSeconds(O.currentTime||0)},set time(B){O.currentTime=secondsToMilliseconds(B)},get speed(){return O.playbackRate},set speed(B){O.playbackRate=B},get duration(){return millisecondsToSeconds(A)},play:()=>{d||(O.play(),cancelFrame(I))},pause:()=>O.pause(),stop:()=>{if(d=!0,O.playState==="idle")return;const{currentTime:B}=O;if(B){const H=animateValue({...a,autoplay:!1});s.setWithVelocity(H.sample(B-sampleDelta).value,H.sample(B).value,sampleDelta)}P()},complete:()=>{_||O.finish()},cancel:P}}function createInstantAnimation({keyframes:s,delay:e,onUpdate:t,onComplete:o}){const a=()=>(t&&t(s[s.length-1]),o&&o(),{time:0,speed:1,duration:0,play:noop$1,pause:noop$1,stop:noop$1,then:c=>(c(),Promise.resolve()),cancel:noop$1,complete:noop$1});return e?animateValue({keyframes:[0,1],duration:0,delay:e,onComplete:a}):a()}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(s,{keyframes:e})=>e.length>2?keyframesTransition:transformProps.has(s)?s.startsWith("scale")?criticallyDampedSpring(e[1]):underDampedSpring:ease,isAnimatable=(s,e)=>s==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(complex.test(e)||e==="0")&&!e.startsWith("url(")),maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(s){const[e,t]=s.slice(0,-1).split("(");if(e==="drop-shadow")return s;const[o]=t.match(floatRegex)||[];if(!o)return s;const a=t.replace(o,"");let c=maxDefaults.has(e)?1:0;return o!==t&&(c*=100),e+"("+c+a+")"}const functionRegex=/([a-z-]*)\(.*?\)/g,filter={...complex,getAnimatableNone:s=>{const e=s.match(functionRegex);return e?e.map(applyDefaultFilter).join(" "):s}},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=s=>defaultValueTypes[s];function getAnimatableNone(s,e){let t=getDefaultValueType(s);return t!==filter&&(t=complex),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const isZeroValueString=s=>/^0[^.\s]+$/.test(s);function isNone(s){if(typeof s=="number")return s===0;if(s!==null)return s==="none"||s==="0"||isZeroValueString(s)}function getKeyframes(s,e,t,o){const a=isAnimatable(e,t);let c;Array.isArray(t)?c=[...t]:c=[null,t];const d=o.from!==void 0?o.from:s.get();let g;const y=[];for(let _=0;_<c.length;_++)c[_]===null&&(c[_]=_===0?d:c[_-1]),isNone(c[_])&&y.push(_),typeof c[_]=="string"&&c[_]!=="none"&&c[_]!=="0"&&(g=c[_]);if(a&&y.length&&g)for(let _=0;_<y.length;_++){const E=y[_];c[E]=getAnimatableNone(e,g)}return c}function isTransitionDefined({when:s,delay:e,delayChildren:t,staggerChildren:o,staggerDirection:a,repeat:c,repeatType:d,repeatDelay:g,from:y,elapsed:_,...E}){return!!Object.keys(E).length}function getValueTransition(s,e){return s[e]||s.default||s}const MotionGlobalConfig={skipAnimations:!1},animateMotionValue=(s,e,t,o={})=>a=>{const c=getValueTransition(o,s)||{},d=c.delay||o.delay||0;let{elapsed:g=0}=o;g=g-secondsToMilliseconds(d);const y=getKeyframes(e,s,t,c),_=y[0],E=y[y.length-1],S=isAnimatable(s,_),A=isAnimatable(s,E);let C={keyframes:y,velocity:e.getVelocity(),ease:"easeOut",...c,delay:-g,onUpdate:N=>{e.set(N),c.onUpdate&&c.onUpdate(N)},onComplete:()=>{a(),c.onComplete&&c.onComplete()}};if(isTransitionDefined(c)||(C={...C,...getDefaultTransition(s,C)}),C.duration&&(C.duration=secondsToMilliseconds(C.duration)),C.repeatDelay&&(C.repeatDelay=secondsToMilliseconds(C.repeatDelay)),!S||!A||instantAnimationState.current||c.type===!1||MotionGlobalConfig.skipAnimations)return createInstantAnimation(C);if(!o.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const N=createAcceleratedAnimation(e,s,C);if(N)return N}return animateValue(C)};function isWillChangeMotionValue(s){return!!(isMotionValue(s)&&s.add)}const isNumericalString=s=>/^\-?\d*\.?\d+$/.test(s);function addUniqueItem(s,e){s.indexOf(e)===-1&&s.push(e)}function removeItem(s,e){const t=s.indexOf(e);t>-1&&s.splice(t,1)}class SubscriptionManager{constructor(){this.subscriptions=[]}add(e){return addUniqueItem(this.subscriptions,e),()=>removeItem(this.subscriptions,e)}notify(e,t,o){const a=this.subscriptions.length;if(a)if(a===1)this.subscriptions[0](e,t,o);else for(let c=0;c<a;c++){const d=this.subscriptions[c];d&&d(e,t,o)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const isFloat=s=>!isNaN(parseFloat(s));class MotionValue{constructor(e,t={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(o,a=!0)=>{this.prev=this.current,this.current=o;const{delta:c,timestamp:d}=frameData;this.lastUpdated!==d&&(this.timeDelta=c,this.lastUpdated=d,frame.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),a&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>frame.postRender(this.velocityCheck),this.velocityCheck=({timestamp:o})=>{o!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=isFloat(this.current),this.owner=t.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new SubscriptionManager);const o=this.events[e].add(t);return e==="change"?()=>{o(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:o}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,o){this.set(t),this.prev=e,this.timeDelta=o}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?velocityPerSecond(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(s,e){return new MotionValue(s,e)}const testValueType=s=>e=>e.test(s),auto={test:s=>s==="auto",parse:s=>s},dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=s=>dimensionValueTypes.find(testValueType(s)),valueTypes=[...dimensionValueTypes,color,complex],findValueType=s=>valueTypes.find(testValueType(s));function setMotionValue(s,e,t){s.hasValue(e)?s.getValue(e).set(t):s.addValue(e,motionValue(t))}function setTarget(s,e){const t=resolveVariant(s,e);let{transitionEnd:o={},transition:a={},...c}=t?s.makeTargetAnimatable(t,!1):{};c={...c,...o};for(const d in c){const g=resolveFinalValueInKeyframes(c[d]);setMotionValue(s,d,g)}}function checkTargetForNewValues(s,e,t){var o,a;const c=Object.keys(e).filter(g=>!s.hasValue(g)),d=c.length;if(d)for(let g=0;g<d;g++){const y=c[g],_=e[y];let E=null;Array.isArray(_)&&(E=_[0]),E===null&&(E=(a=(o=t[y])!==null&&o!==void 0?o:s.readValue(y))!==null&&a!==void 0?a:e[y]),E!=null&&(typeof E=="string"&&(isNumericalString(E)||isZeroValueString(E))?E=parseFloat(E):!findValueType(E)&&complex.test(_)&&(E=getAnimatableNone(y,_)),s.addValue(y,motionValue(E,{owner:s})),t[y]===void 0&&(t[y]=E),E!==null&&s.setBaseTarget(y,E))}}function getOriginFromTransition(s,e){return e?(e[s]||e.default||e).from:void 0}function getOrigin(s,e,t){const o={};for(const a in s){const c=getOriginFromTransition(a,e);if(c!==void 0)o[a]=c;else{const d=t.getValue(a);d&&(o[a]=d.get())}}return o}function shouldBlockAnimation({protectedKeys:s,needsAnimating:e},t){const o=s.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,o}function hasKeyframesChanged(s,e){const t=s.get();if(Array.isArray(e)){for(let o=0;o<e.length;o++)if(e[o]!==t)return!0}else return t!==e}function animateTarget(s,e,{delay:t=0,transitionOverride:o,type:a}={}){let{transition:c=s.getDefaultTransition(),transitionEnd:d,...g}=s.makeTargetAnimatable(e);const y=s.getValue("willChange");o&&(c=o);const _=[],E=a&&s.animationState&&s.animationState.getState()[a];for(const S in g){const A=s.getValue(S),C=g[S];if(!A||C===void 0||E&&shouldBlockAnimation(E,S))continue;const N={delay:t,elapsed:0,...getValueTransition(c||{},S)};if(window.HandoffAppearAnimations){const P=s.getProps()[optimizedAppearDataAttribute];if(P){const j=window.HandoffAppearAnimations(P,S,A,frame);j!==null&&(N.elapsed=j,N.isHandoff=!0)}}let O=!N.isHandoff&&!hasKeyframesChanged(A,C);if(N.type==="spring"&&(A.getVelocity()||N.velocity)&&(O=!1),A.animation&&(O=!1),O)continue;A.start(animateMotionValue(S,A,C,s.shouldReduceMotion&&transformProps.has(S)?{type:!1}:N));const I=A.animation;isWillChangeMotionValue(y)&&(y.add(S),I.then(()=>y.remove(S))),_.push(I)}return d&&Promise.all(_).then(()=>{d&&setTarget(s,d)}),_}function animateVariant(s,e,t={}){const o=resolveVariant(s,e,t.custom);let{transition:a=s.getDefaultTransition()||{}}=o||{};t.transitionOverride&&(a=t.transitionOverride);const c=o?()=>Promise.all(animateTarget(s,o,t)):()=>Promise.resolve(),d=s.variantChildren&&s.variantChildren.size?(y=0)=>{const{delayChildren:_=0,staggerChildren:E,staggerDirection:S}=a;return animateChildren(s,e,_+y,E,S,t)}:()=>Promise.resolve(),{when:g}=a;if(g){const[y,_]=g==="beforeChildren"?[c,d]:[d,c];return y().then(()=>_())}else return Promise.all([c(),d(t.delay)])}function animateChildren(s,e,t=0,o=0,a=1,c){const d=[],g=(s.variantChildren.size-1)*o,y=a===1?(_=0)=>_*o:(_=0)=>g-_*o;return Array.from(s.variantChildren).sort(sortByTreeOrder).forEach((_,E)=>{_.notify("AnimationStart",e),d.push(animateVariant(_,e,{...c,delay:t+y(E)}).then(()=>_.notify("AnimationComplete",e)))}),Promise.all(d)}function sortByTreeOrder(s,e){return s.sortNodePosition(e)}function animateVisualElement(s,e,t={}){s.notify("AnimationStart",e);let o;if(Array.isArray(e)){const a=e.map(c=>animateVariant(s,c,t));o=Promise.all(a)}else if(typeof e=="string")o=animateVariant(s,e,t);else{const a=typeof e=="function"?resolveVariant(s,e,t.custom):e;o=Promise.all(animateTarget(s,a,t))}return o.then(()=>s.notify("AnimationComplete",e))}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(s){return e=>Promise.all(e.map(({animation:t,options:o})=>animateVisualElement(s,t,o)))}function createAnimationState(s){let e=animateList(s);const t=createState();let o=!0;const a=(y,_)=>{const E=resolveVariant(s,_);if(E){const{transition:S,transitionEnd:A,...C}=E;y={...y,...C,...A}}return y};function c(y){e=y(s)}function d(y,_){const E=s.getProps(),S=s.getVariantContext(!0)||{},A=[],C=new Set;let N={},O=1/0;for(let P=0;P<numAnimationTypes;P++){const j=reversePriorityOrder[P],B=t[j],H=E[j]!==void 0?E[j]:S[j],se=isVariantLabel(H),oe=j===_?B.isActive:null;oe===!1&&(O=P);let Q=H===S[j]&&H!==E[j]&&se;if(Q&&o&&s.manuallyAnimateOnMount&&(Q=!1),B.protectedKeys={...N},!B.isActive&&oe===null||!H&&!B.prevProp||isAnimationControls(H)||typeof H=="boolean")continue;let Z=checkVariantsDidChange(B.prevProp,H)||j===_&&B.isActive&&!Q&&se||P>O&&se,ce=!1;const ge=Array.isArray(H)?H:[H];let me=ge.reduce(a,{});oe===!1&&(me={});const{prevResolvedValues:V={}}=B,R={...V,...me},L=z=>{Z=!0,C.has(z)&&(ce=!0,C.delete(z)),B.needsAnimating[z]=!0};for(const z in R){const Y=me[z],W=V[z];if(N.hasOwnProperty(z))continue;let ee=!1;isKeyframesTarget(Y)&&isKeyframesTarget(W)?ee=!shallowCompare(Y,W):ee=Y!==W,ee?Y!==void 0?L(z):C.add(z):Y!==void 0&&C.has(z)?L(z):B.protectedKeys[z]=!0}B.prevProp=H,B.prevResolvedValues=me,B.isActive&&(N={...N,...me}),o&&s.blockInitialAnimation&&(Z=!1),Z&&(!Q||ce)&&A.push(...ge.map(z=>({animation:z,options:{type:j,...y}})))}if(C.size){const P={};C.forEach(j=>{const B=s.getBaseTarget(j);B!==void 0&&(P[j]=B)}),A.push({animation:P})}let I=!!A.length;return o&&(E.initial===!1||E.initial===E.animate)&&!s.manuallyAnimateOnMount&&(I=!1),o=!1,I?e(A):Promise.resolve()}function g(y,_,E){var S;if(t[y].isActive===_)return Promise.resolve();(S=s.variantChildren)===null||S===void 0||S.forEach(C=>{var N;return(N=C.animationState)===null||N===void 0?void 0:N.setActive(y,_)}),t[y].isActive=_;const A=d(E,y);for(const C in t)t[C].protectedKeys={};return A}return{animateChanges:d,setActive:g,setAnimateFunction:c,getState:()=>t}}function checkVariantsDidChange(s,e){return typeof e=="string"?e!==s:Array.isArray(e)?!shallowCompare(e,s):!1}function createTypeState(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class AnimationFeature extends Feature{constructor(e){super(e),e.animationState||(e.animationState=createAnimationState(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),isAnimationControls(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t,custom:o}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===a)return;const c=this.node.animationState.setActive("exit",!e,{custom:o??this.node.getProps().custom});t&&!e&&c.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}},distance=(s,e)=>Math.abs(s-e);function distance2D(s,e){const t=distance(s.x,e.x),o=distance(s.y,e.y);return Math.sqrt(t**2+o**2)}class PanSession{constructor(e,t,{transformPagePoint:o,contextWindow:a,dragSnapToOrigin:c=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=getPanInfo(this.lastMoveEventInfo,this.history),A=this.startEvent!==null,C=distance2D(S.offset,{x:0,y:0})>=3;if(!A&&!C)return;const{point:N}=S,{timestamp:O}=frameData;this.history.push({...N,timestamp:O});const{onStart:I,onMove:P}=this.handlers;A||(I&&I(this.lastMoveEvent,S),this.startEvent=this.lastMoveEvent),P&&P(this.lastMoveEvent,S)},this.handlePointerMove=(S,A)=>{this.lastMoveEvent=S,this.lastMoveEventInfo=transformPoint(A,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(S,A)=>{this.end();const{onEnd:C,onSessionEnd:N,resumeAnimation:O}=this.handlers;if(this.dragSnapToOrigin&&O&&O(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const I=getPanInfo(S.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(A,this.transformPagePoint),this.history);this.startEvent&&C&&C(S,I),N&&N(S,I)},!isPrimaryPointer(e))return;this.dragSnapToOrigin=c,this.handlers=t,this.transformPagePoint=o,this.contextWindow=a||window;const d=extractEventInfo(e),g=transformPoint(d,this.transformPagePoint),{point:y}=g,{timestamp:_}=frameData;this.history=[{...y,timestamp:_}];const{onSessionStart:E}=t;E&&E(e,getPanInfo(g,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(s,e){return e?{point:e(s.point)}:s}function subtractPoint(s,e){return{x:s.x-e.x,y:s.y-e.y}}function getPanInfo({point:s},e){return{point:s,delta:subtractPoint(s,lastDevicePoint(e)),offset:subtractPoint(s,startDevicePoint(e)),velocity:getVelocity(e,.1)}}function startDevicePoint(s){return s[0]}function lastDevicePoint(s){return s[s.length-1]}function getVelocity(s,e){if(s.length<2)return{x:0,y:0};let t=s.length-1,o=null;const a=lastDevicePoint(s);for(;t>=0&&(o=s[t],!(a.timestamp-o.timestamp>secondsToMilliseconds(e)));)t--;if(!o)return{x:0,y:0};const c=millisecondsToSeconds(a.timestamp-o.timestamp);if(c===0)return{x:0,y:0};const d={x:(a.x-o.x)/c,y:(a.y-o.y)/c};return d.x===1/0&&(d.x=0),d.y===1/0&&(d.y=0),d}function calcLength(s){return s.max-s.min}function isNear(s,e=0,t=.01){return Math.abs(s-e)<=t}function calcAxisDelta(s,e,t,o=.5){s.origin=o,s.originPoint=mix(e.min,e.max,s.origin),s.scale=calcLength(t)/calcLength(e),(isNear(s.scale,1,1e-4)||isNaN(s.scale))&&(s.scale=1),s.translate=mix(t.min,t.max,s.origin)-s.originPoint,(isNear(s.translate)||isNaN(s.translate))&&(s.translate=0)}function calcBoxDelta(s,e,t,o){calcAxisDelta(s.x,e.x,t.x,o?o.originX:void 0),calcAxisDelta(s.y,e.y,t.y,o?o.originY:void 0)}function calcRelativeAxis(s,e,t){s.min=t.min+e.min,s.max=s.min+calcLength(e)}function calcRelativeBox(s,e,t){calcRelativeAxis(s.x,e.x,t.x),calcRelativeAxis(s.y,e.y,t.y)}function calcRelativeAxisPosition(s,e,t){s.min=e.min-t.min,s.max=s.min+calcLength(e)}function calcRelativePosition(s,e,t){calcRelativeAxisPosition(s.x,e.x,t.x),calcRelativeAxisPosition(s.y,e.y,t.y)}function applyConstraints(s,{min:e,max:t},o){return e!==void 0&&s<e?s=o?mix(e,s,o.min):Math.max(s,e):t!==void 0&&s>t&&(s=o?mix(t,s,o.max):Math.min(s,t)),s}function calcRelativeAxisConstraints(s,e,t){return{min:e!==void 0?s.min+e:void 0,max:t!==void 0?s.max+t-(s.max-s.min):void 0}}function calcRelativeConstraints(s,{top:e,left:t,bottom:o,right:a}){return{x:calcRelativeAxisConstraints(s.x,t,a),y:calcRelativeAxisConstraints(s.y,e,o)}}function calcViewportAxisConstraints(s,e){let t=e.min-s.min,o=e.max-s.max;return e.max-e.min<s.max-s.min&&([t,o]=[o,t]),{min:t,max:o}}function calcViewportConstraints(s,e){return{x:calcViewportAxisConstraints(s.x,e.x),y:calcViewportAxisConstraints(s.y,e.y)}}function calcOrigin(s,e){let t=.5;const o=calcLength(s),a=calcLength(e);return a>o?t=progress(e.min,e.max-o,s.min):o>a&&(t=progress(s.min,s.max-a,e.min)),clamp$1(0,1,t)}function rebaseAxisConstraints(s,e){const t={};return e.min!==void 0&&(t.min=e.min-s.min),e.max!==void 0&&(t.max=e.max-s.min),t}const defaultElastic=.35;function resolveDragElastic(s=defaultElastic){return s===!1?s=0:s===!0&&(s=defaultElastic),{x:resolveAxisElastic(s,"left","right"),y:resolveAxisElastic(s,"top","bottom")}}function resolveAxisElastic(s,e,t){return{min:resolvePointElastic(s,e),max:resolvePointElastic(s,t)}}function resolvePointElastic(s,e){return typeof s=="number"?s:s[e]||0}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(s){return[s("x"),s("y")]}function convertBoundingBoxToBox({top:s,left:e,right:t,bottom:o}){return{x:{min:e,max:t},y:{min:s,max:o}}}function convertBoxToBoundingBox({x:s,y:e}){return{top:e.min,right:s.max,bottom:e.max,left:s.min}}function transformBoxPoints(s,e){if(!e)return s;const t=e({x:s.left,y:s.top}),o=e({x:s.right,y:s.bottom});return{top:t.y,left:t.x,bottom:o.y,right:o.x}}function isIdentityScale(s){return s===void 0||s===1}function hasScale({scale:s,scaleX:e,scaleY:t}){return!isIdentityScale(s)||!isIdentityScale(e)||!isIdentityScale(t)}function hasTransform(s){return hasScale(s)||has2DTranslate(s)||s.z||s.rotate||s.rotateX||s.rotateY}function has2DTranslate(s){return is2DTranslate(s.x)||is2DTranslate(s.y)}function is2DTranslate(s){return s&&s!=="0%"}function scalePoint(s,e,t){const o=s-t,a=e*o;return t+a}function applyPointDelta(s,e,t,o,a){return a!==void 0&&(s=scalePoint(s,a,o)),scalePoint(s,t,o)+e}function applyAxisDelta(s,e=0,t=1,o,a){s.min=applyPointDelta(s.min,e,t,o,a),s.max=applyPointDelta(s.max,e,t,o,a)}function applyBoxDelta(s,{x:e,y:t}){applyAxisDelta(s.x,e.translate,e.scale,e.originPoint),applyAxisDelta(s.y,t.translate,t.scale,t.originPoint)}function applyTreeDeltas(s,e,t,o=!1){const a=t.length;if(!a)return;e.x=e.y=1;let c,d;for(let g=0;g<a;g++){c=t[g],d=c.projectionDelta;const y=c.instance;y&&y.style&&y.style.display==="contents"||(o&&c.options.layoutScroll&&c.scroll&&c!==c.root&&transformBox(s,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),d&&(e.x*=d.x.scale,e.y*=d.y.scale,applyBoxDelta(s,d)),o&&hasTransform(c.latestValues)&&transformBox(s,c.latestValues))}e.x=snapToDefault(e.x),e.y=snapToDefault(e.y)}function snapToDefault(s){return Number.isInteger(s)||s>1.0000000000001||s<.999999999999?s:1}function translateAxis(s,e){s.min=s.min+e,s.max=s.max+e}function transformAxis(s,e,[t,o,a]){const c=e[a]!==void 0?e[a]:.5,d=mix(s.min,s.max,c);applyAxisDelta(s,e[t],e[o],d,e.scale)}const xKeys$1=["x","scaleX","originX"],yKeys$1=["y","scaleY","originY"];function transformBox(s,e){transformAxis(s.x,e,xKeys$1),transformAxis(s.y,e,yKeys$1)}function measureViewportBox(s,e){return convertBoundingBoxToBox(transformBoxPoints(s.getBoundingClientRect(),e))}function measurePageBox(s,e,t){const o=measureViewportBox(s,t),{scroll:a}=e;return a&&(translateAxis(o.x,a.offset.x),translateAxis(o.y,a.offset.y)),o}const getContextWindow=({current:s})=>s?s.ownerDocument.defaultView:null,elementDragControls=new WeakMap;class VisualElementDragControls{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const a=E=>{const{dragSnapToOrigin:S}=this.getProps();S?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(extractEventInfo(E,"page").point)},c=(E,S)=>{const{drag:A,dragPropagation:C,onDragStart:N}=this.getProps();if(A&&!C&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=getGlobalLock(A),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(I=>{let P=this.getAxisMotionValue(I).get()||0;if(percent.test(P)){const{projection:j}=this.visualElement;if(j&&j.layout){const B=j.layout.layoutBox[I];B&&(P=calcLength(B)*(parseFloat(P)/100))}}this.originPoint[I]=P}),N&&frame.update(()=>N(E,S),!1,!0);const{animationState:O}=this.visualElement;O&&O.setActive("whileDrag",!0)},d=(E,S)=>{const{dragPropagation:A,dragDirectionLock:C,onDirectionLock:N,onDrag:O}=this.getProps();if(!A&&!this.openGlobalLock)return;const{offset:I}=S;if(C&&this.currentDirection===null){this.currentDirection=getCurrentDirection(I),this.currentDirection!==null&&N&&N(this.currentDirection);return}this.updateAxis("x",S.point,I),this.updateAxis("y",S.point,I),this.visualElement.render(),O&&O(E,S)},g=(E,S)=>this.stop(E,S),y=()=>eachAxis(E=>{var S;return this.getAnimationState(E)==="paused"&&((S=this.getAxisMotionValue(E).animation)===null||S===void 0?void 0:S.play())}),{dragSnapToOrigin:_}=this.getProps();this.panSession=new PanSession(e,{onSessionStart:a,onStart:c,onMove:d,onSessionEnd:g,resumeAnimation:y},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:_,contextWindow:getContextWindow(this.visualElement)})}stop(e,t){const o=this.isDragging;if(this.cancel(),!o)return;const{velocity:a}=t;this.startAnimation(a);const{onDragEnd:c}=this.getProps();c&&frame.update(()=>c(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:o}=this.getProps();!o&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,o){const{drag:a}=this.getProps();if(!o||!shouldDrag(e,a,this.currentDirection))return;const c=this.getAxisMotionValue(e);let d=this.originPoint[e]+o[e];this.constraints&&this.constraints[e]&&(d=applyConstraints(d,this.constraints[e],this.elastic[e])),c.set(d)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:o}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,c=this.constraints;t&&isRefObject(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=calcRelativeConstraints(a.layoutBox,t):this.constraints=!1,this.elastic=resolveDragElastic(o),c!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(d=>{this.getAxisMotionValue(d)&&(this.constraints[d]=rebaseAxisConstraints(a.layoutBox[d],this.constraints[d]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!isRefObject(e))return!1;const o=e.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const c=measurePageBox(o,a.root,this.visualElement.getTransformPagePoint());let d=calcViewportConstraints(a.layout.layoutBox,c);if(t){const g=t(convertBoxToBoundingBox(d));this.hasMutatedConstraints=!!g,g&&(d=convertBoundingBoxToBox(g))}return d}startAnimation(e){const{drag:t,dragMomentum:o,dragElastic:a,dragTransition:c,dragSnapToOrigin:d,onDragTransitionEnd:g}=this.getProps(),y=this.constraints||{},_=eachAxis(E=>{if(!shouldDrag(E,t,this.currentDirection))return;let S=y&&y[E]||{};d&&(S={min:0,max:0});const A=a?200:1e6,C=a?40:1e7,N={type:"inertia",velocity:o?e[E]:0,bounceStiffness:A,bounceDamping:C,timeConstant:750,restDelta:1,restSpeed:10,...c,...S};return this.startAxisValueAnimation(E,N)});return Promise.all(_).then(g)}startAxisValueAnimation(e,t){const o=this.getAxisMotionValue(e);return o.start(animateMotionValue(e,o,0,t))}stopAnimation(){eachAxis(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){eachAxis(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t="_drag"+e.toUpperCase(),o=this.visualElement.getProps(),a=o[t];return a||this.visualElement.getValue(e,(o.initial?o.initial[e]:void 0)||0)}snapToCursor(e){eachAxis(t=>{const{drag:o}=this.getProps();if(!shouldDrag(t,o,this.currentDirection))return;const{projection:a}=this.visualElement,c=this.getAxisMotionValue(t);if(a&&a.layout){const{min:d,max:g}=a.layout.layoutBox[t];c.set(e[t]-mix(d,g,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:o}=this.visualElement;if(!isRefObject(t)||!o||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};eachAxis(d=>{const g=this.getAxisMotionValue(d);if(g){const y=g.get();a[d]=calcOrigin({min:y,max:y},this.constraints[d])}});const{transformTemplate:c}=this.visualElement.getProps();this.visualElement.current.style.transform=c?c({},""):"none",o.root&&o.root.updateScroll(),o.updateLayout(),this.resolveConstraints(),eachAxis(d=>{if(!shouldDrag(d,e,null))return;const g=this.getAxisMotionValue(d),{min:y,max:_}=this.constraints[d];g.set(mix(y,_,a[d]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const e=this.visualElement.current,t=addPointerEvent(e,"pointerdown",y=>{const{drag:_,dragListener:E=!0}=this.getProps();_&&E&&this.start(y)}),o=()=>{const{dragConstraints:y}=this.getProps();isRefObject(y)&&(this.constraints=this.resolveRefConstraints())},{projection:a}=this.visualElement,c=a.addEventListener("measure",o);a&&!a.layout&&(a.root&&a.root.updateScroll(),a.updateLayout()),o();const d=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),g=a.addEventListener("didUpdate",({delta:y,hasLayoutChanged:_})=>{this.isDragging&&_&&(eachAxis(E=>{const S=this.getAxisMotionValue(E);S&&(this.originPoint[E]+=y[E].translate,S.set(S.get()+y[E].translate))}),this.visualElement.render())});return()=>{d(),t(),c(),g&&g()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:o=!1,dragPropagation:a=!1,dragConstraints:c=!1,dragElastic:d=defaultElastic,dragMomentum:g=!0}=e;return{...e,drag:t,dragDirectionLock:o,dragPropagation:a,dragConstraints:c,dragElastic:d,dragMomentum:g}}}function shouldDrag(s,e,t){return(e===!0||e===s)&&(t===null||t===s)}function getCurrentDirection(s,e=10){let t=null;return Math.abs(s.y)>e?t="y":Math.abs(s.x)>e&&(t="x"),t}class DragGesture extends Feature{constructor(e){super(e),this.removeGroupControls=noop$1,this.removeListeners=noop$1,this.controls=new VisualElementDragControls(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop$1}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=s=>(e,t)=>{s&&frame.update(()=>s(e,t))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop$1}onPointerDown(e){this.session=new PanSession(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:o,onPanEnd:a}=this.node.getProps();return{onSessionStart:asyncHandler(e),onStart:asyncHandler(t),onMove:o,onEnd:(c,d)=>{delete this.session,a&&frame.update(()=>a(c,d))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function usePresence(){const s=reactExports.useContext(PresenceContext);if(s===null)return[!0,null];const{isPresent:e,onExitComplete:t,register:o}=s,a=reactExports.useId();return reactExports.useEffect(()=>o(a),[]),!e&&t?[!1,()=>t&&t(a)]:[!0]}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(s,e){return e.max===e.min?0:s/(e.max-e.min)*100}const correctBorderRadius={correct:(s,e)=>{if(!e.target)return s;if(typeof s=="string")if(px.test(s))s=parseFloat(s);else return s;const t=pixelsToPercent(s,e.target.x),o=pixelsToPercent(s,e.target.y);return`${t}% ${o}%`}},correctBoxShadow={correct:(s,{treeScale:e,projectionDelta:t})=>{const o=s,a=complex.parse(s);if(a.length>5)return o;const c=complex.createTransformer(s),d=typeof a[0]!="number"?1:0,g=t.x.scale*e.x,y=t.y.scale*e.y;a[0+d]/=g,a[1+d]/=y;const _=mix(g,y,.5);return typeof a[2+d]=="number"&&(a[2+d]/=_),typeof a[3+d]=="number"&&(a[3+d]/=_),c(a)}};class MeasureLayoutWithContext extends React$1.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:o,layoutId:a}=this.props,{projection:c}=e;addScaleCorrector(defaultScaleCorrectors),c&&(t.group&&t.group.add(c),o&&o.register&&a&&o.register(c),c.root.didUpdate(),c.addEventListener("animationComplete",()=>{this.safeToRemove()}),c.setOptions({...c.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:o,drag:a,isPresent:c}=this.props,d=o.projection;return d&&(d.isPresent=c,a||e.layoutDependency!==t||t===void 0?d.willUpdate():this.safeToRemove(),e.isPresent!==c&&(c?d.promote():d.relegate()||frame.postRender(()=>{const g=d.getStack();(!g||!g.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:o}=this.props,{projection:a}=e;a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),o&&o.deregister&&o.deregister(a))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function MeasureLayout(s){const[e,t]=usePresence(),o=reactExports.useContext(LayoutGroupContext);return React$1.createElement(MeasureLayoutWithContext,{...s,layoutGroup:o,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:e,safeToRemove:t})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow},borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=s=>typeof s=="string"?parseFloat(s):s,isPx=s=>typeof s=="number"||px.test(s);function mixValues(s,e,t,o,a,c){a?(s.opacity=mix(0,t.opacity!==void 0?t.opacity:1,easeCrossfadeIn(o)),s.opacityExit=mix(e.opacity!==void 0?e.opacity:1,0,easeCrossfadeOut(o))):c&&(s.opacity=mix(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,o));for(let d=0;d<numBorders;d++){const g=`border${borders[d]}Radius`;let y=getRadius(e,g),_=getRadius(t,g);if(y===void 0&&_===void 0)continue;y||(y=0),_||(_=0),y===0||_===0||isPx(y)===isPx(_)?(s[g]=Math.max(mix(asNumber(y),asNumber(_),o),0),(percent.test(_)||percent.test(y))&&(s[g]+="%")):s[g]=_}(e.rotate||t.rotate)&&(s.rotate=mix(e.rotate||0,t.rotate||0,o))}function getRadius(s,e){return s[e]!==void 0?s[e]:s.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop$1);function compress(s,e,t){return o=>o<s?0:o>e?1:t(progress(s,e,o))}function copyAxisInto(s,e){s.min=e.min,s.max=e.max}function copyBoxInto(s,e){copyAxisInto(s.x,e.x),copyAxisInto(s.y,e.y)}function removePointDelta(s,e,t,o,a){return s-=e,s=scalePoint(s,1/t,o),a!==void 0&&(s=scalePoint(s,1/a,o)),s}function removeAxisDelta(s,e=0,t=1,o=.5,a,c=s,d=s){if(percent.test(e)&&(e=parseFloat(e),e=mix(d.min,d.max,e/100)-d.min),typeof e!="number")return;let g=mix(c.min,c.max,o);s===c&&(g-=e),s.min=removePointDelta(s.min,e,t,g,a),s.max=removePointDelta(s.max,e,t,g,a)}function removeAxisTransforms(s,e,[t,o,a],c,d){removeAxisDelta(s,e[t],e[o],e[a],e.scale,c,d)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(s,e,t,o){removeAxisTransforms(s.x,e,xKeys,t?t.x:void 0,o?o.x:void 0),removeAxisTransforms(s.y,e,yKeys,t?t.y:void 0,o?o.y:void 0)}function isAxisDeltaZero(s){return s.translate===0&&s.scale===1}function isDeltaZero(s){return isAxisDeltaZero(s.x)&&isAxisDeltaZero(s.y)}function boxEquals(s,e){return s.x.min===e.x.min&&s.x.max===e.x.max&&s.y.min===e.y.min&&s.y.max===e.y.max}function boxEqualsRounded(s,e){return Math.round(s.x.min)===Math.round(e.x.min)&&Math.round(s.x.max)===Math.round(e.x.max)&&Math.round(s.y.min)===Math.round(e.y.min)&&Math.round(s.y.max)===Math.round(e.y.max)}function aspectRatio(s){return calcLength(s.x)/calcLength(s.y)}class NodeStack{constructor(){this.members=[]}add(e){addUniqueItem(this.members,e),e.scheduleRender()}remove(e){if(removeItem(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(a=>e===a);if(t===0)return!1;let o;for(let a=t;a>=0;a--){const c=this.members[a];if(c.isPresent!==!1){o=c;break}}return o?(this.promote(o),!0):!1}promote(e,t){const o=this.lead;if(e!==o&&(this.prevLead=o,this.lead=e,e.show(),o)){o.instance&&o.scheduleRender(),e.scheduleRender(),e.resumeFrom=o,t&&(e.resumeFrom.preserveOpacity=!0),o.snapshot&&(e.snapshot=o.snapshot,e.snapshot.latestValues=o.animationValues||o.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:a}=e.options;a===!1&&o.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:o}=e;t.onExitComplete&&t.onExitComplete(),o&&o.options.onExitComplete&&o.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(s,e,t){let o="";const a=s.x.translate/e.x,c=s.y.translate/e.y;if((a||c)&&(o=`translate3d(${a}px, ${c}px, 0) `),(e.x!==1||e.y!==1)&&(o+=`scale(${1/e.x}, ${1/e.y}) `),t){const{rotate:y,rotateX:_,rotateY:E}=t;y&&(o+=`rotate(${y}deg) `),_&&(o+=`rotateX(${_}deg) `),E&&(o+=`rotateY(${E}deg) `)}const d=s.x.scale*e.x,g=s.y.scale*e.y;return(d!==1||g!==1)&&(o+=`scale(${d}, ${g})`),o||"none"}const compareByDepth=(s,e)=>s.depth-e.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(e){addUniqueItem(this.children,e),this.isDirty=!0}remove(e){removeItem(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(e)}}function delay(s,e){const t=performance.now(),o=({timestamp:a})=>{const c=a-t;c>=e&&(cancelFrame(o),s(c-e))};return frame.read(o,!0),()=>cancelFrame(o)}function record(s){window.MotionDebug&&window.MotionDebug.record(s)}function isSVGElement(s){return s instanceof SVGElement&&s.tagName!=="svg"}function animateSingleValue(s,e,t){const o=isMotionValue(s)?s:motionValue(s);return o.start(animateMotionValue("",o,e,t)),o.animation}const transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id=0;const projectionFrameData={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function createProjectionNode({attachResizeListener:s,defaultParent:e,measureScroll:t,checkIsScrollRoot:o,resetTransform:a}){return class{constructor(d={},g=e==null?void 0:e()){this.id=id++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,projectionFrameData.totalNodes=projectionFrameData.resolvedTargetDeltas=projectionFrameData.recalculatedProjection=0,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),record(projectionFrameData)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=d,this.root=g?g.root||g:this,this.path=g?[...g.path,g]:[],this.parent=g,this.depth=g?g.depth+1:0;for(let y=0;y<this.path.length;y++)this.path[y].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(d,g){return this.eventHandlers.has(d)||this.eventHandlers.set(d,new SubscriptionManager),this.eventHandlers.get(d).add(g)}notifyListeners(d,...g){const y=this.eventHandlers.get(d);y&&y.notify(...g)}hasListeners(d){return this.eventHandlers.has(d)}mount(d,g=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=isSVGElement(d),this.instance=d;const{layoutId:y,layout:_,visualElement:E}=this.options;if(E&&!E.current&&E.mount(d),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),g&&(_||y)&&(this.isLayoutDirty=!0),s){let S;const A=()=>this.root.updateBlockedByResize=!1;s(d,()=>{this.root.updateBlockedByResize=!0,S&&S(),S=delay(A,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}y&&this.root.registerSharedNode(y,this),this.options.animate!==!1&&E&&(y||_)&&this.addEventListener("didUpdate",({delta:S,hasLayoutChanged:A,hasRelativeTargetChanged:C,layout:N})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const O=this.options.transition||E.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:I,onLayoutAnimationComplete:P}=E.getProps(),j=!this.targetLayout||!boxEqualsRounded(this.targetLayout,N)||C,B=!A&&C;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||B||A&&(j||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(S,B);const H={...getValueTransition(O,"layout"),onPlay:I,onComplete:P};(E.shouldReduceMotion||this.options.layoutRoot)&&(H.delay=0,H.type=!1),this.startAnimation(H)}else A||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=N})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const d=this.getStack();d&&d.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetRotation),this.animationId++)}getTransformTemplate(){const{visualElement:d}=this.options;return d&&d.getProps().transformTemplate}willUpdate(d=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let E=0;E<this.path.length;E++){const S=this.path[E];S.shouldResetTransform=!0,S.updateScroll("snapshot"),S.options.layoutRoot&&S.willUpdate(!1)}const{layoutId:g,layout:y}=this.options;if(g===void 0&&!y)return;const _=this.getTransformTemplate();this.prevTransformTemplateValue=_?_(this.latestValues,""):void 0,this.updateSnapshot(),d&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const g=performance.now();frameData.delta=clamp$1(0,1e3/60,g-frameData.timestamp),frameData.timestamp=g,frameData.isProcessing=!0,steps.update.process(frameData),steps.preRender.process(frameData),steps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let y=0;y<this.path.length;y++)this.path[y].updateScroll();const d=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:g}=this.options;g&&g.notify("LayoutMeasure",this.layout.layoutBox,d?d.layoutBox:void 0)}updateScroll(d="measure"){let g=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===d&&(g=!1),g&&(this.scroll={animationId:this.root.animationId,phase:d,isRoot:o(this.instance),offset:t(this.instance)})}resetTransform(){if(!a)return;const d=this.isLayoutDirty||this.shouldResetTransform,g=this.projectionDelta&&!isDeltaZero(this.projectionDelta),y=this.getTransformTemplate(),_=y?y(this.latestValues,""):void 0,E=_!==this.prevTransformTemplateValue;d&&(g||hasTransform(this.latestValues)||E)&&(a(this.instance,_),this.shouldResetTransform=!1,this.scheduleRender())}measure(d=!0){const g=this.measurePageBox();let y=this.removeElementScroll(g);return d&&(y=this.removeTransform(y)),roundBox(y),{animationId:this.root.animationId,measuredBox:g,layoutBox:y,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:d}=this.options;if(!d)return createBox();const g=d.measureViewportBox(),{scroll:y}=this.root;return y&&(translateAxis(g.x,y.offset.x),translateAxis(g.y,y.offset.y)),g}removeElementScroll(d){const g=createBox();copyBoxInto(g,d);for(let y=0;y<this.path.length;y++){const _=this.path[y],{scroll:E,options:S}=_;if(_!==this.root&&E&&S.layoutScroll){if(E.isRoot){copyBoxInto(g,d);const{scroll:A}=this.root;A&&(translateAxis(g.x,-A.offset.x),translateAxis(g.y,-A.offset.y))}translateAxis(g.x,E.offset.x),translateAxis(g.y,E.offset.y)}}return g}applyTransform(d,g=!1){const y=createBox();copyBoxInto(y,d);for(let _=0;_<this.path.length;_++){const E=this.path[_];!g&&E.options.layoutScroll&&E.scroll&&E!==E.root&&transformBox(y,{x:-E.scroll.offset.x,y:-E.scroll.offset.y}),hasTransform(E.latestValues)&&transformBox(y,E.latestValues)}return hasTransform(this.latestValues)&&transformBox(y,this.latestValues),y}removeTransform(d){const g=createBox();copyBoxInto(g,d);for(let y=0;y<this.path.length;y++){const _=this.path[y];if(!_.instance||!hasTransform(_.latestValues))continue;hasScale(_.latestValues)&&_.updateSnapshot();const E=createBox(),S=_.measurePageBox();copyBoxInto(E,S),removeBoxTransforms(g,_.latestValues,_.snapshot?_.snapshot.layoutBox:void 0,E)}return hasTransform(this.latestValues)&&removeBoxTransforms(g,this.latestValues),g}setTargetDelta(d){this.targetDelta=d,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(d){this.options={...this.options,...d,crossfade:d.crossfade!==void 0?d.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(d=!1){var g;const y=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=y.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=y.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=y.isSharedProjectionDirty);const _=!!this.resumingFrom||this!==y;if(!(d||_&&this.isSharedProjectionDirty||this.isProjectionDirty||!((g=this.parent)===null||g===void 0)&&g.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:S,layoutId:A}=this.options;if(!(!this.layout||!(S||A))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const C=this.getClosestProjectingParent();C&&C.layout&&this.animationProgress!==1?(this.relativeParent=C,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,C.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const C=this.getClosestProjectingParent();C&&!!C.resumingFrom==!!this.resumingFrom&&!C.options.layoutScroll&&C.target&&this.animationProgress!==1?(this.relativeParent=C,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,C.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}projectionFrameData.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var d;const g=this.getLead(),y=!!this.resumingFrom||this!==g;let _=!0;if((this.isProjectionDirty||!((d=this.parent)===null||d===void 0)&&d.isProjectionDirty)&&(_=!1),y&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(_=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(_=!1),_)return;const{layout:E,layoutId:S}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(E||S))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const A=this.treeScale.x,C=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,y),g.layout&&!g.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(g.target=g.layout.layoutBox);const{target:N}=g;if(!N){this.projectionTransform&&(this.projectionDelta=createDelta(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta());const O=this.projectionTransform;calcBoxDelta(this.projectionDelta,this.layoutCorrected,N,this.latestValues),this.projectionTransform=buildProjectionTransform(this.projectionDelta,this.treeScale),(this.projectionTransform!==O||this.treeScale.x!==A||this.treeScale.y!==C)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",N)),projectionFrameData.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(d=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),d){const g=this.getStack();g&&g.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(d,g=!1){const y=this.snapshot,_=y?y.latestValues:{},E={...this.latestValues},S=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!g;const A=createBox(),C=y?y.source:void 0,N=this.layout?this.layout.source:void 0,O=C!==N,I=this.getStack(),P=!I||I.members.length<=1,j=!!(O&&!P&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let B;this.mixTargetDelta=H=>{const se=H/1e3;mixAxisDelta(S.x,d.x,se),mixAxisDelta(S.y,d.y,se),this.setTargetDelta(S),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(A,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,A,se),B&&boxEquals(this.relativeTarget,B)&&(this.isProjectionDirty=!1),B||(B=createBox()),copyBoxInto(B,this.relativeTarget)),O&&(this.animationValues=E,mixValues(E,_,this.latestValues,se,j,P)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=se},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(d){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.currentAnimation=animateSingleValue(0,animationTarget,{...d,onUpdate:g=>{this.mixTargetDelta(g),d.onUpdate&&d.onUpdate(g)},onComplete:()=>{d.onComplete&&d.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const d=this.getStack();d&&d.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const d=this.getLead();let{targetWithTransforms:g,target:y,layout:_,latestValues:E}=d;if(!(!g||!y||!_)){if(this!==d&&this.layout&&_&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,_.layoutBox)){y=this.target||createBox();const S=calcLength(this.layout.layoutBox.x);y.x.min=d.target.x.min,y.x.max=y.x.min+S;const A=calcLength(this.layout.layoutBox.y);y.y.min=d.target.y.min,y.y.max=y.y.min+A}copyBoxInto(g,y),transformBox(g,E),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,g,E)}}registerSharedNode(d,g){this.sharedNodes.has(d)||this.sharedNodes.set(d,new NodeStack),this.sharedNodes.get(d).add(g);const _=g.options.initialPromotionConfig;g.promote({transition:_?_.transition:void 0,preserveFollowOpacity:_&&_.shouldPreserveFollowOpacity?_.shouldPreserveFollowOpacity(g):void 0})}isLead(){const d=this.getStack();return d?d.lead===this:!0}getLead(){var d;const{layoutId:g}=this.options;return g?((d=this.getStack())===null||d===void 0?void 0:d.lead)||this:this}getPrevLead(){var d;const{layoutId:g}=this.options;return g?(d=this.getStack())===null||d===void 0?void 0:d.prevLead:void 0}getStack(){const{layoutId:d}=this.options;if(d)return this.root.sharedNodes.get(d)}promote({needsReset:d,transition:g,preserveFollowOpacity:y}={}){const _=this.getStack();_&&_.promote(this,y),d&&(this.projectionDelta=void 0,this.needsReset=!0),g&&this.setOptions({transition:g})}relegate(){const d=this.getStack();return d?d.relegate(this):!1}resetRotation(){const{visualElement:d}=this.options;if(!d)return;let g=!1;const{latestValues:y}=d;if((y.rotate||y.rotateX||y.rotateY||y.rotateZ)&&(g=!0),!g)return;const _={};for(let E=0;E<transformAxes.length;E++){const S="rotate"+transformAxes[E];y[S]&&(_[S]=y[S],d.setStaticValue(S,0))}d.render();for(const E in _)d.setStaticValue(E,_[E]);d.scheduleRender()}getProjectionStyles(d){var g,y;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const _={visibility:""},E=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,_.opacity="",_.pointerEvents=resolveMotionValue(d==null?void 0:d.pointerEvents)||"",_.transform=E?E(this.latestValues,""):"none",_;const S=this.getLead();if(!this.projectionDelta||!this.layout||!S.target){const O={};return this.options.layoutId&&(O.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,O.pointerEvents=resolveMotionValue(d==null?void 0:d.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(O.transform=E?E({},""):"none",this.hasProjected=!1),O}const A=S.animationValues||S.latestValues;this.applyTransformsToTarget(),_.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,A),E&&(_.transform=E(A,_.transform));const{x:C,y:N}=this.projectionDelta;_.transformOrigin=`${C.origin*100}% ${N.origin*100}% 0`,S.animationValues?_.opacity=S===this?(y=(g=A.opacity)!==null&&g!==void 0?g:this.latestValues.opacity)!==null&&y!==void 0?y:1:this.preserveOpacity?this.latestValues.opacity:A.opacityExit:_.opacity=S===this?A.opacity!==void 0?A.opacity:"":A.opacityExit!==void 0?A.opacityExit:0;for(const O in scaleCorrectors){if(A[O]===void 0)continue;const{correct:I,applyTo:P}=scaleCorrectors[O],j=_.transform==="none"?A[O]:I(A[O],S);if(P){const B=P.length;for(let H=0;H<B;H++)_[P[H]]=j}else _[O]=j}return this.options.layoutId&&(_.pointerEvents=S===this?resolveMotionValue(d==null?void 0:d.pointerEvents)||"":"none"),_}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(d=>{var g;return(g=d.currentAnimation)===null||g===void 0?void 0:g.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(s){s.updateLayout()}function notifyLayoutUpdate(s){var e;const t=((e=s.resumeFrom)===null||e===void 0?void 0:e.snapshot)||s.snapshot;if(s.isLead()&&s.layout&&t&&s.hasListeners("didUpdate")){const{layoutBox:o,measuredBox:a}=s.layout,{animationType:c}=s.options,d=t.source!==s.layout.source;c==="size"?eachAxis(S=>{const A=d?t.measuredBox[S]:t.layoutBox[S],C=calcLength(A);A.min=o[S].min,A.max=A.min+C}):shouldAnimatePositionOnly(c,t.layoutBox,o)&&eachAxis(S=>{const A=d?t.measuredBox[S]:t.layoutBox[S],C=calcLength(o[S]);A.max=A.min+C,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[S].max=s.relativeTarget[S].min+C)});const g=createDelta();calcBoxDelta(g,o,t.layoutBox);const y=createDelta();d?calcBoxDelta(y,s.applyTransform(a,!0),t.measuredBox):calcBoxDelta(y,o,t.layoutBox);const _=!isDeltaZero(g);let E=!1;if(!s.resumeFrom){const S=s.getClosestProjectingParent();if(S&&!S.resumeFrom){const{snapshot:A,layout:C}=S;if(A&&C){const N=createBox();calcRelativePosition(N,t.layoutBox,A.layoutBox);const O=createBox();calcRelativePosition(O,o,C.layoutBox),boxEqualsRounded(N,O)||(E=!0),S.options.layoutRoot&&(s.relativeTarget=O,s.relativeTargetOrigin=N,s.relativeParent=S)}}}s.notifyListeners("didUpdate",{layout:o,snapshot:t,delta:y,layoutDelta:g,hasLayoutChanged:_,hasRelativeTargetChanged:E})}else if(s.isLead()){const{onExitComplete:o}=s.options;o&&o()}s.options.transition=void 0}function propagateDirtyNodes(s){projectionFrameData.totalNodes++,s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function cleanDirtyNodes(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function clearSnapshot(s){s.clearSnapshot()}function clearMeasurements(s){s.clearMeasurements()}function clearIsLayoutDirty(s){s.isLayoutDirty=!1}function resetTransformStyle(s){const{visualElement:e}=s.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),s.resetTransform()}function finishAnimation(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function resolveTargetDelta(s){s.resolveTargetDelta()}function calcProjection(s){s.calcProjection()}function resetRotation(s){s.resetRotation()}function removeLeadSnapshots(s){s.removeLeadSnapshot()}function mixAxisDelta(s,e,t){s.translate=mix(e.translate,0,t),s.scale=mix(e.scale,1,t),s.origin=e.origin,s.originPoint=e.originPoint}function mixAxis(s,e,t,o){s.min=mix(e.min,t.min,o),s.max=mix(e.max,t.max,o)}function mixBox(s,e,t,o){mixAxis(s.x,e.x,t.x,o),mixAxis(s.y,e.y,t.y,o)}function hasOpacityCrossfade(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=s=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(s),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop$1;function roundAxis(s){s.min=roundPoint(s.min),s.max=roundPoint(s.max)}function roundBox(s){roundAxis(s.x),roundAxis(s.y)}function shouldAnimatePositionOnly(s,e,t){return s==="position"||s==="preserve-aspect"&&!isNear(aspectRatio(e),aspectRatio(t),.2)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(s,e)=>addDomEvent(s,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const s=new DocumentProjectionNode({});s.mount(window),s.setOptions({layoutScroll:!0}),rootProjectionNode.current=s}return rootProjectionNode.current},resetTransform:(s,e)=>{s.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}},splitCSSVariableRegex=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function parseCSSVariable(s){const e=splitCSSVariableRegex.exec(s);if(!e)return[,];const[,t,o]=e;return[t,o]}function getVariableValue(s,e,t=1){const[o,a]=parseCSSVariable(s);if(!o)return;const c=window.getComputedStyle(e).getPropertyValue(o);if(c){const d=c.trim();return isNumericalString(d)?parseFloat(d):d}else return isCSSVariableToken(a)?getVariableValue(a,e,t+1):a}function resolveCSSVariables(s,{...e},t){const o=s.current;if(!(o instanceof Element))return{target:e,transitionEnd:t};t&&(t={...t}),s.values.forEach(a=>{const c=a.get();if(!isCSSVariableToken(c))return;const d=getVariableValue(c,o);d&&a.set(d)});for(const a in e){const c=e[a];if(!isCSSVariableToken(c))continue;const d=getVariableValue(c,o);d&&(e[a]=d,t||(t={}),t[a]===void 0&&(t[a]=c))}return{target:e,transitionEnd:t}}const positionalKeys=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),isPositionalKey=s=>positionalKeys.has(s),hasPositionalKey=s=>Object.keys(s).some(isPositionalKey),isNumOrPxType=s=>s===number||s===px,getPosFromMatrix=(s,e)=>parseFloat(s.split(", ")[e]),getTranslateFromMatrix=(s,e)=>(t,{transform:o})=>{if(o==="none"||!o)return 0;const a=o.match(/^matrix3d\((.+)\)$/);if(a)return getPosFromMatrix(a[1],e);{const c=o.match(/^matrix\((.+)\)$/);return c?getPosFromMatrix(c[1],s):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(s=>!transformKeys.has(s));function removeNonTranslationalTransform(s){const e=[];return nonTranslationalTransformKeys.forEach(t=>{const o=s.getValue(t);o!==void 0&&(e.push([t,o.get()]),o.set(t.startsWith("scale")?1:0))}),e.length&&s.render(),e}const positionalValues={width:({x:s},{paddingLeft:e="0",paddingRight:t="0"})=>s.max-s.min-parseFloat(e)-parseFloat(t),height:({y:s},{paddingTop:e="0",paddingBottom:t="0"})=>s.max-s.min-parseFloat(e)-parseFloat(t),top:(s,{top:e})=>parseFloat(e),left:(s,{left:e})=>parseFloat(e),bottom:({y:s},{top:e})=>parseFloat(e)+(s.max-s.min),right:({x:s},{left:e})=>parseFloat(e)+(s.max-s.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const convertChangedValueTypes=(s,e,t)=>{const o=e.measureViewportBox(),a=e.current,c=getComputedStyle(a),{display:d}=c,g={};d==="none"&&e.setStaticValue("display",s.display||"block"),t.forEach(_=>{g[_]=positionalValues[_](o,c)}),e.render();const y=e.measureViewportBox();return t.forEach(_=>{const E=e.getValue(_);E&&E.jump(g[_]),s[_]=positionalValues[_](y,c)}),s},checkAndConvertChangedValueTypes=(s,e,t={},o={})=>{e={...e},o={...o};const a=Object.keys(e).filter(isPositionalKey);let c=[],d=!1;const g=[];if(a.forEach(y=>{const _=s.getValue(y);if(!s.hasValue(y))return;let E=t[y],S=findDimensionValueType(E);const A=e[y];let C;if(isKeyframesTarget(A)){const N=A.length,O=A[0]===null?1:0;E=A[O],S=findDimensionValueType(E);for(let I=O;I<N&&A[I]!==null;I++)C?invariant(findDimensionValueType(A[I])===C):C=findDimensionValueType(A[I])}else C=findDimensionValueType(A);if(S!==C)if(isNumOrPxType(S)&&isNumOrPxType(C)){const N=_.get();typeof N=="string"&&_.set(parseFloat(N)),typeof A=="string"?e[y]=parseFloat(A):Array.isArray(A)&&C===px&&(e[y]=A.map(parseFloat))}else S!=null&&S.transform&&(C!=null&&C.transform)&&(E===0||A===0)?E===0?_.set(C.transform(E)):e[y]=S.transform(A):(d||(c=removeNonTranslationalTransform(s),d=!0),g.push(y),o[y]=o[y]!==void 0?o[y]:e[y],_.jump(A))}),g.length){const y=g.indexOf("height")>=0?window.pageYOffset:null,_=convertChangedValueTypes(e,s,g);return c.length&&c.forEach(([E,S])=>{s.getValue(E).set(S)}),s.render(),isBrowser&&y!==null&&window.scrollTo({top:y}),{target:_,transitionEnd:o}}else return{target:e,transitionEnd:o}};function unitConversion(s,e,t,o){return hasPositionalKey(e)?checkAndConvertChangedValueTypes(s,e,t,o):{target:e,transitionEnd:o}}const parseDomVariant=(s,e,t,o)=>{const a=resolveCSSVariables(s,e,o);return e=a.target,o=a.transitionEnd,unitConversion(s,e,t,o)},prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),e=()=>prefersReducedMotion.current=s.matches;s.addListener(e),e()}else prefersReducedMotion.current=!1}function updateMotionValuesFromProps(s,e,t){const{willChange:o}=e;for(const a in e){const c=e[a],d=t[a];if(isMotionValue(c))s.addValue(a,c),isWillChangeMotionValue(o)&&o.add(a);else if(isMotionValue(d))s.addValue(a,motionValue(c,{owner:s})),isWillChangeMotionValue(o)&&o.remove(a);else if(d!==c)if(s.hasValue(a)){const g=s.getValue(a);!g.hasAnimated&&g.set(c)}else{const g=s.getStaticValue(a);s.addValue(a,motionValue(g!==void 0?g:c,{owner:s}))}}for(const a in t)e[a]===void 0&&s.removeValue(a);return e}const visualElementStore=new WeakMap,featureNames=Object.keys(featureDefinitions),numFeatures=featureNames.length,propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],numVariantProps=variantProps.length;class VisualElement{constructor({parent:e,props:t,presenceContext:o,reducedMotionConfig:a,visualState:c},d={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>frame.render(this.render,!1,!0);const{latestValues:g,renderState:y}=c;this.latestValues=g,this.baseTarget={...g},this.initialValues=t.initial?{...g}:{},this.renderState=y,this.parent=e,this.props=t,this.presenceContext=o,this.depth=e?e.depth+1:0,this.reducedMotionConfig=a,this.options=d,this.isControllingVariants=isControllingVariants(t),this.isVariantNode=isVariantNode(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:_,...E}=this.scrapeMotionValuesFromProps(t,{});for(const S in E){const A=E[S];g[S]!==void 0&&isMotionValue(A)&&(A.set(g[S],!1),isWillChangeMotionValue(_)&&_.add(S))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,visualElementStore.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,o)=>this.bindToMotionValue(o,t)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){visualElementStore.delete(this.current),this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){const o=transformProps.has(e),a=t.on("change",d=>{this.latestValues[e]=d,this.props.onUpdate&&frame.update(this.notifyUpdate,!1,!0),o&&this.projection&&(this.projection.isTransformDirty=!0)}),c=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{a(),c()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...t},o,a,c){let d,g;for(let y=0;y<numFeatures;y++){const _=featureNames[y],{isEnabled:E,Feature:S,ProjectionNode:A,MeasureLayout:C}=featureDefinitions[_];A&&(d=A),E(t)&&(!this.features[_]&&S&&(this.features[_]=new S(this)),C&&(g=C))}if((this.type==="html"||this.type==="svg")&&!this.projection&&d){this.projection=new d(this.latestValues,this.parent&&this.parent.projection);const{layoutId:y,layout:_,drag:E,dragConstraints:S,layoutScroll:A,layoutRoot:C}=t;this.projection.setOptions({layoutId:y,layout:_,alwaysMeasureLayout:!!E||S&&isRefObject(S),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof _=="string"?_:"both",initialPromotionConfig:c,layoutScroll:A,layoutRoot:C})}return g}updateFeatures(){for(const e in this.features){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e,t=!0){return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let o=0;o<propEventHandlers.length;o++){const a=propEventHandlers[o];this.propEventSubscriptions[a]&&(this.propEventSubscriptions[a](),delete this.propEventSubscriptions[a]);const c=e["on"+a];c&&(this.propEventSubscriptions[a]=this.on(a,c))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const o=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(o.initial=this.props.initial),o}const t={};for(let o=0;o<numVariantProps;o++){const a=variantProps[o],c=this.props[a];(isVariantLabel(c)||c===!1)&&(t[a]=c)}return t}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let o=this.values.get(e);return o===void 0&&t!==void 0&&(o=motionValue(t,{owner:this}),this.addValue(e,o)),o}readValue(e){var t;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(t=this.getBaseTargetFromProps(this.props,e))!==null&&t!==void 0?t:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:o}=this.props,a=typeof o=="string"||typeof o=="object"?(t=resolveVariantFromProps(this.props,o))===null||t===void 0?void 0:t[e]:void 0;if(o&&a!==void 0)return a;const c=this.getBaseTargetFromProps(this.props,e);return c!==void 0&&!isMotionValue(c)?c:this.initialValues[e]!==void 0&&a===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new SubscriptionManager),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class DOMVisualElement extends VisualElement{sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:o}){delete t[e],delete o[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:t,...o},{transformValues:a},c){let d=getOrigin(o,e||{},this);if(a&&(t&&(t=a(t)),o&&(o=a(o)),d&&(d=a(d))),c){checkTargetForNewValues(this,o,d);const g=parseDomVariant(this,o,d,t);t=g.transitionEnd,o=g.target}return{transition:e,transitionEnd:t,...o}}}function getComputedStyle$1(s){return window.getComputedStyle(s)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,t){if(transformProps.has(t)){const o=getDefaultValueType(t);return o&&o.default||0}else{const o=getComputedStyle$1(e),a=(isCSSVariableName(t)?o.getPropertyValue(t):o[t])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:t}){return measureViewportBox(e,t)}build(e,t,o,a){buildHTMLStyles(e,t,o,a.transformTemplate)}scrapeMotionValuesFromProps(e,t){return scrapeMotionValuesFromProps$1(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;isMotionValue(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}renderInstance(e,t,o,a){renderHTML(e,t,o,a)}}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(transformProps.has(t)){const o=getDefaultValueType(t);return o&&o.default||0}return t=camelCaseAttributes.has(t)?t:camelToDash(t),e.getAttribute(t)}measureInstanceViewportBox(){return createBox()}scrapeMotionValuesFromProps(e,t){return scrapeMotionValuesFromProps(e,t)}build(e,t,o,a){buildSVGAttrs(e,t,o,this.isSVGTag,a.transformTemplate)}renderInstance(e,t,o,a){renderSVG(e,t,o,a)}mount(e){this.isSVGTag=isSVGTag(e.tagName),super.mount(e)}}const createDomVisualElement=(s,e)=>isSVGComponent(s)?new SVGVisualElement(e,{enableHardwareAcceleration:!1}):new HTMLVisualElement(e,{enableHardwareAcceleration:!0}),layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},preloadedFeatures={...animations,...gestureAnimations,...drag,...layout},motion=createMotionProxy((s,e)=>createDomMotionConfig(s,e,preloadedFeatures,createDomVisualElement));function useIsMounted(){const s=reactExports.useRef(!1);return useIsomorphicLayoutEffect(()=>(s.current=!0,()=>{s.current=!1}),[]),s}function useForceUpdate(){const s=useIsMounted(),[e,t]=reactExports.useState(0),o=reactExports.useCallback(()=>{s.current&&t(e+1)},[e]);return[reactExports.useCallback(()=>frame.postRender(o),[o]),e]}class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const o=this.props.sizeRef.current;o.height=t.offsetHeight||0,o.width=t.offsetWidth||0,o.top=t.offsetTop,o.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:s,isPresent:e}){const t=reactExports.useId(),o=reactExports.useRef(null),a=reactExports.useRef({width:0,height:0,top:0,left:0});return reactExports.useInsertionEffect(()=>{const{width:c,height:d,top:g,left:y}=a.current;if(e||!o.current||!c||!d)return;o.current.dataset.motionPopId=t;const _=document.createElement("style");return document.head.appendChild(_),_.sheet&&_.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            top: ${g}px !important;
            left: ${y}px !important;
          }
        `),()=>{document.head.removeChild(_)}},[e]),reactExports.createElement(PopChildMeasure,{isPresent:e,childRef:o,sizeRef:a},reactExports.cloneElement(s,{ref:o}))}const PresenceChild=({children:s,initial:e,isPresent:t,onExitComplete:o,custom:a,presenceAffectsLayout:c,mode:d})=>{const g=useConstant(newChildrenMap),y=reactExports.useId(),_=reactExports.useMemo(()=>({id:y,initial:e,isPresent:t,custom:a,onExitComplete:E=>{g.set(E,!0);for(const S of g.values())if(!S)return;o&&o()},register:E=>(g.set(E,!1),()=>g.delete(E))}),c?void 0:[t]);return reactExports.useMemo(()=>{g.forEach((E,S)=>g.set(S,!1))},[t]),reactExports.useEffect(()=>{!t&&!g.size&&o&&o()},[t]),d==="popLayout"&&(s=reactExports.createElement(PopChild,{isPresent:t},s)),reactExports.createElement(PresenceContext.Provider,{value:_},s)};function newChildrenMap(){return new Map}function useUnmountEffect(s){return reactExports.useEffect(()=>()=>s(),[])}const getChildKey=s=>s.key||"";function updateChildLookup(s,e){s.forEach(t=>{const o=getChildKey(t);e.set(o,t)})}function onlyElements(s){const e=[];return reactExports.Children.forEach(s,t=>{reactExports.isValidElement(t)&&e.push(t)}),e}const AnimatePresence=({children:s,custom:e,initial:t=!0,onExitComplete:o,exitBeforeEnter:a,presenceAffectsLayout:c=!0,mode:d="sync"})=>{const g=reactExports.useContext(LayoutGroupContext).forceRender||useForceUpdate()[0],y=useIsMounted(),_=onlyElements(s);let E=_;const S=reactExports.useRef(new Map).current,A=reactExports.useRef(E),C=reactExports.useRef(new Map).current,N=reactExports.useRef(!0);if(useIsomorphicLayoutEffect(()=>{N.current=!1,updateChildLookup(_,C),A.current=E}),useUnmountEffect(()=>{N.current=!0,C.clear(),S.clear()}),N.current)return reactExports.createElement(reactExports.Fragment,null,E.map(j=>reactExports.createElement(PresenceChild,{key:getChildKey(j),isPresent:!0,initial:t?void 0:!1,presenceAffectsLayout:c,mode:d},j)));E=[...E];const O=A.current.map(getChildKey),I=_.map(getChildKey),P=O.length;for(let j=0;j<P;j++){const B=O[j];I.indexOf(B)===-1&&!S.has(B)&&S.set(B,void 0)}return d==="wait"&&S.size&&(E=[]),S.forEach((j,B)=>{if(I.indexOf(B)!==-1)return;const H=C.get(B);if(!H)return;const se=O.indexOf(B);let oe=j;if(!oe){const Q=()=>{S.delete(B);const fe=Array.from(C.keys()).filter(Z=>!I.includes(Z));if(fe.forEach(Z=>C.delete(Z)),A.current=_.filter(Z=>{const ce=getChildKey(Z);return ce===B||fe.includes(ce)}),!S.size){if(y.current===!1)return;g(),o&&o()}};oe=reactExports.createElement(PresenceChild,{key:getChildKey(H),isPresent:!1,onExitComplete:Q,custom:e,presenceAffectsLayout:c,mode:d},H),S.set(B,oe)}E.splice(se,0,oe)}),E=E.map(j=>{const B=j.key;return S.has(B)?j:reactExports.createElement(PresenceChild,{key:getChildKey(j),isPresent:!0,presenceAffectsLayout:c,mode:d},j)}),reactExports.createElement(reactExports.Fragment,null,S.size?E:E.map(j=>reactExports.cloneElement(j)))};function ArrowRightOnRectangleIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3 0 3-3m0 0-3-3m3 3H9"}))}const ForwardRef$A=reactExports.forwardRef(ArrowRightOnRectangleIcon),ArrowRightOnRectangleIcon$1=ForwardRef$A;function ArrowRightIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"}))}const ForwardRef$z=reactExports.forwardRef(ArrowRightIcon),ArrowRightIcon$1=ForwardRef$z;function ArrowTopRightOnSquareIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"}))}const ForwardRef$y=reactExports.forwardRef(ArrowTopRightOnSquareIcon),ArrowTopRightOnSquareIcon$1=ForwardRef$y;function ArrowUpTrayIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const ForwardRef$x=reactExports.forwardRef(ArrowUpTrayIcon),ArrowUpTrayIcon$1=ForwardRef$x;function BoltIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z"}))}const ForwardRef$w=reactExports.forwardRef(BoltIcon),BoltIcon$1=ForwardRef$w;function BuildingOfficeIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h1.5m-1.5 3h1.5m-1.5 3h1.5m3-6H15m-1.5 3H15m-1.5 3H15M9 21v-3.375c0-.621.504-1.125 1.125-1.125h3.75c.621 0 1.125.504 1.125 1.125V21"}))}const ForwardRef$v=reactExports.forwardRef(BuildingOfficeIcon),BuildingOfficeIcon$1=ForwardRef$v;function CameraIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"}))}const ForwardRef$u=reactExports.forwardRef(CameraIcon),CameraIcon$1=ForwardRef$u;function ChatBubbleLeftRightIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"}))}const ForwardRef$t=reactExports.forwardRef(ChatBubbleLeftRightIcon),ChatBubbleLeftRightIcon$1=ForwardRef$t;function CheckCircleIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ForwardRef$s=reactExports.forwardRef(CheckCircleIcon),CheckCircleIcon$1=ForwardRef$s;function ChevronDownIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const ForwardRef$r=reactExports.forwardRef(ChevronDownIcon),ChevronDownIcon$1=ForwardRef$r;function ChevronUpIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const ForwardRef$q=reactExports.forwardRef(ChevronUpIcon),ChevronUpIcon$1=ForwardRef$q;function CircleStackIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.25 6.375c0 2.278-3.694 4.125-8.25 4.125S3.75 8.653 3.75 6.375m16.5 0c0-2.278-3.694-4.125-8.25-4.125S3.75 4.097 3.75 6.375m16.5 0v11.25c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125V6.375m16.5 0v3.75m-16.5-3.75v3.75m16.5 0v3.75C20.25 16.153 16.556 18 12 18s-8.25-1.847-8.25-4.125v-3.75m16.5 0c0 2.278-3.694 4.125-8.25 4.125s-8.25-1.847-8.25-4.125"}))}const ForwardRef$p=reactExports.forwardRef(CircleStackIcon),CircleStackIcon$1=ForwardRef$p;function ClockIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const ForwardRef$o=reactExports.forwardRef(ClockIcon),ClockIcon$1=ForwardRef$o;function CogIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12a7.5 7.5 0 0 0 15 0m-15 0a7.5 7.5 0 1 1 15 0m-15 0H3m16.5 0H21m-1.5 0H12m-8.457 3.077 1.41-.513m14.095-5.13 1.41-.513M5.106 17.785l1.15-.964m11.49-9.642 1.149-.964M7.501 19.795l.75-1.3m7.5-12.99.75-1.3m-6.063 16.658.26-1.477m2.605-14.772.26-1.477m0 17.726-.26-1.477M10.698 4.614l-.26-1.477M16.5 19.794l-.75-1.299M7.5 4.205 12 12m6.894 5.785-1.149-.964M6.256 7.178l-1.15-.964m15.352 8.864-1.41-.513M4.954 9.435l-1.41-.514M12.002 12l-3.75 6.495"}))}const ForwardRef$n=reactExports.forwardRef(CogIcon),CogIcon$1=ForwardRef$n;function CreditCardIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25v10.5A2.25 2.25 0 0 0 4.5 19.5Z"}))}const ForwardRef$m=reactExports.forwardRef(CreditCardIcon),CreditCardIcon$1=ForwardRef$m;function DevicePhoneMobileIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3"}))}const ForwardRef$l=reactExports.forwardRef(DevicePhoneMobileIcon),DevicePhoneMobileIcon$1=ForwardRef$l;function DocumentTextIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ForwardRef$k=reactExports.forwardRef(DocumentTextIcon),DocumentTextIcon$1=ForwardRef$k;function EyeIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const ForwardRef$j=reactExports.forwardRef(EyeIcon),EyeIcon$1=ForwardRef$j;function FlagIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"}))}const ForwardRef$i=reactExports.forwardRef(FlagIcon),FlagIcon$1=ForwardRef$i;function GiftIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 11.25v8.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5v-8.25M12 4.875A2.625 2.625 0 1 0 9.375 7.5H12m0-2.625V7.5m0-2.625A2.625 2.625 0 1 1 14.625 7.5H12m0 0V21m-8.625-9.75h18c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125h-18c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z"}))}const ForwardRef$h=reactExports.forwardRef(GiftIcon),GiftIcon$1=ForwardRef$h;function HandThumbUpIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.633 10.25c.806 0 1.533-.446 2.031-1.08a9.041 9.041 0 0 1 2.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 0 0 .322-1.672V2.75a.75.75 0 0 1 .75-.75 2.25 2.25 0 0 1 2.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558.107 1.282.725 1.282m0 0h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 0 1-2.649 7.521c-.388.482-.987.729-1.605.729H13.48c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 0 0-1.423-.23H5.904m10.598-9.75H14.25M5.904 18.5c.083.205.173.405.27.602.197.4-.078.898-.523.898h-.908c-.889 0-1.713-.518-1.972-1.368a12 12 0 0 1-.521-3.507c0-1.553.295-3.036.831-4.398C3.387 9.953 4.167 9.5 5 9.5h1.053c.472 0 .745.556.5.96a8.958 8.958 0 0 0-1.302 4.665c0 1.194.232 2.333.654 3.375Z"}))}const ForwardRef$g=reactExports.forwardRef(HandThumbUpIcon),HandThumbUpIcon$1=ForwardRef$g;function HeartIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z"}))}const ForwardRef$f=reactExports.forwardRef(HeartIcon),HeartIcon$1=ForwardRef$f;function HomeIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))}const ForwardRef$e=reactExports.forwardRef(HomeIcon),HomeIcon$1=ForwardRef$e;function InformationCircleIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"}))}const ForwardRef$d=reactExports.forwardRef(InformationCircleIcon),InformationCircleIcon$1=ForwardRef$d;function LightBulbIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"}))}const ForwardRef$c=reactExports.forwardRef(LightBulbIcon),LightBulbIcon$1=ForwardRef$c;function LockClosedIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 10.5V6.75a4.5 4.5 0 1 0-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"}))}const ForwardRef$b=reactExports.forwardRef(LockClosedIcon),LockClosedIcon$1=ForwardRef$b;function MagnifyingGlassIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const ForwardRef$a=reactExports.forwardRef(MagnifyingGlassIcon),MagnifyingGlassIcon$1=ForwardRef$a;function PlusIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const ForwardRef$9=reactExports.forwardRef(PlusIcon),PlusIcon$1=ForwardRef$9;function QrCodeIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 3.75 9.375v-4.5ZM3.75 14.625c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5a1.125 1.125 0 0 1-1.125-1.125v-4.5ZM13.5 4.875c0-.621.504-1.125 1.125-1.125h4.5c.621 0 1.125.504 1.125 1.125v4.5c0 .621-.504 1.125-1.125 1.125h-4.5A1.125 1.125 0 0 1 13.5 9.375v-4.5Z"}),reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 6.75h.75v.75h-.75v-.75ZM6.75 16.5h.75v.75h-.75v-.75ZM16.5 6.75h.75v.75h-.75v-.75ZM13.5 13.5h.75v.75h-.75v-.75ZM13.5 19.5h.75v.75h-.75v-.75ZM19.5 13.5h.75v.75h-.75v-.75ZM19.5 19.5h.75v.75h-.75v-.75ZM16.5 16.5h.75v.75h-.75v-.75Z"}))}const ForwardRef$8=reactExports.forwardRef(QrCodeIcon),QrCodeIcon$1=ForwardRef$8;function RocketLaunchIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.59 14.37a6 6 0 0 1-5.84 7.38v-4.8m5.84-2.58a14.98 14.98 0 0 0 6.16-12.12A14.98 14.98 0 0 0 9.631 8.41m5.96 5.96a14.926 14.926 0 0 1-5.841 2.58m-.119-8.54a6 6 0 0 0-7.381 5.84h4.8m2.581-5.84a14.927 14.927 0 0 0-2.58 5.84m2.699 2.7c-.103.021-.207.041-.311.06a15.09 15.09 0 0 1-2.448-2.448 14.9 14.9 0 0 1 .06-.312m-2.24 2.39a4.493 4.493 0 0 0-1.757 4.306 4.493 4.493 0 0 0 4.306-1.758M16.5 9a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z"}))}const ForwardRef$7=reactExports.forwardRef(RocketLaunchIcon),RocketLaunchIcon$1=ForwardRef$7;function ShieldCheckIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z"}))}const ForwardRef$6=reactExports.forwardRef(ShieldCheckIcon),ShieldCheckIcon$1=ForwardRef$6;function ShoppingBagIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 10.5V6a3.75 3.75 0 1 0-7.5 0v4.5m11.356-1.993 1.263 12c.07.665-.45 1.243-1.119 1.243H4.25a1.125 1.125 0 0 1-1.12-1.243l1.264-12A1.125 1.125 0 0 1 5.513 7.5h12.974c.576 0 1.059.435 1.119 1.007ZM8.625 10.5a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm7.5 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const ForwardRef$5=reactExports.forwardRef(ShoppingBagIcon),ShoppingBagIcon$1=ForwardRef$5;function SparklesIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const ForwardRef$4=reactExports.forwardRef(SparklesIcon),SparklesIcon$1=ForwardRef$4;function StarIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const ForwardRef$3=reactExports.forwardRef(StarIcon),StarIcon$1=ForwardRef$3;function UserIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const ForwardRef$2=reactExports.forwardRef(UserIcon),UserIcon$1=ForwardRef$2;function UsersIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z"}))}const ForwardRef$1=reactExports.forwardRef(UsersIcon),UsersIcon$1=ForwardRef$1;function XMarkIcon({title:s,titleId:e,...t},o){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":e},t),s?reactExports.createElement("title",{id:e},s):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const ForwardRef=reactExports.forwardRef(XMarkIcon),XMarkIcon$1=ForwardRef;function setRef(s,e){if(typeof s=="function")return s(e);s!=null&&(s.current=e)}function composeRefs(...s){return e=>{let t=!1;const o=s.map(a=>{const c=setRef(a,e);return!t&&typeof c=="function"&&(t=!0),c});if(t)return()=>{for(let a=0;a<o.length;a++){const c=o[a];typeof c=="function"?c():setRef(s[a],null)}}}}function createSlot(s){const e=createSlotClone(s),t=reactExports.forwardRef((o,a)=>{const{children:c,...d}=o,g=reactExports.Children.toArray(c),y=g.find(isSlottable);if(y){const _=y.props.children,E=g.map(S=>S===y?reactExports.Children.count(_)>1?reactExports.Children.only(null):reactExports.isValidElement(_)?_.props.children:null:S);return jsxRuntimeExports.jsx(e,{...d,ref:a,children:reactExports.isValidElement(_)?reactExports.cloneElement(_,void 0,E):null})}return jsxRuntimeExports.jsx(e,{...d,ref:a,children:c})});return t.displayName=`${s}.Slot`,t}var Slot=createSlot("Slot");function createSlotClone(s){const e=reactExports.forwardRef((t,o)=>{const{children:a,...c}=t;if(reactExports.isValidElement(a)){const d=getElementRef(a),g=mergeProps(c,a.props);return a.type!==reactExports.Fragment&&(g.ref=o?composeRefs(o,d):d),reactExports.cloneElement(a,g)}return reactExports.Children.count(a)>1?reactExports.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var SLOTTABLE_IDENTIFIER=Symbol("radix.slottable");function isSlottable(s){return reactExports.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===SLOTTABLE_IDENTIFIER}function mergeProps(s,e){const t={...e};for(const o in e){const a=s[o],c=e[o];/^on[A-Z]/.test(o)?a&&c?t[o]=(...g)=>{const y=c(...g);return a(...g),y}:a&&(t[o]=a):o==="style"?t[o]={...a,...c}:o==="className"&&(t[o]=[a,c].filter(Boolean).join(" "))}return{...s,...t}}function getElementRef(s){var o,a;let e=(o=Object.getOwnPropertyDescriptor(s.props,"ref"))==null?void 0:o.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=(a=Object.getOwnPropertyDescriptor(s,"ref"))==null?void 0:a.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function r(s){var e,t,o="";if(typeof s=="string"||typeof s=="number")o+=s;else if(typeof s=="object")if(Array.isArray(s)){var a=s.length;for(e=0;e<a;e++)s[e]&&(t=r(s[e]))&&(o&&(o+=" "),o+=t)}else for(t in s)s[t]&&(o&&(o+=" "),o+=t);return o}function clsx(){for(var s,e,t=0,o="",a=arguments.length;t<a;t++)(s=arguments[t])&&(e=r(s))&&(o&&(o+=" "),o+=e);return o}const falsyToString=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,cx=clsx,cva=(s,e)=>t=>{var o;if((e==null?void 0:e.variants)==null)return cx(s,t==null?void 0:t.class,t==null?void 0:t.className);const{variants:a,defaultVariants:c}=e,d=Object.keys(a).map(_=>{const E=t==null?void 0:t[_],S=c==null?void 0:c[_];if(E===null)return null;const A=falsyToString(E)||falsyToString(S);return a[_][A]}),g=t&&Object.entries(t).reduce((_,E)=>{let[S,A]=E;return A===void 0||(_[S]=A),_},{}),y=e==null||(o=e.compoundVariants)===null||o===void 0?void 0:o.reduce((_,E)=>{let{class:S,className:A,...C}=E;return Object.entries(C).every(N=>{let[O,I]=N;return Array.isArray(I)?I.includes({...c,...g}[O]):{...c,...g}[O]===I})?[..._,S,A]:_},[]);return cx(s,d,y,t==null?void 0:t.class,t==null?void 0:t.className)},CLASS_PART_SEPARATOR="-",createClassGroupUtils=s=>{const e=createClassMap(s),{conflictingClassGroups:t,conflictingClassGroupModifiers:o}=s;return{getClassGroupId:d=>{const g=d.split(CLASS_PART_SEPARATOR);return g[0]===""&&g.length!==1&&g.shift(),getGroupRecursive(g,e)||getGroupIdForArbitraryProperty(d)},getConflictingClassGroupIds:(d,g)=>{const y=t[d]||[];return g&&o[d]?[...y,...o[d]]:y}}},getGroupRecursive=(s,e)=>{var d;if(s.length===0)return e.classGroupId;const t=s[0],o=e.nextPart.get(t),a=o?getGroupRecursive(s.slice(1),o):void 0;if(a)return a;if(e.validators.length===0)return;const c=s.join(CLASS_PART_SEPARATOR);return(d=e.validators.find(({validator:g})=>g(c)))==null?void 0:d.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=s=>{if(arbitraryPropertyRegex.test(s)){const e=arbitraryPropertyRegex.exec(s)[1],t=e==null?void 0:e.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},createClassMap=s=>{const{theme:e,classGroups:t}=s,o={nextPart:new Map,validators:[]};for(const a in t)processClassesRecursively(t[a],o,a,e);return o},processClassesRecursively=(s,e,t,o)=>{s.forEach(a=>{if(typeof a=="string"){const c=a===""?e:getPart(e,a);c.classGroupId=t;return}if(typeof a=="function"){if(isThemeGetter(a)){processClassesRecursively(a(o),e,t,o);return}e.validators.push({validator:a,classGroupId:t});return}Object.entries(a).forEach(([c,d])=>{processClassesRecursively(d,getPart(e,c),t,o)})})},getPart=(s,e)=>{let t=s;return e.split(CLASS_PART_SEPARATOR).forEach(o=>{t.nextPart.has(o)||t.nextPart.set(o,{nextPart:new Map,validators:[]}),t=t.nextPart.get(o)}),t},isThemeGetter=s=>s.isThemeGetter,createLruCache=s=>{if(s<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,o=new Map;const a=(c,d)=>{t.set(c,d),e++,e>s&&(e=0,o=t,t=new Map)};return{get(c){let d=t.get(c);if(d!==void 0)return d;if((d=o.get(c))!==void 0)return a(c,d),d},set(c,d){t.has(c)?t.set(c,d):a(c,d)}}},IMPORTANT_MODIFIER="!",MODIFIER_SEPARATOR=":",MODIFIER_SEPARATOR_LENGTH=MODIFIER_SEPARATOR.length,createParseClassName=s=>{const{prefix:e,experimentalParseClassName:t}=s;let o=a=>{const c=[];let d=0,g=0,y=0,_;for(let N=0;N<a.length;N++){let O=a[N];if(d===0&&g===0){if(O===MODIFIER_SEPARATOR){c.push(a.slice(y,N)),y=N+MODIFIER_SEPARATOR_LENGTH;continue}if(O==="/"){_=N;continue}}O==="["?d++:O==="]"?d--:O==="("?g++:O===")"&&g--}const E=c.length===0?a:a.substring(y),S=stripImportantModifier(E),A=S!==E,C=_&&_>y?_-y:void 0;return{modifiers:c,hasImportantModifier:A,baseClassName:S,maybePostfixModifierPosition:C}};if(e){const a=e+MODIFIER_SEPARATOR,c=o;o=d=>d.startsWith(a)?c(d.substring(a.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:d,maybePostfixModifierPosition:void 0}}if(t){const a=o;o=c=>t({className:c,parseClassName:a})}return o},stripImportantModifier=s=>s.endsWith(IMPORTANT_MODIFIER)?s.substring(0,s.length-1):s.startsWith(IMPORTANT_MODIFIER)?s.substring(1):s,createSortModifiers=s=>{const e=Object.fromEntries(s.orderSensitiveModifiers.map(o=>[o,!0]));return o=>{if(o.length<=1)return o;const a=[];let c=[];return o.forEach(d=>{d[0]==="["||e[d]?(a.push(...c.sort(),d),c=[]):c.push(d)}),a.push(...c.sort()),a}},createConfigUtils=s=>({cache:createLruCache(s.cacheSize),parseClassName:createParseClassName(s),sortModifiers:createSortModifiers(s),...createClassGroupUtils(s)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(s,e)=>{const{parseClassName:t,getClassGroupId:o,getConflictingClassGroupIds:a,sortModifiers:c}=e,d=[],g=s.trim().split(SPLIT_CLASSES_REGEX);let y="";for(let _=g.length-1;_>=0;_-=1){const E=g[_],{isExternal:S,modifiers:A,hasImportantModifier:C,baseClassName:N,maybePostfixModifierPosition:O}=t(E);if(S){y=E+(y.length>0?" "+y:y);continue}let I=!!O,P=o(I?N.substring(0,O):N);if(!P){if(!I){y=E+(y.length>0?" "+y:y);continue}if(P=o(N),!P){y=E+(y.length>0?" "+y:y);continue}I=!1}const j=c(A).join(":"),B=C?j+IMPORTANT_MODIFIER:j,H=B+P;if(d.includes(H))continue;d.push(H);const se=a(P,I);for(let oe=0;oe<se.length;++oe){const Q=se[oe];d.push(B+Q)}y=E+(y.length>0?" "+y:y)}return y};function twJoin(){let s=0,e,t,o="";for(;s<arguments.length;)(e=arguments[s++])&&(t=toValue(e))&&(o&&(o+=" "),o+=t);return o}const toValue=s=>{if(typeof s=="string")return s;let e,t="";for(let o=0;o<s.length;o++)s[o]&&(e=toValue(s[o]))&&(t&&(t+=" "),t+=e);return t};function createTailwindMerge(s,...e){let t,o,a,c=d;function d(y){const _=e.reduce((E,S)=>S(E),s());return t=createConfigUtils(_),o=t.cache.get,a=t.cache.set,c=g,g(y)}function g(y){const _=o(y);if(_)return _;const E=mergeClassList(y,t);return a(y,E),E}return function(){return c(twJoin.apply(null,arguments))}}const fromTheme=s=>{const e=t=>t[s]||[];return e.isThemeGetter=!0,e},arbitraryValueRegex=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,arbitraryVariableRegex=/^\((?:(\w[\w-]*):)?(.+)\)$/i,fractionRegex=/^\d+\/\d+$/,tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isFraction=s=>fractionRegex.test(s),isNumber=s=>!!s&&!Number.isNaN(Number(s)),isInteger=s=>!!s&&Number.isInteger(Number(s)),isPercent=s=>s.endsWith("%")&&isNumber(s.slice(0,-1)),isTshirtSize=s=>tshirtUnitRegex.test(s),isAny=()=>!0,isLengthOnly=s=>lengthUnitRegex.test(s)&&!colorFunctionRegex.test(s),isNever=()=>!1,isShadow=s=>shadowRegex.test(s),isImage=s=>imageRegex.test(s),isAnyNonArbitrary=s=>!isArbitraryValue(s)&&!isArbitraryVariable(s),isArbitrarySize=s=>getIsArbitraryValue(s,isLabelSize,isNever),isArbitraryValue=s=>arbitraryValueRegex.test(s),isArbitraryLength=s=>getIsArbitraryValue(s,isLabelLength,isLengthOnly),isArbitraryNumber=s=>getIsArbitraryValue(s,isLabelNumber,isNumber),isArbitraryPosition=s=>getIsArbitraryValue(s,isLabelPosition,isNever),isArbitraryImage=s=>getIsArbitraryValue(s,isLabelImage,isImage),isArbitraryShadow=s=>getIsArbitraryValue(s,isLabelShadow,isShadow),isArbitraryVariable=s=>arbitraryVariableRegex.test(s),isArbitraryVariableLength=s=>getIsArbitraryVariable(s,isLabelLength),isArbitraryVariableFamilyName=s=>getIsArbitraryVariable(s,isLabelFamilyName),isArbitraryVariablePosition=s=>getIsArbitraryVariable(s,isLabelPosition),isArbitraryVariableSize=s=>getIsArbitraryVariable(s,isLabelSize),isArbitraryVariableImage=s=>getIsArbitraryVariable(s,isLabelImage),isArbitraryVariableShadow=s=>getIsArbitraryVariable(s,isLabelShadow,!0),getIsArbitraryValue=(s,e,t)=>{const o=arbitraryValueRegex.exec(s);return o?o[1]?e(o[1]):t(o[2]):!1},getIsArbitraryVariable=(s,e,t=!1)=>{const o=arbitraryVariableRegex.exec(s);return o?o[1]?e(o[1]):t:!1},isLabelPosition=s=>s==="position"||s==="percentage",isLabelImage=s=>s==="image"||s==="url",isLabelSize=s=>s==="length"||s==="size"||s==="bg-size",isLabelLength=s=>s==="length",isLabelNumber=s=>s==="number",isLabelFamilyName=s=>s==="family-name",isLabelShadow=s=>s==="shadow",getDefaultConfig=()=>{const s=fromTheme("color"),e=fromTheme("font"),t=fromTheme("text"),o=fromTheme("font-weight"),a=fromTheme("tracking"),c=fromTheme("leading"),d=fromTheme("breakpoint"),g=fromTheme("container"),y=fromTheme("spacing"),_=fromTheme("radius"),E=fromTheme("shadow"),S=fromTheme("inset-shadow"),A=fromTheme("text-shadow"),C=fromTheme("drop-shadow"),N=fromTheme("blur"),O=fromTheme("perspective"),I=fromTheme("aspect"),P=fromTheme("ease"),j=fromTheme("animate"),B=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],se=()=>[...H(),isArbitraryVariable,isArbitraryValue],oe=()=>["auto","hidden","clip","visible","scroll"],Q=()=>["auto","contain","none"],fe=()=>[isArbitraryVariable,isArbitraryValue,y],Z=()=>[isFraction,"full","auto",...fe()],ce=()=>[isInteger,"none","subgrid",isArbitraryVariable,isArbitraryValue],ge=()=>["auto",{span:["full",isInteger,isArbitraryVariable,isArbitraryValue]},isInteger,isArbitraryVariable,isArbitraryValue],me=()=>[isInteger,"auto",isArbitraryVariable,isArbitraryValue],V=()=>["auto","min","max","fr",isArbitraryVariable,isArbitraryValue],R=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],L=()=>["start","end","center","stretch","center-safe","end-safe"],z=()=>["auto",...fe()],Y=()=>[isFraction,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...fe()],W=()=>[s,isArbitraryVariable,isArbitraryValue],ee=()=>[...H(),isArbitraryVariablePosition,isArbitraryPosition,{position:[isArbitraryVariable,isArbitraryValue]}],ie=()=>["no-repeat",{repeat:["","x","y","space","round"]}],X=()=>["auto","cover","contain",isArbitraryVariableSize,isArbitrarySize,{size:[isArbitraryVariable,isArbitraryValue]}],F=()=>[isPercent,isArbitraryVariableLength,isArbitraryLength],J=()=>["","none","full",_,isArbitraryVariable,isArbitraryValue],Ee=()=>["",isNumber,isArbitraryVariableLength,isArbitraryLength],Re=()=>["solid","dashed","dotted","double"],Te=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ue=()=>[isNumber,isPercent,isArbitraryVariablePosition,isArbitraryPosition],ze=()=>["","none",N,isArbitraryVariable,isArbitraryValue],Ke=()=>["none",isNumber,isArbitraryVariable,isArbitraryValue],it=()=>["none",isNumber,isArbitraryVariable,isArbitraryValue],Ye=()=>[isNumber,isArbitraryVariable,isArbitraryValue],Ce=()=>[isFraction,"full",...fe()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[isTshirtSize],breakpoint:[isTshirtSize],color:[isAny],container:[isTshirtSize],"drop-shadow":[isTshirtSize],ease:["in","out","in-out"],font:[isAnyNonArbitrary],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[isTshirtSize],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[isTshirtSize],shadow:[isTshirtSize],spacing:["px",isNumber],text:[isTshirtSize],"text-shadow":[isTshirtSize],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",isFraction,isArbitraryValue,isArbitraryVariable,I]}],container:["container"],columns:[{columns:[isNumber,isArbitraryValue,isArbitraryVariable,g]}],"break-after":[{"break-after":B()}],"break-before":[{"break-before":B()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:se()}],overflow:[{overflow:oe()}],"overflow-x":[{"overflow-x":oe()}],"overflow-y":[{"overflow-y":oe()}],overscroll:[{overscroll:Q()}],"overscroll-x":[{"overscroll-x":Q()}],"overscroll-y":[{"overscroll-y":Q()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:Z()}],"inset-x":[{"inset-x":Z()}],"inset-y":[{"inset-y":Z()}],start:[{start:Z()}],end:[{end:Z()}],top:[{top:Z()}],right:[{right:Z()}],bottom:[{bottom:Z()}],left:[{left:Z()}],visibility:["visible","invisible","collapse"],z:[{z:[isInteger,"auto",isArbitraryVariable,isArbitraryValue]}],basis:[{basis:[isFraction,"full","auto",g,...fe()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[isNumber,isFraction,"auto","initial","none",isArbitraryValue]}],grow:[{grow:["",isNumber,isArbitraryVariable,isArbitraryValue]}],shrink:[{shrink:["",isNumber,isArbitraryVariable,isArbitraryValue]}],order:[{order:[isInteger,"first","last","none",isArbitraryVariable,isArbitraryValue]}],"grid-cols":[{"grid-cols":ce()}],"col-start-end":[{col:ge()}],"col-start":[{"col-start":me()}],"col-end":[{"col-end":me()}],"grid-rows":[{"grid-rows":ce()}],"row-start-end":[{row:ge()}],"row-start":[{"row-start":me()}],"row-end":[{"row-end":me()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":V()}],"auto-rows":[{"auto-rows":V()}],gap:[{gap:fe()}],"gap-x":[{"gap-x":fe()}],"gap-y":[{"gap-y":fe()}],"justify-content":[{justify:[...R(),"normal"]}],"justify-items":[{"justify-items":[...L(),"normal"]}],"justify-self":[{"justify-self":["auto",...L()]}],"align-content":[{content:["normal",...R()]}],"align-items":[{items:[...L(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...L(),{baseline:["","last"]}]}],"place-content":[{"place-content":R()}],"place-items":[{"place-items":[...L(),"baseline"]}],"place-self":[{"place-self":["auto",...L()]}],p:[{p:fe()}],px:[{px:fe()}],py:[{py:fe()}],ps:[{ps:fe()}],pe:[{pe:fe()}],pt:[{pt:fe()}],pr:[{pr:fe()}],pb:[{pb:fe()}],pl:[{pl:fe()}],m:[{m:z()}],mx:[{mx:z()}],my:[{my:z()}],ms:[{ms:z()}],me:[{me:z()}],mt:[{mt:z()}],mr:[{mr:z()}],mb:[{mb:z()}],ml:[{ml:z()}],"space-x":[{"space-x":fe()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":fe()}],"space-y-reverse":["space-y-reverse"],size:[{size:Y()}],w:[{w:[g,"screen",...Y()]}],"min-w":[{"min-w":[g,"screen","none",...Y()]}],"max-w":[{"max-w":[g,"screen","none","prose",{screen:[d]},...Y()]}],h:[{h:["screen","lh",...Y()]}],"min-h":[{"min-h":["screen","lh","none",...Y()]}],"max-h":[{"max-h":["screen","lh",...Y()]}],"font-size":[{text:["base",t,isArbitraryVariableLength,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[o,isArbitraryVariable,isArbitraryNumber]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",isPercent,isArbitraryValue]}],"font-family":[{font:[isArbitraryVariableFamilyName,isArbitraryValue,e]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[a,isArbitraryVariable,isArbitraryValue]}],"line-clamp":[{"line-clamp":[isNumber,"none",isArbitraryVariable,isArbitraryNumber]}],leading:[{leading:[c,...fe()]}],"list-image":[{"list-image":["none",isArbitraryVariable,isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",isArbitraryVariable,isArbitraryValue]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:W()}],"text-color":[{text:W()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Re(),"wavy"]}],"text-decoration-thickness":[{decoration:[isNumber,"from-font","auto",isArbitraryVariable,isArbitraryLength]}],"text-decoration-color":[{decoration:W()}],"underline-offset":[{"underline-offset":[isNumber,"auto",isArbitraryVariable,isArbitraryValue]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:fe()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryVariable,isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryVariable,isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:ee()}],"bg-repeat":[{bg:ie()}],"bg-size":[{bg:X()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},isInteger,isArbitraryVariable,isArbitraryValue],radial:["",isArbitraryVariable,isArbitraryValue],conic:[isInteger,isArbitraryVariable,isArbitraryValue]},isArbitraryVariableImage,isArbitraryImage]}],"bg-color":[{bg:W()}],"gradient-from-pos":[{from:F()}],"gradient-via-pos":[{via:F()}],"gradient-to-pos":[{to:F()}],"gradient-from":[{from:W()}],"gradient-via":[{via:W()}],"gradient-to":[{to:W()}],rounded:[{rounded:J()}],"rounded-s":[{"rounded-s":J()}],"rounded-e":[{"rounded-e":J()}],"rounded-t":[{"rounded-t":J()}],"rounded-r":[{"rounded-r":J()}],"rounded-b":[{"rounded-b":J()}],"rounded-l":[{"rounded-l":J()}],"rounded-ss":[{"rounded-ss":J()}],"rounded-se":[{"rounded-se":J()}],"rounded-ee":[{"rounded-ee":J()}],"rounded-es":[{"rounded-es":J()}],"rounded-tl":[{"rounded-tl":J()}],"rounded-tr":[{"rounded-tr":J()}],"rounded-br":[{"rounded-br":J()}],"rounded-bl":[{"rounded-bl":J()}],"border-w":[{border:Ee()}],"border-w-x":[{"border-x":Ee()}],"border-w-y":[{"border-y":Ee()}],"border-w-s":[{"border-s":Ee()}],"border-w-e":[{"border-e":Ee()}],"border-w-t":[{"border-t":Ee()}],"border-w-r":[{"border-r":Ee()}],"border-w-b":[{"border-b":Ee()}],"border-w-l":[{"border-l":Ee()}],"divide-x":[{"divide-x":Ee()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":Ee()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...Re(),"hidden","none"]}],"divide-style":[{divide:[...Re(),"hidden","none"]}],"border-color":[{border:W()}],"border-color-x":[{"border-x":W()}],"border-color-y":[{"border-y":W()}],"border-color-s":[{"border-s":W()}],"border-color-e":[{"border-e":W()}],"border-color-t":[{"border-t":W()}],"border-color-r":[{"border-r":W()}],"border-color-b":[{"border-b":W()}],"border-color-l":[{"border-l":W()}],"divide-color":[{divide:W()}],"outline-style":[{outline:[...Re(),"none","hidden"]}],"outline-offset":[{"outline-offset":[isNumber,isArbitraryVariable,isArbitraryValue]}],"outline-w":[{outline:["",isNumber,isArbitraryVariableLength,isArbitraryLength]}],"outline-color":[{outline:W()}],shadow:[{shadow:["","none",E,isArbitraryVariableShadow,isArbitraryShadow]}],"shadow-color":[{shadow:W()}],"inset-shadow":[{"inset-shadow":["none",S,isArbitraryVariableShadow,isArbitraryShadow]}],"inset-shadow-color":[{"inset-shadow":W()}],"ring-w":[{ring:Ee()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:W()}],"ring-offset-w":[{"ring-offset":[isNumber,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":W()}],"inset-ring-w":[{"inset-ring":Ee()}],"inset-ring-color":[{"inset-ring":W()}],"text-shadow":[{"text-shadow":["none",A,isArbitraryVariableShadow,isArbitraryShadow]}],"text-shadow-color":[{"text-shadow":W()}],opacity:[{opacity:[isNumber,isArbitraryVariable,isArbitraryValue]}],"mix-blend":[{"mix-blend":[...Te(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Te()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[isNumber]}],"mask-image-linear-from-pos":[{"mask-linear-from":Ue()}],"mask-image-linear-to-pos":[{"mask-linear-to":Ue()}],"mask-image-linear-from-color":[{"mask-linear-from":W()}],"mask-image-linear-to-color":[{"mask-linear-to":W()}],"mask-image-t-from-pos":[{"mask-t-from":Ue()}],"mask-image-t-to-pos":[{"mask-t-to":Ue()}],"mask-image-t-from-color":[{"mask-t-from":W()}],"mask-image-t-to-color":[{"mask-t-to":W()}],"mask-image-r-from-pos":[{"mask-r-from":Ue()}],"mask-image-r-to-pos":[{"mask-r-to":Ue()}],"mask-image-r-from-color":[{"mask-r-from":W()}],"mask-image-r-to-color":[{"mask-r-to":W()}],"mask-image-b-from-pos":[{"mask-b-from":Ue()}],"mask-image-b-to-pos":[{"mask-b-to":Ue()}],"mask-image-b-from-color":[{"mask-b-from":W()}],"mask-image-b-to-color":[{"mask-b-to":W()}],"mask-image-l-from-pos":[{"mask-l-from":Ue()}],"mask-image-l-to-pos":[{"mask-l-to":Ue()}],"mask-image-l-from-color":[{"mask-l-from":W()}],"mask-image-l-to-color":[{"mask-l-to":W()}],"mask-image-x-from-pos":[{"mask-x-from":Ue()}],"mask-image-x-to-pos":[{"mask-x-to":Ue()}],"mask-image-x-from-color":[{"mask-x-from":W()}],"mask-image-x-to-color":[{"mask-x-to":W()}],"mask-image-y-from-pos":[{"mask-y-from":Ue()}],"mask-image-y-to-pos":[{"mask-y-to":Ue()}],"mask-image-y-from-color":[{"mask-y-from":W()}],"mask-image-y-to-color":[{"mask-y-to":W()}],"mask-image-radial":[{"mask-radial":[isArbitraryVariable,isArbitraryValue]}],"mask-image-radial-from-pos":[{"mask-radial-from":Ue()}],"mask-image-radial-to-pos":[{"mask-radial-to":Ue()}],"mask-image-radial-from-color":[{"mask-radial-from":W()}],"mask-image-radial-to-color":[{"mask-radial-to":W()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":H()}],"mask-image-conic-pos":[{"mask-conic":[isNumber]}],"mask-image-conic-from-pos":[{"mask-conic-from":Ue()}],"mask-image-conic-to-pos":[{"mask-conic-to":Ue()}],"mask-image-conic-from-color":[{"mask-conic-from":W()}],"mask-image-conic-to-color":[{"mask-conic-to":W()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:ee()}],"mask-repeat":[{mask:ie()}],"mask-size":[{mask:X()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",isArbitraryVariable,isArbitraryValue]}],filter:[{filter:["","none",isArbitraryVariable,isArbitraryValue]}],blur:[{blur:ze()}],brightness:[{brightness:[isNumber,isArbitraryVariable,isArbitraryValue]}],contrast:[{contrast:[isNumber,isArbitraryVariable,isArbitraryValue]}],"drop-shadow":[{"drop-shadow":["","none",C,isArbitraryVariableShadow,isArbitraryShadow]}],"drop-shadow-color":[{"drop-shadow":W()}],grayscale:[{grayscale:["",isNumber,isArbitraryVariable,isArbitraryValue]}],"hue-rotate":[{"hue-rotate":[isNumber,isArbitraryVariable,isArbitraryValue]}],invert:[{invert:["",isNumber,isArbitraryVariable,isArbitraryValue]}],saturate:[{saturate:[isNumber,isArbitraryVariable,isArbitraryValue]}],sepia:[{sepia:["",isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-filter":[{"backdrop-filter":["","none",isArbitraryVariable,isArbitraryValue]}],"backdrop-blur":[{"backdrop-blur":ze()}],"backdrop-brightness":[{"backdrop-brightness":[isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-contrast":[{"backdrop-contrast":[isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-grayscale":[{"backdrop-grayscale":["",isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-invert":[{"backdrop-invert":["",isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-opacity":[{"backdrop-opacity":[isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-saturate":[{"backdrop-saturate":[isNumber,isArbitraryVariable,isArbitraryValue]}],"backdrop-sepia":[{"backdrop-sepia":["",isNumber,isArbitraryVariable,isArbitraryValue]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":fe()}],"border-spacing-x":[{"border-spacing-x":fe()}],"border-spacing-y":[{"border-spacing-y":fe()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",isArbitraryVariable,isArbitraryValue]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[isNumber,"initial",isArbitraryVariable,isArbitraryValue]}],ease:[{ease:["linear","initial",P,isArbitraryVariable,isArbitraryValue]}],delay:[{delay:[isNumber,isArbitraryVariable,isArbitraryValue]}],animate:[{animate:["none",j,isArbitraryVariable,isArbitraryValue]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[O,isArbitraryVariable,isArbitraryValue]}],"perspective-origin":[{"perspective-origin":se()}],rotate:[{rotate:Ke()}],"rotate-x":[{"rotate-x":Ke()}],"rotate-y":[{"rotate-y":Ke()}],"rotate-z":[{"rotate-z":Ke()}],scale:[{scale:it()}],"scale-x":[{"scale-x":it()}],"scale-y":[{"scale-y":it()}],"scale-z":[{"scale-z":it()}],"scale-3d":["scale-3d"],skew:[{skew:Ye()}],"skew-x":[{"skew-x":Ye()}],"skew-y":[{"skew-y":Ye()}],transform:[{transform:[isArbitraryVariable,isArbitraryValue,"","none","gpu","cpu"]}],"transform-origin":[{origin:se()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ce()}],"translate-x":[{"translate-x":Ce()}],"translate-y":[{"translate-y":Ce()}],"translate-z":[{"translate-z":Ce()}],"translate-none":["translate-none"],accent:[{accent:W()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:W()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryVariable,isArbitraryValue]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":fe()}],"scroll-mx":[{"scroll-mx":fe()}],"scroll-my":[{"scroll-my":fe()}],"scroll-ms":[{"scroll-ms":fe()}],"scroll-me":[{"scroll-me":fe()}],"scroll-mt":[{"scroll-mt":fe()}],"scroll-mr":[{"scroll-mr":fe()}],"scroll-mb":[{"scroll-mb":fe()}],"scroll-ml":[{"scroll-ml":fe()}],"scroll-p":[{"scroll-p":fe()}],"scroll-px":[{"scroll-px":fe()}],"scroll-py":[{"scroll-py":fe()}],"scroll-ps":[{"scroll-ps":fe()}],"scroll-pe":[{"scroll-pe":fe()}],"scroll-pt":[{"scroll-pt":fe()}],"scroll-pr":[{"scroll-pr":fe()}],"scroll-pb":[{"scroll-pb":fe()}],"scroll-pl":[{"scroll-pl":fe()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryVariable,isArbitraryValue]}],fill:[{fill:["none",...W()]}],"stroke-w":[{stroke:[isNumber,isArbitraryVariableLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:["none",...W()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...s){return twMerge(clsx(s))}const buttonVariants=cva("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Button=reactExports.forwardRef(({className:s,variant:e,size:t,asChild:o=!1,...a},c)=>{const d=o?Slot:"button";return jsxRuntimeExports.jsx(d,{className:cn(buttonVariants({variant:e,size:t,className:s})),ref:c,...a})});Button.displayName="Button";const PassportsPage=({role:s,passports:e,formData:t,handleInputChange:o,handleFileChange:a,mintPassport:c,handleSort:d,sortField:g,sortOrder:y})=>{const[_,E]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex justify-between items-center mb-8",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-500",children:"Паспорти продуктів"}),(s==="manufacturer"||s==="admin")&&jsxRuntimeExports.jsxs(Button,{onClick:()=>E(!_),className:"mb-6 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg flex items-center gap-2 transition-all duration-300 hover:scale-105",children:[jsxRuntimeExports.jsx(PlusIcon$1,{className:"w-5 h-5"}),"Створити паспорт"]})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:_&&(s==="manufacturer"||s==="admin")&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-gradient-to-br from-gray-800 to-gray-900 p-8 rounded-2xl mb-8 border border-gray-700/50 shadow-xl",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-white mb-6",children:"Створення нового паспорта"}),jsxRuntimeExports.jsxs("form",{onSubmit:c,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"Серійний номер"}),jsxRuntimeExports.jsx("input",{type:"text",name:"serialNumber",value:t.serialNumber,onChange:o,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"Дата виробництва"}),jsxRuntimeExports.jsx("input",{type:"date",name:"productionDate",value:t.productionDate,onChange:o,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"Модель пристрою"}),jsxRuntimeExports.jsx("input",{type:"text",name:"deviceModel",value:t.deviceModel,onChange:o,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"Гарантійний період"}),jsxRuntimeExports.jsx("input",{type:"text",name:"warrantyPeriod",value:t.warrantyPeriod,onChange:o,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"Країна походження"}),jsxRuntimeExports.jsx("input",{type:"text",name:"countryOfOrigin",value:t.countryOfOrigin,onChange:o,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all",required:!0})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"ID виробника"}),jsxRuntimeExports.jsx("input",{type:"text",name:"manufacturerId",value:t.manufacturerId,onChange:o,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all",required:!0})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-gray-300 mb-2",children:"Додаткові документи"}),jsxRuntimeExports.jsx("div",{className:"flex items-center gap-4",children:jsxRuntimeExports.jsx("input",{type:"file",onChange:a,className:"w-full px-4 py-2 rounded-lg bg-gray-700/50 text-white border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-all"})})]}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",className:"w-full px-6 py-3 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white font-medium hover:shadow-lg hover:shadow-blue-500/25 transition-all",children:"Створити паспорт"})]})]})}),jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl overflow-hidden border border-gray-700/50 shadow-xl",children:jsxRuntimeExports.jsx("div",{className:"overflow-x-auto",children:jsxRuntimeExports.jsxs("table",{className:"min-w-full divide-y divide-gray-700",children:[jsxRuntimeExports.jsx("thead",{className:"bg-gray-700/30",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700/50 transition-colors",children:jsxRuntimeExports.jsxs("button",{onClick:()=>d("serialNumber"),className:"flex items-center gap-2 px-4 py-2 text-left hover:bg-gray-100 transition-colors",children:["Серійний номер",g==="serialNumber"&&(y==="asc"?jsxRuntimeExports.jsx(ChevronUpIcon$1,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ChevronDownIcon$1,{className:"w-4 h-4"}))]})}),jsxRuntimeExports.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider cursor-pointer hover:bg-gray-700/50 transition-colors",children:jsxRuntimeExports.jsxs("button",{onClick:()=>d("productionDate"),className:"flex items-center gap-2 px-4 py-2 text-left hover:bg-gray-100 transition-colors",children:["Дата виробництва",g==="productionDate"&&(y==="asc"?jsxRuntimeExports.jsx(ChevronUpIcon$1,{className:"w-4 h-4"}):jsxRuntimeExports.jsx(ChevronDownIcon$1,{className:"w-4 h-4"}))]})}),jsxRuntimeExports.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Модель"}),jsxRuntimeExports.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Гарантія"}),jsxRuntimeExports.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Країна"}),jsxRuntimeExports.jsx("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-gray-300 uppercase tracking-wider",children:"Документи"})]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y divide-gray-700",children:e.map(S=>jsxRuntimeExports.jsxs(motion.tr,{initial:{opacity:0},animate:{opacity:1},whileHover:{backgroundColor:"rgba(55, 65, 81, 0.3)"},className:"transition-colors",children:[jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:S.serialNumber}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:S.productionDate}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:S.deviceModel}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:S.warrantyPeriod}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:S.countryOfOrigin}),jsxRuntimeExports.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-300",children:S.ipfsCid?jsxRuntimeExports.jsxs("button",{onClick:()=>handleViewPassport(S),className:"text-blue-400 hover:text-blue-300 transition-colors flex items-center gap-1",children:["Переглянути ",jsxRuntimeExports.jsx(ArrowTopRightOnSquareIcon$1,{className:"w-4 h-4"})]}):"Немає"})]},S.address))})]})})})]})};var Html5QrcodeSupportedFormats;(function(s){s[s.QR_CODE=0]="QR_CODE",s[s.AZTEC=1]="AZTEC",s[s.CODABAR=2]="CODABAR",s[s.CODE_39=3]="CODE_39",s[s.CODE_93=4]="CODE_93",s[s.CODE_128=5]="CODE_128",s[s.DATA_MATRIX=6]="DATA_MATRIX",s[s.MAXICODE=7]="MAXICODE",s[s.ITF=8]="ITF",s[s.EAN_13=9]="EAN_13",s[s.EAN_8=10]="EAN_8",s[s.PDF_417=11]="PDF_417",s[s.RSS_14=12]="RSS_14",s[s.RSS_EXPANDED=13]="RSS_EXPANDED",s[s.UPC_A=14]="UPC_A",s[s.UPC_E=15]="UPC_E",s[s.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Html5QrcodeSupportedFormats||(Html5QrcodeSupportedFormats={}));var html5QrcodeSupportedFormatsTextMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,"QR_CODE"],[Html5QrcodeSupportedFormats.AZTEC,"AZTEC"],[Html5QrcodeSupportedFormats.CODABAR,"CODABAR"],[Html5QrcodeSupportedFormats.CODE_39,"CODE_39"],[Html5QrcodeSupportedFormats.CODE_93,"CODE_93"],[Html5QrcodeSupportedFormats.CODE_128,"CODE_128"],[Html5QrcodeSupportedFormats.DATA_MATRIX,"DATA_MATRIX"],[Html5QrcodeSupportedFormats.MAXICODE,"MAXICODE"],[Html5QrcodeSupportedFormats.ITF,"ITF"],[Html5QrcodeSupportedFormats.EAN_13,"EAN_13"],[Html5QrcodeSupportedFormats.EAN_8,"EAN_8"],[Html5QrcodeSupportedFormats.PDF_417,"PDF_417"],[Html5QrcodeSupportedFormats.RSS_14,"RSS_14"],[Html5QrcodeSupportedFormats.RSS_EXPANDED,"RSS_EXPANDED"],[Html5QrcodeSupportedFormats.UPC_A,"UPC_A"],[Html5QrcodeSupportedFormats.UPC_E,"UPC_E"],[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),DecodedTextType;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.URL=1]="URL"})(DecodedTextType||(DecodedTextType={}));function isValidHtml5QrcodeSupportedFormats(s){return Object.values(Html5QrcodeSupportedFormats).includes(s)}var Html5QrcodeScanType;(function(s){s[s.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",s[s.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(Html5QrcodeScanType||(Html5QrcodeScanType={}));var Html5QrcodeConstants=function(){function s(){}return s.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",s.SCAN_DEFAULT_FPS=2,s.DEFAULT_DISABLE_FLIP=!1,s.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,s.DEFAULT_SUPPORTED_SCAN_TYPE=[Html5QrcodeScanType.SCAN_TYPE_CAMERA,Html5QrcodeScanType.SCAN_TYPE_FILE],s}(),QrcodeResultFormat=function(){function s(e,t){this.format=e,this.formatName=t}return s.prototype.toString=function(){return this.formatName},s.create=function(e){if(!html5QrcodeSupportedFormatsTextMap.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new s(e,html5QrcodeSupportedFormatsTextMap.get(e))},s}(),Html5QrcodeResultFactory=function(){function s(){}return s.createFromText=function(e){var t={text:e};return{decodedText:e,result:t}},s.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},s}(),Html5QrcodeErrorTypes;(function(s){s[s.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",s[s.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",s[s.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Html5QrcodeErrorTypes||(Html5QrcodeErrorTypes={}));var Html5QrcodeErrorFactory=function(){function s(){}return s.createFrom=function(e){return{errorMessage:e,type:Html5QrcodeErrorTypes.UNKWOWN_ERROR}},s}(),BaseLoggger=function(){function s(e){this.verbose=e}return s.prototype.log=function(e){this.verbose&&console.log(e)},s.prototype.warn=function(e){this.verbose&&console.warn(e)},s.prototype.logError=function(e,t){(this.verbose||t===!0)&&console.error(e)},s.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},s}();function isNullOrUndefined(s){return typeof s>"u"||s===null}function clip(s,e,t){return s>t?t:s<e?e:s}var Html5QrcodeStrings=function(){function s(){}return s.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},s.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},s.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},s.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},s.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},s.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},s.scannerPaused=function(){return"Scanner paused"},s}(),Html5QrcodeScannerStrings=function(){function s(){}return s.scanningStatus=function(){return"Scanning"},s.idleStatus=function(){return"Idle"},s.errorStatus=function(){return"Error"},s.permissionStatus=function(){return"Permission"},s.noCameraFoundErrorStatus=function(){return"No Cameras"},s.lastMatch=function(e){return"Last Match: ".concat(e)},s.codeScannerTitle=function(){return"Code Scanner"},s.cameraPermissionTitle=function(){return"Request Camera Permissions"},s.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},s.noCameraFound=function(){return"No camera found"},s.scanButtonStopScanningText=function(){return"Stop Scanning"},s.scanButtonStartScanningText=function(){return"Start Scanning"},s.torchOnButton=function(){return"Switch On Torch"},s.torchOffButton=function(){return"Switch Off Torch"},s.torchOnFailedMessage=function(){return"Failed to turn on torch"},s.torchOffFailedMessage=function(){return"Failed to turn off torch"},s.scanButtonScanningStarting=function(){return"Launching Camera..."},s.textIfCameraScanSelected=function(){return"Scan an Image File"},s.textIfFileScanSelected=function(){return"Scan using camera directly"},s.selectCamera=function(){return"Select Camera"},s.fileSelectionChooseImage=function(){return"Choose Image"},s.fileSelectionChooseAnother=function(){return"Choose Another"},s.fileSelectionNoImageSelected=function(){return"No image choosen"},s.anonymousCameraPrefix=function(){return"Anonymous Camera"},s.dragAndDropMessage=function(){return"Or drop an image to scan"},s.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},s.zoom=function(){return"zoom"},s.loadingImage=function(){return"Loading image..."},s.cameraScanAltText=function(){return"Camera based scan"},s.fileScanAltText=function(){return"Fule based scan"},s}(),LibraryInfoStrings=function(){function s(){}return s.poweredBy=function(){return"Powered by "},s.reportIssues=function(){return"Report issues"},s}(),VideoConstraintsUtil=function(){function s(){}return s.isMediaStreamConstraintsValid=function(e,t){if(typeof e!="object"){var o=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(o,"."),!0),!1}for(var a=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],c=new Set(a),d=Object.keys(e),g=0,y=d;g<y.length;g++){var _=y[g];if(c.has(_))return t.logError("".concat(_," is not supported videoConstaints."),!0),!1}return!0},s}(),zxingJs_umd$1={exports:{}};(function(s,e){(function(t,o){o(e)})(commonjsGlobal,function(t){function o(ne){return ne==null}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ne,u){ne.__proto__=u}||function(ne,u){for(var h in u)u.hasOwnProperty(h)&&(ne[h]=u[h])};function c(ne,u){a(ne,u);function h(){this.constructor=ne}ne.prototype=u===null?Object.create(u):(h.prototype=u.prototype,new h)}function d(ne,u){var h=Object.setPrototypeOf;h?h(ne,u):ne.__proto__=u}function g(ne,u){u===void 0&&(u=ne.constructor);var h=Error.captureStackTrace;h&&h(ne,u)}var y=function(ne){c(u,ne);function u(h){var x=this.constructor,b=ne.call(this,h)||this;return Object.defineProperty(b,"name",{value:x.name,enumerable:!1}),d(b,x.prototype),g(b),b}return u}(Error);class _ extends y{constructor(u=void 0){super(u),this.message=u}getKind(){return this.constructor.kind}}_.kind="Exception";class E extends _{}E.kind="ArgumentException";class S extends _{}S.kind="IllegalArgumentException";class A{constructor(u){if(this.binarizer=u,u===null)throw new S("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(u,h){return this.binarizer.getBlackRow(u,h)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(u,h,x,b){const w=this.binarizer.getLuminanceSource().crop(u,h,x,b);return new A(this.binarizer.createBinarizer(w))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const u=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new A(this.binarizer.createBinarizer(u))}rotateCounterClockwise45(){const u=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new A(this.binarizer.createBinarizer(u))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class C extends _{static getChecksumInstance(){return new C}}C.kind="ChecksumException";class N{constructor(u){this.source=u}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class O{static arraycopy(u,h,x,b,w){for(;w--;)x[b++]=u[h++]}static currentTimeMillis(){return Date.now()}}class I extends _{}I.kind="IndexOutOfBoundsException";class P extends I{constructor(u=void 0,h=void 0){super(h),this.index=u,this.message=h}}P.kind="ArrayIndexOutOfBoundsException";class j{static fill(u,h){for(let x=0,b=u.length;x<b;x++)u[x]=h}static fillWithin(u,h,x,b){j.rangeCheck(u.length,h,x);for(let w=h;w<x;w++)u[w]=b}static rangeCheck(u,h,x){if(h>x)throw new S("fromIndex("+h+") > toIndex("+x+")");if(h<0)throw new P(h);if(x>u)throw new P(x)}static asList(...u){return u}static create(u,h,x){return Array.from({length:u}).map(w=>Array.from({length:h}).fill(x))}static createInt32Array(u,h,x){return Array.from({length:u}).map(w=>Int32Array.from({length:h}).fill(x))}static equals(u,h){if(!u||!h||!u.length||!h.length||u.length!==h.length)return!1;for(let x=0,b=u.length;x<b;x++)if(u[x]!==h[x])return!1;return!0}static hashCode(u){if(u===null)return 0;let h=1;for(const x of u)h=31*h+x;return h}static fillUint8Array(u,h){for(let x=0;x!==u.length;x++)u[x]=h}static copyOf(u,h){return u.slice(0,h)}static copyOfUint8Array(u,h){if(u.length<=h){const x=new Uint8Array(h);return x.set(u),x}return u.slice(0,h)}static copyOfRange(u,h,x){const b=x-h,w=new Int32Array(b);return O.arraycopy(u,h,w,0,b),w}static binarySearch(u,h,x){x===void 0&&(x=j.numberComparator);let b=0,w=u.length-1;for(;b<=w;){const v=w+b>>1,T=x(h,u[v]);if(T>0)b=v+1;else if(T<0)w=v-1;else return v}return-b-1}static numberComparator(u,h){return u-h}}class B{static numberOfTrailingZeros(u){let h;if(u===0)return 32;let x=31;return h=u<<16,h!==0&&(x-=16,u=h),h=u<<8,h!==0&&(x-=8,u=h),h=u<<4,h!==0&&(x-=4,u=h),h=u<<2,h!==0&&(x-=2,u=h),x-(u<<1>>>31)}static numberOfLeadingZeros(u){if(u===0)return 32;let h=1;return u>>>16||(h+=16,u<<=16),u>>>24||(h+=8,u<<=8),u>>>28||(h+=4,u<<=4),u>>>30||(h+=2,u<<=2),h-=u>>>31,h}static toHexString(u){return u.toString(16)}static toBinaryString(u){return String(parseInt(String(u),2))}static bitCount(u){return u=u-(u>>>1&1431655765),u=(u&858993459)+(u>>>2&858993459),u=u+(u>>>4)&252645135,u=u+(u>>>8),u=u+(u>>>16),u&63}static truncDivision(u,h){return Math.trunc(u/h)}static parseInt(u,h=void 0){return parseInt(u,h)}}B.MIN_VALUE_32_BITS=-2147483648,B.MAX_VALUE=Number.MAX_SAFE_INTEGER;class H{constructor(u,h){u===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=u,h==null?this.bits=H.makeArray(u):this.bits=h)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(u){if(u>this.bits.length*32){const h=H.makeArray(u);O.arraycopy(this.bits,0,h,0,this.bits.length),this.bits=h}}get(u){return(this.bits[Math.floor(u/32)]&1<<(u&31))!==0}set(u){this.bits[Math.floor(u/32)]|=1<<(u&31)}flip(u){this.bits[Math.floor(u/32)]^=1<<(u&31)}getNextSet(u){const h=this.size;if(u>=h)return h;const x=this.bits;let b=Math.floor(u/32),w=x[b];w&=~((1<<(u&31))-1);const v=x.length;for(;w===0;){if(++b===v)return h;w=x[b]}const T=b*32+B.numberOfTrailingZeros(w);return T>h?h:T}getNextUnset(u){const h=this.size;if(u>=h)return h;const x=this.bits;let b=Math.floor(u/32),w=~x[b];w&=~((1<<(u&31))-1);const v=x.length;for(;w===0;){if(++b===v)return h;w=~x[b]}const T=b*32+B.numberOfTrailingZeros(w);return T>h?h:T}setBulk(u,h){this.bits[Math.floor(u/32)]=h}setRange(u,h){if(h<u||u<0||h>this.size)throw new S;if(h===u)return;h--;const x=Math.floor(u/32),b=Math.floor(h/32),w=this.bits;for(let v=x;v<=b;v++){const T=v>x?0:u&31,D=(2<<(v<b?31:h&31))-(1<<T);w[v]|=D}}clear(){const u=this.bits.length,h=this.bits;for(let x=0;x<u;x++)h[x]=0}isRange(u,h,x){if(h<u||u<0||h>this.size)throw new S;if(h===u)return!0;h--;const b=Math.floor(u/32),w=Math.floor(h/32),v=this.bits;for(let T=b;T<=w;T++){const M=T>b?0:u&31,G=(2<<(T<w?31:h&31))-(1<<M)&4294967295;if((v[T]&G)!==(x?G:0))return!1}return!0}appendBit(u){this.ensureCapacity(this.size+1),u&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(u,h){if(h<0||h>32)throw new S("Num bits must be between 0 and 32");this.ensureCapacity(this.size+h);for(let x=h;x>0;x--)this.appendBit((u>>x-1&1)===1)}appendBitArray(u){const h=u.size;this.ensureCapacity(this.size+h);for(let x=0;x<h;x++)this.appendBit(u.get(x))}xor(u){if(this.size!==u.size)throw new S("Sizes don't match");const h=this.bits;for(let x=0,b=h.length;x<b;x++)h[x]^=u.bits[x]}toBytes(u,h,x,b){for(let w=0;w<b;w++){let v=0;for(let T=0;T<8;T++)this.get(u)&&(v|=1<<7-T),u++;h[x+w]=v}}getBitArray(){return this.bits}reverse(){const u=new Int32Array(this.bits.length),h=Math.floor((this.size-1)/32),x=h+1,b=this.bits;for(let w=0;w<x;w++){let v=b[w];v=v>>1&1431655765|(v&1431655765)<<1,v=v>>2&858993459|(v&858993459)<<2,v=v>>4&252645135|(v&252645135)<<4,v=v>>8&16711935|(v&16711935)<<8,v=v>>16&65535|(v&65535)<<16,u[h-w]=v}if(this.size!==x*32){const w=x*32-this.size;let v=u[0]>>>w;for(let T=1;T<x;T++){const M=u[T];v|=M<<32-w,u[T-1]=v,v=M>>>w}u[x-1]=v}this.bits=u}static makeArray(u){return new Int32Array(Math.floor((u+31)/32))}equals(u){if(!(u instanceof H))return!1;const h=u;return this.size===h.size&&j.equals(this.bits,h.bits)}hashCode(){return 31*this.size+j.hashCode(this.bits)}toString(){let u="";for(let h=0,x=this.size;h<x;h++)h&7||(u+=" "),u+=this.get(h)?"X":".";return u}clone(){return new H(this.size,this.bits.slice())}}var se;(function(ne){ne[ne.OTHER=0]="OTHER",ne[ne.PURE_BARCODE=1]="PURE_BARCODE",ne[ne.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",ne[ne.TRY_HARDER=3]="TRY_HARDER",ne[ne.CHARACTER_SET=4]="CHARACTER_SET",ne[ne.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",ne[ne.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",ne[ne.ASSUME_GS1=7]="ASSUME_GS1",ne[ne.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",ne[ne.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",ne[ne.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(se||(se={}));var oe=se;class Q extends _{static getFormatInstance(){return new Q}}Q.kind="FormatException";var fe;(function(ne){ne[ne.Cp437=0]="Cp437",ne[ne.ISO8859_1=1]="ISO8859_1",ne[ne.ISO8859_2=2]="ISO8859_2",ne[ne.ISO8859_3=3]="ISO8859_3",ne[ne.ISO8859_4=4]="ISO8859_4",ne[ne.ISO8859_5=5]="ISO8859_5",ne[ne.ISO8859_6=6]="ISO8859_6",ne[ne.ISO8859_7=7]="ISO8859_7",ne[ne.ISO8859_8=8]="ISO8859_8",ne[ne.ISO8859_9=9]="ISO8859_9",ne[ne.ISO8859_10=10]="ISO8859_10",ne[ne.ISO8859_11=11]="ISO8859_11",ne[ne.ISO8859_13=12]="ISO8859_13",ne[ne.ISO8859_14=13]="ISO8859_14",ne[ne.ISO8859_15=14]="ISO8859_15",ne[ne.ISO8859_16=15]="ISO8859_16",ne[ne.SJIS=16]="SJIS",ne[ne.Cp1250=17]="Cp1250",ne[ne.Cp1251=18]="Cp1251",ne[ne.Cp1252=19]="Cp1252",ne[ne.Cp1256=20]="Cp1256",ne[ne.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",ne[ne.UTF8=22]="UTF8",ne[ne.ASCII=23]="ASCII",ne[ne.Big5=24]="Big5",ne[ne.GB18030=25]="GB18030",ne[ne.EUC_KR=26]="EUC_KR"})(fe||(fe={}));class Z{constructor(u,h,x,...b){this.valueIdentifier=u,this.name=x,typeof h=="number"?this.values=Int32Array.from([h]):this.values=h,this.otherEncodingNames=b,Z.VALUE_IDENTIFIER_TO_ECI.set(u,this),Z.NAME_TO_ECI.set(x,this);const w=this.values;for(let v=0,T=w.length;v!==T;v++){const M=w[v];Z.VALUES_TO_ECI.set(M,this)}for(const v of b)Z.NAME_TO_ECI.set(v,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(u){if(u<0||u>=900)throw new Q("incorect value");const h=Z.VALUES_TO_ECI.get(u);if(h===void 0)throw new Q("incorect value");return h}static getCharacterSetECIByName(u){const h=Z.NAME_TO_ECI.get(u);if(h===void 0)throw new Q("incorect value");return h}equals(u){if(!(u instanceof Z))return!1;const h=u;return this.getName()===h.getName()}}Z.VALUE_IDENTIFIER_TO_ECI=new Map,Z.VALUES_TO_ECI=new Map,Z.NAME_TO_ECI=new Map,Z.Cp437=new Z(fe.Cp437,Int32Array.from([0,2]),"Cp437"),Z.ISO8859_1=new Z(fe.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),Z.ISO8859_2=new Z(fe.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),Z.ISO8859_3=new Z(fe.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),Z.ISO8859_4=new Z(fe.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),Z.ISO8859_5=new Z(fe.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),Z.ISO8859_6=new Z(fe.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),Z.ISO8859_7=new Z(fe.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),Z.ISO8859_8=new Z(fe.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),Z.ISO8859_9=new Z(fe.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),Z.ISO8859_10=new Z(fe.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),Z.ISO8859_11=new Z(fe.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),Z.ISO8859_13=new Z(fe.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),Z.ISO8859_14=new Z(fe.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),Z.ISO8859_15=new Z(fe.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),Z.ISO8859_16=new Z(fe.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),Z.SJIS=new Z(fe.SJIS,20,"SJIS","Shift_JIS"),Z.Cp1250=new Z(fe.Cp1250,21,"Cp1250","windows-1250"),Z.Cp1251=new Z(fe.Cp1251,22,"Cp1251","windows-1251"),Z.Cp1252=new Z(fe.Cp1252,23,"Cp1252","windows-1252"),Z.Cp1256=new Z(fe.Cp1256,24,"Cp1256","windows-1256"),Z.UnicodeBigUnmarked=new Z(fe.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),Z.UTF8=new Z(fe.UTF8,26,"UTF8","UTF-8"),Z.ASCII=new Z(fe.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),Z.Big5=new Z(fe.Big5,28,"Big5"),Z.GB18030=new Z(fe.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),Z.EUC_KR=new Z(fe.EUC_KR,30,"EUC_KR","EUC-KR");class ce extends _{}ce.kind="UnsupportedOperationException";class ge{static decode(u,h){const x=this.encodingName(h);return this.customDecoder?this.customDecoder(u,x):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(x)?this.decodeFallback(u,x):new TextDecoder(x).decode(u)}static shouldDecodeOnFallback(u){return!ge.isBrowser()&&u==="ISO-8859-1"}static encode(u,h){const x=this.encodingName(h);return this.customEncoder?this.customEncoder(u,x):typeof TextEncoder>"u"?this.encodeFallback(u):new TextEncoder().encode(u)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(u){return typeof u=="string"?u:u.getName()}static encodingCharacterSet(u){return u instanceof Z?u:Z.getCharacterSetECIByName(u)}static decodeFallback(u,h){const x=this.encodingCharacterSet(h);if(ge.isDecodeFallbackSupported(x)){let b="";for(let w=0,v=u.length;w<v;w++){let T=u[w].toString(16);T.length<2&&(T="0"+T),b+="%"+T}return decodeURIComponent(b)}if(x.equals(Z.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(u.buffer));throw new ce(`Encoding ${this.encodingName(h)} not supported by fallback.`)}static isDecodeFallbackSupported(u){return u.equals(Z.UTF8)||u.equals(Z.ISO8859_1)||u.equals(Z.ASCII)}static encodeFallback(u){const x=btoa(unescape(encodeURIComponent(u))).split(""),b=[];for(let w=0;w<x.length;w++)b.push(x[w].charCodeAt(0));return new Uint8Array(b)}}class me{static castAsNonUtf8Char(u,h=null){const x=h?h.getName():this.ISO88591;return ge.decode(new Uint8Array([u]),x)}static guessEncoding(u,h){if(h!=null&&h.get(oe.CHARACTER_SET)!==void 0)return h.get(oe.CHARACTER_SET).toString();const x=u.length;let b=!0,w=!0,v=!0,T=0,M=0,D=0,G=0,re=0,le=0,xe=0,we=0,ve=0,Le=0,ke=0;const Je=u.length>3&&u[0]===239&&u[1]===187&&u[2]===191;for(let tt=0;tt<x&&(b||w||v);tt++){const qe=u[tt]&255;v&&(T>0?qe&128?T--:v=!1:qe&128&&(qe&64?(T++,qe&32?(T++,qe&16?(T++,qe&8?v=!1:G++):D++):M++):v=!1)),b&&(qe>127&&qe<160?b=!1:qe>159&&(qe<192||qe===215||qe===247)&&ke++),w&&(re>0?qe<64||qe===127||qe>252?w=!1:re--:qe===128||qe===160||qe>239?w=!1:qe>160&&qe<224?(le++,we=0,xe++,xe>ve&&(ve=xe)):qe>127?(re++,xe=0,we++,we>Le&&(Le=we)):(xe=0,we=0))}return v&&T>0&&(v=!1),w&&re>0&&(w=!1),v&&(Je||M+D+G>0)?me.UTF8:w&&(me.ASSUME_SHIFT_JIS||ve>=3||Le>=3)?me.SHIFT_JIS:b&&w?ve===2&&le===2||ke*10>=x?me.SHIFT_JIS:me.ISO88591:b?me.ISO88591:w?me.SHIFT_JIS:v?me.UTF8:me.PLATFORM_DEFAULT_ENCODING}static format(u,...h){let x=-1;function b(v,T,M,D,G,re){if(v==="%%")return"%";if(h[++x]===void 0)return;v=D?parseInt(D.substr(1)):void 0;let le=G?parseInt(G.substr(1)):void 0,xe;switch(re){case"s":xe=h[x];break;case"c":xe=h[x][0];break;case"f":xe=parseFloat(h[x]).toFixed(v);break;case"p":xe=parseFloat(h[x]).toPrecision(v);break;case"e":xe=parseFloat(h[x]).toExponential(v);break;case"x":xe=parseInt(h[x]).toString(le||16);break;case"d":xe=parseFloat(parseInt(h[x],le||10).toPrecision(v)).toFixed(0);break}xe=typeof xe=="object"?JSON.stringify(xe):(+xe).toString(le);let we=parseInt(M),ve=M&&M[0]+""=="0"?"0":" ";for(;xe.length<we;)xe=T!==void 0?xe+ve:ve+xe;return xe}let w=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return u.replace(w,b)}static getBytes(u,h){return ge.encode(u,h)}static getCharCode(u,h=0){return u.charCodeAt(h)}static getCharAt(u){return String.fromCharCode(u)}}me.SHIFT_JIS=Z.SJIS.getName(),me.GB2312="GB2312",me.ISO88591=Z.ISO8859_1.getName(),me.EUC_JP="EUC_JP",me.UTF8=Z.UTF8.getName(),me.PLATFORM_DEFAULT_ENCODING=me.UTF8,me.ASSUME_SHIFT_JIS=!1;class V{constructor(u=""){this.value=u}enableDecoding(u){return this.encoding=u,this}append(u){return typeof u=="string"?this.value+=u.toString():this.encoding?this.value+=me.castAsNonUtf8Char(u,this.encoding):this.value+=String.fromCharCode(u),this}appendChars(u,h,x){for(let b=h;h<h+x;b++)this.append(u[b]);return this}length(){return this.value.length}charAt(u){return this.value.charAt(u)}deleteCharAt(u){this.value=this.value.substr(0,u)+this.value.substring(u+1)}setCharAt(u,h){this.value=this.value.substr(0,u)+h+this.value.substr(u+1)}substring(u,h){return this.value.substring(u,h)}setLengthToZero(){this.value=""}toString(){return this.value}insert(u,h){this.value=this.value.substr(0,u)+h+this.value.substr(u+h.length)}}class R{constructor(u,h,x,b){if(this.width=u,this.height=h,this.rowSize=x,this.bits=b,h==null&&(h=u),this.height=h,u<1||h<1)throw new S("Both dimensions must be greater than 0");x==null&&(x=Math.floor((u+31)/32)),this.rowSize=x,b==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(u){const h=u.length,x=u[0].length,b=new R(x,h);for(let w=0;w<h;w++){const v=u[w];for(let T=0;T<x;T++)v[T]&&b.set(T,w)}return b}static parseFromString(u,h,x){if(u===null)throw new S("stringRepresentation cannot be null");const b=new Array(u.length);let w=0,v=0,T=-1,M=0,D=0;for(;D<u.length;)if(u.charAt(D)===`
`||u.charAt(D)==="\r"){if(w>v){if(T===-1)T=w-v;else if(w-v!==T)throw new S("row lengths do not match");v=w,M++}D++}else if(u.substring(D,D+h.length)===h)D+=h.length,b[w]=!0,w++;else if(u.substring(D,D+x.length)===x)D+=x.length,b[w]=!1,w++;else throw new S("illegal character encountered: "+u.substring(D));if(w>v){if(T===-1)T=w-v;else if(w-v!==T)throw new S("row lengths do not match");M++}const G=new R(T,M);for(let re=0;re<w;re++)b[re]&&G.set(Math.floor(re%T),Math.floor(re/T));return G}get(u,h){const x=h*this.rowSize+Math.floor(u/32);return(this.bits[x]>>>(u&31)&1)!==0}set(u,h){const x=h*this.rowSize+Math.floor(u/32);this.bits[x]|=1<<(u&31)&4294967295}unset(u,h){const x=h*this.rowSize+Math.floor(u/32);this.bits[x]&=~(1<<(u&31)&4294967295)}flip(u,h){const x=h*this.rowSize+Math.floor(u/32);this.bits[x]^=1<<(u&31)&4294967295}xor(u){if(this.width!==u.getWidth()||this.height!==u.getHeight()||this.rowSize!==u.getRowSize())throw new S("input matrix dimensions do not match");const h=new H(Math.floor(this.width/32)+1),x=this.rowSize,b=this.bits;for(let w=0,v=this.height;w<v;w++){const T=w*x,M=u.getRow(w,h).getBitArray();for(let D=0;D<x;D++)b[T+D]^=M[D]}}clear(){const u=this.bits,h=u.length;for(let x=0;x<h;x++)u[x]=0}setRegion(u,h,x,b){if(h<0||u<0)throw new S("Left and top must be nonnegative");if(b<1||x<1)throw new S("Height and width must be at least 1");const w=u+x,v=h+b;if(v>this.height||w>this.width)throw new S("The region must fit inside the matrix");const T=this.rowSize,M=this.bits;for(let D=h;D<v;D++){const G=D*T;for(let re=u;re<w;re++)M[G+Math.floor(re/32)]|=1<<(re&31)&4294967295}}getRow(u,h){h==null||h.getSize()<this.width?h=new H(this.width):h.clear();const x=this.rowSize,b=this.bits,w=u*x;for(let v=0;v<x;v++)h.setBulk(v*32,b[w+v]);return h}setRow(u,h){O.arraycopy(h.getBitArray(),0,this.bits,u*this.rowSize,this.rowSize)}rotate180(){const u=this.getWidth(),h=this.getHeight();let x=new H(u),b=new H(u);for(let w=0,v=Math.floor((h+1)/2);w<v;w++)x=this.getRow(w,x),b=this.getRow(h-1-w,b),x.reverse(),b.reverse(),this.setRow(w,b),this.setRow(h-1-w,x)}getEnclosingRectangle(){const u=this.width,h=this.height,x=this.rowSize,b=this.bits;let w=u,v=h,T=-1,M=-1;for(let D=0;D<h;D++)for(let G=0;G<x;G++){const re=b[D*x+G];if(re!==0){if(D<v&&(v=D),D>M&&(M=D),G*32<w){let le=0;for(;!(re<<31-le&4294967295);)le++;G*32+le<w&&(w=G*32+le)}if(G*32+31>T){let le=31;for(;!(re>>>le);)le--;G*32+le>T&&(T=G*32+le)}}}return T<w||M<v?null:Int32Array.from([w,v,T-w+1,M-v+1])}getTopLeftOnBit(){const u=this.rowSize,h=this.bits;let x=0;for(;x<h.length&&h[x]===0;)x++;if(x===h.length)return null;const b=x/u;let w=x%u*32;const v=h[x];let T=0;for(;!(v<<31-T&4294967295);)T++;return w+=T,Int32Array.from([w,b])}getBottomRightOnBit(){const u=this.rowSize,h=this.bits;let x=h.length-1;for(;x>=0&&h[x]===0;)x--;if(x<0)return null;const b=Math.floor(x/u);let w=Math.floor(x%u)*32;const v=h[x];let T=31;for(;!(v>>>T);)T--;return w+=T,Int32Array.from([w,b])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(u){if(!(u instanceof R))return!1;const h=u;return this.width===h.width&&this.height===h.height&&this.rowSize===h.rowSize&&j.equals(this.bits,h.bits)}hashCode(){let u=this.width;return u=31*u+this.width,u=31*u+this.height,u=31*u+this.rowSize,u=31*u+j.hashCode(this.bits),u}toString(u="X ",h="  ",x=`
`){return this.buildToString(u,h,x)}buildToString(u,h,x){let b=new V;for(let w=0,v=this.height;w<v;w++){for(let T=0,M=this.width;T<M;T++)b.append(this.get(T,w)?u:h);b.append(x)}return b.toString()}clone(){return new R(this.width,this.height,this.rowSize,this.bits.slice())}}class L extends _{static getNotFoundInstance(){return new L}}L.kind="NotFoundException";class z extends N{constructor(u){super(u),this.luminances=z.EMPTY,this.buckets=new Int32Array(z.LUMINANCE_BUCKETS)}getBlackRow(u,h){const x=this.getLuminanceSource(),b=x.getWidth();h==null||h.getSize()<b?h=new H(b):h.clear(),this.initArrays(b);const w=x.getRow(u,this.luminances),v=this.buckets;for(let M=0;M<b;M++)v[(w[M]&255)>>z.LUMINANCE_SHIFT]++;const T=z.estimateBlackPoint(v);if(b<3)for(let M=0;M<b;M++)(w[M]&255)<T&&h.set(M);else{let M=w[0]&255,D=w[1]&255;for(let G=1;G<b-1;G++){const re=w[G+1]&255;(D*4-M-re)/2<T&&h.set(G),M=D,D=re}}return h}getBlackMatrix(){const u=this.getLuminanceSource(),h=u.getWidth(),x=u.getHeight(),b=new R(h,x);this.initArrays(h);const w=this.buckets;for(let M=1;M<5;M++){const D=Math.floor(x*M/5),G=u.getRow(D,this.luminances),re=Math.floor(h*4/5);for(let le=Math.floor(h/5);le<re;le++){const xe=G[le]&255;w[xe>>z.LUMINANCE_SHIFT]++}}const v=z.estimateBlackPoint(w),T=u.getMatrix();for(let M=0;M<x;M++){const D=M*h;for(let G=0;G<h;G++)(T[D+G]&255)<v&&b.set(G,M)}return b}createBinarizer(u){return new z(u)}initArrays(u){this.luminances.length<u&&(this.luminances=new Uint8ClampedArray(u));const h=this.buckets;for(let x=0;x<z.LUMINANCE_BUCKETS;x++)h[x]=0}static estimateBlackPoint(u){const h=u.length;let x=0,b=0,w=0;for(let G=0;G<h;G++)u[G]>w&&(b=G,w=u[G]),u[G]>x&&(x=u[G]);let v=0,T=0;for(let G=0;G<h;G++){const re=G-b,le=u[G]*re*re;le>T&&(v=G,T=le)}if(b>v){const G=b;b=v,v=G}if(v-b<=h/16)throw new L;let M=v-1,D=-1;for(let G=v-1;G>b;G--){const re=G-b,le=re*re*(v-G)*(x-u[G]);le>D&&(M=G,D=le)}return M<<z.LUMINANCE_SHIFT}}z.LUMINANCE_BITS=5,z.LUMINANCE_SHIFT=8-z.LUMINANCE_BITS,z.LUMINANCE_BUCKETS=1<<z.LUMINANCE_BITS,z.EMPTY=Uint8ClampedArray.from([0]);class Y extends z{constructor(u){super(u),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const u=this.getLuminanceSource(),h=u.getWidth(),x=u.getHeight();if(h>=Y.MINIMUM_DIMENSION&&x>=Y.MINIMUM_DIMENSION){const b=u.getMatrix();let w=h>>Y.BLOCK_SIZE_POWER;h&Y.BLOCK_SIZE_MASK&&w++;let v=x>>Y.BLOCK_SIZE_POWER;x&Y.BLOCK_SIZE_MASK&&v++;const T=Y.calculateBlackPoints(b,w,v,h,x),M=new R(h,x);Y.calculateThresholdForBlock(b,w,v,h,x,T,M),this.matrix=M}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(u){return new Y(u)}static calculateThresholdForBlock(u,h,x,b,w,v,T){const M=w-Y.BLOCK_SIZE,D=b-Y.BLOCK_SIZE;for(let G=0;G<x;G++){let re=G<<Y.BLOCK_SIZE_POWER;re>M&&(re=M);const le=Y.cap(G,2,x-3);for(let xe=0;xe<h;xe++){let we=xe<<Y.BLOCK_SIZE_POWER;we>D&&(we=D);const ve=Y.cap(xe,2,h-3);let Le=0;for(let Je=-2;Je<=2;Je++){const tt=v[le+Je];Le+=tt[ve-2]+tt[ve-1]+tt[ve]+tt[ve+1]+tt[ve+2]}const ke=Le/25;Y.thresholdBlock(u,we,re,ke,b,T)}}}static cap(u,h,x){return u<h?h:u>x?x:u}static thresholdBlock(u,h,x,b,w,v){for(let T=0,M=x*w+h;T<Y.BLOCK_SIZE;T++,M+=w)for(let D=0;D<Y.BLOCK_SIZE;D++)(u[M+D]&255)<=b&&v.set(h+D,x+T)}static calculateBlackPoints(u,h,x,b,w){const v=w-Y.BLOCK_SIZE,T=b-Y.BLOCK_SIZE,M=new Array(x);for(let D=0;D<x;D++){M[D]=new Int32Array(h);let G=D<<Y.BLOCK_SIZE_POWER;G>v&&(G=v);for(let re=0;re<h;re++){let le=re<<Y.BLOCK_SIZE_POWER;le>T&&(le=T);let xe=0,we=255,ve=0;for(let ke=0,Je=G*b+le;ke<Y.BLOCK_SIZE;ke++,Je+=b){for(let tt=0;tt<Y.BLOCK_SIZE;tt++){const qe=u[Je+tt]&255;xe+=qe,qe<we&&(we=qe),qe>ve&&(ve=qe)}if(ve-we>Y.MIN_DYNAMIC_RANGE)for(ke++,Je+=b;ke<Y.BLOCK_SIZE;ke++,Je+=b)for(let tt=0;tt<Y.BLOCK_SIZE;tt++)xe+=u[Je+tt]&255}let Le=xe>>Y.BLOCK_SIZE_POWER*2;if(ve-we<=Y.MIN_DYNAMIC_RANGE&&(Le=we/2,D>0&&re>0)){const ke=(M[D-1][re]+2*M[D][re-1]+M[D-1][re-1])/4;we<ke&&(Le=ke)}M[D][re]=Le}}return M}}Y.BLOCK_SIZE_POWER=3,Y.BLOCK_SIZE=1<<Y.BLOCK_SIZE_POWER,Y.BLOCK_SIZE_MASK=Y.BLOCK_SIZE-1,Y.MINIMUM_DIMENSION=Y.BLOCK_SIZE*5,Y.MIN_DYNAMIC_RANGE=24;class W{constructor(u,h){this.width=u,this.height=h}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(u,h,x,b){throw new ce("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new ce("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new ce("This luminance source does not support rotation by 45 degrees.")}toString(){const u=new Uint8ClampedArray(this.width);let h=new V;for(let x=0;x<this.height;x++){const b=this.getRow(x,u);for(let w=0;w<this.width;w++){const v=b[w]&255;let T;v<64?T="#":v<128?T="+":v<192?T=".":T=" ",h.append(T)}h.append(`
`)}return h.toString()}}class ee extends W{constructor(u){super(u.getWidth(),u.getHeight()),this.delegate=u}getRow(u,h){const x=this.delegate.getRow(u,h),b=this.getWidth();for(let w=0;w<b;w++)x[w]=255-(x[w]&255);return x}getMatrix(){const u=this.delegate.getMatrix(),h=this.getWidth()*this.getHeight(),x=new Uint8ClampedArray(h);for(let b=0;b<h;b++)x[b]=255-(u[b]&255);return x}isCropSupported(){return this.delegate.isCropSupported()}crop(u,h,x,b){return new ee(this.delegate.crop(u,h,x,b))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new ee(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new ee(this.delegate.rotateCounterClockwise45())}}class ie extends W{constructor(u){super(u.width,u.height),this.canvas=u,this.tempCanvasElement=null,this.buffer=ie.makeBufferFromCanvasImageData(u)}static makeBufferFromCanvasImageData(u){const h=u.getContext("2d").getImageData(0,0,u.width,u.height);return ie.toGrayscaleBuffer(h.data,u.width,u.height)}static toGrayscaleBuffer(u,h,x){const b=new Uint8ClampedArray(h*x);for(let w=0,v=0,T=u.length;w<T;w+=4,v++){let M;if(u[w+3]===0)M=255;else{const G=u[w],re=u[w+1],le=u[w+2];M=306*G+601*re+117*le+512>>10}b[v]=M}return b}getRow(u,h){if(u<0||u>=this.getHeight())throw new S("Requested row is outside the image: "+u);const x=this.getWidth(),b=u*x;return h===null?h=this.buffer.slice(b,b+x):(h.length<x&&(h=new Uint8ClampedArray(x)),h.set(this.buffer.slice(b,b+x))),h}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(u,h,x,b){return super.crop(u,h,x,b),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const u=this.canvas.ownerDocument.createElement("canvas");u.width=this.canvas.width,u.height=this.canvas.height,this.tempCanvasElement=u}return this.tempCanvasElement}rotate(u){const h=this.getTempCanvasElement(),x=h.getContext("2d"),b=u*ie.DEGREE_TO_RADIANS,w=this.canvas.width,v=this.canvas.height,T=Math.ceil(Math.abs(Math.cos(b))*w+Math.abs(Math.sin(b))*v),M=Math.ceil(Math.abs(Math.sin(b))*w+Math.abs(Math.cos(b))*v);return h.width=T,h.height=M,x.translate(T/2,M/2),x.rotate(b),x.drawImage(this.canvas,w/-2,v/-2),this.buffer=ie.makeBufferFromCanvasImageData(h),this}invert(){return new ee(this)}}ie.DEGREE_TO_RADIANS=Math.PI/180;class X{constructor(u,h,x){this.deviceId=u,this.label=h,this.kind="videoinput",this.groupId=x||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var F=(globalThis||globalThis||self||window||void 0)&&(globalThis||globalThis||self||window||void 0).__awaiter||function(ne,u,h,x){function b(w){return w instanceof h?w:new h(function(v){v(w)})}return new(h||(h=Promise))(function(w,v){function T(G){try{D(x.next(G))}catch(re){v(re)}}function M(G){try{D(x.throw(G))}catch(re){v(re)}}function D(G){G.done?w(G.value):b(G.value).then(T,M)}D((x=x.apply(ne,u||[])).next())})};class J{constructor(u,h=500,x){this.reader=u,this.timeBetweenScansMillis=h,this._hints=x,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(u){this._timeBetweenDecodingAttempts=u<0?0:u}set hints(u){this._hints=u||null}get hints(){return this._hints}listVideoInputDevices(){return F(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const u=yield navigator.mediaDevices.enumerateDevices(),h=[];for(const x of u){const b=x.kind==="video"?"videoinput":x.kind;if(b!=="videoinput")continue;const w=x.deviceId||x.id,v=x.label||`Video device ${h.length+1}`,T=x.groupId,M={deviceId:w,label:v,kind:b,groupId:T};h.push(M)}return h})}getVideoInputDevices(){return F(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(h=>new X(h.deviceId,h.label))})}findDeviceById(u){return F(this,void 0,void 0,function*(){const h=yield this.listVideoInputDevices();return h?h.find(x=>x.deviceId===u):null})}decodeFromInputVideoDevice(u,h){return F(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(u,h)})}decodeOnceFromVideoDevice(u,h){return F(this,void 0,void 0,function*(){this.reset();let x;u?x={deviceId:{exact:u}}:x={facingMode:"environment"};const b={video:x};return yield this.decodeOnceFromConstraints(b,h)})}decodeOnceFromConstraints(u,h){return F(this,void 0,void 0,function*(){const x=yield navigator.mediaDevices.getUserMedia(u);return yield this.decodeOnceFromStream(x,h)})}decodeOnceFromStream(u,h){return F(this,void 0,void 0,function*(){this.reset();const x=yield this.attachStreamToVideo(u,h);return yield this.decodeOnce(x)})}decodeFromInputVideoDeviceContinuously(u,h,x){return F(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(u,h,x)})}decodeFromVideoDevice(u,h,x){return F(this,void 0,void 0,function*(){let b;u?b={deviceId:{exact:u}}:b={facingMode:"environment"};const w={video:b};return yield this.decodeFromConstraints(w,h,x)})}decodeFromConstraints(u,h,x){return F(this,void 0,void 0,function*(){const b=yield navigator.mediaDevices.getUserMedia(u);return yield this.decodeFromStream(b,h,x)})}decodeFromStream(u,h,x){return F(this,void 0,void 0,function*(){this.reset();const b=yield this.attachStreamToVideo(u,h);return yield this.decodeContinuously(b,x)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(u,h){return F(this,void 0,void 0,function*(){const x=this.prepareVideoElement(h);return this.addVideoSource(x,u),this.videoElement=x,this.stream=u,yield this.playVideoOnLoadAsync(x),x})}playVideoOnLoadAsync(u){return new Promise((h,x)=>this.playVideoOnLoad(u,()=>h()))}playVideoOnLoad(u,h){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(u),u.addEventListener("ended",this.videoEndedListener),u.addEventListener("canplay",this.videoCanPlayListener),u.addEventListener("playing",h),this.tryPlayVideo(u)}isVideoPlaying(u){return u.currentTime>0&&!u.paused&&!u.ended&&u.readyState>2}tryPlayVideo(u){return F(this,void 0,void 0,function*(){if(this.isVideoPlaying(u)){console.warn("Trying to play video that is already playing.");return}try{yield u.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(u,h){const x=document.getElementById(u);if(!x)throw new E(`element with id '${u}' not found`);if(x.nodeName.toLowerCase()!==h.toLowerCase())throw new E(`element with id '${u}' must be an ${h} element`);return x}decodeFromImage(u,h){if(!u&&!h)throw new E("either imageElement with a src set or an url must be provided");return h&&!u?this.decodeFromImageUrl(h):this.decodeFromImageElement(u)}decodeFromVideo(u,h){if(!u&&!h)throw new E("Either an element with a src set or an URL must be provided");return h&&!u?this.decodeFromVideoUrl(h):this.decodeFromVideoElement(u)}decodeFromVideoContinuously(u,h,x){if(u===void 0&&h===void 0)throw new E("Either an element with a src set or an URL must be provided");return h&&!u?this.decodeFromVideoUrlContinuously(h,x):this.decodeFromVideoElementContinuously(u,x)}decodeFromImageElement(u){if(!u)throw new E("An image element must be provided.");this.reset();const h=this.prepareImageElement(u);this.imageElement=h;let x;return this.isImageLoaded(h)?x=this.decodeOnce(h,!1,!0):x=this._decodeOnLoadImage(h),x}decodeFromVideoElement(u){const h=this._decodeFromVideoElementSetup(u);return this._decodeOnLoadVideo(h)}decodeFromVideoElementContinuously(u,h){const x=this._decodeFromVideoElementSetup(u);return this._decodeOnLoadVideoContinuously(x,h)}_decodeFromVideoElementSetup(u){if(!u)throw new E("A video element must be provided.");this.reset();const h=this.prepareVideoElement(u);return this.videoElement=h,h}decodeFromImageUrl(u){if(!u)throw new E("An URL must be provided.");this.reset();const h=this.prepareImageElement();this.imageElement=h;const x=this._decodeOnLoadImage(h);return h.src=u,x}decodeFromVideoUrl(u){if(!u)throw new E("An URL must be provided.");this.reset();const h=this.prepareVideoElement(),x=this.decodeFromVideoElement(h);return h.src=u,x}decodeFromVideoUrlContinuously(u,h){if(!u)throw new E("An URL must be provided.");this.reset();const x=this.prepareVideoElement(),b=this.decodeFromVideoElementContinuously(x,h);return x.src=u,b}_decodeOnLoadImage(u){return new Promise((h,x)=>{this.imageLoadedListener=()=>this.decodeOnce(u,!1,!0).then(h,x),u.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(u){return F(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(u),yield this.decodeOnce(u)})}_decodeOnLoadVideoContinuously(u,h){return F(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(u),this.decodeContinuously(u,h)})}isImageLoaded(u){return!(!u.complete||u.naturalWidth===0)}prepareImageElement(u){let h;return typeof u>"u"&&(h=document.createElement("img"),h.width=200,h.height=200),typeof u=="string"&&(h=this.getMediaElement(u,"img")),u instanceof HTMLImageElement&&(h=u),h}prepareVideoElement(u){let h;return!u&&typeof document<"u"&&(h=document.createElement("video"),h.width=200,h.height=200),typeof u=="string"&&(h=this.getMediaElement(u,"video")),u instanceof HTMLVideoElement&&(h=u),h.setAttribute("autoplay","true"),h.setAttribute("muted","true"),h.setAttribute("playsinline","true"),h}decodeOnce(u,h=!0,x=!0){this._stopAsyncDecode=!1;const b=(w,v)=>{if(this._stopAsyncDecode){v(new L("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const T=this.decode(u);w(T)}catch(T){const M=h&&T instanceof L,G=(T instanceof C||T instanceof Q)&&x;if(M||G)return setTimeout(b,this._timeBetweenDecodingAttempts,w,v);v(T)}};return new Promise((w,v)=>b(w,v))}decodeContinuously(u,h){this._stopContinuousDecode=!1;const x=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const b=this.decode(u);h(b,null),setTimeout(x,this.timeBetweenScansMillis)}catch(b){h(null,b);const w=b instanceof C||b instanceof Q,v=b instanceof L;(w||v)&&setTimeout(x,this._timeBetweenDecodingAttempts)}};x()}decode(u){const h=this.createBinaryBitmap(u);return this.decodeBitmap(h)}_isHTMLVideoElement(u){return u.videoWidth!==0}drawFrameOnCanvas(u,h,x){h||(h={sx:0,sy:0,sWidth:u.videoWidth,sHeight:u.videoHeight,dx:0,dy:0,dWidth:u.videoWidth,dHeight:u.videoHeight}),x||(x=this.captureCanvasContext),x.drawImage(u,h.sx,h.sy,h.sWidth,h.sHeight,h.dx,h.dy,h.dWidth,h.dHeight)}drawImageOnCanvas(u,h,x=this.captureCanvasContext){h||(h={sx:0,sy:0,sWidth:u.naturalWidth,sHeight:u.naturalHeight,dx:0,dy:0,dWidth:u.naturalWidth,dHeight:u.naturalHeight}),x||(x=this.captureCanvasContext),x.drawImage(u,h.sx,h.sy,h.sWidth,h.sHeight,h.dx,h.dy,h.dWidth,h.dHeight)}createBinaryBitmap(u){this.getCaptureCanvasContext(u),this._isHTMLVideoElement(u)?this.drawFrameOnCanvas(u):this.drawImageOnCanvas(u);const h=this.getCaptureCanvas(u),x=new ie(h),b=new Y(x);return new A(b)}getCaptureCanvasContext(u){if(!this.captureCanvasContext){const x=this.getCaptureCanvas(u).getContext("2d");this.captureCanvasContext=x}return this.captureCanvasContext}getCaptureCanvas(u){if(!this.captureCanvas){const h=this.createCaptureCanvas(u);this.captureCanvas=h}return this.captureCanvas}decodeBitmap(u){return this.reader.decode(u,this._hints)}createCaptureCanvas(u){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const h=document.createElement("canvas");let x,b;return typeof u<"u"&&(u instanceof HTMLVideoElement?(x=u.videoWidth,b=u.videoHeight):u instanceof HTMLImageElement&&(x=u.naturalWidth||u.width,b=u.naturalHeight||u.height)),h.style.width=x+"px",h.style.height=b+"px",h.width=x,h.height=b,h}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(u=>u.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(u,h){try{u.srcObject=h}catch{u.src=URL.createObjectURL(h)}}cleanVideoSource(u){try{u.srcObject=null}catch{u.src=""}this.videoElement.removeAttribute("src")}}class Ee{constructor(u,h,x=h==null?0:8*h.length,b,w,v=O.currentTimeMillis()){this.text=u,this.rawBytes=h,this.numBits=x,this.resultPoints=b,this.format=w,this.timestamp=v,this.text=u,this.rawBytes=h,x==null?this.numBits=h==null?0:8*h.length:this.numBits=x,this.resultPoints=b,this.format=w,this.resultMetadata=null,v==null?this.timestamp=O.currentTimeMillis():this.timestamp=v}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(u,h){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(u,h)}putAllMetadata(u){u!==null&&(this.resultMetadata===null?this.resultMetadata=u:this.resultMetadata=new Map(u))}addResultPoints(u){const h=this.resultPoints;if(h===null)this.resultPoints=u;else if(u!==null&&u.length>0){const x=new Array(h.length+u.length);O.arraycopy(h,0,x,0,h.length),O.arraycopy(u,0,x,h.length,u.length),this.resultPoints=x}}getTimestamp(){return this.timestamp}toString(){return this.text}}var Re;(function(ne){ne[ne.AZTEC=0]="AZTEC",ne[ne.CODABAR=1]="CODABAR",ne[ne.CODE_39=2]="CODE_39",ne[ne.CODE_93=3]="CODE_93",ne[ne.CODE_128=4]="CODE_128",ne[ne.DATA_MATRIX=5]="DATA_MATRIX",ne[ne.EAN_8=6]="EAN_8",ne[ne.EAN_13=7]="EAN_13",ne[ne.ITF=8]="ITF",ne[ne.MAXICODE=9]="MAXICODE",ne[ne.PDF_417=10]="PDF_417",ne[ne.QR_CODE=11]="QR_CODE",ne[ne.RSS_14=12]="RSS_14",ne[ne.RSS_EXPANDED=13]="RSS_EXPANDED",ne[ne.UPC_A=14]="UPC_A",ne[ne.UPC_E=15]="UPC_E",ne[ne.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(Re||(Re={}));var Te=Re,Ue;(function(ne){ne[ne.OTHER=0]="OTHER",ne[ne.ORIENTATION=1]="ORIENTATION",ne[ne.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",ne[ne.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",ne[ne.ISSUE_NUMBER=4]="ISSUE_NUMBER",ne[ne.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",ne[ne.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",ne[ne.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",ne[ne.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",ne[ne.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",ne[ne.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(Ue||(Ue={}));var ze=Ue;class Ke{constructor(u,h,x,b,w=-1,v=-1){this.rawBytes=u,this.text=h,this.byteSegments=x,this.ecLevel=b,this.structuredAppendSequenceNumber=w,this.structuredAppendParity=v,this.numBits=u==null?0:8*u.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(u){this.numBits=u}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(u){this.errorsCorrected=u}getErasures(){return this.erasures}setErasures(u){this.erasures=u}getOther(){return this.other}setOther(u){this.other=u}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class it{exp(u){return this.expTable[u]}log(u){if(u===0)throw new S;return this.logTable[u]}static addOrSubtract(u,h){return u^h}}class Ye{constructor(u,h){if(h.length===0)throw new S;this.field=u;const x=h.length;if(x>1&&h[0]===0){let b=1;for(;b<x&&h[b]===0;)b++;b===x?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(x-b),O.arraycopy(h,b,this.coefficients,0,this.coefficients.length))}else this.coefficients=h}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(u){return this.coefficients[this.coefficients.length-1-u]}evaluateAt(u){if(u===0)return this.getCoefficient(0);const h=this.coefficients;let x;if(u===1){x=0;for(let v=0,T=h.length;v!==T;v++){const M=h[v];x=it.addOrSubtract(x,M)}return x}x=h[0];const b=h.length,w=this.field;for(let v=1;v<b;v++)x=it.addOrSubtract(w.multiply(u,x),h[v]);return x}addOrSubtract(u){if(!this.field.equals(u.field))throw new S("GenericGFPolys do not have same GenericGF field");if(this.isZero())return u;if(u.isZero())return this;let h=this.coefficients,x=u.coefficients;if(h.length>x.length){const v=h;h=x,x=v}let b=new Int32Array(x.length);const w=x.length-h.length;O.arraycopy(x,0,b,0,w);for(let v=w;v<x.length;v++)b[v]=it.addOrSubtract(h[v-w],x[v]);return new Ye(this.field,b)}multiply(u){if(!this.field.equals(u.field))throw new S("GenericGFPolys do not have same GenericGF field");if(this.isZero()||u.isZero())return this.field.getZero();const h=this.coefficients,x=h.length,b=u.coefficients,w=b.length,v=new Int32Array(x+w-1),T=this.field;for(let M=0;M<x;M++){const D=h[M];for(let G=0;G<w;G++)v[M+G]=it.addOrSubtract(v[M+G],T.multiply(D,b[G]))}return new Ye(T,v)}multiplyScalar(u){if(u===0)return this.field.getZero();if(u===1)return this;const h=this.coefficients.length,x=this.field,b=new Int32Array(h),w=this.coefficients;for(let v=0;v<h;v++)b[v]=x.multiply(w[v],u);return new Ye(x,b)}multiplyByMonomial(u,h){if(u<0)throw new S;if(h===0)return this.field.getZero();const x=this.coefficients,b=x.length,w=new Int32Array(b+u),v=this.field;for(let T=0;T<b;T++)w[T]=v.multiply(x[T],h);return new Ye(v,w)}divide(u){if(!this.field.equals(u.field))throw new S("GenericGFPolys do not have same GenericGF field");if(u.isZero())throw new S("Divide by 0");const h=this.field;let x=h.getZero(),b=this;const w=u.getCoefficient(u.getDegree()),v=h.inverse(w);for(;b.getDegree()>=u.getDegree()&&!b.isZero();){const T=b.getDegree()-u.getDegree(),M=h.multiply(b.getCoefficient(b.getDegree()),v),D=u.multiplyByMonomial(T,M),G=h.buildMonomial(T,M);x=x.addOrSubtract(G),b=b.addOrSubtract(D)}return[x,b]}toString(){let u="";for(let h=this.getDegree();h>=0;h--){let x=this.getCoefficient(h);if(x!==0){if(x<0?(u+=" - ",x=-x):u.length>0&&(u+=" + "),h===0||x!==1){const b=this.field.log(x);b===0?u+="1":b===1?u+="a":(u+="a^",u+=b)}h!==0&&(h===1?u+="x":(u+="x^",u+=h))}}return u}}class Ce extends _{}Ce.kind="ArithmeticException";class ft extends it{constructor(u,h,x){super(),this.primitive=u,this.size=h,this.generatorBase=x;const b=new Int32Array(h);let w=1;for(let T=0;T<h;T++)b[T]=w,w*=2,w>=h&&(w^=u,w&=h-1);this.expTable=b;const v=new Int32Array(h);for(let T=0;T<h-1;T++)v[b[T]]=T;this.logTable=v,this.zero=new Ye(this,Int32Array.from([0])),this.one=new Ye(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(u,h){if(u<0)throw new S;if(h===0)return this.zero;const x=new Int32Array(u+1);return x[0]=h,new Ye(this,x)}inverse(u){if(u===0)throw new Ce;return this.expTable[this.size-this.logTable[u]-1]}multiply(u,h){return u===0||h===0?0:this.expTable[(this.logTable[u]+this.logTable[h])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+B.toHexString(this.primitive)+","+this.size+")"}equals(u){return u===this}}ft.AZTEC_DATA_12=new ft(4201,4096,1),ft.AZTEC_DATA_10=new ft(1033,1024,1),ft.AZTEC_DATA_6=new ft(67,64,1),ft.AZTEC_PARAM=new ft(19,16,1),ft.QR_CODE_FIELD_256=new ft(285,256,0),ft.DATA_MATRIX_FIELD_256=new ft(301,256,1),ft.AZTEC_DATA_8=ft.DATA_MATRIX_FIELD_256,ft.MAXICODE_FIELD_64=ft.AZTEC_DATA_6;class Ze extends _{}Ze.kind="ReedSolomonException";class nt extends _{}nt.kind="IllegalStateException";class dt{constructor(u){this.field=u}decode(u,h){const x=this.field,b=new Ye(x,u),w=new Int32Array(h);let v=!0;for(let xe=0;xe<h;xe++){const we=b.evaluateAt(x.exp(xe+x.getGeneratorBase()));w[w.length-1-xe]=we,we!==0&&(v=!1)}if(v)return;const T=new Ye(x,w),M=this.runEuclideanAlgorithm(x.buildMonomial(h,1),T,h),D=M[0],G=M[1],re=this.findErrorLocations(D),le=this.findErrorMagnitudes(G,re);for(let xe=0;xe<re.length;xe++){const we=u.length-1-x.log(re[xe]);if(we<0)throw new Ze("Bad error location");u[we]=ft.addOrSubtract(u[we],le[xe])}}runEuclideanAlgorithm(u,h,x){if(u.getDegree()<h.getDegree()){const xe=u;u=h,h=xe}const b=this.field;let w=u,v=h,T=b.getZero(),M=b.getOne();for(;v.getDegree()>=(x/2|0);){let xe=w,we=T;if(w=v,T=M,w.isZero())throw new Ze("r_{i-1} was zero");v=xe;let ve=b.getZero();const Le=w.getCoefficient(w.getDegree()),ke=b.inverse(Le);for(;v.getDegree()>=w.getDegree()&&!v.isZero();){const Je=v.getDegree()-w.getDegree(),tt=b.multiply(v.getCoefficient(v.getDegree()),ke);ve=ve.addOrSubtract(b.buildMonomial(Je,tt)),v=v.addOrSubtract(w.multiplyByMonomial(Je,tt))}if(M=ve.multiply(T).addOrSubtract(we),v.getDegree()>=w.getDegree())throw new nt("Division algorithm failed to reduce polynomial?")}const D=M.getCoefficient(0);if(D===0)throw new Ze("sigmaTilde(0) was zero");const G=b.inverse(D),re=M.multiplyScalar(G),le=v.multiplyScalar(G);return[re,le]}findErrorLocations(u){const h=u.getDegree();if(h===1)return Int32Array.from([u.getCoefficient(1)]);const x=new Int32Array(h);let b=0;const w=this.field;for(let v=1;v<w.getSize()&&b<h;v++)u.evaluateAt(v)===0&&(x[b]=w.inverse(v),b++);if(b!==h)throw new Ze("Error locator degree does not match number of roots");return x}findErrorMagnitudes(u,h){const x=h.length,b=new Int32Array(x),w=this.field;for(let v=0;v<x;v++){const T=w.inverse(h[v]);let M=1;for(let D=0;D<x;D++)if(v!==D){const G=w.multiply(h[D],T),re=G&1?G&-2:G|1;M=w.multiply(M,re)}b[v]=w.multiply(u.evaluateAt(T),w.inverse(M)),w.getGeneratorBase()!==0&&(b[v]=w.multiply(b[v],T))}return b}}var gt;(function(ne){ne[ne.UPPER=0]="UPPER",ne[ne.LOWER=1]="LOWER",ne[ne.MIXED=2]="MIXED",ne[ne.DIGIT=3]="DIGIT",ne[ne.PUNCT=4]="PUNCT",ne[ne.BINARY=5]="BINARY"})(gt||(gt={}));class et{decode(u){this.ddata=u;let h=u.getBits(),x=this.extractBits(h),b=this.correctBits(x),w=et.convertBoolArrayToByteArray(b),v=et.getEncodedData(b),T=new Ke(w,v,null,null);return T.setNumBits(b.length),T}static highLevelDecode(u){return this.getEncodedData(u)}static getEncodedData(u){let h=u.length,x=gt.UPPER,b=gt.UPPER,w="",v=0;for(;v<h;)if(b===gt.BINARY){if(h-v<5)break;let T=et.readCode(u,v,5);if(v+=5,T===0){if(h-v<11)break;T=et.readCode(u,v,11)+31,v+=11}for(let M=0;M<T;M++){if(h-v<8){v=h;break}const D=et.readCode(u,v,8);w+=me.castAsNonUtf8Char(D),v+=8}b=x}else{let T=b===gt.DIGIT?4:5;if(h-v<T)break;let M=et.readCode(u,v,T);v+=T;let D=et.getCharacter(b,M);D.startsWith("CTRL_")?(x=b,b=et.getTable(D.charAt(5)),D.charAt(6)==="L"&&(x=b)):(w+=D,b=x)}return w}static getTable(u){switch(u){case"L":return gt.LOWER;case"P":return gt.PUNCT;case"M":return gt.MIXED;case"D":return gt.DIGIT;case"B":return gt.BINARY;case"U":default:return gt.UPPER}}static getCharacter(u,h){switch(u){case gt.UPPER:return et.UPPER_TABLE[h];case gt.LOWER:return et.LOWER_TABLE[h];case gt.MIXED:return et.MIXED_TABLE[h];case gt.PUNCT:return et.PUNCT_TABLE[h];case gt.DIGIT:return et.DIGIT_TABLE[h];default:throw new nt("Bad table")}}correctBits(u){let h,x;this.ddata.getNbLayers()<=2?(x=6,h=ft.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(x=8,h=ft.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(x=10,h=ft.AZTEC_DATA_10):(x=12,h=ft.AZTEC_DATA_12);let b=this.ddata.getNbDatablocks(),w=u.length/x;if(w<b)throw new Q;let v=u.length%x,T=new Int32Array(w);for(let le=0;le<w;le++,v+=x)T[le]=et.readCode(u,v,x);try{new dt(h).decode(T,w-b)}catch(le){throw new Q(le)}let M=(1<<x)-1,D=0;for(let le=0;le<b;le++){let xe=T[le];if(xe===0||xe===M)throw new Q;(xe===1||xe===M-1)&&D++}let G=new Array(b*x-D),re=0;for(let le=0;le<b;le++){let xe=T[le];if(xe===1||xe===M-1)G.fill(xe>1,re,re+x-1),re+=x-1;else for(let we=x-1;we>=0;--we)G[re++]=(xe&1<<we)!==0}return G}extractBits(u){let h=this.ddata.isCompact(),x=this.ddata.getNbLayers(),b=(h?11:14)+x*4,w=new Int32Array(b),v=new Array(this.totalBitsInLayer(x,h));if(h)for(let T=0;T<w.length;T++)w[T]=T;else{let T=b+1+2*B.truncDivision(B.truncDivision(b,2)-1,15),M=b/2,D=B.truncDivision(T,2);for(let G=0;G<M;G++){let re=G+B.truncDivision(G,15);w[M-G-1]=D-re-1,w[M+G]=D+re+1}}for(let T=0,M=0;T<x;T++){let D=(x-T)*4+(h?9:12),G=T*2,re=b-1-G;for(let le=0;le<D;le++){let xe=le*2;for(let we=0;we<2;we++)v[M+xe+we]=u.get(w[G+we],w[G+le]),v[M+2*D+xe+we]=u.get(w[G+le],w[re-we]),v[M+4*D+xe+we]=u.get(w[re-we],w[re-le]),v[M+6*D+xe+we]=u.get(w[re-le],w[G+we])}M+=D*8}return v}static readCode(u,h,x){let b=0;for(let w=h;w<h+x;w++)b<<=1,u[w]&&(b|=1);return b}static readByte(u,h){let x=u.length-h;return x>=8?et.readCode(u,h,8):et.readCode(u,h,x)<<8-x}static convertBoolArrayToByteArray(u){let h=new Uint8Array((u.length+7)/8);for(let x=0;x<h.length;x++)h[x]=et.readByte(u,8*x);return h}totalBitsInLayer(u,h){return((h?88:112)+16*u)*u}}et.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],et.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],et.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],et.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],et.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class he{constructor(){}static round(u){return u===NaN?0:u<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:u>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:u+(u<0?-.5:.5)|0}static distance(u,h,x,b){const w=u-x,v=h-b;return Math.sqrt(w*w+v*v)}static sum(u){let h=0;for(let x=0,b=u.length;x!==b;x++){const w=u[x];h+=w}return h}}class ue{static floatToIntBits(u){return u}}ue.MAX_VALUE=Number.MAX_SAFE_INTEGER;class _e{constructor(u,h){this.x=u,this.y=h}getX(){return this.x}getY(){return this.y}equals(u){if(u instanceof _e){const h=u;return this.x===h.x&&this.y===h.y}return!1}hashCode(){return 31*ue.floatToIntBits(this.x)+ue.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(u){const h=this.distance(u[0],u[1]),x=this.distance(u[1],u[2]),b=this.distance(u[0],u[2]);let w,v,T;if(x>=h&&x>=b?(v=u[0],w=u[1],T=u[2]):b>=x&&b>=h?(v=u[1],w=u[0],T=u[2]):(v=u[2],w=u[0],T=u[1]),this.crossProductZ(w,v,T)<0){const M=w;w=T,T=M}u[0]=w,u[1]=v,u[2]=T}static distance(u,h){return he.distance(u.x,u.y,h.x,h.y)}static crossProductZ(u,h,x){const b=h.x,w=h.y;return(x.x-b)*(u.y-w)-(x.y-w)*(u.x-b)}}class Ge{constructor(u,h){this.bits=u,this.points=h}getBits(){return this.bits}getPoints(){return this.points}}class He extends Ge{constructor(u,h,x,b,w){super(u,h),this.compact=x,this.nbDatablocks=b,this.nbLayers=w}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ve{constructor(u,h,x,b){this.image=u,this.height=u.getHeight(),this.width=u.getWidth(),h==null&&(h=Ve.INIT_SIZE),x==null&&(x=u.getWidth()/2|0),b==null&&(b=u.getHeight()/2|0);const w=h/2|0;if(this.leftInit=x-w,this.rightInit=x+w,this.upInit=b-w,this.downInit=b+w,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new L}detect(){let u=this.leftInit,h=this.rightInit,x=this.upInit,b=this.downInit,w=!1,v=!0,T=!1,M=!1,D=!1,G=!1,re=!1;const le=this.width,xe=this.height;for(;v;){v=!1;let we=!0;for(;(we||!M)&&h<le;)we=this.containsBlackPoint(x,b,h,!1),we?(h++,v=!0,M=!0):M||h++;if(h>=le){w=!0;break}let ve=!0;for(;(ve||!D)&&b<xe;)ve=this.containsBlackPoint(u,h,b,!0),ve?(b++,v=!0,D=!0):D||b++;if(b>=xe){w=!0;break}let Le=!0;for(;(Le||!G)&&u>=0;)Le=this.containsBlackPoint(x,b,u,!1),Le?(u--,v=!0,G=!0):G||u--;if(u<0){w=!0;break}let ke=!0;for(;(ke||!re)&&x>=0;)ke=this.containsBlackPoint(u,h,x,!0),ke?(x--,v=!0,re=!0):re||x--;if(x<0){w=!0;break}v&&(T=!0)}if(!w&&T){const we=h-u;let ve=null;for(let tt=1;ve===null&&tt<we;tt++)ve=this.getBlackPointOnSegment(u,b-tt,u+tt,b);if(ve==null)throw new L;let Le=null;for(let tt=1;Le===null&&tt<we;tt++)Le=this.getBlackPointOnSegment(u,x+tt,u+tt,x);if(Le==null)throw new L;let ke=null;for(let tt=1;ke===null&&tt<we;tt++)ke=this.getBlackPointOnSegment(h,x+tt,h-tt,x);if(ke==null)throw new L;let Je=null;for(let tt=1;Je===null&&tt<we;tt++)Je=this.getBlackPointOnSegment(h,b-tt,h-tt,b);if(Je==null)throw new L;return this.centerEdges(Je,ve,ke,Le)}else throw new L}getBlackPointOnSegment(u,h,x,b){const w=he.round(he.distance(u,h,x,b)),v=(x-u)/w,T=(b-h)/w,M=this.image;for(let D=0;D<w;D++){const G=he.round(u+D*v),re=he.round(h+D*T);if(M.get(G,re))return new _e(G,re)}return null}centerEdges(u,h,x,b){const w=u.getX(),v=u.getY(),T=h.getX(),M=h.getY(),D=x.getX(),G=x.getY(),re=b.getX(),le=b.getY(),xe=Ve.CORR;return w<this.width/2?[new _e(re-xe,le+xe),new _e(T+xe,M+xe),new _e(D-xe,G-xe),new _e(w+xe,v-xe)]:[new _e(re+xe,le+xe),new _e(T+xe,M-xe),new _e(D-xe,G+xe),new _e(w-xe,v-xe)]}containsBlackPoint(u,h,x,b){const w=this.image;if(b){for(let v=u;v<=h;v++)if(w.get(v,x))return!0}else for(let v=u;v<=h;v++)if(w.get(x,v))return!0;return!1}}Ve.INIT_SIZE=10,Ve.CORR=1;class pt{static checkAndNudgePoints(u,h){const x=u.getWidth(),b=u.getHeight();let w=!0;for(let v=0;v<h.length&&w;v+=2){const T=Math.floor(h[v]),M=Math.floor(h[v+1]);if(T<-1||T>x||M<-1||M>b)throw new L;w=!1,T===-1?(h[v]=0,w=!0):T===x&&(h[v]=x-1,w=!0),M===-1?(h[v+1]=0,w=!0):M===b&&(h[v+1]=b-1,w=!0)}w=!0;for(let v=h.length-2;v>=0&&w;v-=2){const T=Math.floor(h[v]),M=Math.floor(h[v+1]);if(T<-1||T>x||M<-1||M>b)throw new L;w=!1,T===-1?(h[v]=0,w=!0):T===x&&(h[v]=x-1,w=!0),M===-1?(h[v+1]=0,w=!0):M===b&&(h[v+1]=b-1,w=!0)}}}class We{constructor(u,h,x,b,w,v,T,M,D){this.a11=u,this.a21=h,this.a31=x,this.a12=b,this.a22=w,this.a32=v,this.a13=T,this.a23=M,this.a33=D}static quadrilateralToQuadrilateral(u,h,x,b,w,v,T,M,D,G,re,le,xe,we,ve,Le){const ke=We.quadrilateralToSquare(u,h,x,b,w,v,T,M);return We.squareToQuadrilateral(D,G,re,le,xe,we,ve,Le).times(ke)}transformPoints(u){const h=u.length,x=this.a11,b=this.a12,w=this.a13,v=this.a21,T=this.a22,M=this.a23,D=this.a31,G=this.a32,re=this.a33;for(let le=0;le<h;le+=2){const xe=u[le],we=u[le+1],ve=w*xe+M*we+re;u[le]=(x*xe+v*we+D)/ve,u[le+1]=(b*xe+T*we+G)/ve}}transformPointsWithValues(u,h){const x=this.a11,b=this.a12,w=this.a13,v=this.a21,T=this.a22,M=this.a23,D=this.a31,G=this.a32,re=this.a33,le=u.length;for(let xe=0;xe<le;xe++){const we=u[xe],ve=h[xe],Le=w*we+M*ve+re;u[xe]=(x*we+v*ve+D)/Le,h[xe]=(b*we+T*ve+G)/Le}}static squareToQuadrilateral(u,h,x,b,w,v,T,M){const D=u-x+w-T,G=h-b+v-M;if(D===0&&G===0)return new We(x-u,w-x,u,b-h,v-b,h,0,0,1);{const re=x-w,le=T-w,xe=b-v,we=M-v,ve=re*we-le*xe,Le=(D*we-le*G)/ve,ke=(re*G-D*xe)/ve;return new We(x-u+Le*x,T-u+ke*T,u,b-h+Le*b,M-h+ke*M,h,Le,ke,1)}}static quadrilateralToSquare(u,h,x,b,w,v,T,M){return We.squareToQuadrilateral(u,h,x,b,w,v,T,M).buildAdjoint()}buildAdjoint(){return new We(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(u){return new We(this.a11*u.a11+this.a21*u.a12+this.a31*u.a13,this.a11*u.a21+this.a21*u.a22+this.a31*u.a23,this.a11*u.a31+this.a21*u.a32+this.a31*u.a33,this.a12*u.a11+this.a22*u.a12+this.a32*u.a13,this.a12*u.a21+this.a22*u.a22+this.a32*u.a23,this.a12*u.a31+this.a22*u.a32+this.a32*u.a33,this.a13*u.a11+this.a23*u.a12+this.a33*u.a13,this.a13*u.a21+this.a23*u.a22+this.a33*u.a23,this.a13*u.a31+this.a23*u.a32+this.a33*u.a33)}}class te extends pt{sampleGrid(u,h,x,b,w,v,T,M,D,G,re,le,xe,we,ve,Le,ke,Je,tt){const qe=We.quadrilateralToQuadrilateral(b,w,v,T,M,D,G,re,le,xe,we,ve,Le,ke,Je,tt);return this.sampleGridWithTransform(u,h,x,qe)}sampleGridWithTransform(u,h,x,b){if(h<=0||x<=0)throw new L;const w=new R(h,x),v=new Float32Array(2*h);for(let T=0;T<x;T++){const M=v.length,D=T+.5;for(let G=0;G<M;G+=2)v[G]=G/2+.5,v[G+1]=D;b.transformPoints(v),pt.checkAndNudgePoints(u,v);try{for(let G=0;G<M;G+=2)u.get(Math.floor(v[G]),Math.floor(v[G+1]))&&w.set(G/2,T)}catch{throw new L}}return w}}class U{static setGridSampler(u){U.gridSampler=u}static getInstance(){return U.gridSampler}}U.gridSampler=new te;class ${constructor(u,h){this.x=u,this.y=h}toResultPoint(){return new _e(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ae{constructor(u){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=u}detect(){return this.detectMirror(!1)}detectMirror(u){let h=this.getMatrixCenter(),x=this.getBullsEyeCorners(h);if(u){let v=x[0];x[0]=x[2],x[2]=v}this.extractParameters(x);let b=this.sampleGrid(this.image,x[this.shift%4],x[(this.shift+1)%4],x[(this.shift+2)%4],x[(this.shift+3)%4]),w=this.getMatrixCornerPoints(x);return new He(b,w,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(u){if(!this.isValidPoint(u[0])||!this.isValidPoint(u[1])||!this.isValidPoint(u[2])||!this.isValidPoint(u[3]))throw new L;let h=2*this.nbCenterLayers,x=new Int32Array([this.sampleLine(u[0],u[1],h),this.sampleLine(u[1],u[2],h),this.sampleLine(u[2],u[3],h),this.sampleLine(u[3],u[0],h)]);this.shift=this.getRotation(x,h);let b=0;for(let v=0;v<4;v++){let T=x[(this.shift+v)%4];this.compact?(b<<=7,b+=T>>1&127):(b<<=10,b+=(T>>2&992)+(T>>1&31))}let w=this.getCorrectedParameterData(b,this.compact);this.compact?(this.nbLayers=(w>>6)+1,this.nbDataBlocks=(w&63)+1):(this.nbLayers=(w>>11)+1,this.nbDataBlocks=(w&2047)+1)}getRotation(u,h){let x=0;u.forEach((b,w,v)=>{let T=(b>>h-2<<1)+(b&1);x=(x<<3)+T}),x=((x&1)<<11)+(x>>1);for(let b=0;b<4;b++)if(B.bitCount(x^this.EXPECTED_CORNER_BITS[b])<=2)return b;throw new L}getCorrectedParameterData(u,h){let x,b;h?(x=7,b=2):(x=10,b=4);let w=x-b,v=new Int32Array(x);for(let M=x-1;M>=0;--M)v[M]=u&15,u>>=4;try{new dt(ft.AZTEC_PARAM).decode(v,w)}catch{throw new L}let T=0;for(let M=0;M<b;M++)T=(T<<4)+v[M];return T}getBullsEyeCorners(u){let h=u,x=u,b=u,w=u,v=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let re=this.getFirstDifferent(h,v,1,-1),le=this.getFirstDifferent(x,v,1,1),xe=this.getFirstDifferent(b,v,-1,1),we=this.getFirstDifferent(w,v,-1,-1);if(this.nbCenterLayers>2){let ve=this.distancePoint(we,re)*this.nbCenterLayers/(this.distancePoint(w,h)*(this.nbCenterLayers+2));if(ve<.75||ve>1.25||!this.isWhiteOrBlackRectangle(re,le,xe,we))break}h=re,x=le,b=xe,w=we,v=!v}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new L;this.compact=this.nbCenterLayers===5;let T=new _e(h.getX()+.5,h.getY()-.5),M=new _e(x.getX()+.5,x.getY()+.5),D=new _e(b.getX()-.5,b.getY()+.5),G=new _e(w.getX()-.5,w.getY()-.5);return this.expandSquare([T,M,D,G],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let u,h,x,b;try{let T=new Ve(this.image).detect();u=T[0],h=T[1],x=T[2],b=T[3]}catch{let M=this.image.getWidth()/2,D=this.image.getHeight()/2;u=this.getFirstDifferent(new $(M+7,D-7),!1,1,-1).toResultPoint(),h=this.getFirstDifferent(new $(M+7,D+7),!1,1,1).toResultPoint(),x=this.getFirstDifferent(new $(M-7,D+7),!1,-1,1).toResultPoint(),b=this.getFirstDifferent(new $(M-7,D-7),!1,-1,-1).toResultPoint()}let w=he.round((u.getX()+b.getX()+h.getX()+x.getX())/4),v=he.round((u.getY()+b.getY()+h.getY()+x.getY())/4);try{let T=new Ve(this.image,15,w,v).detect();u=T[0],h=T[1],x=T[2],b=T[3]}catch{u=this.getFirstDifferent(new $(w+7,v-7),!1,1,-1).toResultPoint(),h=this.getFirstDifferent(new $(w+7,v+7),!1,1,1).toResultPoint(),x=this.getFirstDifferent(new $(w-7,v+7),!1,-1,1).toResultPoint(),b=this.getFirstDifferent(new $(w-7,v-7),!1,-1,-1).toResultPoint()}return w=he.round((u.getX()+b.getX()+h.getX()+x.getX())/4),v=he.round((u.getY()+b.getY()+h.getY()+x.getY())/4),new $(w,v)}getMatrixCornerPoints(u){return this.expandSquare(u,2*this.nbCenterLayers,this.getDimension())}sampleGrid(u,h,x,b,w){let v=U.getInstance(),T=this.getDimension(),M=T/2-this.nbCenterLayers,D=T/2+this.nbCenterLayers;return v.sampleGrid(u,T,T,M,M,D,M,D,D,M,D,h.getX(),h.getY(),x.getX(),x.getY(),b.getX(),b.getY(),w.getX(),w.getY())}sampleLine(u,h,x){let b=0,w=this.distanceResultPoint(u,h),v=w/x,T=u.getX(),M=u.getY(),D=v*(h.getX()-u.getX())/w,G=v*(h.getY()-u.getY())/w;for(let re=0;re<x;re++)this.image.get(he.round(T+re*D),he.round(M+re*G))&&(b|=1<<x-re-1);return b}isWhiteOrBlackRectangle(u,h,x,b){let w=3;u=new $(u.getX()-w,u.getY()+w),h=new $(h.getX()-w,h.getY()-w),x=new $(x.getX()+w,x.getY()-w),b=new $(b.getX()+w,b.getY()+w);let v=this.getColor(b,u);if(v===0)return!1;let T=this.getColor(u,h);return T!==v||(T=this.getColor(h,x),T!==v)?!1:(T=this.getColor(x,b),T===v)}getColor(u,h){let x=this.distancePoint(u,h),b=(h.getX()-u.getX())/x,w=(h.getY()-u.getY())/x,v=0,T=u.getX(),M=u.getY(),D=this.image.get(u.getX(),u.getY()),G=Math.ceil(x);for(let le=0;le<G;le++)T+=b,M+=w,this.image.get(he.round(T),he.round(M))!==D&&v++;let re=v/x;return re>.1&&re<.9?0:re<=.1===D?1:-1}getFirstDifferent(u,h,x,b){let w=u.getX()+x,v=u.getY()+b;for(;this.isValid(w,v)&&this.image.get(w,v)===h;)w+=x,v+=b;for(w-=x,v-=b;this.isValid(w,v)&&this.image.get(w,v)===h;)w+=x;for(w-=x;this.isValid(w,v)&&this.image.get(w,v)===h;)v+=b;return v-=b,new $(w,v)}expandSquare(u,h,x){let b=x/(2*h),w=u[0].getX()-u[2].getX(),v=u[0].getY()-u[2].getY(),T=(u[0].getX()+u[2].getX())/2,M=(u[0].getY()+u[2].getY())/2,D=new _e(T+b*w,M+b*v),G=new _e(T-b*w,M-b*v);w=u[1].getX()-u[3].getX(),v=u[1].getY()-u[3].getY(),T=(u[1].getX()+u[3].getX())/2,M=(u[1].getY()+u[3].getY())/2;let re=new _e(T+b*w,M+b*v),le=new _e(T-b*w,M-b*v);return[D,re,G,le]}isValid(u,h){return u>=0&&u<this.image.getWidth()&&h>0&&h<this.image.getHeight()}isValidPoint(u){let h=he.round(u.getX()),x=he.round(u.getY());return this.isValid(h,x)}distancePoint(u,h){return he.distance(u.getX(),u.getY(),h.getX(),h.getY())}distanceResultPoint(u,h){return he.distance(u.getX(),u.getY(),h.getX(),h.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(B.truncDivision(this.nbLayers-4,8)+1)+15}}class be{decode(u,h=null){let x=null,b=new ae(u.getBlackMatrix()),w=null,v=null;try{let G=b.detectMirror(!1);w=G.getPoints(),this.reportFoundResultPoints(h,w),v=new et().decode(G)}catch(G){x=G}if(v==null)try{let G=b.detectMirror(!0);w=G.getPoints(),this.reportFoundResultPoints(h,w),v=new et().decode(G)}catch(G){throw x??G}let T=new Ee(v.getText(),v.getRawBytes(),v.getNumBits(),w,Te.AZTEC,O.currentTimeMillis()),M=v.getByteSegments();M!=null&&T.putMetadata(ze.BYTE_SEGMENTS,M);let D=v.getECLevel();return D!=null&&T.putMetadata(ze.ERROR_CORRECTION_LEVEL,D),T}reportFoundResultPoints(u,h){if(u!=null){let x=u.get(oe.NEED_RESULT_POINT_CALLBACK);x!=null&&h.forEach((b,w,v)=>{x.foundPossibleResultPoint(b)})}}reset(){}}class Se extends J{constructor(u=500){super(new be,u)}}class Ae{decode(u,h){try{return this.doDecode(u,h)}catch{if(h&&h.get(oe.TRY_HARDER)===!0&&u.isRotateSupported()){const w=u.rotateCounterClockwise(),v=this.doDecode(w,h),T=v.getResultMetadata();let M=270;T!==null&&T.get(ze.ORIENTATION)===!0&&(M=M+T.get(ze.ORIENTATION)%360),v.putMetadata(ze.ORIENTATION,M);const D=v.getResultPoints();if(D!==null){const G=w.getHeight();for(let re=0;re<D.length;re++)D[re]=new _e(G-D[re].getY()-1,D[re].getX())}return v}else throw new L}}reset(){}doDecode(u,h){const x=u.getWidth(),b=u.getHeight();let w=new H(x);const v=h&&h.get(oe.TRY_HARDER)===!0,T=Math.max(1,b>>(v?8:5));let M;v?M=b:M=15;const D=Math.trunc(b/2);for(let G=0;G<M;G++){const re=Math.trunc((G+1)/2),le=(G&1)===0,xe=D+T*(le?re:-re);if(xe<0||xe>=b)break;try{w=u.getBlackRow(xe,w)}catch{continue}for(let we=0;we<2;we++){if(we===1&&(w.reverse(),h&&h.get(oe.NEED_RESULT_POINT_CALLBACK)===!0)){const ve=new Map;h.forEach((Le,ke)=>ve.set(ke,Le)),ve.delete(oe.NEED_RESULT_POINT_CALLBACK),h=ve}try{const ve=this.decodeRow(xe,w,h);if(we===1){ve.putMetadata(ze.ORIENTATION,180);const Le=ve.getResultPoints();Le!==null&&(Le[0]=new _e(x-Le[0].getX()-1,Le[0].getY()),Le[1]=new _e(x-Le[1].getX()-1,Le[1].getY()))}return ve}catch{}}}throw new L}static recordPattern(u,h,x){const b=x.length;for(let D=0;D<b;D++)x[D]=0;const w=u.getSize();if(h>=w)throw new L;let v=!u.get(h),T=0,M=h;for(;M<w;){if(u.get(M)!==v)x[T]++;else{if(++T===b)break;x[T]=1,v=!v}M++}if(!(T===b||T===b-1&&M===w))throw new L}static recordPatternInReverse(u,h,x){let b=x.length,w=u.get(h);for(;h>0&&b>=0;)u.get(--h)!==w&&(b--,w=!w);if(b>=0)throw new L;Ae.recordPattern(u,h+1,x)}static patternMatchVariance(u,h,x){const b=u.length;let w=0,v=0;for(let D=0;D<b;D++)w+=u[D],v+=h[D];if(w<v)return Number.POSITIVE_INFINITY;const T=w/v;x*=T;let M=0;for(let D=0;D<b;D++){const G=u[D],re=h[D]*T,le=G>re?G-re:re-G;if(le>x)return Number.POSITIVE_INFINITY;M+=le}return M/w}}class Ie extends Ae{static findStartPattern(u){const h=u.getSize(),x=u.getNextSet(0);let b=0,w=Int32Array.from([0,0,0,0,0,0]),v=x,T=!1;const M=6;for(let D=x;D<h;D++)if(u.get(D)!==T)w[b]++;else{if(b===M-1){let G=Ie.MAX_AVG_VARIANCE,re=-1;for(let le=Ie.CODE_START_A;le<=Ie.CODE_START_C;le++){const xe=Ae.patternMatchVariance(w,Ie.CODE_PATTERNS[le],Ie.MAX_INDIVIDUAL_VARIANCE);xe<G&&(G=xe,re=le)}if(re>=0&&u.isRange(Math.max(0,v-(D-v)/2),v,!1))return Int32Array.from([v,D,re]);v+=w[0]+w[1],w=w.slice(2,w.length-1),w[b-1]=0,w[b]=0,b--}else b++;w[b]=1,T=!T}throw new L}static decodeCode(u,h,x){Ae.recordPattern(u,x,h);let b=Ie.MAX_AVG_VARIANCE,w=-1;for(let v=0;v<Ie.CODE_PATTERNS.length;v++){const T=Ie.CODE_PATTERNS[v],M=this.patternMatchVariance(h,T,Ie.MAX_INDIVIDUAL_VARIANCE);M<b&&(b=M,w=v)}if(w>=0)return w;throw new L}decodeRow(u,h,x){const b=x&&x.get(oe.ASSUME_GS1)===!0,w=Ie.findStartPattern(h),v=w[2];let T=0;const M=new Uint8Array(20);M[T++]=v;let D;switch(v){case Ie.CODE_START_A:D=Ie.CODE_CODE_A;break;case Ie.CODE_START_B:D=Ie.CODE_CODE_B;break;case Ie.CODE_START_C:D=Ie.CODE_CODE_C;break;default:throw new Q}let G=!1,re=!1,le="",xe=w[0],we=w[1];const ve=Int32Array.from([0,0,0,0,0,0]);let Le=0,ke=0,Je=v,tt=0,qe=!0,$t=!1,Nt=!1;for(;!G;){const Gn=re;switch(re=!1,Le=ke,ke=Ie.decodeCode(h,ve,we),M[T++]=ke,ke!==Ie.CODE_STOP&&(qe=!0),ke!==Ie.CODE_STOP&&(tt++,Je+=tt*ke),xe=we,we+=ve.reduce((Jr,ei)=>Jr+ei,0),ke){case Ie.CODE_START_A:case Ie.CODE_START_B:case Ie.CODE_START_C:throw new Q}switch(D){case Ie.CODE_CODE_A:if(ke<64)Nt===$t?le+=String.fromCharCode(" ".charCodeAt(0)+ke):le+=String.fromCharCode(" ".charCodeAt(0)+ke+128),Nt=!1;else if(ke<96)Nt===$t?le+=String.fromCharCode(ke-64):le+=String.fromCharCode(ke+64),Nt=!1;else switch(ke!==Ie.CODE_STOP&&(qe=!1),ke){case Ie.CODE_FNC_1:b&&(le.length===0?le+="]C1":le+=String.fromCharCode(29));break;case Ie.CODE_FNC_2:case Ie.CODE_FNC_3:break;case Ie.CODE_FNC_4_A:!$t&&Nt?($t=!0,Nt=!1):$t&&Nt?($t=!1,Nt=!1):Nt=!0;break;case Ie.CODE_SHIFT:re=!0,D=Ie.CODE_CODE_B;break;case Ie.CODE_CODE_B:D=Ie.CODE_CODE_B;break;case Ie.CODE_CODE_C:D=Ie.CODE_CODE_C;break;case Ie.CODE_STOP:G=!0;break}break;case Ie.CODE_CODE_B:if(ke<96)Nt===$t?le+=String.fromCharCode(" ".charCodeAt(0)+ke):le+=String.fromCharCode(" ".charCodeAt(0)+ke+128),Nt=!1;else switch(ke!==Ie.CODE_STOP&&(qe=!1),ke){case Ie.CODE_FNC_1:b&&(le.length===0?le+="]C1":le+=String.fromCharCode(29));break;case Ie.CODE_FNC_2:case Ie.CODE_FNC_3:break;case Ie.CODE_FNC_4_B:!$t&&Nt?($t=!0,Nt=!1):$t&&Nt?($t=!1,Nt=!1):Nt=!0;break;case Ie.CODE_SHIFT:re=!0,D=Ie.CODE_CODE_A;break;case Ie.CODE_CODE_A:D=Ie.CODE_CODE_A;break;case Ie.CODE_CODE_C:D=Ie.CODE_CODE_C;break;case Ie.CODE_STOP:G=!0;break}break;case Ie.CODE_CODE_C:if(ke<100)ke<10&&(le+="0"),le+=ke;else switch(ke!==Ie.CODE_STOP&&(qe=!1),ke){case Ie.CODE_FNC_1:b&&(le.length===0?le+="]C1":le+=String.fromCharCode(29));break;case Ie.CODE_CODE_A:D=Ie.CODE_CODE_A;break;case Ie.CODE_CODE_B:D=Ie.CODE_CODE_B;break;case Ie.CODE_STOP:G=!0;break}break}Gn&&(D=D===Ie.CODE_CODE_A?Ie.CODE_CODE_B:Ie.CODE_CODE_A)}const wn=we-xe;if(we=h.getNextUnset(we),!h.isRange(we,Math.min(h.getSize(),we+(we-xe)/2),!1))throw new L;if(Je-=tt*Le,Je%103!==Le)throw new C;const Nn=le.length;if(Nn===0)throw new L;Nn>0&&qe&&(D===Ie.CODE_CODE_C?le=le.substring(0,Nn-2):le=le.substring(0,Nn-1));const Sn=(w[1]+w[0])/2,Yt=xe+wn/2,gn=M.length,vn=new Uint8Array(gn);for(let Gn=0;Gn<gn;Gn++)vn[Gn]=M[Gn];const jn=[new _e(Sn,u),new _e(Yt,u)];return new Ee(le,vn,0,jn,Te.CODE_128,new Date().getTime())}}Ie.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],Ie.MAX_AVG_VARIANCE=.25,Ie.MAX_INDIVIDUAL_VARIANCE=.7,Ie.CODE_SHIFT=98,Ie.CODE_CODE_C=99,Ie.CODE_CODE_B=100,Ie.CODE_CODE_A=101,Ie.CODE_FNC_1=102,Ie.CODE_FNC_2=97,Ie.CODE_FNC_3=96,Ie.CODE_FNC_4_A=101,Ie.CODE_FNC_4_B=100,Ie.CODE_START_A=103,Ie.CODE_START_B=104,Ie.CODE_START_C=105,Ie.CODE_STOP=106;class $e extends Ae{constructor(u=!1,h=!1){super(),this.usingCheckDigit=u,this.extendedMode=h,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(u,h,x){let b=this.counters;b.fill(0),this.decodeRowResult="";let w=$e.findAsteriskPattern(h,b),v=h.getNextSet(w[1]),T=h.getSize(),M,D;do{$e.recordPattern(h,v,b);let ve=$e.toNarrowWidePattern(b);if(ve<0)throw new L;M=$e.patternToChar(ve),this.decodeRowResult+=M,D=v;for(let Le of b)v+=Le;v=h.getNextSet(v)}while(M!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let G=0;for(let ve of b)G+=ve;let re=v-D-G;if(v!==T&&re*2<G)throw new L;if(this.usingCheckDigit){let ve=this.decodeRowResult.length-1,Le=0;for(let ke=0;ke<ve;ke++)Le+=$e.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ke));if(this.decodeRowResult.charAt(ve)!==$e.ALPHABET_STRING.charAt(Le%43))throw new C;this.decodeRowResult=this.decodeRowResult.substring(0,ve)}if(this.decodeRowResult.length===0)throw new L;let le;this.extendedMode?le=$e.decodeExtended(this.decodeRowResult):le=this.decodeRowResult;let xe=(w[1]+w[0])/2,we=D+G/2;return new Ee(le,null,0,[new _e(xe,u),new _e(we,u)],Te.CODE_39,new Date().getTime())}static findAsteriskPattern(u,h){let x=u.getSize(),b=u.getNextSet(0),w=0,v=b,T=!1,M=h.length;for(let D=b;D<x;D++)if(u.get(D)!==T)h[w]++;else{if(w===M-1){if(this.toNarrowWidePattern(h)===$e.ASTERISK_ENCODING&&u.isRange(Math.max(0,v-Math.floor((D-v)/2)),v,!1))return[v,D];v+=h[0]+h[1],h.copyWithin(0,2,2+w-1),h[w-1]=0,h[w]=0,w--}else w++;h[w]=1,T=!T}throw new L}static toNarrowWidePattern(u){let h=u.length,x=0,b;do{let w=2147483647;for(let M of u)M<w&&M>x&&(w=M);x=w,b=0;let v=0,T=0;for(let M=0;M<h;M++){let D=u[M];D>x&&(T|=1<<h-1-M,b++,v+=D)}if(b===3){for(let M=0;M<h&&b>0;M++){let D=u[M];if(D>x&&(b--,D*2>=v))return-1}return T}}while(b>3);return-1}static patternToChar(u){for(let h=0;h<$e.CHARACTER_ENCODINGS.length;h++)if($e.CHARACTER_ENCODINGS[h]===u)return $e.ALPHABET_STRING.charAt(h);if(u===$e.ASTERISK_ENCODING)return"*";throw new L}static decodeExtended(u){let h=u.length,x="";for(let b=0;b<h;b++){let w=u.charAt(b);if(w==="+"||w==="$"||w==="%"||w==="/"){let v=u.charAt(b+1),T="\0";switch(w){case"+":if(v>="A"&&v<="Z")T=String.fromCharCode(v.charCodeAt(0)+32);else throw new Q;break;case"$":if(v>="A"&&v<="Z")T=String.fromCharCode(v.charCodeAt(0)-64);else throw new Q;break;case"%":if(v>="A"&&v<="E")T=String.fromCharCode(v.charCodeAt(0)-38);else if(v>="F"&&v<="J")T=String.fromCharCode(v.charCodeAt(0)-11);else if(v>="K"&&v<="O")T=String.fromCharCode(v.charCodeAt(0)+16);else if(v>="P"&&v<="T")T=String.fromCharCode(v.charCodeAt(0)+43);else if(v==="U")T="\0";else if(v==="V")T="@";else if(v==="W")T="`";else if(v==="X"||v==="Y"||v==="Z")T="";else throw new Q;break;case"/":if(v>="A"&&v<="O")T=String.fromCharCode(v.charCodeAt(0)-32);else if(v==="Z")T=":";else throw new Q;break}x+=T,b++}else x+=w}return x}}$e.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",$e.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],$e.ASTERISK_ENCODING=148;class je extends Ae{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(u,h,x){let b=this.decodeStart(h),w=this.decodeEnd(h),v=new V;je.decodeMiddle(h,b[1],w[0],v);let T=v.toString(),M=null;x!=null&&(M=x.get(oe.ALLOWED_LENGTHS)),M==null&&(M=je.DEFAULT_ALLOWED_LENGTHS);let D=T.length,G=!1,re=0;for(let we of M){if(D===we){G=!0;break}we>re&&(re=we)}if(!G&&D>re&&(G=!0),!G)throw new Q;const le=[new _e(b[1],u),new _e(w[0],u)];return new Ee(T,null,0,le,Te.ITF,new Date().getTime())}static decodeMiddle(u,h,x,b){let w=new Int32Array(10),v=new Int32Array(5),T=new Int32Array(5);for(w.fill(0),v.fill(0),T.fill(0);h<x;){Ae.recordPattern(u,h,w);for(let D=0;D<5;D++){let G=2*D;v[D]=w[G],T[D]=w[G+1]}let M=je.decodeDigit(v);b.append(M.toString()),M=this.decodeDigit(T),b.append(M.toString()),w.forEach(function(D){h+=D})}}decodeStart(u){let h=je.skipWhiteSpace(u),x=je.findGuardPattern(u,h,je.START_PATTERN);return this.narrowLineWidth=(x[1]-x[0])/4,this.validateQuietZone(u,x[0]),x}validateQuietZone(u,h){let x=this.narrowLineWidth*10;x=x<h?x:h;for(let b=h-1;x>0&&b>=0&&!u.get(b);b--)x--;if(x!==0)throw new L}static skipWhiteSpace(u){const h=u.getSize(),x=u.getNextSet(0);if(x===h)throw new L;return x}decodeEnd(u){u.reverse();try{let h=je.skipWhiteSpace(u),x;try{x=je.findGuardPattern(u,h,je.END_PATTERN_REVERSED[0])}catch(w){w instanceof L&&(x=je.findGuardPattern(u,h,je.END_PATTERN_REVERSED[1]))}this.validateQuietZone(u,x[0]);let b=x[0];return x[0]=u.getSize()-x[1],x[1]=u.getSize()-b,x}finally{u.reverse()}}static findGuardPattern(u,h,x){let b=x.length,w=new Int32Array(b),v=u.getSize(),T=!1,M=0,D=h;w.fill(0);for(let G=h;G<v;G++)if(u.get(G)!==T)w[M]++;else{if(M===b-1){if(Ae.patternMatchVariance(w,x,je.MAX_INDIVIDUAL_VARIANCE)<je.MAX_AVG_VARIANCE)return[D,G];D+=w[0]+w[1],O.arraycopy(w,2,w,0,M-1),w[M-1]=0,w[M]=0,M--}else M++;w[M]=1,T=!T}throw new L}static decodeDigit(u){let h=je.MAX_AVG_VARIANCE,x=-1,b=je.PATTERNS.length;for(let w=0;w<b;w++){let v=je.PATTERNS[w],T=Ae.patternMatchVariance(u,v,je.MAX_INDIVIDUAL_VARIANCE);T<h?(h=T,x=w):T===h&&(x=-1)}if(x>=0)return x%10;throw new L}}je.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],je.MAX_AVG_VARIANCE=.38,je.MAX_INDIVIDUAL_VARIANCE=.5,je.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],je.START_PATTERN=Int32Array.from([1,1,1,1]),je.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class lt extends Ae{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(u){let h=!1,x,b=0,w=Int32Array.from([0,0,0]);for(;!h;){w=Int32Array.from([0,0,0]),x=lt.findGuardPattern(u,b,!1,this.START_END_PATTERN,w);let v=x[0];b=x[1];let T=v-(b-v);T>=0&&(h=u.isRange(T,v,!1))}return x}static checkChecksum(u){return lt.checkStandardUPCEANChecksum(u)}static checkStandardUPCEANChecksum(u){let h=u.length;if(h===0)return!1;let x=parseInt(u.charAt(h-1),10);return lt.getStandardUPCEANChecksum(u.substring(0,h-1))===x}static getStandardUPCEANChecksum(u){let h=u.length,x=0;for(let b=h-1;b>=0;b-=2){let w=u.charAt(b).charCodeAt(0)-"0".charCodeAt(0);if(w<0||w>9)throw new Q;x+=w}x*=3;for(let b=h-2;b>=0;b-=2){let w=u.charAt(b).charCodeAt(0)-"0".charCodeAt(0);if(w<0||w>9)throw new Q;x+=w}return(1e3-x)%10}static decodeEnd(u,h){return lt.findGuardPattern(u,h,!1,lt.START_END_PATTERN,new Int32Array(lt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(u,h,x,b){return this.findGuardPattern(u,h,x,b,new Int32Array(b.length))}static findGuardPattern(u,h,x,b,w){let v=u.getSize();h=x?u.getNextUnset(h):u.getNextSet(h);let T=0,M=h,D=b.length,G=x;for(let re=h;re<v;re++)if(u.get(re)!==G)w[T]++;else{if(T===D-1){if(Ae.patternMatchVariance(w,b,lt.MAX_INDIVIDUAL_VARIANCE)<lt.MAX_AVG_VARIANCE)return Int32Array.from([M,re]);M+=w[0]+w[1];let le=w.slice(2,w.length-1);for(let xe=0;xe<T-1;xe++)w[xe]=le[xe];w[T-1]=0,w[T]=0,T--}else T++;w[T]=1,G=!G}throw new L}static decodeDigit(u,h,x,b){this.recordPattern(u,x,h);let w=this.MAX_AVG_VARIANCE,v=-1,T=b.length;for(let M=0;M<T;M++){let D=b[M],G=Ae.patternMatchVariance(h,D,lt.MAX_INDIVIDUAL_VARIANCE);G<w&&(w=G,v=M)}if(v>=0)return v;throw new L}}lt.MAX_AVG_VARIANCE=.48,lt.MAX_INDIVIDUAL_VARIANCE=.7,lt.START_END_PATTERN=Int32Array.from([1,1,1]),lt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),lt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),lt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class ht{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(u,h,x){let b=this.decodeRowStringBuffer,w=this.decodeMiddle(h,x,b),v=b.toString(),T=ht.parseExtensionString(v),M=[new _e((x[0]+x[1])/2,u),new _e(w,u)],D=new Ee(v,null,0,M,Te.UPC_EAN_EXTENSION,new Date().getTime());return T!=null&&D.putAllMetadata(T),D}decodeMiddle(u,h,x){let b=this.decodeMiddleCounters;b[0]=0,b[1]=0,b[2]=0,b[3]=0;let w=u.getSize(),v=h[1],T=0;for(let D=0;D<5&&v<w;D++){let G=lt.decodeDigit(u,b,v,lt.L_AND_G_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+G%10);for(let re of b)v+=re;G>=10&&(T|=1<<4-D),D!==4&&(v=u.getNextSet(v),v=u.getNextUnset(v))}if(x.length!==5)throw new L;let M=this.determineCheckDigit(T);if(ht.extensionChecksum(x.toString())!==M)throw new L;return v}static extensionChecksum(u){let h=u.length,x=0;for(let b=h-2;b>=0;b-=2)x+=u.charAt(b).charCodeAt(0)-"0".charCodeAt(0);x*=3;for(let b=h-1;b>=0;b-=2)x+=u.charAt(b).charCodeAt(0)-"0".charCodeAt(0);return x*=3,x%10}determineCheckDigit(u){for(let h=0;h<10;h++)if(u===this.CHECK_DIGIT_ENCODINGS[h])return h;throw new L}static parseExtensionString(u){if(u.length!==5)return null;let h=ht.parseExtension5String(u);return h==null?null:new Map([[ze.SUGGESTED_PRICE,h]])}static parseExtension5String(u){let h;switch(u.charAt(0)){case"0":h="£";break;case"5":h="$";break;case"9":switch(u){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}h="";break;default:h="";break}let x=parseInt(u.substring(1)),b=(x/100).toString(),w=x%100,v=w<10?"0"+w:w.toString();return h+b+"."+v}}class yt{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(u,h,x){let b=this.decodeRowStringBuffer,w=this.decodeMiddle(h,x,b),v=b.toString(),T=yt.parseExtensionString(v),M=[new _e((x[0]+x[1])/2,u),new _e(w,u)],D=new Ee(v,null,0,M,Te.UPC_EAN_EXTENSION,new Date().getTime());return T!=null&&D.putAllMetadata(T),D}decodeMiddle(u,h,x){let b=this.decodeMiddleCounters;b[0]=0,b[1]=0,b[2]=0,b[3]=0;let w=u.getSize(),v=h[1],T=0;for(let M=0;M<2&&v<w;M++){let D=lt.decodeDigit(u,b,v,lt.L_AND_G_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+D%10);for(let G of b)v+=G;D>=10&&(T|=1<<1-M),M!==1&&(v=u.getNextSet(v),v=u.getNextUnset(v))}if(x.length!==2)throw new L;if(parseInt(x.toString())%4!==T)throw new L;return v}static parseExtensionString(u){return u.length!==2?null:new Map([[ze.ISSUE_NUMBER,parseInt(u)]])}}class st{static decodeRow(u,h,x){let b=lt.findGuardPattern(h,x,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new ht().decodeRow(u,h,b)}catch{return new yt().decodeRow(u,h,b)}}}st.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class ye extends lt{constructor(){super(),this.decodeRowStringBuffer="",ye.L_AND_G_PATTERNS=ye.L_PATTERNS.map(u=>Int32Array.from(u));for(let u=10;u<20;u++){let h=ye.L_PATTERNS[u-10],x=new Int32Array(h.length);for(let b=0;b<h.length;b++)x[b]=h[h.length-b-1];ye.L_AND_G_PATTERNS[u]=x}}decodeRow(u,h,x){let b=ye.findStartGuardPattern(h),w=x==null?null:x.get(oe.NEED_RESULT_POINT_CALLBACK);if(w!=null){const qe=new _e((b[0]+b[1])/2,u);w.foundPossibleResultPoint(qe)}let v=this.decodeMiddle(h,b,this.decodeRowStringBuffer),T=v.rowOffset,M=v.resultString;if(w!=null){const qe=new _e(T,u);w.foundPossibleResultPoint(qe)}let D=this.decodeEnd(h,T);if(w!=null){const qe=new _e((D[0]+D[1])/2,u);w.foundPossibleResultPoint(qe)}let G=D[1],re=G+(G-D[0]);if(re>=h.getSize()||!h.isRange(G,re,!1))throw new L;let le=M.toString();if(le.length<8)throw new Q;if(!ye.checkChecksum(le))throw new C;let xe=(b[1]+b[0])/2,we=(D[1]+D[0])/2,ve=this.getBarcodeFormat(),Le=[new _e(xe,u),new _e(we,u)],ke=new Ee(le,null,0,Le,ve,new Date().getTime()),Je=0;try{let qe=st.decodeRow(u,h,D[1]);ke.putMetadata(ze.UPC_EAN_EXTENSION,qe.getText()),ke.putAllMetadata(qe.getResultMetadata()),ke.addResultPoints(qe.getResultPoints()),Je=qe.getText().length}catch{}let tt=x==null?null:x.get(oe.ALLOWED_EAN_EXTENSIONS);if(tt!=null){let qe=!1;for(let $t in tt)if(Je.toString()===$t){qe=!0;break}if(!qe)throw new L}return ke}decodeEnd(u,h){return ye.findGuardPattern(u,h,!1,ye.START_END_PATTERN,new Int32Array(ye.START_END_PATTERN.length).fill(0))}static checkChecksum(u){return ye.checkStandardUPCEANChecksum(u)}static checkStandardUPCEANChecksum(u){let h=u.length;if(h===0)return!1;let x=parseInt(u.charAt(h-1),10);return ye.getStandardUPCEANChecksum(u.substring(0,h-1))===x}static getStandardUPCEANChecksum(u){let h=u.length,x=0;for(let b=h-1;b>=0;b-=2){let w=u.charAt(b).charCodeAt(0)-"0".charCodeAt(0);if(w<0||w>9)throw new Q;x+=w}x*=3;for(let b=h-2;b>=0;b-=2){let w=u.charAt(b).charCodeAt(0)-"0".charCodeAt(0);if(w<0||w>9)throw new Q;x+=w}return(1e3-x)%10}}class Xe extends ye{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(u,h,x){let b=this.decodeMiddleCounters;b[0]=0,b[1]=0,b[2]=0,b[3]=0;let w=u.getSize(),v=h[1],T=0;for(let D=0;D<6&&v<w;D++){let G=ye.decodeDigit(u,b,v,ye.L_AND_G_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+G%10);for(let re of b)v+=re;G>=10&&(T|=1<<5-D)}x=Xe.determineFirstDigit(x,T),v=ye.findGuardPattern(u,v,!0,ye.MIDDLE_PATTERN,new Int32Array(ye.MIDDLE_PATTERN.length).fill(0))[1];for(let D=0;D<6&&v<w;D++){let G=ye.decodeDigit(u,b,v,ye.L_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+G);for(let re of b)v+=re}return{rowOffset:v,resultString:x}}getBarcodeFormat(){return Te.EAN_13}static determineFirstDigit(u,h){for(let x=0;x<10;x++)if(h===this.FIRST_DIGIT_ENCODINGS[x])return u=String.fromCharCode("0".charCodeAt(0)+x)+u,u;throw new L}}Xe.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class ct extends ye{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(u,h,x){const b=this.decodeMiddleCounters;b[0]=0,b[1]=0,b[2]=0,b[3]=0;let w=u.getSize(),v=h[1];for(let M=0;M<4&&v<w;M++){let D=ye.decodeDigit(u,b,v,ye.L_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+D);for(let G of b)v+=G}v=ye.findGuardPattern(u,v,!0,ye.MIDDLE_PATTERN,new Int32Array(ye.MIDDLE_PATTERN.length).fill(0))[1];for(let M=0;M<4&&v<w;M++){let D=ye.decodeDigit(u,b,v,ye.L_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+D);for(let G of b)v+=G}return{rowOffset:v,resultString:x}}getBarcodeFormat(){return Te.EAN_8}}class mt extends ye{constructor(){super(...arguments),this.ean13Reader=new Xe}getBarcodeFormat(){return Te.UPC_A}decode(u,h){return this.maybeReturnResult(this.ean13Reader.decode(u))}decodeRow(u,h,x){return this.maybeReturnResult(this.ean13Reader.decodeRow(u,h,x))}decodeMiddle(u,h,x){return this.ean13Reader.decodeMiddle(u,h,x)}maybeReturnResult(u){let h=u.getText();if(h.charAt(0)==="0"){let x=new Ee(h.substring(1),null,null,u.getResultPoints(),Te.UPC_A);return u.getResultMetadata()!=null&&x.putAllMetadata(u.getResultMetadata()),x}else throw new L}reset(){this.ean13Reader.reset()}}class at extends ye{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(u,h,x){const b=this.decodeMiddleCounters.map(D=>D);b[0]=0,b[1]=0,b[2]=0,b[3]=0;const w=u.getSize();let v=h[1],T=0;for(let D=0;D<6&&v<w;D++){const G=at.decodeDigit(u,b,v,at.L_AND_G_PATTERNS);x+=String.fromCharCode("0".charCodeAt(0)+G%10);for(let re of b)v+=re;G>=10&&(T|=1<<5-D)}let M=at.determineNumSysAndCheckDigit(x,T);return{rowOffset:v,resultString:M}}decodeEnd(u,h){return at.findGuardPatternWithoutCounters(u,h,!0,at.MIDDLE_END_PATTERN)}checkChecksum(u){return ye.checkChecksum(at.convertUPCEtoUPCA(u))}static determineNumSysAndCheckDigit(u,h){for(let x=0;x<=1;x++)for(let b=0;b<10;b++)if(h===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[x][b]){let w=String.fromCharCode("0".charCodeAt(0)+x),v=String.fromCharCode("0".charCodeAt(0)+b);return w+u+v}throw L.getNotFoundInstance()}getBarcodeFormat(){return Te.UPC_E}static convertUPCEtoUPCA(u){const h=u.slice(1,7).split("").map(w=>w.charCodeAt(0)),x=new V;x.append(u.charAt(0));let b=h[5];switch(b){case 0:case 1:case 2:x.appendChars(h,0,2),x.append(b),x.append("0000"),x.appendChars(h,2,3);break;case 3:x.appendChars(h,0,3),x.append("00000"),x.appendChars(h,3,2);break;case 4:x.appendChars(h,0,4),x.append("00000"),x.append(h[4]);break;default:x.appendChars(h,0,5),x.append("0000"),x.append(b);break}return u.length>=8&&x.append(u.charAt(7)),x.toString()}}at.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),at.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class Vt extends Ae{constructor(u){super();let h=u==null?null:u.get(oe.POSSIBLE_FORMATS),x=[];o(h)?(x.push(new Xe),x.push(new mt),x.push(new ct),x.push(new at)):(h.indexOf(Te.EAN_13)>-1&&x.push(new Xe),h.indexOf(Te.UPC_A)>-1&&x.push(new mt),h.indexOf(Te.EAN_8)>-1&&x.push(new ct),h.indexOf(Te.UPC_E)>-1&&x.push(new at)),this.readers=x}decodeRow(u,h,x){for(let b of this.readers)try{const w=b.decodeRow(u,h,x),v=w.getBarcodeFormat()===Te.EAN_13&&w.getText().charAt(0)==="0",T=x==null?null:x.get(oe.POSSIBLE_FORMATS),M=T==null||T.includes(Te.UPC_A);if(v&&M){const D=w.getRawBytes(),G=new Ee(w.getText().substring(1),D,D?D.length:null,w.getResultPoints(),Te.UPC_A);return G.putAllMetadata(w.getResultMetadata()),G}return w}catch{}throw new L}reset(){for(let u of this.readers)u.reset()}}class xt extends Ae{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(u,h){for(let x=0;x<h.length;x++)if(Ae.patternMatchVariance(u,h[x],xt.MAX_INDIVIDUAL_VARIANCE)<xt.MAX_AVG_VARIANCE)return x;throw new L}static count(u){return he.sum(new Int32Array(u))}static increment(u,h){let x=0,b=h[0];for(let w=1;w<u.length;w++)h[w]>b&&(b=h[w],x=w);u[x]++}static decrement(u,h){let x=0,b=h[0];for(let w=1;w<u.length;w++)h[w]<b&&(b=h[w],x=w);u[x]--}static isFinderPattern(u){let h=u[0]+u[1],x=h+u[2]+u[3],b=h/x;if(b>=xt.MIN_FINDER_PATTERN_RATIO&&b<=xt.MAX_FINDER_PATTERN_RATIO){let w=Number.MAX_SAFE_INTEGER,v=Number.MIN_SAFE_INTEGER;for(let T of u)T>v&&(v=T),T<w&&(w=T);return v<10*w}return!1}}xt.MAX_AVG_VARIANCE=.2,xt.MAX_INDIVIDUAL_VARIANCE=.45,xt.MIN_FINDER_PATTERN_RATIO=9.5/12,xt.MAX_FINDER_PATTERN_RATIO=12.5/14;class It{constructor(u,h){this.value=u,this.checksumPortion=h}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(u){if(!(u instanceof It))return!1;const h=u;return this.value===h.value&&this.checksumPortion===h.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class tn{constructor(u,h,x,b,w){this.value=u,this.startEnd=h,this.value=u,this.startEnd=h,this.resultPoints=new Array,this.resultPoints.push(new _e(x,w)),this.resultPoints.push(new _e(b,w))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(u){if(!(u instanceof tn))return!1;const h=u;return this.value===h.value}hashCode(){return this.value}}class bt{constructor(){}static getRSSvalue(u,h,x){let b=0;for(let M of u)b+=M;let w=0,v=0,T=u.length;for(let M=0;M<T-1;M++){let D;for(D=1,v|=1<<M;D<u[M];D++,v&=~(1<<M)){let G=bt.combins(b-D-1,T-M-2);if(x&&v===0&&b-D-(T-M-1)>=T-M-1&&(G-=bt.combins(b-D-(T-M),T-M-2)),T-M-1>1){let re=0;for(let le=b-D-(T-M-2);le>h;le--)re+=bt.combins(b-D-le-1,T-M-3);G-=re*(T-1-M)}else b-D>h&&G--;w+=G}b-=D}return w}static combins(u,h){let x,b;u-h>h?(b=h,x=u-h):(b=u-h,x=h);let w=1,v=1;for(let T=u;T>x;T--)w*=T,v<=b&&(w/=v,v++);for(;v<=b;)w/=v,v++;return w}}class Dt{static buildBitArray(u){let h=u.length*2-1;u[u.length-1].getRightChar()==null&&(h-=1);let x=12*h,b=new H(x),w=0,T=u[0].getRightChar().getValue();for(let M=11;M>=0;--M)T&1<<M&&b.set(w),w++;for(let M=1;M<u.length;++M){let D=u[M],G=D.getLeftChar().getValue();for(let re=11;re>=0;--re)G&1<<re&&b.set(w),w++;if(D.getRightChar()!=null){let re=D.getRightChar().getValue();for(let le=11;le>=0;--le)re&1<<le&&b.set(w),w++}}return b}}class on{constructor(u,h){h?this.decodedInformation=null:(this.finished=u,this.decodedInformation=h)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Wt{constructor(u){this.newPosition=u}getNewPosition(){return this.newPosition}}class kt extends Wt{constructor(u,h){super(u),this.value=h}getValue(){return this.value}isFNC1(){return this.value===kt.FNC1}}kt.FNC1="$";class yn extends Wt{constructor(u,h,x){super(u),x?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=h}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Ut extends Wt{constructor(u,h,x){if(super(u),h<0||h>10||x<0||x>10)throw new Q;this.firstDigit=h,this.secondDigit=x}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Ut.FNC1}isSecondDigitFNC1(){return this.secondDigit===Ut.FNC1}isAnyFNC1(){return this.firstDigit===Ut.FNC1||this.secondDigit===Ut.FNC1}}Ut.FNC1=10;class Qe{constructor(){}static parseFieldsInGeneralPurpose(u){if(!u)return null;if(u.length<2)throw new L;let h=u.substring(0,2);for(let w of Qe.TWO_DIGIT_DATA_LENGTH)if(w[0]===h)return w[1]===Qe.VARIABLE_LENGTH?Qe.processVariableAI(2,w[2],u):Qe.processFixedAI(2,w[1],u);if(u.length<3)throw new L;let x=u.substring(0,3);for(let w of Qe.THREE_DIGIT_DATA_LENGTH)if(w[0]===x)return w[1]===Qe.VARIABLE_LENGTH?Qe.processVariableAI(3,w[2],u):Qe.processFixedAI(3,w[1],u);for(let w of Qe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(w[0]===x)return w[1]===Qe.VARIABLE_LENGTH?Qe.processVariableAI(4,w[2],u):Qe.processFixedAI(4,w[1],u);if(u.length<4)throw new L;let b=u.substring(0,4);for(let w of Qe.FOUR_DIGIT_DATA_LENGTH)if(w[0]===b)return w[1]===Qe.VARIABLE_LENGTH?Qe.processVariableAI(4,w[2],u):Qe.processFixedAI(4,w[1],u);throw new L}static processFixedAI(u,h,x){if(x.length<u)throw new L;let b=x.substring(0,u);if(x.length<u+h)throw new L;let w=x.substring(u,u+h),v=x.substring(u+h),T="("+b+")"+w,M=Qe.parseFieldsInGeneralPurpose(v);return M==null?T:T+M}static processVariableAI(u,h,x){let b=x.substring(0,u),w;x.length<u+h?w=x.length:w=u+h;let v=x.substring(u,w),T=x.substring(w),M="("+b+")"+v,D=Qe.parseFieldsInGeneralPurpose(T);return D==null?M:M+D}}Qe.VARIABLE_LENGTH=[],Qe.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Qe.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Qe.VARIABLE_LENGTH,20],["22",Qe.VARIABLE_LENGTH,29],["30",Qe.VARIABLE_LENGTH,8],["37",Qe.VARIABLE_LENGTH,8],["90",Qe.VARIABLE_LENGTH,30],["91",Qe.VARIABLE_LENGTH,30],["92",Qe.VARIABLE_LENGTH,30],["93",Qe.VARIABLE_LENGTH,30],["94",Qe.VARIABLE_LENGTH,30],["95",Qe.VARIABLE_LENGTH,30],["96",Qe.VARIABLE_LENGTH,30],["97",Qe.VARIABLE_LENGTH,3],["98",Qe.VARIABLE_LENGTH,30],["99",Qe.VARIABLE_LENGTH,30]],Qe.THREE_DIGIT_DATA_LENGTH=[["240",Qe.VARIABLE_LENGTH,30],["241",Qe.VARIABLE_LENGTH,30],["242",Qe.VARIABLE_LENGTH,6],["250",Qe.VARIABLE_LENGTH,30],["251",Qe.VARIABLE_LENGTH,30],["253",Qe.VARIABLE_LENGTH,17],["254",Qe.VARIABLE_LENGTH,20],["400",Qe.VARIABLE_LENGTH,30],["401",Qe.VARIABLE_LENGTH,30],["402",17],["403",Qe.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Qe.VARIABLE_LENGTH,20],["421",Qe.VARIABLE_LENGTH,15],["422",3],["423",Qe.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Qe.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Qe.VARIABLE_LENGTH,15],["391",Qe.VARIABLE_LENGTH,18],["392",Qe.VARIABLE_LENGTH,15],["393",Qe.VARIABLE_LENGTH,18],["703",Qe.VARIABLE_LENGTH,30]],Qe.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Qe.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Qe.VARIABLE_LENGTH,20],["8003",Qe.VARIABLE_LENGTH,30],["8004",Qe.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Qe.VARIABLE_LENGTH,30],["8008",Qe.VARIABLE_LENGTH,12],["8018",18],["8020",Qe.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Qe.VARIABLE_LENGTH,70],["8200",Qe.VARIABLE_LENGTH,70]];class An{constructor(u){this.buffer=new V,this.information=u}decodeAllCodes(u,h){let x=h,b=null;do{let w=this.decodeGeneralPurposeField(x,b),v=Qe.parseFieldsInGeneralPurpose(w.getNewString());if(v!=null&&u.append(v),w.isRemaining()?b=""+w.getRemainingValue():b=null,x===w.getNewPosition())break;x=w.getNewPosition()}while(!0);return u.toString()}isStillNumeric(u){if(u+7>this.information.getSize())return u+4<=this.information.getSize();for(let h=u;h<u+3;++h)if(this.information.get(h))return!0;return this.information.get(u+3)}decodeNumeric(u){if(u+7>this.information.getSize()){let w=this.extractNumericValueFromBitArray(u,4);return w===0?new Ut(this.information.getSize(),Ut.FNC1,Ut.FNC1):new Ut(this.information.getSize(),w-1,Ut.FNC1)}let h=this.extractNumericValueFromBitArray(u,7),x=(h-8)/11,b=(h-8)%11;return new Ut(u+7,x,b)}extractNumericValueFromBitArray(u,h){return An.extractNumericValueFromBitArray(this.information,u,h)}static extractNumericValueFromBitArray(u,h,x){let b=0;for(let w=0;w<x;++w)u.get(h+w)&&(b|=1<<x-w-1);return b}decodeGeneralPurposeField(u,h){this.buffer.setLengthToZero(),h!=null&&this.buffer.append(h),this.current.setPosition(u);let x=this.parseBlocks();return x!=null&&x.isRemaining()?new yn(this.current.getPosition(),this.buffer.toString(),x.getRemainingValue()):new yn(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let u,h;do{let x=this.current.getPosition();if(this.current.isAlpha()?(h=this.parseAlphaBlock(),u=h.isFinished()):this.current.isIsoIec646()?(h=this.parseIsoIec646Block(),u=h.isFinished()):(h=this.parseNumericBlock(),u=h.isFinished()),!(x!==this.current.getPosition())&&!u)break}while(!u);return h.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let u=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(u.getNewPosition()),u.isFirstDigitFNC1()){let h;return u.isSecondDigitFNC1()?h=new yn(this.current.getPosition(),this.buffer.toString()):h=new yn(this.current.getPosition(),this.buffer.toString(),u.getSecondDigit()),new on(!0,h)}if(this.buffer.append(u.getFirstDigit()),u.isSecondDigitFNC1()){let h=new yn(this.current.getPosition(),this.buffer.toString());return new on(!0,h)}this.buffer.append(u.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new on(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let u=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(u.getNewPosition()),u.isFNC1()){let h=new yn(this.current.getPosition(),this.buffer.toString());return new on(!0,h)}this.buffer.append(u.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new on(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let u=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(u.getNewPosition()),u.isFNC1()){let h=new yn(this.current.getPosition(),this.buffer.toString());return new on(!0,h)}this.buffer.append(u.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new on(!1)}isStillIsoIec646(u){if(u+5>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(u,5);if(h>=5&&h<16)return!0;if(u+7>this.information.getSize())return!1;let x=this.extractNumericValueFromBitArray(u,7);if(x>=64&&x<116)return!0;if(u+8>this.information.getSize())return!1;let b=this.extractNumericValueFromBitArray(u,8);return b>=232&&b<253}decodeIsoIec646(u){let h=this.extractNumericValueFromBitArray(u,5);if(h===15)return new kt(u+5,kt.FNC1);if(h>=5&&h<15)return new kt(u+5,"0"+(h-5));let x=this.extractNumericValueFromBitArray(u,7);if(x>=64&&x<90)return new kt(u+7,""+(x+1));if(x>=90&&x<116)return new kt(u+7,""+(x+7));let b=this.extractNumericValueFromBitArray(u,8),w;switch(b){case 232:w="!";break;case 233:w='"';break;case 234:w="%";break;case 235:w="&";break;case 236:w="'";break;case 237:w="(";break;case 238:w=")";break;case 239:w="*";break;case 240:w="+";break;case 241:w=",";break;case 242:w="-";break;case 243:w=".";break;case 244:w="/";break;case 245:w=":";break;case 246:w=";";break;case 247:w="<";break;case 248:w="=";break;case 249:w=">";break;case 250:w="?";break;case 251:w="_";break;case 252:w=" ";break;default:throw new Q}return new kt(u+8,w)}isStillAlpha(u){if(u+5>this.information.getSize())return!1;let h=this.extractNumericValueFromBitArray(u,5);if(h>=5&&h<16)return!0;if(u+6>this.information.getSize())return!1;let x=this.extractNumericValueFromBitArray(u,6);return x>=16&&x<63}decodeAlphanumeric(u){let h=this.extractNumericValueFromBitArray(u,5);if(h===15)return new kt(u+5,kt.FNC1);if(h>=5&&h<15)return new kt(u+5,"0"+(h-5));let x=this.extractNumericValueFromBitArray(u,6);if(x>=32&&x<58)return new kt(u+6,""+(x+33));let b;switch(x){case 58:b="*";break;case 59:b=",";break;case 60:b="-";break;case 61:b=".";break;case 62:b="/";break;default:throw new nt("Decoding invalid alphanumeric value: "+x)}return new kt(u+6,b)}isAlphaTo646ToAlphaLatch(u){if(u+1>this.information.getSize())return!1;for(let h=0;h<5&&h+u<this.information.getSize();++h)if(h===2){if(!this.information.get(u+2))return!1}else if(this.information.get(u+h))return!1;return!0}isAlphaOr646ToNumericLatch(u){if(u+3>this.information.getSize())return!1;for(let h=u;h<u+3;++h)if(this.information.get(h))return!1;return!0}isNumericToAlphaNumericLatch(u){if(u+1>this.information.getSize())return!1;for(let h=0;h<4&&h+u<this.information.getSize();++h)if(this.information.get(u+h))return!1;return!0}}class Kt{constructor(u){this.information=u,this.generalDecoder=new An(u)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Ft extends Kt{constructor(u){super(u)}encodeCompressedGtin(u,h){u.append("(01)");let x=u.length();u.append("9"),this.encodeCompressedGtinWithoutAI(u,h,x)}encodeCompressedGtinWithoutAI(u,h,x){for(let b=0;b<4;++b){let w=this.getGeneralDecoder().extractNumericValueFromBitArray(h+10*b,10);w/100===0&&u.append("0"),w/10===0&&u.append("0"),u.append(w)}Ft.appendCheckDigit(u,x)}static appendCheckDigit(u,h){let x=0;for(let b=0;b<13;b++){let w=u.charAt(b+h).charCodeAt(0)-"0".charCodeAt(0);x+=b&1?w:3*w}x=10-x%10,x===10&&(x=0),u.append(x)}}Ft.GTIN_SIZE=40;class Mn extends Ft{constructor(u){super(u)}parseInformation(){let u=new V;u.append("(01)");let h=u.length(),x=this.getGeneralDecoder().extractNumericValueFromBitArray(Mn.HEADER_SIZE,4);return u.append(x),this.encodeCompressedGtinWithoutAI(u,Mn.HEADER_SIZE+4,h),this.getGeneralDecoder().decodeAllCodes(u,Mn.HEADER_SIZE+44)}}Mn.HEADER_SIZE=1+1+2;class Xt extends Kt{constructor(u){super(u)}parseInformation(){let u=new V;return this.getGeneralDecoder().decodeAllCodes(u,Xt.HEADER_SIZE)}}Xt.HEADER_SIZE=2+1+2;class de extends Ft{constructor(u){super(u)}encodeCompressedWeight(u,h,x){let b=this.getGeneralDecoder().extractNumericValueFromBitArray(h,x);this.addWeightCode(u,b);let w=this.checkWeight(b),v=1e5;for(let T=0;T<5;++T)w/v===0&&u.append("0"),v/=10;u.append(w)}}class Me extends de{constructor(u){super(u)}parseInformation(){if(this.getInformation().getSize()!=Me.HEADER_SIZE+de.GTIN_SIZE+Me.WEIGHT_SIZE)throw new L;let u=new V;return this.encodeCompressedGtin(u,Me.HEADER_SIZE),this.encodeCompressedWeight(u,Me.HEADER_SIZE+de.GTIN_SIZE,Me.WEIGHT_SIZE),u.toString()}}Me.HEADER_SIZE=4+1,Me.WEIGHT_SIZE=15;class De extends Me{constructor(u){super(u)}addWeightCode(u,h){u.append("(3103)")}checkWeight(u){return u}}class Fe extends Me{constructor(u){super(u)}addWeightCode(u,h){h<1e4?u.append("(3202)"):u.append("(3203)")}checkWeight(u){return u<1e4?u:u-1e4}}class Pe extends Ft{constructor(u){super(u)}parseInformation(){if(this.getInformation().getSize()<Pe.HEADER_SIZE+Ft.GTIN_SIZE)throw new L;let u=new V;this.encodeCompressedGtin(u,Pe.HEADER_SIZE);let h=this.getGeneralDecoder().extractNumericValueFromBitArray(Pe.HEADER_SIZE+Ft.GTIN_SIZE,Pe.LAST_DIGIT_SIZE);u.append("(392"),u.append(h),u.append(")");let x=this.getGeneralDecoder().decodeGeneralPurposeField(Pe.HEADER_SIZE+Ft.GTIN_SIZE+Pe.LAST_DIGIT_SIZE,null);return u.append(x.getNewString()),u.toString()}}Pe.HEADER_SIZE=5+1+2,Pe.LAST_DIGIT_SIZE=2;class rt extends Ft{constructor(u){super(u)}parseInformation(){if(this.getInformation().getSize()<rt.HEADER_SIZE+Ft.GTIN_SIZE)throw new L;let u=new V;this.encodeCompressedGtin(u,rt.HEADER_SIZE);let h=this.getGeneralDecoder().extractNumericValueFromBitArray(rt.HEADER_SIZE+Ft.GTIN_SIZE,rt.LAST_DIGIT_SIZE);u.append("(393"),u.append(h),u.append(")");let x=this.getGeneralDecoder().extractNumericValueFromBitArray(rt.HEADER_SIZE+Ft.GTIN_SIZE+rt.LAST_DIGIT_SIZE,rt.FIRST_THREE_DIGITS_SIZE);x/100==0&&u.append("0"),x/10==0&&u.append("0"),u.append(x);let b=this.getGeneralDecoder().decodeGeneralPurposeField(rt.HEADER_SIZE+Ft.GTIN_SIZE+rt.LAST_DIGIT_SIZE+rt.FIRST_THREE_DIGITS_SIZE,null);return u.append(b.getNewString()),u.toString()}}rt.HEADER_SIZE=5+1+2,rt.LAST_DIGIT_SIZE=2,rt.FIRST_THREE_DIGITS_SIZE=10;class ot extends de{constructor(u,h,x){super(u),this.dateCode=x,this.firstAIdigits=h}parseInformation(){if(this.getInformation().getSize()!=ot.HEADER_SIZE+ot.GTIN_SIZE+ot.WEIGHT_SIZE+ot.DATE_SIZE)throw new L;let u=new V;return this.encodeCompressedGtin(u,ot.HEADER_SIZE),this.encodeCompressedWeight(u,ot.HEADER_SIZE+ot.GTIN_SIZE,ot.WEIGHT_SIZE),this.encodeCompressedDate(u,ot.HEADER_SIZE+ot.GTIN_SIZE+ot.WEIGHT_SIZE),u.toString()}encodeCompressedDate(u,h){let x=this.getGeneralDecoder().extractNumericValueFromBitArray(h,ot.DATE_SIZE);if(x==38400)return;u.append("("),u.append(this.dateCode),u.append(")");let b=x%32;x/=32;let w=x%12+1;x/=12;let v=x;v/10==0&&u.append("0"),u.append(v),w/10==0&&u.append("0"),u.append(w),b/10==0&&u.append("0"),u.append(b)}addWeightCode(u,h){u.append("("),u.append(this.firstAIdigits),u.append(h/1e5),u.append(")")}checkWeight(u){return u%1e5}}ot.HEADER_SIZE=7+1,ot.WEIGHT_SIZE=20,ot.DATE_SIZE=16;function St(ne){try{if(ne.get(1))return new Mn(ne);if(!ne.get(2))return new Xt(ne);switch(An.extractNumericValueFromBitArray(ne,1,4)){case 4:return new De(ne);case 5:return new Fe(ne)}switch(An.extractNumericValueFromBitArray(ne,1,5)){case 12:return new Pe(ne);case 13:return new rt(ne)}switch(An.extractNumericValueFromBitArray(ne,1,7)){case 56:return new ot(ne,"310","11");case 57:return new ot(ne,"320","11");case 58:return new ot(ne,"310","13");case 59:return new ot(ne,"320","13");case 60:return new ot(ne,"310","15");case 61:return new ot(ne,"320","15");case 62:return new ot(ne,"310","17");case 63:return new ot(ne,"320","17")}}catch(u){throw console.log(u),new nt("unknown decoder: "+ne)}}class Et{constructor(u,h,x,b){this.leftchar=u,this.rightchar=h,this.finderpattern=x,this.maybeLast=b}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(u,h){return u instanceof Et?Et.equalsOrNull(u.leftchar,h.leftchar)&&Et.equalsOrNull(u.rightchar,h.rightchar)&&Et.equalsOrNull(u.finderpattern,h.finderpattern):!1}static equalsOrNull(u,h){return u===null?h===null:Et.equals(u,h)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Rt{constructor(u,h,x){this.pairs=u,this.rowNumber=h,this.wasReversed=x}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(u){return this.checkEqualitity(this,u)}toString(){return"{ "+this.pairs+" }"}equals(u,h){return u instanceof Rt?this.checkEqualitity(u,h)&&u.wasReversed===h.wasReversed:!1}checkEqualitity(u,h){if(!u||!h)return;let x;return u.forEach((b,w)=>{h.forEach(v=>{b.getLeftChar().getValue()===v.getLeftChar().getValue()&&b.getRightChar().getValue()===v.getRightChar().getValue()&&b.getFinderPatter().getValue()===v.getFinderPatter().getValue()&&(x=!0)})}),x}}class Oe extends xt{constructor(u){super(...arguments),this.pairs=new Array(Oe.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=u===!0}decodeRow(u,h,x){this.pairs.length=0,this.startFromEven=!1;try{return Oe.constructResult(this.decodeRow2pairs(u,h))}catch(b){this.verbose&&console.log(b)}return this.pairs.length=0,this.startFromEven=!0,Oe.constructResult(this.decodeRow2pairs(u,h))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(u,h){let x=!1;for(;!x;)try{this.pairs.push(this.retrieveNextPair(h,this.pairs,u))}catch(w){if(w instanceof L){if(!this.pairs.length)throw new L;x=!0}}if(this.checkChecksum())return this.pairs;let b;if(this.rows.length?b=!0:b=!1,this.storeRow(u,!1),b){let w=this.checkRowsBoolean(!1);if(w!=null||(w=this.checkRowsBoolean(!0),w!=null))return w}throw new L}checkRowsBoolean(u){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,u&&(this.rows=this.rows.reverse());let h=null;try{h=this.checkRows(new Array,0)}catch(x){this.verbose&&console.log(x)}return u&&(this.rows=this.rows.reverse()),h}checkRows(u,h){for(let x=h;x<this.rows.length;x++){let b=this.rows[x];this.pairs.length=0;for(let v of u)this.pairs.push(v.getPairs());if(this.pairs.push(b.getPairs()),!Oe.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let w=new Array(u);w.push(b);try{return this.checkRows(w,x+1)}catch(v){this.verbose&&console.log(v)}}throw new L}static isValidSequence(u){for(let h of Oe.FINDER_PATTERN_SEQUENCES){if(u.length>h.length)continue;let x=!0;for(let b=0;b<u.length;b++)if(u[b].getFinderPattern().getValue()!=h[b]){x=!1;break}if(x)return!0}return!1}storeRow(u,h){let x=0,b=!1,w=!1;for(;x<this.rows.length;){let v=this.rows[x];if(v.getRowNumber()>u){w=v.isEquivalent(this.pairs);break}b=v.isEquivalent(this.pairs),x++}w||b||Oe.isPartialRow(this.pairs,this.rows)||(this.rows.push(x,new Rt(this.pairs,u,h)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(u,h){for(let x of h)if(x.getPairs().length!==u.length){for(let b of x.getPairs())for(let w of u)if(Et.equals(b,w))break}}static isPartialRow(u,h){for(let x of h){let b=!0;for(let w of u){let v=!1;for(let T of x.getPairs())if(w.equals(T)){v=!0;break}if(!v){b=!1;break}}if(b)return!0}return!1}getRows(){return this.rows}static constructResult(u){let h=Dt.buildBitArray(u),b=St(h).parseInformation(),w=u[0].getFinderPattern().getResultPoints(),v=u[u.length-1].getFinderPattern().getResultPoints(),T=[w[0],w[1],v[0],v[1]];return new Ee(b,null,null,T,Te.RSS_EXPANDED,null)}checkChecksum(){let u=this.pairs.get(0),h=u.getLeftChar(),x=u.getRightChar();if(x==null)return!1;let b=x.getChecksumPortion(),w=2;for(let T=1;T<this.pairs.size();++T){let M=this.pairs.get(T);b+=M.getLeftChar().getChecksumPortion(),w++;let D=M.getRightChar();D!=null&&(b+=D.getChecksumPortion(),w++)}return b%=211,211*(w-4)+b==h.getValue()}static getNextSecondBar(u,h){let x;return u.get(h)?(x=u.getNextUnset(h),x=u.getNextSet(x)):(x=u.getNextSet(h),x=u.getNextUnset(x)),x}retrieveNextPair(u,h,x){let b=h.length%2==0;this.startFromEven&&(b=!b);let w,v=!0,T=-1;do this.findNextPair(u,h,T),w=this.parseFoundFinderPattern(u,x,b),w==null?T=Oe.getNextSecondBar(u,this.startEnd[0]):v=!1;while(v);let M=this.decodeDataCharacter(u,w,b,!0);if(!this.isEmptyPair(h)&&h[h.length-1].mustBeLast())throw new L;let D;try{D=this.decodeDataCharacter(u,w,b,!1)}catch(G){D=null,this.verbose&&console.log(G)}return new Et(M,D,w,!0)}isEmptyPair(u){return u.length===0}findNextPair(u,h,x){let b=this.getDecodeFinderCounters();b[0]=0,b[1]=0,b[2]=0,b[3]=0;let w=u.getSize(),v;x>=0?v=x:this.isEmptyPair(h)?v=0:v=h[h.length-1].getFinderPattern().getStartEnd()[1];let T=h.length%2!=0;this.startFromEven&&(T=!T);let M=!1;for(;v<w&&(M=!u.get(v),!!M);)v++;let D=0,G=v;for(let re=v;re<w;re++)if(u.get(re)!=M)b[D]++;else{if(D==3){if(T&&Oe.reverseCounters(b),Oe.isFinderPattern(b)){this.startEnd[0]=G,this.startEnd[1]=re;return}T&&Oe.reverseCounters(b),G+=b[0]+b[1],b[0]=b[2],b[1]=b[3],b[2]=0,b[3]=0,D--}else D++;b[D]=1,M=!M}throw new L}static reverseCounters(u){let h=u.length;for(let x=0;x<h/2;++x){let b=u[x];u[x]=u[h-x-1],u[h-x-1]=b}}parseFoundFinderPattern(u,h,x){let b,w,v;if(x){let D=this.startEnd[0]-1;for(;D>=0&&!u.get(D);)D--;D++,b=this.startEnd[0]-D,w=D,v=this.startEnd[1]}else w=this.startEnd[0],v=u.getNextUnset(this.startEnd[1]+1),b=v-this.startEnd[1];let T=this.getDecodeFinderCounters();O.arraycopy(T,0,T,1,T.length-1),T[0]=b;let M;try{M=this.parseFinderValue(T,Oe.FINDER_PATTERNS)}catch{return null}return new tn(M,[w,v],w,v,h)}decodeDataCharacter(u,h,x,b){let w=this.getDataCharacterCounters();for(let Yt=0;Yt<w.length;Yt++)w[Yt]=0;if(b)Oe.recordPatternInReverse(u,h.getStartEnd()[0],w);else{Oe.recordPattern(u,h.getStartEnd()[1],w);for(let Yt=0,gn=w.length-1;Yt<gn;Yt++,gn--){let vn=w[Yt];w[Yt]=w[gn],w[gn]=vn}}let v=17,T=he.sum(new Int32Array(w))/v,M=(h.getStartEnd()[1]-h.getStartEnd()[0])/15;if(Math.abs(T-M)/M>.3)throw new L;let D=this.getOddCounts(),G=this.getEvenCounts(),re=this.getOddRoundingErrors(),le=this.getEvenRoundingErrors();for(let Yt=0;Yt<w.length;Yt++){let gn=1*w[Yt]/T,vn=gn+.5;if(vn<1){if(gn<.3)throw new L;vn=1}else if(vn>8){if(gn>8.7)throw new L;vn=8}let jn=Yt/2;Yt&1?(G[jn]=vn,le[jn]=gn-vn):(D[jn]=vn,re[jn]=gn-vn)}this.adjustOddEvenCounts(v);let xe=4*h.getValue()+(x?0:2)+(b?0:1)-1,we=0,ve=0;for(let Yt=D.length-1;Yt>=0;Yt--){if(Oe.isNotA1left(h,x,b)){let gn=Oe.WEIGHTS[xe][2*Yt];ve+=D[Yt]*gn}we+=D[Yt]}let Le=0;for(let Yt=G.length-1;Yt>=0;Yt--)if(Oe.isNotA1left(h,x,b)){let gn=Oe.WEIGHTS[xe][2*Yt+1];Le+=G[Yt]*gn}let ke=ve+Le;if(we&1||we>13||we<4)throw new L;let Je=(13-we)/2,tt=Oe.SYMBOL_WIDEST[Je],qe=9-tt,$t=bt.getRSSvalue(D,tt,!0),Nt=bt.getRSSvalue(G,qe,!1),wn=Oe.EVEN_TOTAL_SUBSET[Je],Nn=Oe.GSUM[Je],Sn=$t*wn+Nt+Nn;return new It(Sn,ke)}static isNotA1left(u,h,x){return!(u.getValue()==0&&h&&x)}adjustOddEvenCounts(u){let h=he.sum(new Int32Array(this.getOddCounts())),x=he.sum(new Int32Array(this.getEvenCounts())),b=!1,w=!1;h>13?w=!0:h<4&&(b=!0);let v=!1,T=!1;x>13?T=!0:x<4&&(v=!0);let M=h+x-u,D=(h&1)==1,G=(x&1)==0;if(M==1)if(D){if(G)throw new L;w=!0}else{if(!G)throw new L;T=!0}else if(M==-1)if(D){if(G)throw new L;b=!0}else{if(!G)throw new L;v=!0}else if(M==0){if(D){if(!G)throw new L;h<x?(b=!0,T=!0):(w=!0,v=!0)}else if(G)throw new L}else throw new L;if(b){if(w)throw new L;Oe.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(w&&Oe.decrement(this.getOddCounts(),this.getOddRoundingErrors()),v){if(T)throw new L;Oe.increment(this.getEvenCounts(),this.getOddRoundingErrors())}T&&Oe.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Oe.SYMBOL_WIDEST=[7,5,4,3,1],Oe.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Oe.GSUM=[0,348,1388,2948,3988],Oe.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Oe.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Oe.FINDER_PAT_A=0,Oe.FINDER_PAT_B=1,Oe.FINDER_PAT_C=2,Oe.FINDER_PAT_D=3,Oe.FINDER_PAT_E=4,Oe.FINDER_PAT_F=5,Oe.FINDER_PATTERN_SEQUENCES=[[Oe.FINDER_PAT_A,Oe.FINDER_PAT_A],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_B,Oe.FINDER_PAT_B],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_C,Oe.FINDER_PAT_B,Oe.FINDER_PAT_D],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_E,Oe.FINDER_PAT_B,Oe.FINDER_PAT_D,Oe.FINDER_PAT_C],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_E,Oe.FINDER_PAT_B,Oe.FINDER_PAT_D,Oe.FINDER_PAT_D,Oe.FINDER_PAT_F],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_E,Oe.FINDER_PAT_B,Oe.FINDER_PAT_D,Oe.FINDER_PAT_E,Oe.FINDER_PAT_F,Oe.FINDER_PAT_F],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_A,Oe.FINDER_PAT_B,Oe.FINDER_PAT_B,Oe.FINDER_PAT_C,Oe.FINDER_PAT_C,Oe.FINDER_PAT_D,Oe.FINDER_PAT_D],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_A,Oe.FINDER_PAT_B,Oe.FINDER_PAT_B,Oe.FINDER_PAT_C,Oe.FINDER_PAT_C,Oe.FINDER_PAT_D,Oe.FINDER_PAT_E,Oe.FINDER_PAT_E],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_A,Oe.FINDER_PAT_B,Oe.FINDER_PAT_B,Oe.FINDER_PAT_C,Oe.FINDER_PAT_C,Oe.FINDER_PAT_D,Oe.FINDER_PAT_E,Oe.FINDER_PAT_F,Oe.FINDER_PAT_F],[Oe.FINDER_PAT_A,Oe.FINDER_PAT_A,Oe.FINDER_PAT_B,Oe.FINDER_PAT_B,Oe.FINDER_PAT_C,Oe.FINDER_PAT_D,Oe.FINDER_PAT_D,Oe.FINDER_PAT_E,Oe.FINDER_PAT_E,Oe.FINDER_PAT_F,Oe.FINDER_PAT_F]],Oe.MAX_PAIRS=11;class Mt extends It{constructor(u,h,x){super(u,h),this.count=0,this.finderPattern=x}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Ct extends xt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(u,h,x){const b=this.decodePair(h,!1,u,x);Ct.addOrTally(this.possibleLeftPairs,b),h.reverse();let w=this.decodePair(h,!0,u,x);Ct.addOrTally(this.possibleRightPairs,w),h.reverse();for(let v of this.possibleLeftPairs)if(v.getCount()>1){for(let T of this.possibleRightPairs)if(T.getCount()>1&&Ct.checkChecksum(v,T))return Ct.constructResult(v,T)}throw new L}static addOrTally(u,h){if(h==null)return;let x=!1;for(let b of u)if(b.getValue()===h.getValue()){b.incrementCount(),x=!0;break}x||u.push(h)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(u,h){let x=4537077*u.getValue()+h.getValue(),b=new String(x).toString(),w=new V;for(let D=13-b.length;D>0;D--)w.append("0");w.append(b);let v=0;for(let D=0;D<13;D++){let G=w.charAt(D).charCodeAt(0)-"0".charCodeAt(0);v+=D&1?G:3*G}v=10-v%10,v===10&&(v=0),w.append(v.toString());let T=u.getFinderPattern().getResultPoints(),M=h.getFinderPattern().getResultPoints();return new Ee(w.toString(),null,0,[T[0],T[1],M[0],M[1]],Te.RSS_14,new Date().getTime())}static checkChecksum(u,h){let x=(u.getChecksumPortion()+16*h.getChecksumPortion())%79,b=9*u.getFinderPattern().getValue()+h.getFinderPattern().getValue();return b>72&&b--,b>8&&b--,x===b}decodePair(u,h,x,b){try{let w=this.findFinderPattern(u,h),v=this.parseFoundFinderPattern(u,x,h,w),T=b==null?null:b.get(oe.NEED_RESULT_POINT_CALLBACK);if(T!=null){let G=(w[0]+w[1])/2;h&&(G=u.getSize()-1-G),T.foundPossibleResultPoint(new _e(G,x))}let M=this.decodeDataCharacter(u,v,!0),D=this.decodeDataCharacter(u,v,!1);return new Mt(1597*M.getValue()+D.getValue(),M.getChecksumPortion()+4*D.getChecksumPortion(),v)}catch{return null}}decodeDataCharacter(u,h,x){let b=this.getDataCharacterCounters();for(let Le=0;Le<b.length;Le++)b[Le]=0;if(x)Ae.recordPatternInReverse(u,h.getStartEnd()[0],b);else{Ae.recordPattern(u,h.getStartEnd()[1]+1,b);for(let Le=0,ke=b.length-1;Le<ke;Le++,ke--){let Je=b[Le];b[Le]=b[ke],b[ke]=Je}}let w=x?16:15,v=he.sum(new Int32Array(b))/w,T=this.getOddCounts(),M=this.getEvenCounts(),D=this.getOddRoundingErrors(),G=this.getEvenRoundingErrors();for(let Le=0;Le<b.length;Le++){let ke=b[Le]/v,Je=Math.floor(ke+.5);Je<1?Je=1:Je>8&&(Je=8);let tt=Math.floor(Le/2);Le&1?(M[tt]=Je,G[tt]=ke-Je):(T[tt]=Je,D[tt]=ke-Je)}this.adjustOddEvenCounts(x,w);let re=0,le=0;for(let Le=T.length-1;Le>=0;Le--)le*=9,le+=T[Le],re+=T[Le];let xe=0,we=0;for(let Le=M.length-1;Le>=0;Le--)xe*=9,xe+=M[Le],we+=M[Le];let ve=le+3*xe;if(x){if(re&1||re>12||re<4)throw new L;let Le=(12-re)/2,ke=Ct.OUTSIDE_ODD_WIDEST[Le],Je=9-ke,tt=bt.getRSSvalue(T,ke,!1),qe=bt.getRSSvalue(M,Je,!0),$t=Ct.OUTSIDE_EVEN_TOTAL_SUBSET[Le],Nt=Ct.OUTSIDE_GSUM[Le];return new It(tt*$t+qe+Nt,ve)}else{if(we&1||we>10||we<4)throw new L;let Le=(10-we)/2,ke=Ct.INSIDE_ODD_WIDEST[Le],Je=9-ke,tt=bt.getRSSvalue(T,ke,!0),qe=bt.getRSSvalue(M,Je,!1),$t=Ct.INSIDE_ODD_TOTAL_SUBSET[Le],Nt=Ct.INSIDE_GSUM[Le];return new It(qe*$t+tt+Nt,ve)}}findFinderPattern(u,h){let x=this.getDecodeFinderCounters();x[0]=0,x[1]=0,x[2]=0,x[3]=0;let b=u.getSize(),w=!1,v=0;for(;v<b&&(w=!u.get(v),h!==w);)v++;let T=0,M=v;for(let D=v;D<b;D++)if(u.get(D)!==w)x[T]++;else{if(T===3){if(xt.isFinderPattern(x))return[M,D];M+=x[0]+x[1],x[0]=x[2],x[1]=x[3],x[2]=0,x[3]=0,T--}else T++;x[T]=1,w=!w}throw new L}parseFoundFinderPattern(u,h,x,b){let w=u.get(b[0]),v=b[0]-1;for(;v>=0&&w!==u.get(v);)v--;v++;const T=b[0]-v,M=this.getDecodeFinderCounters(),D=new Int32Array(M.length);O.arraycopy(M,0,D,1,M.length-1),D[0]=T;const G=this.parseFinderValue(D,Ct.FINDER_PATTERNS);let re=v,le=b[1];return x&&(re=u.getSize()-1-re,le=u.getSize()-1-le),new tn(G,[v,b[1]],re,le,h)}adjustOddEvenCounts(u,h){let x=he.sum(new Int32Array(this.getOddCounts())),b=he.sum(new Int32Array(this.getEvenCounts())),w=!1,v=!1,T=!1,M=!1;u?(x>12?v=!0:x<4&&(w=!0),b>12?M=!0:b<4&&(T=!0)):(x>11?v=!0:x<5&&(w=!0),b>10?M=!0:b<4&&(T=!0));let D=x+b-h,G=(x&1)===(u?1:0),re=(b&1)===1;if(D===1)if(G){if(re)throw new L;v=!0}else{if(!re)throw new L;M=!0}else if(D===-1)if(G){if(re)throw new L;w=!0}else{if(!re)throw new L;T=!0}else if(D===0){if(G){if(!re)throw new L;x<b?(w=!0,M=!0):(v=!0,T=!0)}else if(re)throw new L}else throw new L;if(w){if(v)throw new L;xt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(v&&xt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),T){if(M)throw new L;xt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}M&&xt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ct.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Ct.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Ct.OUTSIDE_GSUM=[0,161,961,2015,2715],Ct.INSIDE_GSUM=[0,336,1036,1516],Ct.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Ct.INSIDE_ODD_WIDEST=[2,4,6,8],Ct.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Qt extends Ae{constructor(u,h){super(),this.readers=[],this.verbose=h===!0;const x=u?u.get(oe.POSSIBLE_FORMATS):null,b=u&&u.get(oe.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;x?((x.includes(Te.EAN_13)||x.includes(Te.UPC_A)||x.includes(Te.EAN_8)||x.includes(Te.UPC_E))&&this.readers.push(new Vt(u)),x.includes(Te.CODE_39)&&this.readers.push(new $e(b)),x.includes(Te.CODE_128)&&this.readers.push(new Ie),x.includes(Te.ITF)&&this.readers.push(new je),x.includes(Te.RSS_14)&&this.readers.push(new Ct),x.includes(Te.RSS_EXPANDED)&&this.readers.push(new Oe(this.verbose))):(this.readers.push(new Vt(u)),this.readers.push(new $e),this.readers.push(new Vt(u)),this.readers.push(new Ie),this.readers.push(new je),this.readers.push(new Ct),this.readers.push(new Oe(this.verbose)))}decodeRow(u,h,x){for(let b=0;b<this.readers.length;b++)try{return this.readers[b].decodeRow(u,h,x)}catch{}throw new L}reset(){this.readers.forEach(u=>u.reset())}}class Jt extends J{constructor(u=500,h){super(new Qt(h),u,h)}}class Lt{constructor(u,h,x){this.ecCodewords=u,this.ecBlocks=[h],x&&this.ecBlocks.push(x)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class _t{constructor(u,h){this.count=u,this.dataCodewords=h}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class ut{constructor(u,h,x,b,w,v){this.versionNumber=u,this.symbolSizeRows=h,this.symbolSizeColumns=x,this.dataRegionSizeRows=b,this.dataRegionSizeColumns=w,this.ecBlocks=v;let T=0;const M=v.getECCodewords(),D=v.getECBlocks();for(let G of D)T+=G.getCount()*(G.getDataCodewords()+M);this.totalCodewords=T}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(u,h){if(u&1||h&1)throw new Q;for(let x of ut.VERSIONS)if(x.symbolSizeRows===u&&x.symbolSizeColumns===h)return x;throw new Q}toString(){return""+this.versionNumber}static buildVersions(){return[new ut(1,10,10,8,8,new Lt(5,new _t(1,3))),new ut(2,12,12,10,10,new Lt(7,new _t(1,5))),new ut(3,14,14,12,12,new Lt(10,new _t(1,8))),new ut(4,16,16,14,14,new Lt(12,new _t(1,12))),new ut(5,18,18,16,16,new Lt(14,new _t(1,18))),new ut(6,20,20,18,18,new Lt(18,new _t(1,22))),new ut(7,22,22,20,20,new Lt(20,new _t(1,30))),new ut(8,24,24,22,22,new Lt(24,new _t(1,36))),new ut(9,26,26,24,24,new Lt(28,new _t(1,44))),new ut(10,32,32,14,14,new Lt(36,new _t(1,62))),new ut(11,36,36,16,16,new Lt(42,new _t(1,86))),new ut(12,40,40,18,18,new Lt(48,new _t(1,114))),new ut(13,44,44,20,20,new Lt(56,new _t(1,144))),new ut(14,48,48,22,22,new Lt(68,new _t(1,174))),new ut(15,52,52,24,24,new Lt(42,new _t(2,102))),new ut(16,64,64,14,14,new Lt(56,new _t(2,140))),new ut(17,72,72,16,16,new Lt(36,new _t(4,92))),new ut(18,80,80,18,18,new Lt(48,new _t(4,114))),new ut(19,88,88,20,20,new Lt(56,new _t(4,144))),new ut(20,96,96,22,22,new Lt(68,new _t(4,174))),new ut(21,104,104,24,24,new Lt(56,new _t(6,136))),new ut(22,120,120,18,18,new Lt(68,new _t(6,175))),new ut(23,132,132,20,20,new Lt(62,new _t(8,163))),new ut(24,144,144,22,22,new Lt(62,new _t(8,156),new _t(2,155))),new ut(25,8,18,6,16,new Lt(7,new _t(1,5))),new ut(26,8,32,6,14,new Lt(11,new _t(1,10))),new ut(27,12,26,10,24,new Lt(14,new _t(1,16))),new ut(28,12,36,10,16,new Lt(18,new _t(1,22))),new ut(29,16,36,14,16,new Lt(24,new _t(1,32))),new ut(30,16,48,14,22,new Lt(28,new _t(1,49)))]}}ut.VERSIONS=ut.buildVersions();class In{constructor(u){const h=u.getHeight();if(h<8||h>144||h&1)throw new Q;this.version=In.readVersion(u),this.mappingBitMatrix=this.extractDataRegion(u),this.readMappingMatrix=new R(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(u){const h=u.getHeight(),x=u.getWidth();return ut.getVersionForDimensions(h,x)}readCodewords(){const u=new Int8Array(this.version.getTotalCodewords());let h=0,x=4,b=0;const w=this.mappingBitMatrix.getHeight(),v=this.mappingBitMatrix.getWidth();let T=!1,M=!1,D=!1,G=!1;do if(x===w&&b===0&&!T)u[h++]=this.readCorner1(w,v)&255,x-=2,b+=2,T=!0;else if(x===w-2&&b===0&&v&3&&!M)u[h++]=this.readCorner2(w,v)&255,x-=2,b+=2,M=!0;else if(x===w+4&&b===2&&!(v&7)&&!D)u[h++]=this.readCorner3(w,v)&255,x-=2,b+=2,D=!0;else if(x===w-2&&b===0&&(v&7)===4&&!G)u[h++]=this.readCorner4(w,v)&255,x-=2,b+=2,G=!0;else{do x<w&&b>=0&&!this.readMappingMatrix.get(b,x)&&(u[h++]=this.readUtah(x,b,w,v)&255),x-=2,b+=2;while(x>=0&&b<v);x+=1,b+=3;do x>=0&&b<v&&!this.readMappingMatrix.get(b,x)&&(u[h++]=this.readUtah(x,b,w,v)&255),x+=2,b-=2;while(x<w&&b>=0);x+=3,b+=1}while(x<w||b<v);if(h!==this.version.getTotalCodewords())throw new Q;return u}readModule(u,h,x,b){return u<0&&(u+=x,h+=4-(x+4&7)),h<0&&(h+=b,u+=4-(b+4&7)),this.readMappingMatrix.set(h,u),this.mappingBitMatrix.get(h,u)}readUtah(u,h,x,b){let w=0;return this.readModule(u-2,h-2,x,b)&&(w|=1),w<<=1,this.readModule(u-2,h-1,x,b)&&(w|=1),w<<=1,this.readModule(u-1,h-2,x,b)&&(w|=1),w<<=1,this.readModule(u-1,h-1,x,b)&&(w|=1),w<<=1,this.readModule(u-1,h,x,b)&&(w|=1),w<<=1,this.readModule(u,h-2,x,b)&&(w|=1),w<<=1,this.readModule(u,h-1,x,b)&&(w|=1),w<<=1,this.readModule(u,h,x,b)&&(w|=1),w}readCorner1(u,h){let x=0;return this.readModule(u-1,0,u,h)&&(x|=1),x<<=1,this.readModule(u-1,1,u,h)&&(x|=1),x<<=1,this.readModule(u-1,2,u,h)&&(x|=1),x<<=1,this.readModule(0,h-2,u,h)&&(x|=1),x<<=1,this.readModule(0,h-1,u,h)&&(x|=1),x<<=1,this.readModule(1,h-1,u,h)&&(x|=1),x<<=1,this.readModule(2,h-1,u,h)&&(x|=1),x<<=1,this.readModule(3,h-1,u,h)&&(x|=1),x}readCorner2(u,h){let x=0;return this.readModule(u-3,0,u,h)&&(x|=1),x<<=1,this.readModule(u-2,0,u,h)&&(x|=1),x<<=1,this.readModule(u-1,0,u,h)&&(x|=1),x<<=1,this.readModule(0,h-4,u,h)&&(x|=1),x<<=1,this.readModule(0,h-3,u,h)&&(x|=1),x<<=1,this.readModule(0,h-2,u,h)&&(x|=1),x<<=1,this.readModule(0,h-1,u,h)&&(x|=1),x<<=1,this.readModule(1,h-1,u,h)&&(x|=1),x}readCorner3(u,h){let x=0;return this.readModule(u-1,0,u,h)&&(x|=1),x<<=1,this.readModule(u-1,h-1,u,h)&&(x|=1),x<<=1,this.readModule(0,h-3,u,h)&&(x|=1),x<<=1,this.readModule(0,h-2,u,h)&&(x|=1),x<<=1,this.readModule(0,h-1,u,h)&&(x|=1),x<<=1,this.readModule(1,h-3,u,h)&&(x|=1),x<<=1,this.readModule(1,h-2,u,h)&&(x|=1),x<<=1,this.readModule(1,h-1,u,h)&&(x|=1),x}readCorner4(u,h){let x=0;return this.readModule(u-3,0,u,h)&&(x|=1),x<<=1,this.readModule(u-2,0,u,h)&&(x|=1),x<<=1,this.readModule(u-1,0,u,h)&&(x|=1),x<<=1,this.readModule(0,h-2,u,h)&&(x|=1),x<<=1,this.readModule(0,h-1,u,h)&&(x|=1),x<<=1,this.readModule(1,h-1,u,h)&&(x|=1),x<<=1,this.readModule(2,h-1,u,h)&&(x|=1),x<<=1,this.readModule(3,h-1,u,h)&&(x|=1),x}extractDataRegion(u){const h=this.version.getSymbolSizeRows(),x=this.version.getSymbolSizeColumns();if(u.getHeight()!==h)throw new S("Dimension of bitMatrix must match the version size");const b=this.version.getDataRegionSizeRows(),w=this.version.getDataRegionSizeColumns(),v=h/b|0,T=x/w|0,M=v*b,D=T*w,G=new R(D,M);for(let re=0;re<v;++re){const le=re*b;for(let xe=0;xe<T;++xe){const we=xe*w;for(let ve=0;ve<b;++ve){const Le=re*(b+2)+1+ve,ke=le+ve;for(let Je=0;Je<w;++Je){const tt=xe*(w+2)+1+Je;if(u.get(tt,Le)){const qe=we+Je;G.set(qe,ke)}}}}}return G}}class zt{constructor(u,h){this.numDataCodewords=u,this.codewords=h}static getDataBlocks(u,h){const x=h.getECBlocks();let b=0;const w=x.getECBlocks();for(let ve of w)b+=ve.getCount();const v=new Array(b);let T=0;for(let ve of w)for(let Le=0;Le<ve.getCount();Le++){const ke=ve.getDataCodewords(),Je=x.getECCodewords()+ke;v[T++]=new zt(ke,new Uint8Array(Je))}const D=v[0].codewords.length-x.getECCodewords(),G=D-1;let re=0;for(let ve=0;ve<G;ve++)for(let Le=0;Le<T;Le++)v[Le].codewords[ve]=u[re++];const le=h.getVersionNumber()===24,xe=le?8:T;for(let ve=0;ve<xe;ve++)v[ve].codewords[D-1]=u[re++];const we=v[0].codewords.length;for(let ve=D;ve<we;ve++)for(let Le=0;Le<T;Le++){const ke=le?(Le+8)%T:Le,Je=le&&ke>7?ve-1:ve;v[ke].codewords[Je]=u[re++]}if(re!==u.length)throw new S;return v}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Ln{constructor(u){this.bytes=u,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(u){if(u<1||u>32||u>this.available())throw new S(""+u);let h=0,x=this.bitOffset,b=this.byteOffset;const w=this.bytes;if(x>0){const v=8-x,T=u<v?u:v,M=v-T,D=255>>8-T<<M;h=(w[b]&D)>>M,u-=T,x+=T,x===8&&(x=0,b++)}if(u>0){for(;u>=8;)h=h<<8|w[b]&255,b++,u-=8;if(u>0){const v=8-u,T=255>>v<<v;h=h<<u|(w[b]&T)>>v,x+=u}}return this.bitOffset=x,this.byteOffset=b,h}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var rn;(function(ne){ne[ne.PAD_ENCODE=0]="PAD_ENCODE",ne[ne.ASCII_ENCODE=1]="ASCII_ENCODE",ne[ne.C40_ENCODE=2]="C40_ENCODE",ne[ne.TEXT_ENCODE=3]="TEXT_ENCODE",ne[ne.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",ne[ne.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",ne[ne.BASE256_ENCODE=6]="BASE256_ENCODE"})(rn||(rn={}));class _n{static decode(u){const h=new Ln(u),x=new V,b=new V,w=new Array;let v=rn.ASCII_ENCODE;do if(v===rn.ASCII_ENCODE)v=this.decodeAsciiSegment(h,x,b);else{switch(v){case rn.C40_ENCODE:this.decodeC40Segment(h,x);break;case rn.TEXT_ENCODE:this.decodeTextSegment(h,x);break;case rn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(h,x);break;case rn.EDIFACT_ENCODE:this.decodeEdifactSegment(h,x);break;case rn.BASE256_ENCODE:this.decodeBase256Segment(h,x,w);break;default:throw new Q}v=rn.ASCII_ENCODE}while(v!==rn.PAD_ENCODE&&h.available()>0);return b.length()>0&&x.append(b.toString()),new Ke(u,x.toString(),w.length===0?null:w,null)}static decodeAsciiSegment(u,h,x){let b=!1;do{let w=u.readBits(8);if(w===0)throw new Q;if(w<=128)return b&&(w+=128),h.append(String.fromCharCode(w-1)),rn.ASCII_ENCODE;if(w===129)return rn.PAD_ENCODE;if(w<=229){const v=w-130;v<10&&h.append("0"),h.append(""+v)}else switch(w){case 230:return rn.C40_ENCODE;case 231:return rn.BASE256_ENCODE;case 232:h.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:b=!0;break;case 236:h.append("[)>05"),x.insert(0,"");break;case 237:h.append("[)>06"),x.insert(0,"");break;case 238:return rn.ANSIX12_ENCODE;case 239:return rn.TEXT_ENCODE;case 240:return rn.EDIFACT_ENCODE;case 241:break;default:if(w!==254||u.available()!==0)throw new Q;break}}while(u.available()>0);return rn.ASCII_ENCODE}static decodeC40Segment(u,h){let x=!1;const b=[];let w=0;do{if(u.available()===8)return;const v=u.readBits(8);if(v===254)return;this.parseTwoBytes(v,u.readBits(8),b);for(let T=0;T<3;T++){const M=b[T];switch(w){case 0:if(M<3)w=M+1;else if(M<this.C40_BASIC_SET_CHARS.length){const D=this.C40_BASIC_SET_CHARS[M];x?(h.append(String.fromCharCode(D.charCodeAt(0)+128)),x=!1):h.append(D)}else throw new Q;break;case 1:x?(h.append(String.fromCharCode(M+128)),x=!1):h.append(String.fromCharCode(M)),w=0;break;case 2:if(M<this.C40_SHIFT2_SET_CHARS.length){const D=this.C40_SHIFT2_SET_CHARS[M];x?(h.append(String.fromCharCode(D.charCodeAt(0)+128)),x=!1):h.append(D)}else switch(M){case 27:h.append(String.fromCharCode(29));break;case 30:x=!0;break;default:throw new Q}w=0;break;case 3:x?(h.append(String.fromCharCode(M+224)),x=!1):h.append(String.fromCharCode(M+96)),w=0;break;default:throw new Q}}}while(u.available()>0)}static decodeTextSegment(u,h){let x=!1,b=[],w=0;do{if(u.available()===8)return;const v=u.readBits(8);if(v===254)return;this.parseTwoBytes(v,u.readBits(8),b);for(let T=0;T<3;T++){const M=b[T];switch(w){case 0:if(M<3)w=M+1;else if(M<this.TEXT_BASIC_SET_CHARS.length){const D=this.TEXT_BASIC_SET_CHARS[M];x?(h.append(String.fromCharCode(D.charCodeAt(0)+128)),x=!1):h.append(D)}else throw new Q;break;case 1:x?(h.append(String.fromCharCode(M+128)),x=!1):h.append(String.fromCharCode(M)),w=0;break;case 2:if(M<this.TEXT_SHIFT2_SET_CHARS.length){const D=this.TEXT_SHIFT2_SET_CHARS[M];x?(h.append(String.fromCharCode(D.charCodeAt(0)+128)),x=!1):h.append(D)}else switch(M){case 27:h.append(String.fromCharCode(29));break;case 30:x=!0;break;default:throw new Q}w=0;break;case 3:if(M<this.TEXT_SHIFT3_SET_CHARS.length){const D=this.TEXT_SHIFT3_SET_CHARS[M];x?(h.append(String.fromCharCode(D.charCodeAt(0)+128)),x=!1):h.append(D),w=0}else throw new Q;break;default:throw new Q}}}while(u.available()>0)}static decodeAnsiX12Segment(u,h){const x=[];do{if(u.available()===8)return;const b=u.readBits(8);if(b===254)return;this.parseTwoBytes(b,u.readBits(8),x);for(let w=0;w<3;w++){const v=x[w];switch(v){case 0:h.append("\r");break;case 1:h.append("*");break;case 2:h.append(">");break;case 3:h.append(" ");break;default:if(v<14)h.append(String.fromCharCode(v+44));else if(v<40)h.append(String.fromCharCode(v+51));else throw new Q;break}}}while(u.available()>0)}static parseTwoBytes(u,h,x){let b=(u<<8)+h-1,w=Math.floor(b/1600);x[0]=w,b-=w*1600,w=Math.floor(b/40),x[1]=w,x[2]=b-w*40}static decodeEdifactSegment(u,h){do{if(u.available()<=16)return;for(let x=0;x<4;x++){let b=u.readBits(6);if(b===31){const w=8-u.getBitOffset();w!==8&&u.readBits(w);return}b&32||(b|=64),h.append(String.fromCharCode(b))}}while(u.available()>0)}static decodeBase256Segment(u,h,x){let b=1+u.getByteOffset();const w=this.unrandomize255State(u.readBits(8),b++);let v;if(w===0?v=u.available()/8|0:w<250?v=w:v=250*(w-249)+this.unrandomize255State(u.readBits(8),b++),v<0)throw new Q;const T=new Uint8Array(v);for(let M=0;M<v;M++){if(u.available()<8)throw new Q;T[M]=this.unrandomize255State(u.readBits(8),b++)}x.push(T);try{h.append(ge.decode(T,me.ISO88591))}catch(M){throw new nt("Platform does not support required encoding: "+M.message)}}static unrandomize255State(u,h){const x=149*h%255+1,b=u-x;return b>=0?b:b+256}}_n.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_n.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],_n.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],_n.TEXT_SHIFT2_SET_CHARS=_n.C40_SHIFT2_SET_CHARS,_n.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Wn{constructor(){this.rsDecoder=new dt(ft.DATA_MATRIX_FIELD_256)}decode(u){const h=new In(u),x=h.getVersion(),b=h.readCodewords(),w=zt.getDataBlocks(b,x);let v=0;for(let D of w)v+=D.getNumDataCodewords();const T=new Uint8Array(v),M=w.length;for(let D=0;D<M;D++){const G=w[D],re=G.getCodewords(),le=G.getNumDataCodewords();this.correctErrors(re,le);for(let xe=0;xe<le;xe++)T[xe*M+D]=re[xe]}return _n.decode(T)}correctErrors(u,h){const x=new Int32Array(u);try{this.rsDecoder.decode(x,u.length-h)}catch{throw new C}for(let b=0;b<h;b++)u[b]=x[b]}}class Bt{constructor(u){this.image=u,this.rectangleDetector=new Ve(this.image)}detect(){const u=this.rectangleDetector.detect();let h=this.detectSolid1(u);if(h=this.detectSolid2(h),h[3]=this.correctTopRight(h),!h[3])throw new L;h=this.shiftToModuleCenter(h);const x=h[0],b=h[1],w=h[2],v=h[3];let T=this.transitionsBetween(x,v)+1,M=this.transitionsBetween(w,v)+1;(T&1)===1&&(T+=1),(M&1)===1&&(M+=1),4*T<7*M&&4*M<7*T&&(T=M=Math.max(T,M));let D=Bt.sampleGrid(this.image,x,b,w,v,T,M);return new Ge(D,[x,b,w,v])}static shiftPoint(u,h,x){let b=(h.getX()-u.getX())/(x+1),w=(h.getY()-u.getY())/(x+1);return new _e(u.getX()+b,u.getY()+w)}static moveAway(u,h,x){let b=u.getX(),w=u.getY();return b<h?b-=1:b+=1,w<x?w-=1:w+=1,new _e(b,w)}detectSolid1(u){let h=u[0],x=u[1],b=u[3],w=u[2],v=this.transitionsBetween(h,x),T=this.transitionsBetween(x,b),M=this.transitionsBetween(b,w),D=this.transitionsBetween(w,h),G=v,re=[w,h,x,b];return G>T&&(G=T,re[0]=h,re[1]=x,re[2]=b,re[3]=w),G>M&&(G=M,re[0]=x,re[1]=b,re[2]=w,re[3]=h),G>D&&(re[0]=b,re[1]=w,re[2]=h,re[3]=x),re}detectSolid2(u){let h=u[0],x=u[1],b=u[2],w=u[3],v=this.transitionsBetween(h,w),T=Bt.shiftPoint(x,b,(v+1)*4),M=Bt.shiftPoint(b,x,(v+1)*4),D=this.transitionsBetween(T,h),G=this.transitionsBetween(M,w);return D<G?(u[0]=h,u[1]=x,u[2]=b,u[3]=w):(u[0]=x,u[1]=b,u[2]=w,u[3]=h),u}correctTopRight(u){let h=u[0],x=u[1],b=u[2],w=u[3],v=this.transitionsBetween(h,w),T=this.transitionsBetween(x,w),M=Bt.shiftPoint(h,x,(T+1)*4),D=Bt.shiftPoint(b,x,(v+1)*4);v=this.transitionsBetween(M,w),T=this.transitionsBetween(D,w);let G=new _e(w.getX()+(b.getX()-x.getX())/(v+1),w.getY()+(b.getY()-x.getY())/(v+1)),re=new _e(w.getX()+(h.getX()-x.getX())/(T+1),w.getY()+(h.getY()-x.getY())/(T+1));if(!this.isValid(G))return this.isValid(re)?re:null;if(!this.isValid(re))return G;let le=this.transitionsBetween(M,G)+this.transitionsBetween(D,G),xe=this.transitionsBetween(M,re)+this.transitionsBetween(D,re);return le>xe?G:re}shiftToModuleCenter(u){let h=u[0],x=u[1],b=u[2],w=u[3],v=this.transitionsBetween(h,w)+1,T=this.transitionsBetween(b,w)+1,M=Bt.shiftPoint(h,x,T*4),D=Bt.shiftPoint(b,x,v*4);v=this.transitionsBetween(M,w)+1,T=this.transitionsBetween(D,w)+1,(v&1)===1&&(v+=1),(T&1)===1&&(T+=1);let G=(h.getX()+x.getX()+b.getX()+w.getX())/4,re=(h.getY()+x.getY()+b.getY()+w.getY())/4;h=Bt.moveAway(h,G,re),x=Bt.moveAway(x,G,re),b=Bt.moveAway(b,G,re),w=Bt.moveAway(w,G,re);let le,xe;return M=Bt.shiftPoint(h,x,T*4),M=Bt.shiftPoint(M,w,v*4),le=Bt.shiftPoint(x,h,T*4),le=Bt.shiftPoint(le,b,v*4),D=Bt.shiftPoint(b,w,T*4),D=Bt.shiftPoint(D,x,v*4),xe=Bt.shiftPoint(w,b,T*4),xe=Bt.shiftPoint(xe,h,v*4),[M,le,D,xe]}isValid(u){return u.getX()>=0&&u.getX()<this.image.getWidth()&&u.getY()>0&&u.getY()<this.image.getHeight()}static sampleGrid(u,h,x,b,w,v,T){return U.getInstance().sampleGrid(u,v,T,.5,.5,v-.5,.5,v-.5,T-.5,.5,T-.5,h.getX(),h.getY(),w.getX(),w.getY(),b.getX(),b.getY(),x.getX(),x.getY())}transitionsBetween(u,h){let x=Math.trunc(u.getX()),b=Math.trunc(u.getY()),w=Math.trunc(h.getX()),v=Math.trunc(h.getY()),T=Math.abs(v-b)>Math.abs(w-x);if(T){let ve=x;x=b,b=ve,ve=w,w=v,v=ve}let M=Math.abs(w-x),D=Math.abs(v-b),G=-M/2,re=b<v?1:-1,le=x<w?1:-1,xe=0,we=this.image.get(T?b:x,T?x:b);for(let ve=x,Le=b;ve!==w;ve+=le){let ke=this.image.get(T?Le:ve,T?ve:Le);if(ke!==we&&(xe++,we=ke),G+=D,G>0){if(Le===v)break;Le+=re,G-=M}}return xe}}class xn{constructor(){this.decoder=new Wn}decode(u,h=null){let x,b;if(h!=null&&h.has(oe.PURE_BARCODE)){const D=xn.extractPureBits(u.getBlackMatrix());x=this.decoder.decode(D),b=xn.NO_POINTS}else{const D=new Bt(u.getBlackMatrix()).detect();x=this.decoder.decode(D.getBits()),b=D.getPoints()}const w=x.getRawBytes(),v=new Ee(x.getText(),w,8*w.length,b,Te.DATA_MATRIX,O.currentTimeMillis()),T=x.getByteSegments();T!=null&&v.putMetadata(ze.BYTE_SEGMENTS,T);const M=x.getECLevel();return M!=null&&v.putMetadata(ze.ERROR_CORRECTION_LEVEL,M),v}reset(){}static extractPureBits(u){const h=u.getTopLeftOnBit(),x=u.getBottomRightOnBit();if(h==null||x==null)throw new L;const b=this.moduleSize(h,u);let w=h[1];const v=x[1];let T=h[0];const D=(x[0]-T+1)/b,G=(v-w+1)/b;if(D<=0||G<=0)throw new L;const re=b/2;w+=re,T+=re;const le=new R(D,G);for(let xe=0;xe<G;xe++){const we=w+xe*b;for(let ve=0;ve<D;ve++)u.get(T+ve*b,we)&&le.set(ve,xe)}return le}static moduleSize(u,h){const x=h.getWidth();let b=u[0];const w=u[1];for(;b<x&&h.get(b,w);)b++;if(b===x)throw new L;const v=b-u[0];if(v===0)throw new L;return v}}xn.NO_POINTS=[];class Kn extends J{constructor(u=500){super(new xn,u)}}var ln;(function(ne){ne[ne.L=0]="L",ne[ne.M=1]="M",ne[ne.Q=2]="Q",ne[ne.H=3]="H"})(ln||(ln={}));class jt{constructor(u,h,x){this.value=u,this.stringValue=h,this.bits=x,jt.FOR_BITS.set(x,this),jt.FOR_VALUE.set(u,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(u){switch(u){case"L":return jt.L;case"M":return jt.M;case"Q":return jt.Q;case"H":return jt.H;default:throw new E(u+"not available")}}toString(){return this.stringValue}equals(u){if(!(u instanceof jt))return!1;const h=u;return this.value===h.value}static forBits(u){if(u<0||u>=jt.FOR_BITS.size)throw new S;return jt.FOR_BITS.get(u)}}jt.FOR_BITS=new Map,jt.FOR_VALUE=new Map,jt.L=new jt(ln.L,"L",1),jt.M=new jt(ln.M,"M",0),jt.Q=new jt(ln.Q,"Q",3),jt.H=new jt(ln.H,"H",2);class dn{constructor(u){this.errorCorrectionLevel=jt.forBits(u>>3&3),this.dataMask=u&7}static numBitsDiffering(u,h){return B.bitCount(u^h)}static decodeFormatInformation(u,h){const x=dn.doDecodeFormatInformation(u,h);return x!==null?x:dn.doDecodeFormatInformation(u^dn.FORMAT_INFO_MASK_QR,h^dn.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(u,h){let x=Number.MAX_SAFE_INTEGER,b=0;for(const w of dn.FORMAT_INFO_DECODE_LOOKUP){const v=w[0];if(v===u||v===h)return new dn(w[1]);let T=dn.numBitsDiffering(u,v);T<x&&(b=w[1],x=T),u!==h&&(T=dn.numBitsDiffering(h,v),T<x&&(b=w[1],x=T))}return x<=3?new dn(b):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(u){if(!(u instanceof dn))return!1;const h=u;return this.errorCorrectionLevel===h.errorCorrectionLevel&&this.dataMask===h.dataMask}}dn.FORMAT_INFO_MASK_QR=21522,dn.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Ne{constructor(u,...h){this.ecCodewordsPerBlock=u,this.ecBlocks=h}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let u=0;const h=this.ecBlocks;for(const x of h)u+=x.getCount();return u}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class pe{constructor(u,h){this.count=u,this.dataCodewords=h}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class wt{constructor(u,h,...x){this.versionNumber=u,this.alignmentPatternCenters=h,this.ecBlocks=x;let b=0;const w=x[0].getECCodewordsPerBlock(),v=x[0].getECBlocks();for(const T of v)b+=T.getCount()*(T.getDataCodewords()+w);this.totalCodewords=b}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(u){return this.ecBlocks[u.getValue()]}static getProvisionalVersionForDimension(u){if(u%4!==1)throw new Q;try{return this.getVersionForNumber((u-17)/4)}catch{throw new Q}}static getVersionForNumber(u){if(u<1||u>40)throw new S;return wt.VERSIONS[u-1]}static decodeVersionInformation(u){let h=Number.MAX_SAFE_INTEGER,x=0;for(let b=0;b<wt.VERSION_DECODE_INFO.length;b++){const w=wt.VERSION_DECODE_INFO[b];if(w===u)return wt.getVersionForNumber(b+7);const v=dn.numBitsDiffering(u,w);v<h&&(x=b+7,h=v)}return h<=3?wt.getVersionForNumber(x):null}buildFunctionPattern(){const u=this.getDimensionForVersion(),h=new R(u);h.setRegion(0,0,9,9),h.setRegion(u-8,0,8,9),h.setRegion(0,u-8,9,8);const x=this.alignmentPatternCenters.length;for(let b=0;b<x;b++){const w=this.alignmentPatternCenters[b]-2;for(let v=0;v<x;v++)b===0&&(v===0||v===x-1)||b===x-1&&v===0||h.setRegion(this.alignmentPatternCenters[v]-2,w,5,5)}return h.setRegion(6,9,1,u-17),h.setRegion(9,6,u-17,1),this.versionNumber>6&&(h.setRegion(u-11,0,3,6),h.setRegion(0,u-11,6,3)),h}toString(){return""+this.versionNumber}}wt.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),wt.VERSIONS=[new wt(1,new Int32Array(0),new Ne(7,new pe(1,19)),new Ne(10,new pe(1,16)),new Ne(13,new pe(1,13)),new Ne(17,new pe(1,9))),new wt(2,Int32Array.from([6,18]),new Ne(10,new pe(1,34)),new Ne(16,new pe(1,28)),new Ne(22,new pe(1,22)),new Ne(28,new pe(1,16))),new wt(3,Int32Array.from([6,22]),new Ne(15,new pe(1,55)),new Ne(26,new pe(1,44)),new Ne(18,new pe(2,17)),new Ne(22,new pe(2,13))),new wt(4,Int32Array.from([6,26]),new Ne(20,new pe(1,80)),new Ne(18,new pe(2,32)),new Ne(26,new pe(2,24)),new Ne(16,new pe(4,9))),new wt(5,Int32Array.from([6,30]),new Ne(26,new pe(1,108)),new Ne(24,new pe(2,43)),new Ne(18,new pe(2,15),new pe(2,16)),new Ne(22,new pe(2,11),new pe(2,12))),new wt(6,Int32Array.from([6,34]),new Ne(18,new pe(2,68)),new Ne(16,new pe(4,27)),new Ne(24,new pe(4,19)),new Ne(28,new pe(4,15))),new wt(7,Int32Array.from([6,22,38]),new Ne(20,new pe(2,78)),new Ne(18,new pe(4,31)),new Ne(18,new pe(2,14),new pe(4,15)),new Ne(26,new pe(4,13),new pe(1,14))),new wt(8,Int32Array.from([6,24,42]),new Ne(24,new pe(2,97)),new Ne(22,new pe(2,38),new pe(2,39)),new Ne(22,new pe(4,18),new pe(2,19)),new Ne(26,new pe(4,14),new pe(2,15))),new wt(9,Int32Array.from([6,26,46]),new Ne(30,new pe(2,116)),new Ne(22,new pe(3,36),new pe(2,37)),new Ne(20,new pe(4,16),new pe(4,17)),new Ne(24,new pe(4,12),new pe(4,13))),new wt(10,Int32Array.from([6,28,50]),new Ne(18,new pe(2,68),new pe(2,69)),new Ne(26,new pe(4,43),new pe(1,44)),new Ne(24,new pe(6,19),new pe(2,20)),new Ne(28,new pe(6,15),new pe(2,16))),new wt(11,Int32Array.from([6,30,54]),new Ne(20,new pe(4,81)),new Ne(30,new pe(1,50),new pe(4,51)),new Ne(28,new pe(4,22),new pe(4,23)),new Ne(24,new pe(3,12),new pe(8,13))),new wt(12,Int32Array.from([6,32,58]),new Ne(24,new pe(2,92),new pe(2,93)),new Ne(22,new pe(6,36),new pe(2,37)),new Ne(26,new pe(4,20),new pe(6,21)),new Ne(28,new pe(7,14),new pe(4,15))),new wt(13,Int32Array.from([6,34,62]),new Ne(26,new pe(4,107)),new Ne(22,new pe(8,37),new pe(1,38)),new Ne(24,new pe(8,20),new pe(4,21)),new Ne(22,new pe(12,11),new pe(4,12))),new wt(14,Int32Array.from([6,26,46,66]),new Ne(30,new pe(3,115),new pe(1,116)),new Ne(24,new pe(4,40),new pe(5,41)),new Ne(20,new pe(11,16),new pe(5,17)),new Ne(24,new pe(11,12),new pe(5,13))),new wt(15,Int32Array.from([6,26,48,70]),new Ne(22,new pe(5,87),new pe(1,88)),new Ne(24,new pe(5,41),new pe(5,42)),new Ne(30,new pe(5,24),new pe(7,25)),new Ne(24,new pe(11,12),new pe(7,13))),new wt(16,Int32Array.from([6,26,50,74]),new Ne(24,new pe(5,98),new pe(1,99)),new Ne(28,new pe(7,45),new pe(3,46)),new Ne(24,new pe(15,19),new pe(2,20)),new Ne(30,new pe(3,15),new pe(13,16))),new wt(17,Int32Array.from([6,30,54,78]),new Ne(28,new pe(1,107),new pe(5,108)),new Ne(28,new pe(10,46),new pe(1,47)),new Ne(28,new pe(1,22),new pe(15,23)),new Ne(28,new pe(2,14),new pe(17,15))),new wt(18,Int32Array.from([6,30,56,82]),new Ne(30,new pe(5,120),new pe(1,121)),new Ne(26,new pe(9,43),new pe(4,44)),new Ne(28,new pe(17,22),new pe(1,23)),new Ne(28,new pe(2,14),new pe(19,15))),new wt(19,Int32Array.from([6,30,58,86]),new Ne(28,new pe(3,113),new pe(4,114)),new Ne(26,new pe(3,44),new pe(11,45)),new Ne(26,new pe(17,21),new pe(4,22)),new Ne(26,new pe(9,13),new pe(16,14))),new wt(20,Int32Array.from([6,34,62,90]),new Ne(28,new pe(3,107),new pe(5,108)),new Ne(26,new pe(3,41),new pe(13,42)),new Ne(30,new pe(15,24),new pe(5,25)),new Ne(28,new pe(15,15),new pe(10,16))),new wt(21,Int32Array.from([6,28,50,72,94]),new Ne(28,new pe(4,116),new pe(4,117)),new Ne(26,new pe(17,42)),new Ne(28,new pe(17,22),new pe(6,23)),new Ne(30,new pe(19,16),new pe(6,17))),new wt(22,Int32Array.from([6,26,50,74,98]),new Ne(28,new pe(2,111),new pe(7,112)),new Ne(28,new pe(17,46)),new Ne(30,new pe(7,24),new pe(16,25)),new Ne(24,new pe(34,13))),new wt(23,Int32Array.from([6,30,54,78,102]),new Ne(30,new pe(4,121),new pe(5,122)),new Ne(28,new pe(4,47),new pe(14,48)),new Ne(30,new pe(11,24),new pe(14,25)),new Ne(30,new pe(16,15),new pe(14,16))),new wt(24,Int32Array.from([6,28,54,80,106]),new Ne(30,new pe(6,117),new pe(4,118)),new Ne(28,new pe(6,45),new pe(14,46)),new Ne(30,new pe(11,24),new pe(16,25)),new Ne(30,new pe(30,16),new pe(2,17))),new wt(25,Int32Array.from([6,32,58,84,110]),new Ne(26,new pe(8,106),new pe(4,107)),new Ne(28,new pe(8,47),new pe(13,48)),new Ne(30,new pe(7,24),new pe(22,25)),new Ne(30,new pe(22,15),new pe(13,16))),new wt(26,Int32Array.from([6,30,58,86,114]),new Ne(28,new pe(10,114),new pe(2,115)),new Ne(28,new pe(19,46),new pe(4,47)),new Ne(28,new pe(28,22),new pe(6,23)),new Ne(30,new pe(33,16),new pe(4,17))),new wt(27,Int32Array.from([6,34,62,90,118]),new Ne(30,new pe(8,122),new pe(4,123)),new Ne(28,new pe(22,45),new pe(3,46)),new Ne(30,new pe(8,23),new pe(26,24)),new Ne(30,new pe(12,15),new pe(28,16))),new wt(28,Int32Array.from([6,26,50,74,98,122]),new Ne(30,new pe(3,117),new pe(10,118)),new Ne(28,new pe(3,45),new pe(23,46)),new Ne(30,new pe(4,24),new pe(31,25)),new Ne(30,new pe(11,15),new pe(31,16))),new wt(29,Int32Array.from([6,30,54,78,102,126]),new Ne(30,new pe(7,116),new pe(7,117)),new Ne(28,new pe(21,45),new pe(7,46)),new Ne(30,new pe(1,23),new pe(37,24)),new Ne(30,new pe(19,15),new pe(26,16))),new wt(30,Int32Array.from([6,26,52,78,104,130]),new Ne(30,new pe(5,115),new pe(10,116)),new Ne(28,new pe(19,47),new pe(10,48)),new Ne(30,new pe(15,24),new pe(25,25)),new Ne(30,new pe(23,15),new pe(25,16))),new wt(31,Int32Array.from([6,30,56,82,108,134]),new Ne(30,new pe(13,115),new pe(3,116)),new Ne(28,new pe(2,46),new pe(29,47)),new Ne(30,new pe(42,24),new pe(1,25)),new Ne(30,new pe(23,15),new pe(28,16))),new wt(32,Int32Array.from([6,34,60,86,112,138]),new Ne(30,new pe(17,115)),new Ne(28,new pe(10,46),new pe(23,47)),new Ne(30,new pe(10,24),new pe(35,25)),new Ne(30,new pe(19,15),new pe(35,16))),new wt(33,Int32Array.from([6,30,58,86,114,142]),new Ne(30,new pe(17,115),new pe(1,116)),new Ne(28,new pe(14,46),new pe(21,47)),new Ne(30,new pe(29,24),new pe(19,25)),new Ne(30,new pe(11,15),new pe(46,16))),new wt(34,Int32Array.from([6,34,62,90,118,146]),new Ne(30,new pe(13,115),new pe(6,116)),new Ne(28,new pe(14,46),new pe(23,47)),new Ne(30,new pe(44,24),new pe(7,25)),new Ne(30,new pe(59,16),new pe(1,17))),new wt(35,Int32Array.from([6,30,54,78,102,126,150]),new Ne(30,new pe(12,121),new pe(7,122)),new Ne(28,new pe(12,47),new pe(26,48)),new Ne(30,new pe(39,24),new pe(14,25)),new Ne(30,new pe(22,15),new pe(41,16))),new wt(36,Int32Array.from([6,24,50,76,102,128,154]),new Ne(30,new pe(6,121),new pe(14,122)),new Ne(28,new pe(6,47),new pe(34,48)),new Ne(30,new pe(46,24),new pe(10,25)),new Ne(30,new pe(2,15),new pe(64,16))),new wt(37,Int32Array.from([6,28,54,80,106,132,158]),new Ne(30,new pe(17,122),new pe(4,123)),new Ne(28,new pe(29,46),new pe(14,47)),new Ne(30,new pe(49,24),new pe(10,25)),new Ne(30,new pe(24,15),new pe(46,16))),new wt(38,Int32Array.from([6,32,58,84,110,136,162]),new Ne(30,new pe(4,122),new pe(18,123)),new Ne(28,new pe(13,46),new pe(32,47)),new Ne(30,new pe(48,24),new pe(14,25)),new Ne(30,new pe(42,15),new pe(32,16))),new wt(39,Int32Array.from([6,26,54,82,110,138,166]),new Ne(30,new pe(20,117),new pe(4,118)),new Ne(28,new pe(40,47),new pe(7,48)),new Ne(30,new pe(43,24),new pe(22,25)),new Ne(30,new pe(10,15),new pe(67,16))),new wt(40,Int32Array.from([6,30,58,86,114,142,170]),new Ne(30,new pe(19,118),new pe(6,119)),new Ne(28,new pe(18,47),new pe(31,48)),new Ne(30,new pe(34,24),new pe(34,25)),new Ne(30,new pe(20,15),new pe(61,16)))];var hn;(function(ne){ne[ne.DATA_MASK_000=0]="DATA_MASK_000",ne[ne.DATA_MASK_001=1]="DATA_MASK_001",ne[ne.DATA_MASK_010=2]="DATA_MASK_010",ne[ne.DATA_MASK_011=3]="DATA_MASK_011",ne[ne.DATA_MASK_100=4]="DATA_MASK_100",ne[ne.DATA_MASK_101=5]="DATA_MASK_101",ne[ne.DATA_MASK_110=6]="DATA_MASK_110",ne[ne.DATA_MASK_111=7]="DATA_MASK_111"})(hn||(hn={}));class Tn{constructor(u,h){this.value=u,this.isMasked=h}unmaskBitMatrix(u,h){for(let x=0;x<h;x++)for(let b=0;b<h;b++)this.isMasked(x,b)&&u.flip(b,x)}}Tn.values=new Map([[hn.DATA_MASK_000,new Tn(hn.DATA_MASK_000,(ne,u)=>(ne+u&1)===0)],[hn.DATA_MASK_001,new Tn(hn.DATA_MASK_001,(ne,u)=>(ne&1)===0)],[hn.DATA_MASK_010,new Tn(hn.DATA_MASK_010,(ne,u)=>u%3===0)],[hn.DATA_MASK_011,new Tn(hn.DATA_MASK_011,(ne,u)=>(ne+u)%3===0)],[hn.DATA_MASK_100,new Tn(hn.DATA_MASK_100,(ne,u)=>(Math.floor(ne/2)+Math.floor(u/3)&1)===0)],[hn.DATA_MASK_101,new Tn(hn.DATA_MASK_101,(ne,u)=>ne*u%6===0)],[hn.DATA_MASK_110,new Tn(hn.DATA_MASK_110,(ne,u)=>ne*u%6<3)],[hn.DATA_MASK_111,new Tn(hn.DATA_MASK_111,(ne,u)=>(ne+u+ne*u%3&1)===0)]]);class Nr{constructor(u){const h=u.getHeight();if(h<21||(h&3)!==1)throw new Q;this.bitMatrix=u}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let u=0;for(let w=0;w<6;w++)u=this.copyBit(w,8,u);u=this.copyBit(7,8,u),u=this.copyBit(8,8,u),u=this.copyBit(8,7,u);for(let w=5;w>=0;w--)u=this.copyBit(8,w,u);const h=this.bitMatrix.getHeight();let x=0;const b=h-7;for(let w=h-1;w>=b;w--)x=this.copyBit(8,w,x);for(let w=h-8;w<h;w++)x=this.copyBit(w,8,x);if(this.parsedFormatInfo=dn.decodeFormatInformation(u,x),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new Q}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const u=this.bitMatrix.getHeight(),h=Math.floor((u-17)/4);if(h<=6)return wt.getVersionForNumber(h);let x=0;const b=u-11;for(let v=5;v>=0;v--)for(let T=u-9;T>=b;T--)x=this.copyBit(T,v,x);let w=wt.decodeVersionInformation(x);if(w!==null&&w.getDimensionForVersion()===u)return this.parsedVersion=w,w;x=0;for(let v=5;v>=0;v--)for(let T=u-9;T>=b;T--)x=this.copyBit(v,T,x);if(w=wt.decodeVersionInformation(x),w!==null&&w.getDimensionForVersion()===u)return this.parsedVersion=w,w;throw new Q}copyBit(u,h,x){return(this.isMirror?this.bitMatrix.get(h,u):this.bitMatrix.get(u,h))?x<<1|1:x<<1}readCodewords(){const u=this.readFormatInformation(),h=this.readVersion(),x=Tn.values.get(u.getDataMask()),b=this.bitMatrix.getHeight();x.unmaskBitMatrix(this.bitMatrix,b);const w=h.buildFunctionPattern();let v=!0;const T=new Uint8Array(h.getTotalCodewords());let M=0,D=0,G=0;for(let re=b-1;re>0;re-=2){re===6&&re--;for(let le=0;le<b;le++){const xe=v?b-1-le:le;for(let we=0;we<2;we++)w.get(re-we,xe)||(G++,D<<=1,this.bitMatrix.get(re-we,xe)&&(D|=1),G===8&&(T[M++]=D,G=0,D=0))}v=!v}if(M!==h.getTotalCodewords())throw new Q;return T}remask(){if(this.parsedFormatInfo===null)return;const u=Tn.values[this.parsedFormatInfo.getDataMask()],h=this.bitMatrix.getHeight();u.unmaskBitMatrix(this.bitMatrix,h)}setMirror(u){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=u}mirror(){const u=this.bitMatrix;for(let h=0,x=u.getWidth();h<x;h++)for(let b=h+1,w=u.getHeight();b<w;b++)u.get(h,b)!==u.get(b,h)&&(u.flip(b,h),u.flip(h,b))}}class cr{constructor(u,h){this.numDataCodewords=u,this.codewords=h}static getDataBlocks(u,h,x){if(u.length!==h.getTotalCodewords())throw new S;const b=h.getECBlocksForLevel(x);let w=0;const v=b.getECBlocks();for(const we of v)w+=we.getCount();const T=new Array(w);let M=0;for(const we of v)for(let ve=0;ve<we.getCount();ve++){const Le=we.getDataCodewords(),ke=b.getECCodewordsPerBlock()+Le;T[M++]=new cr(Le,new Uint8Array(ke))}const D=T[0].codewords.length;let G=T.length-1;for(;G>=0&&T[G].codewords.length!==D;)G--;G++;const re=D-b.getECCodewordsPerBlock();let le=0;for(let we=0;we<re;we++)for(let ve=0;ve<M;ve++)T[ve].codewords[we]=u[le++];for(let we=G;we<M;we++)T[we].codewords[re]=u[le++];const xe=T[0].codewords.length;for(let we=re;we<xe;we++)for(let ve=0;ve<M;ve++){const Le=ve<G?we:we+1;T[ve].codewords[Le]=u[le++]}return T}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var Cn;(function(ne){ne[ne.TERMINATOR=0]="TERMINATOR",ne[ne.NUMERIC=1]="NUMERIC",ne[ne.ALPHANUMERIC=2]="ALPHANUMERIC",ne[ne.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",ne[ne.BYTE=4]="BYTE",ne[ne.ECI=5]="ECI",ne[ne.KANJI=6]="KANJI",ne[ne.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",ne[ne.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",ne[ne.HANZI=9]="HANZI"})(Cn||(Cn={}));class vt{constructor(u,h,x,b){this.value=u,this.stringValue=h,this.characterCountBitsForVersions=x,this.bits=b,vt.FOR_BITS.set(b,this),vt.FOR_VALUE.set(u,this)}static forBits(u){const h=vt.FOR_BITS.get(u);if(h===void 0)throw new S;return h}getCharacterCountBits(u){const h=u.getVersionNumber();let x;return h<=9?x=0:h<=26?x=1:x=2,this.characterCountBitsForVersions[x]}getValue(){return this.value}getBits(){return this.bits}equals(u){if(!(u instanceof vt))return!1;const h=u;return this.value===h.value}toString(){return this.stringValue}}vt.FOR_BITS=new Map,vt.FOR_VALUE=new Map,vt.TERMINATOR=new vt(Cn.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),vt.NUMERIC=new vt(Cn.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),vt.ALPHANUMERIC=new vt(Cn.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),vt.STRUCTURED_APPEND=new vt(Cn.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),vt.BYTE=new vt(Cn.BYTE,"BYTE",Int32Array.from([8,16,16]),4),vt.ECI=new vt(Cn.ECI,"ECI",Int32Array.from([0,0,0]),7),vt.KANJI=new vt(Cn.KANJI,"KANJI",Int32Array.from([8,10,12]),8),vt.FNC1_FIRST_POSITION=new vt(Cn.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),vt.FNC1_SECOND_POSITION=new vt(Cn.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),vt.HANZI=new vt(Cn.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class nn{static decode(u,h,x,b){const w=new Ln(u);let v=new V;const T=new Array;let M=-1,D=-1;try{let G=null,re=!1,le;do{if(w.available()<4)le=vt.TERMINATOR;else{const xe=w.readBits(4);le=vt.forBits(xe)}switch(le){case vt.TERMINATOR:break;case vt.FNC1_FIRST_POSITION:case vt.FNC1_SECOND_POSITION:re=!0;break;case vt.STRUCTURED_APPEND:if(w.available()<16)throw new Q;M=w.readBits(8),D=w.readBits(8);break;case vt.ECI:const xe=nn.parseECIValue(w);if(G=Z.getCharacterSetECIByValue(xe),G===null)throw new Q;break;case vt.HANZI:const we=w.readBits(4),ve=w.readBits(le.getCharacterCountBits(h));we===nn.GB2312_SUBSET&&nn.decodeHanziSegment(w,v,ve);break;default:const Le=w.readBits(le.getCharacterCountBits(h));switch(le){case vt.NUMERIC:nn.decodeNumericSegment(w,v,Le);break;case vt.ALPHANUMERIC:nn.decodeAlphanumericSegment(w,v,Le,re);break;case vt.BYTE:nn.decodeByteSegment(w,v,Le,G,T,b);break;case vt.KANJI:nn.decodeKanjiSegment(w,v,Le);break;default:throw new Q}break}}while(le!==vt.TERMINATOR)}catch{throw new Q}return new Ke(u,v.toString(),T.length===0?null:T,x===null?null:x.toString(),M,D)}static decodeHanziSegment(u,h,x){if(x*13>u.available())throw new Q;const b=new Uint8Array(2*x);let w=0;for(;x>0;){const v=u.readBits(13);let T=v/96<<8&4294967295|v%96;T<959?T+=41377:T+=42657,b[w]=T>>8&255,b[w+1]=T&255,w+=2,x--}try{h.append(ge.decode(b,me.GB2312))}catch(v){throw new Q(v)}}static decodeKanjiSegment(u,h,x){if(x*13>u.available())throw new Q;const b=new Uint8Array(2*x);let w=0;for(;x>0;){const v=u.readBits(13);let T=v/192<<8&4294967295|v%192;T<7936?T+=33088:T+=49472,b[w]=T>>8,b[w+1]=T,w+=2,x--}try{h.append(ge.decode(b,me.SHIFT_JIS))}catch(v){throw new Q(v)}}static decodeByteSegment(u,h,x,b,w,v){if(8*x>u.available())throw new Q;const T=new Uint8Array(x);for(let D=0;D<x;D++)T[D]=u.readBits(8);let M;b===null?M=me.guessEncoding(T,v):M=b.getName();try{h.append(ge.decode(T,M))}catch(D){throw new Q(D)}w.push(T)}static toAlphaNumericChar(u){if(u>=nn.ALPHANUMERIC_CHARS.length)throw new Q;return nn.ALPHANUMERIC_CHARS[u]}static decodeAlphanumericSegment(u,h,x,b){const w=h.length();for(;x>1;){if(u.available()<11)throw new Q;const v=u.readBits(11);h.append(nn.toAlphaNumericChar(Math.floor(v/45))),h.append(nn.toAlphaNumericChar(v%45)),x-=2}if(x===1){if(u.available()<6)throw new Q;h.append(nn.toAlphaNumericChar(u.readBits(6)))}if(b)for(let v=w;v<h.length();v++)h.charAt(v)==="%"&&(v<h.length()-1&&h.charAt(v+1)==="%"?h.deleteCharAt(v+1):h.setCharAt(v,String.fromCharCode(29)))}static decodeNumericSegment(u,h,x){for(;x>=3;){if(u.available()<10)throw new Q;const b=u.readBits(10);if(b>=1e3)throw new Q;h.append(nn.toAlphaNumericChar(Math.floor(b/100))),h.append(nn.toAlphaNumericChar(Math.floor(b/10)%10)),h.append(nn.toAlphaNumericChar(b%10)),x-=3}if(x===2){if(u.available()<7)throw new Q;const b=u.readBits(7);if(b>=100)throw new Q;h.append(nn.toAlphaNumericChar(Math.floor(b/10))),h.append(nn.toAlphaNumericChar(b%10))}else if(x===1){if(u.available()<4)throw new Q;const b=u.readBits(4);if(b>=10)throw new Q;h.append(nn.toAlphaNumericChar(b))}}static parseECIValue(u){const h=u.readBits(8);if(!(h&128))return h&127;if((h&192)===128){const x=u.readBits(8);return(h&63)<<8&4294967295|x}if((h&224)===192){const x=u.readBits(16);return(h&31)<<16&4294967295|x}throw new Q}}nn.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",nn.GB2312_SUBSET=1;class _r{constructor(u){this.mirrored=u}isMirrored(){return this.mirrored}applyMirroredCorrection(u){if(!this.mirrored||u===null||u.length<3)return;const h=u[0];u[0]=u[2],u[2]=h}}class Pr{constructor(){this.rsDecoder=new dt(ft.QR_CODE_FIELD_256)}decodeBooleanArray(u,h){return this.decodeBitMatrix(R.parseFromBooleanArray(u),h)}decodeBitMatrix(u,h){const x=new Nr(u);let b=null;try{return this.decodeBitMatrixParser(x,h)}catch(w){b=w}try{x.remask(),x.setMirror(!0),x.readVersion(),x.readFormatInformation(),x.mirror();const w=this.decodeBitMatrixParser(x,h);return w.setOther(new _r(!0)),w}catch(w){throw b!==null?b:w}}decodeBitMatrixParser(u,h){const x=u.readVersion(),b=u.readFormatInformation().getErrorCorrectionLevel(),w=u.readCodewords(),v=cr.getDataBlocks(w,x,b);let T=0;for(const G of v)T+=G.getNumDataCodewords();const M=new Uint8Array(T);let D=0;for(const G of v){const re=G.getCodewords(),le=G.getNumDataCodewords();this.correctErrors(re,le);for(let xe=0;xe<le;xe++)M[D++]=re[xe]}return nn.decode(M,x,b,h)}correctErrors(u,h){const x=new Int32Array(u);try{this.rsDecoder.decode(x,u.length-h)}catch{throw new C}for(let b=0;b<h;b++)u[b]=x[b]}}class lr extends _e{constructor(u,h,x){super(u,h),this.estimatedModuleSize=x}aboutEquals(u,h,x){if(Math.abs(h-this.getY())<=u&&Math.abs(x-this.getX())<=u){const b=Math.abs(u-this.estimatedModuleSize);return b<=1||b<=this.estimatedModuleSize}return!1}combineEstimate(u,h,x){const b=(this.getX()+h)/2,w=(this.getY()+u)/2,v=(this.estimatedModuleSize+x)/2;return new lr(b,w,v)}}class nr{constructor(u,h,x,b,w,v,T){this.image=u,this.startX=h,this.startY=x,this.width=b,this.height=w,this.moduleSize=v,this.resultPointCallback=T,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const u=this.startX,h=this.height,x=this.width,b=u+x,w=this.startY+h/2,v=new Int32Array(3),T=this.image;for(let M=0;M<h;M++){const D=w+(M&1?-Math.floor((M+1)/2):Math.floor((M+1)/2));v[0]=0,v[1]=0,v[2]=0;let G=u;for(;G<b&&!T.get(G,D);)G++;let re=0;for(;G<b;){if(T.get(G,D))if(re===1)v[1]++;else if(re===2){if(this.foundPatternCross(v)){const le=this.handlePossibleCenter(v,D,G);if(le!==null)return le}v[0]=v[2],v[1]=1,v[2]=0,re=1}else v[++re]++;else re===1&&re++,v[re]++;G++}if(this.foundPatternCross(v)){const le=this.handlePossibleCenter(v,D,b);if(le!==null)return le}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new L}static centerFromEnd(u,h){return h-u[2]-u[1]/2}foundPatternCross(u){const h=this.moduleSize,x=h/2;for(let b=0;b<3;b++)if(Math.abs(h-u[b])>=x)return!1;return!0}crossCheckVertical(u,h,x,b){const w=this.image,v=w.getHeight(),T=this.crossCheckStateCount;T[0]=0,T[1]=0,T[2]=0;let M=u;for(;M>=0&&w.get(h,M)&&T[1]<=x;)T[1]++,M--;if(M<0||T[1]>x)return NaN;for(;M>=0&&!w.get(h,M)&&T[0]<=x;)T[0]++,M--;if(T[0]>x)return NaN;for(M=u+1;M<v&&w.get(h,M)&&T[1]<=x;)T[1]++,M++;if(M===v||T[1]>x)return NaN;for(;M<v&&!w.get(h,M)&&T[2]<=x;)T[2]++,M++;if(T[2]>x)return NaN;const D=T[0]+T[1]+T[2];return 5*Math.abs(D-b)>=2*b?NaN:this.foundPatternCross(T)?nr.centerFromEnd(T,M):NaN}handlePossibleCenter(u,h,x){const b=u[0]+u[1]+u[2],w=nr.centerFromEnd(u,x),v=this.crossCheckVertical(h,w,2*u[1],b);if(!isNaN(v)){const T=(u[0]+u[1]+u[2])/3;for(const D of this.possibleCenters)if(D.aboutEquals(T,v,w))return D.combineEstimate(v,w,T);const M=new lr(w,v,T);this.possibleCenters.push(M),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(M)}return null}}class ur extends _e{constructor(u,h,x,b){super(u,h),this.estimatedModuleSize=x,this.count=b,b===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(u,h,x){if(Math.abs(h-this.getY())<=u&&Math.abs(x-this.getX())<=u){const b=Math.abs(u-this.estimatedModuleSize);return b<=1||b<=this.estimatedModuleSize}return!1}combineEstimate(u,h,x){const b=this.count+1,w=(this.count*this.getX()+h)/b,v=(this.count*this.getY()+u)/b,T=(this.count*this.estimatedModuleSize+x)/b;return new ur(w,v,T,b)}}class Or{constructor(u){this.bottomLeft=u[0],this.topLeft=u[1],this.topRight=u[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class fn{constructor(u,h){this.image=u,this.resultPointCallback=h,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=h}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(u){const h=u!=null&&u.get(oe.TRY_HARDER)!==void 0,x=u!=null&&u.get(oe.PURE_BARCODE)!==void 0,b=this.image,w=b.getHeight(),v=b.getWidth();let T=Math.floor(3*w/(4*fn.MAX_MODULES));(T<fn.MIN_SKIP||h)&&(T=fn.MIN_SKIP);let M=!1;const D=new Int32Array(5);for(let re=T-1;re<w&&!M;re+=T){D[0]=0,D[1]=0,D[2]=0,D[3]=0,D[4]=0;let le=0;for(let xe=0;xe<v;xe++)if(b.get(xe,re))(le&1)===1&&le++,D[le]++;else if(le&1)D[le]++;else if(le===4)if(fn.foundPatternCross(D)){if(this.handlePossibleCenter(D,re,xe,x)===!0)if(T=2,this.hasSkipped===!0)M=this.haveMultiplyConfirmedCenters();else{const ve=this.findRowSkip();ve>D[2]&&(re+=ve-D[2]-T,xe=v-1)}else{D[0]=D[2],D[1]=D[3],D[2]=D[4],D[3]=1,D[4]=0,le=3;continue}le=0,D[0]=0,D[1]=0,D[2]=0,D[3]=0,D[4]=0}else D[0]=D[2],D[1]=D[3],D[2]=D[4],D[3]=1,D[4]=0,le=3;else D[++le]++;fn.foundPatternCross(D)&&this.handlePossibleCenter(D,re,v,x)===!0&&(T=D[0],this.hasSkipped&&(M=this.haveMultiplyConfirmedCenters()))}const G=this.selectBestPatterns();return _e.orderBestPatterns(G),new Or(G)}static centerFromEnd(u,h){return h-u[4]-u[3]-u[2]/2}static foundPatternCross(u){let h=0;for(let w=0;w<5;w++){const v=u[w];if(v===0)return!1;h+=v}if(h<7)return!1;const x=h/7,b=x/2;return Math.abs(x-u[0])<b&&Math.abs(x-u[1])<b&&Math.abs(3*x-u[2])<3*b&&Math.abs(x-u[3])<b&&Math.abs(x-u[4])<b}getCrossCheckStateCount(){const u=this.crossCheckStateCount;return u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u}crossCheckDiagonal(u,h,x,b){const w=this.getCrossCheckStateCount();let v=0;const T=this.image;for(;u>=v&&h>=v&&T.get(h-v,u-v);)w[2]++,v++;if(u<v||h<v)return!1;for(;u>=v&&h>=v&&!T.get(h-v,u-v)&&w[1]<=x;)w[1]++,v++;if(u<v||h<v||w[1]>x)return!1;for(;u>=v&&h>=v&&T.get(h-v,u-v)&&w[0]<=x;)w[0]++,v++;if(w[0]>x)return!1;const M=T.getHeight(),D=T.getWidth();for(v=1;u+v<M&&h+v<D&&T.get(h+v,u+v);)w[2]++,v++;if(u+v>=M||h+v>=D)return!1;for(;u+v<M&&h+v<D&&!T.get(h+v,u+v)&&w[3]<x;)w[3]++,v++;if(u+v>=M||h+v>=D||w[3]>=x)return!1;for(;u+v<M&&h+v<D&&T.get(h+v,u+v)&&w[4]<x;)w[4]++,v++;if(w[4]>=x)return!1;const G=w[0]+w[1]+w[2]+w[3]+w[4];return Math.abs(G-b)<2*b&&fn.foundPatternCross(w)}crossCheckVertical(u,h,x,b){const w=this.image,v=w.getHeight(),T=this.getCrossCheckStateCount();let M=u;for(;M>=0&&w.get(h,M);)T[2]++,M--;if(M<0)return NaN;for(;M>=0&&!w.get(h,M)&&T[1]<=x;)T[1]++,M--;if(M<0||T[1]>x)return NaN;for(;M>=0&&w.get(h,M)&&T[0]<=x;)T[0]++,M--;if(T[0]>x)return NaN;for(M=u+1;M<v&&w.get(h,M);)T[2]++,M++;if(M===v)return NaN;for(;M<v&&!w.get(h,M)&&T[3]<x;)T[3]++,M++;if(M===v||T[3]>=x)return NaN;for(;M<v&&w.get(h,M)&&T[4]<x;)T[4]++,M++;if(T[4]>=x)return NaN;const D=T[0]+T[1]+T[2]+T[3]+T[4];return 5*Math.abs(D-b)>=2*b?NaN:fn.foundPatternCross(T)?fn.centerFromEnd(T,M):NaN}crossCheckHorizontal(u,h,x,b){const w=this.image,v=w.getWidth(),T=this.getCrossCheckStateCount();let M=u;for(;M>=0&&w.get(M,h);)T[2]++,M--;if(M<0)return NaN;for(;M>=0&&!w.get(M,h)&&T[1]<=x;)T[1]++,M--;if(M<0||T[1]>x)return NaN;for(;M>=0&&w.get(M,h)&&T[0]<=x;)T[0]++,M--;if(T[0]>x)return NaN;for(M=u+1;M<v&&w.get(M,h);)T[2]++,M++;if(M===v)return NaN;for(;M<v&&!w.get(M,h)&&T[3]<x;)T[3]++,M++;if(M===v||T[3]>=x)return NaN;for(;M<v&&w.get(M,h)&&T[4]<x;)T[4]++,M++;if(T[4]>=x)return NaN;const D=T[0]+T[1]+T[2]+T[3]+T[4];return 5*Math.abs(D-b)>=b?NaN:fn.foundPatternCross(T)?fn.centerFromEnd(T,M):NaN}handlePossibleCenter(u,h,x,b){const w=u[0]+u[1]+u[2]+u[3]+u[4];let v=fn.centerFromEnd(u,x),T=this.crossCheckVertical(h,Math.floor(v),u[2],w);if(!isNaN(T)&&(v=this.crossCheckHorizontal(Math.floor(v),Math.floor(T),u[2],w),!isNaN(v)&&(!b||this.crossCheckDiagonal(Math.floor(T),Math.floor(v),u[2],w)))){const M=w/7;let D=!1;const G=this.possibleCenters;for(let re=0,le=G.length;re<le;re++){const xe=G[re];if(xe.aboutEquals(M,T,v)){G[re]=xe.combineEstimate(T,v,M),D=!0;break}}if(!D){const re=new ur(v,T,M);G.push(re),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(re)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let h=null;for(const x of this.possibleCenters)if(x.getCount()>=fn.CENTER_QUORUM)if(h==null)h=x;else return this.hasSkipped=!0,Math.floor((Math.abs(h.getX()-x.getX())-Math.abs(h.getY()-x.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let u=0,h=0;const x=this.possibleCenters.length;for(const v of this.possibleCenters)v.getCount()>=fn.CENTER_QUORUM&&(u++,h+=v.getEstimatedModuleSize());if(u<3)return!1;const b=h/x;let w=0;for(const v of this.possibleCenters)w+=Math.abs(v.getEstimatedModuleSize()-b);return w<=.05*h}selectBestPatterns(){const u=this.possibleCenters.length;if(u<3)throw new L;const h=this.possibleCenters;let x;if(u>3){let b=0,w=0;for(const M of this.possibleCenters){const D=M.getEstimatedModuleSize();b+=D,w+=D*D}x=b/u;let v=Math.sqrt(w/u-x*x);h.sort((M,D)=>{const G=Math.abs(D.getEstimatedModuleSize()-x),re=Math.abs(M.getEstimatedModuleSize()-x);return G<re?-1:G>re?1:0});const T=Math.max(.2*x,v);for(let M=0;M<h.length&&h.length>3;M++){const D=h[M];Math.abs(D.getEstimatedModuleSize()-x)>T&&(h.splice(M,1),M--)}}if(h.length>3){let b=0;for(const w of h)b+=w.getEstimatedModuleSize();x=b/h.length,h.sort((w,v)=>{if(v.getCount()===w.getCount()){const T=Math.abs(v.getEstimatedModuleSize()-x),M=Math.abs(w.getEstimatedModuleSize()-x);return T<M?1:T>M?-1:0}else return v.getCount()-w.getCount()}),h.splice(3)}return[h[0],h[1],h[2]]}}fn.CENTER_QUORUM=2,fn.MIN_SKIP=3,fn.MAX_MODULES=57;class Xn{constructor(u){this.image=u}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(u){this.resultPointCallback=u==null?null:u.get(oe.NEED_RESULT_POINT_CALLBACK);const x=new fn(this.image,this.resultPointCallback).find(u);return this.processFinderPatternInfo(x)}processFinderPatternInfo(u){const h=u.getTopLeft(),x=u.getTopRight(),b=u.getBottomLeft(),w=this.calculateModuleSize(h,x,b);if(w<1)throw new L("No pattern found in proccess finder.");const v=Xn.computeDimension(h,x,b,w),T=wt.getProvisionalVersionForDimension(v),M=T.getDimensionForVersion()-7;let D=null;if(T.getAlignmentPatternCenters().length>0){const xe=x.getX()-h.getX()+b.getX(),we=x.getY()-h.getY()+b.getY(),ve=1-3/M,Le=Math.floor(h.getX()+ve*(xe-h.getX())),ke=Math.floor(h.getY()+ve*(we-h.getY()));for(let Je=4;Je<=16;Je<<=1)try{D=this.findAlignmentInRegion(w,Le,ke,Je);break}catch(tt){if(!(tt instanceof L))throw tt}}const G=Xn.createTransform(h,x,b,D,v),re=Xn.sampleGrid(this.image,G,v);let le;return D===null?le=[b,h,x]:le=[b,h,x,D],new Ge(re,le)}static createTransform(u,h,x,b,w){const v=w-3.5;let T,M,D,G;return b!==null?(T=b.getX(),M=b.getY(),D=v-3,G=D):(T=h.getX()-u.getX()+x.getX(),M=h.getY()-u.getY()+x.getY(),D=v,G=v),We.quadrilateralToQuadrilateral(3.5,3.5,v,3.5,D,G,3.5,v,u.getX(),u.getY(),h.getX(),h.getY(),T,M,x.getX(),x.getY())}static sampleGrid(u,h,x){return U.getInstance().sampleGridWithTransform(u,x,x,h)}static computeDimension(u,h,x,b){const w=he.round(_e.distance(u,h)/b),v=he.round(_e.distance(u,x)/b);let T=Math.floor((w+v)/2)+7;switch(T&3){case 0:T++;break;case 2:T--;break;case 3:throw new L("Dimensions could be not found.")}return T}calculateModuleSize(u,h,x){return(this.calculateModuleSizeOneWay(u,h)+this.calculateModuleSizeOneWay(u,x))/2}calculateModuleSizeOneWay(u,h){const x=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(u.getX()),Math.floor(u.getY()),Math.floor(h.getX()),Math.floor(h.getY())),b=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(h.getX()),Math.floor(h.getY()),Math.floor(u.getX()),Math.floor(u.getY()));return isNaN(x)?b/7:isNaN(b)?x/7:(x+b)/14}sizeOfBlackWhiteBlackRunBothWays(u,h,x,b){let w=this.sizeOfBlackWhiteBlackRun(u,h,x,b),v=1,T=u-(x-u);T<0?(v=u/(u-T),T=0):T>=this.image.getWidth()&&(v=(this.image.getWidth()-1-u)/(T-u),T=this.image.getWidth()-1);let M=Math.floor(h-(b-h)*v);return v=1,M<0?(v=h/(h-M),M=0):M>=this.image.getHeight()&&(v=(this.image.getHeight()-1-h)/(M-h),M=this.image.getHeight()-1),T=Math.floor(u+(T-u)*v),w+=this.sizeOfBlackWhiteBlackRun(u,h,T,M),w-1}sizeOfBlackWhiteBlackRun(u,h,x,b){const w=Math.abs(b-h)>Math.abs(x-u);if(w){let xe=u;u=h,h=xe,xe=x,x=b,b=xe}const v=Math.abs(x-u),T=Math.abs(b-h);let M=-v/2;const D=u<x?1:-1,G=h<b?1:-1;let re=0;const le=x+D;for(let xe=u,we=h;xe!==le;xe+=D){const ve=w?we:xe,Le=w?xe:we;if(re===1===this.image.get(ve,Le)){if(re===2)return he.distance(xe,we,u,h);re++}if(M+=T,M>0){if(we===b)break;we+=G,M-=v}}return re===2?he.distance(x+D,b,u,h):NaN}findAlignmentInRegion(u,h,x,b){const w=Math.floor(b*u),v=Math.max(0,h-w),T=Math.min(this.image.getWidth()-1,h+w);if(T-v<u*3)throw new L("Alignment top exceeds estimated module size.");const M=Math.max(0,x-w),D=Math.min(this.image.getHeight()-1,x+w);if(D-M<u*3)throw new L("Alignment bottom exceeds estimated module size.");return new nr(this.image,v,M,T-v,D-M,u,this.resultPointCallback).find()}}class Bn{constructor(){this.decoder=new Pr}getDecoder(){return this.decoder}decode(u,h){let x,b;if(h!=null&&h.get(oe.PURE_BARCODE)!==void 0){const M=Bn.extractPureBits(u.getBlackMatrix());x=this.decoder.decodeBitMatrix(M,h),b=Bn.NO_POINTS}else{const M=new Xn(u.getBlackMatrix()).detect(h);x=this.decoder.decodeBitMatrix(M.getBits(),h),b=M.getPoints()}x.getOther()instanceof _r&&x.getOther().applyMirroredCorrection(b);const w=new Ee(x.getText(),x.getRawBytes(),void 0,b,Te.QR_CODE,void 0),v=x.getByteSegments();v!==null&&w.putMetadata(ze.BYTE_SEGMENTS,v);const T=x.getECLevel();return T!==null&&w.putMetadata(ze.ERROR_CORRECTION_LEVEL,T),x.hasStructuredAppend()&&(w.putMetadata(ze.STRUCTURED_APPEND_SEQUENCE,x.getStructuredAppendSequenceNumber()),w.putMetadata(ze.STRUCTURED_APPEND_PARITY,x.getStructuredAppendParity())),w}reset(){}static extractPureBits(u){const h=u.getTopLeftOnBit(),x=u.getBottomRightOnBit();if(h===null||x===null)throw new L;const b=this.moduleSize(h,u);let w=h[1],v=x[1],T=h[0],M=x[0];if(T>=M||w>=v)throw new L;if(v-w!==M-T&&(M=T+(v-w),M>=u.getWidth()))throw new L;const D=Math.round((M-T+1)/b),G=Math.round((v-w+1)/b);if(D<=0||G<=0)throw new L;if(G!==D)throw new L;const re=Math.floor(b/2);w+=re,T+=re;const le=T+Math.floor((D-1)*b)-M;if(le>0){if(le>re)throw new L;T-=le}const xe=w+Math.floor((G-1)*b)-v;if(xe>0){if(xe>re)throw new L;w-=xe}const we=new R(D,G);for(let ve=0;ve<G;ve++){const Le=w+Math.floor(ve*b);for(let ke=0;ke<D;ke++)u.get(T+Math.floor(ke*b),Le)&&we.set(ke,ve)}return we}static moduleSize(u,h){const x=h.getHeight(),b=h.getWidth();let w=u[0],v=u[1],T=!0,M=0;for(;w<b&&v<x;){if(T!==h.get(w,v)){if(++M===5)break;T=!T}w++,v++}if(w===b||v===x)throw new L;return(w-u[0])/7}}Bn.NO_POINTS=new Array;class Tt{PDF417Common(){}static getBitCountSum(u){return he.sum(u)}static toIntArray(u){if(u==null||!u.length)return Tt.EMPTY_INT_ARRAY;const h=new Int32Array(u.length);let x=0;for(const b of u)h[x++]=b;return h}static getCodeword(u){const h=j.binarySearch(Tt.SYMBOL_TABLE,u&262143);return h<0?-1:(Tt.CODEWORD_TABLE[h]-1)%Tt.NUMBER_OF_CODEWORDS}}Tt.NUMBER_OF_CODEWORDS=929,Tt.MAX_CODEWORDS_IN_BARCODE=Tt.NUMBER_OF_CODEWORDS-1,Tt.MIN_ROWS_IN_BARCODE=3,Tt.MAX_ROWS_IN_BARCODE=90,Tt.MODULES_IN_CODEWORD=17,Tt.MODULES_IN_STOP_PATTERN=18,Tt.BARS_IN_MODULE=8,Tt.EMPTY_INT_ARRAY=new Int32Array([]),Tt.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Tt.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Dr{constructor(u,h){this.bits=u,this.points=h}getBits(){return this.bits}getPoints(){return this.points}}class Pt{static detectMultiple(u,h,x){let b=u.getBlackMatrix(),w=Pt.detect(x,b);return w.length||(b=b.clone(),b.rotate180(),w=Pt.detect(x,b)),new Dr(b,w)}static detect(u,h){const x=new Array;let b=0,w=0,v=!1;for(;b<h.getHeight();){const T=Pt.findVertices(h,b,w);if(T[0]==null&&T[3]==null){if(!v)break;v=!1,w=0;for(const M of x)M[1]!=null&&(b=Math.trunc(Math.max(b,M[1].getY()))),M[3]!=null&&(b=Math.max(b,Math.trunc(M[3].getY())));b+=Pt.ROW_STEP;continue}if(v=!0,x.push(T),!u)break;T[2]!=null?(w=Math.trunc(T[2].getX()),b=Math.trunc(T[2].getY())):(w=Math.trunc(T[4].getX()),b=Math.trunc(T[4].getY()))}return x}static findVertices(u,h,x){const b=u.getHeight(),w=u.getWidth(),v=new Array(8);return Pt.copyToResult(v,Pt.findRowsWithPattern(u,b,w,h,x,Pt.START_PATTERN),Pt.INDEXES_START_PATTERN),v[4]!=null&&(x=Math.trunc(v[4].getX()),h=Math.trunc(v[4].getY())),Pt.copyToResult(v,Pt.findRowsWithPattern(u,b,w,h,x,Pt.STOP_PATTERN),Pt.INDEXES_STOP_PATTERN),v}static copyToResult(u,h,x){for(let b=0;b<x.length;b++)u[x[b]]=h[b]}static findRowsWithPattern(u,h,x,b,w,v){const T=new Array(4);let M=!1;const D=new Int32Array(v.length);for(;b<h;b+=Pt.ROW_STEP){let re=Pt.findGuardPattern(u,w,b,x,!1,v,D);if(re!=null){for(;b>0;){const le=Pt.findGuardPattern(u,w,--b,x,!1,v,D);if(le!=null)re=le;else{b++;break}}T[0]=new _e(re[0],b),T[1]=new _e(re[1],b),M=!0;break}}let G=b+1;if(M){let re=0,le=Int32Array.from([Math.trunc(T[0].getX()),Math.trunc(T[1].getX())]);for(;G<h;G++){const xe=Pt.findGuardPattern(u,le[0],G,x,!1,v,D);if(xe!=null&&Math.abs(le[0]-xe[0])<Pt.MAX_PATTERN_DRIFT&&Math.abs(le[1]-xe[1])<Pt.MAX_PATTERN_DRIFT)le=xe,re=0;else{if(re>Pt.SKIPPED_ROW_COUNT_MAX)break;re++}}G-=re+1,T[2]=new _e(le[0],G),T[3]=new _e(le[1],G)}return G-b<Pt.BARCODE_MIN_HEIGHT&&j.fill(T,null),T}static findGuardPattern(u,h,x,b,w,v,T){j.fillWithin(T,0,T.length,0);let M=h,D=0;for(;u.get(M,x)&&M>0&&D++<Pt.MAX_PIXEL_DRIFT;)M--;let G=M,re=0,le=v.length;for(let xe=w;G<b;G++)if(u.get(G,x)!==xe)T[re]++;else{if(re===le-1){if(Pt.patternMatchVariance(T,v,Pt.MAX_INDIVIDUAL_VARIANCE)<Pt.MAX_AVG_VARIANCE)return new Int32Array([M,G]);M+=T[0]+T[1],O.arraycopy(T,2,T,0,re-1),T[re-1]=0,T[re]=0,re--}else re++;T[re]=1,xe=!xe}return re===le-1&&Pt.patternMatchVariance(T,v,Pt.MAX_INDIVIDUAL_VARIANCE)<Pt.MAX_AVG_VARIANCE?new Int32Array([M,G-1]):null}static patternMatchVariance(u,h,x){let b=u.length,w=0,v=0;for(let D=0;D<b;D++)w+=u[D],v+=h[D];if(w<v)return 1/0;let T=w/v;x*=T;let M=0;for(let D=0;D<b;D++){let G=u[D],re=h[D]*T,le=G>re?G-re:re-G;if(le>x)return 1/0;M+=le}return M/w}}Pt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Pt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Pt.MAX_AVG_VARIANCE=.42,Pt.MAX_INDIVIDUAL_VARIANCE=.8,Pt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Pt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Pt.MAX_PIXEL_DRIFT=3,Pt.MAX_PATTERN_DRIFT=5,Pt.SKIPPED_ROW_COUNT_MAX=25,Pt.ROW_STEP=5,Pt.BARCODE_MIN_HEIGHT=10;class pn{constructor(u,h){if(h.length===0)throw new S;this.field=u;let x=h.length;if(x>1&&h[0]===0){let b=1;for(;b<x&&h[b]===0;)b++;b===x?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(x-b),O.arraycopy(h,b,this.coefficients,0,this.coefficients.length))}else this.coefficients=h}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(u){return this.coefficients[this.coefficients.length-1-u]}evaluateAt(u){if(u===0)return this.getCoefficient(0);if(u===1){let b=0;for(let w of this.coefficients)b=this.field.add(b,w);return b}let h=this.coefficients[0],x=this.coefficients.length;for(let b=1;b<x;b++)h=this.field.add(this.field.multiply(u,h),this.coefficients[b]);return h}add(u){if(!this.field.equals(u.field))throw new S("ModulusPolys do not have same ModulusGF field");if(this.isZero())return u;if(u.isZero())return this;let h=this.coefficients,x=u.coefficients;if(h.length>x.length){let v=h;h=x,x=v}let b=new Int32Array(x.length),w=x.length-h.length;O.arraycopy(x,0,b,0,w);for(let v=w;v<x.length;v++)b[v]=this.field.add(h[v-w],x[v]);return new pn(this.field,b)}subtract(u){if(!this.field.equals(u.field))throw new S("ModulusPolys do not have same ModulusGF field");return u.isZero()?this:this.add(u.negative())}multiply(u){return u instanceof pn?this.multiplyOther(u):this.multiplyScalar(u)}multiplyOther(u){if(!this.field.equals(u.field))throw new S("ModulusPolys do not have same ModulusGF field");if(this.isZero()||u.isZero())return new pn(this.field,new Int32Array([0]));let h=this.coefficients,x=h.length,b=u.coefficients,w=b.length,v=new Int32Array(x+w-1);for(let T=0;T<x;T++){let M=h[T];for(let D=0;D<w;D++)v[T+D]=this.field.add(v[T+D],this.field.multiply(M,b[D]))}return new pn(this.field,v)}negative(){let u=this.coefficients.length,h=new Int32Array(u);for(let x=0;x<u;x++)h[x]=this.field.subtract(0,this.coefficients[x]);return new pn(this.field,h)}multiplyScalar(u){if(u===0)return new pn(this.field,new Int32Array([0]));if(u===1)return this;let h=this.coefficients.length,x=new Int32Array(h);for(let b=0;b<h;b++)x[b]=this.field.multiply(this.coefficients[b],u);return new pn(this.field,x)}multiplyByMonomial(u,h){if(u<0)throw new S;if(h===0)return new pn(this.field,new Int32Array([0]));let x=this.coefficients.length,b=new Int32Array(x+u);for(let w=0;w<x;w++)b[w]=this.field.multiply(this.coefficients[w],h);return new pn(this.field,b)}toString(){let u=new V;for(let h=this.getDegree();h>=0;h--){let x=this.getCoefficient(h);x!==0&&(x<0?(u.append(" - "),x=-x):u.length()>0&&u.append(" + "),(h===0||x!==1)&&u.append(x),h!==0&&(h===1?u.append("x"):(u.append("x^"),u.append(h))))}return u.toString()}}class Br{add(u,h){return(u+h)%this.modulus}subtract(u,h){return(this.modulus+u-h)%this.modulus}exp(u){return this.expTable[u]}log(u){if(u===0)throw new S;return this.logTable[u]}inverse(u){if(u===0)throw new Ce;return this.expTable[this.modulus-this.logTable[u]-1]}multiply(u,h){return u===0||h===0?0:this.expTable[(this.logTable[u]+this.logTable[h])%(this.modulus-1)]}getSize(){return this.modulus}equals(u){return u===this}}class dr extends Br{constructor(u,h){super(),this.modulus=u,this.expTable=new Int32Array(u),this.logTable=new Int32Array(u);let x=1;for(let b=0;b<u;b++)this.expTable[b]=x,x=x*h%u;for(let b=0;b<u-1;b++)this.logTable[this.expTable[b]]=b;this.zero=new pn(this,new Int32Array([0])),this.one=new pn(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(u,h){if(u<0)throw new S;if(h===0)return this.zero;let x=new Int32Array(u+1);return x[0]=h,new pn(this,x)}}dr.PDF417_GF=new dr(Tt.NUMBER_OF_CODEWORDS,3);class br{constructor(){this.field=dr.PDF417_GF}decode(u,h,x){let b=new pn(this.field,u),w=new Int32Array(h),v=!1;for(let we=h;we>0;we--){let ve=b.evaluateAt(this.field.exp(we));w[h-we]=ve,ve!==0&&(v=!0)}if(!v)return 0;let T=this.field.getOne();if(x!=null)for(const we of x){let ve=this.field.exp(u.length-1-we),Le=new pn(this.field,new Int32Array([this.field.subtract(0,ve),1]));T=T.multiply(Le)}let M=new pn(this.field,w),D=this.runEuclideanAlgorithm(this.field.buildMonomial(h,1),M,h),G=D[0],re=D[1],le=this.findErrorLocations(G),xe=this.findErrorMagnitudes(re,G,le);for(let we=0;we<le.length;we++){let ve=u.length-1-this.field.log(le[we]);if(ve<0)throw C.getChecksumInstance();u[ve]=this.field.subtract(u[ve],xe[we])}return le.length}runEuclideanAlgorithm(u,h,x){if(u.getDegree()<h.getDegree()){let le=u;u=h,h=le}let b=u,w=h,v=this.field.getZero(),T=this.field.getOne();for(;w.getDegree()>=Math.round(x/2);){let le=b,xe=v;if(b=w,v=T,b.isZero())throw C.getChecksumInstance();w=le;let we=this.field.getZero(),ve=b.getCoefficient(b.getDegree()),Le=this.field.inverse(ve);for(;w.getDegree()>=b.getDegree()&&!w.isZero();){let ke=w.getDegree()-b.getDegree(),Je=this.field.multiply(w.getCoefficient(w.getDegree()),Le);we=we.add(this.field.buildMonomial(ke,Je)),w=w.subtract(b.multiplyByMonomial(ke,Je))}T=we.multiply(v).subtract(xe).negative()}let M=T.getCoefficient(0);if(M===0)throw C.getChecksumInstance();let D=this.field.inverse(M),G=T.multiply(D),re=w.multiply(D);return[G,re]}findErrorLocations(u){let h=u.getDegree(),x=new Int32Array(h),b=0;for(let w=1;w<this.field.getSize()&&b<h;w++)u.evaluateAt(w)===0&&(x[b]=this.field.inverse(w),b++);if(b!==h)throw C.getChecksumInstance();return x}findErrorMagnitudes(u,h,x){let b=h.getDegree(),w=new Int32Array(b);for(let D=1;D<=b;D++)w[b-D]=this.field.multiply(D,h.getCoefficient(D));let v=new pn(this.field,w),T=x.length,M=new Int32Array(T);for(let D=0;D<T;D++){let G=this.field.inverse(x[D]),re=this.field.subtract(0,u.evaluateAt(G)),le=this.field.inverse(v.evaluateAt(G));M[D]=this.field.multiply(re,le)}return M}}class Un{constructor(u,h,x,b,w){u instanceof Un?this.constructor_2(u):this.constructor_1(u,h,x,b,w)}constructor_1(u,h,x,b,w){const v=h==null||x==null,T=b==null||w==null;if(v&&T)throw new L;v?(h=new _e(0,b.getY()),x=new _e(0,w.getY())):T&&(b=new _e(u.getWidth()-1,h.getY()),w=new _e(u.getWidth()-1,x.getY())),this.image=u,this.topLeft=h,this.bottomLeft=x,this.topRight=b,this.bottomRight=w,this.minX=Math.trunc(Math.min(h.getX(),x.getX())),this.maxX=Math.trunc(Math.max(b.getX(),w.getX())),this.minY=Math.trunc(Math.min(h.getY(),b.getY())),this.maxY=Math.trunc(Math.max(x.getY(),w.getY()))}constructor_2(u){this.image=u.image,this.topLeft=u.getTopLeft(),this.bottomLeft=u.getBottomLeft(),this.topRight=u.getTopRight(),this.bottomRight=u.getBottomRight(),this.minX=u.getMinX(),this.maxX=u.getMaxX(),this.minY=u.getMinY(),this.maxY=u.getMaxY()}static merge(u,h){return u==null?h:h==null?u:new Un(u.image,u.topLeft,u.bottomLeft,h.topRight,h.bottomRight)}addMissingRows(u,h,x){let b=this.topLeft,w=this.bottomLeft,v=this.topRight,T=this.bottomRight;if(u>0){let M=x?this.topLeft:this.topRight,D=Math.trunc(M.getY()-u);D<0&&(D=0);let G=new _e(M.getX(),D);x?b=G:v=G}if(h>0){let M=x?this.bottomLeft:this.bottomRight,D=Math.trunc(M.getY()+h);D>=this.image.getHeight()&&(D=this.image.getHeight()-1);let G=new _e(M.getX(),D);x?w=G:T=G}return new Un(this.image,b,w,v,T)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class kr{constructor(u,h,x,b){this.columnCount=u,this.errorCorrectionLevel=b,this.rowCountUpperPart=h,this.rowCountLowerPart=x,this.rowCount=h+x}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class qn{constructor(){this.buffer=""}static form(u,h){let x=-1;function b(v,T,M,D,G,re){if(v==="%%")return"%";if(h[++x]===void 0)return;v=D?parseInt(D.substr(1)):void 0;let le=G?parseInt(G.substr(1)):void 0,xe;switch(re){case"s":xe=h[x];break;case"c":xe=h[x][0];break;case"f":xe=parseFloat(h[x]).toFixed(v);break;case"p":xe=parseFloat(h[x]).toPrecision(v);break;case"e":xe=parseFloat(h[x]).toExponential(v);break;case"x":xe=parseInt(h[x]).toString(le||16);break;case"d":xe=parseFloat(parseInt(h[x],le||10).toPrecision(v)).toFixed(0);break}xe=typeof xe=="object"?JSON.stringify(xe):(+xe).toString(le);let we=parseInt(M),ve=M&&M[0]+""=="0"?"0":" ";for(;xe.length<we;)xe=T!==void 0?xe+ve:ve+xe;return xe}let w=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return u.replace(w,b)}format(u,...h){this.buffer+=qn.form(u,h)}toString(){return this.buffer}}class Yn{constructor(u){this.boundingBox=new Un(u),this.codewords=new Array(u.getMaxY()-u.getMinY()+1)}getCodewordNearby(u){let h=this.getCodeword(u);if(h!=null)return h;for(let x=1;x<Yn.MAX_NEARBY_DISTANCE;x++){let b=this.imageRowToCodewordIndex(u)-x;if(b>=0&&(h=this.codewords[b],h!=null)||(b=this.imageRowToCodewordIndex(u)+x,b<this.codewords.length&&(h=this.codewords[b],h!=null)))return h}return null}imageRowToCodewordIndex(u){return u-this.boundingBox.getMinY()}setCodeword(u,h){this.codewords[this.imageRowToCodewordIndex(u)]=h}getCodeword(u){return this.codewords[this.imageRowToCodewordIndex(u)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const u=new qn;let h=0;for(const x of this.codewords){if(x==null){u.format("%3d:    |   %n",h++);continue}u.format("%3d: %3d|%3d%n",h++,x.getRowNumber(),x.getValue())}return u.toString()}}Yn.MAX_NEARBY_DISTANCE=5;class Zn{constructor(){this.values=new Map}setValue(u){u=Math.trunc(u);let h=this.values.get(u);h==null&&(h=0),h++,this.values.set(u,h)}getValue(){let u=-1,h=new Array;for(const[x,b]of this.values.entries()){const w={getKey:()=>x,getValue:()=>b};w.getValue()>u?(u=w.getValue(),h=[],h.push(w.getKey())):w.getValue()===u&&h.push(w.getKey())}return Tt.toIntArray(h)}getConfidence(u){return this.values.get(u)}}class Er extends Yn{constructor(u,h){super(u),this._isLeft=h}setRowNumbers(){for(let u of this.getCodewords())u!=null&&u.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(u){let h=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(h,u);let x=this.getBoundingBox(),b=this._isLeft?x.getTopLeft():x.getTopRight(),w=this._isLeft?x.getBottomLeft():x.getBottomRight(),v=this.imageRowToCodewordIndex(Math.trunc(b.getY())),T=this.imageRowToCodewordIndex(Math.trunc(w.getY())),M=-1,D=1,G=0;for(let re=v;re<T;re++){if(h[re]==null)continue;let le=h[re],xe=le.getRowNumber()-M;if(xe===0)G++;else if(xe===1)D=Math.max(D,G),G=1,M=le.getRowNumber();else if(xe<0||le.getRowNumber()>=u.getRowCount()||xe>re)h[re]=null;else{let we;D>2?we=(D-2)*xe:we=xe;let ve=we>=re;for(let Le=1;Le<=we&&!ve;Le++)ve=h[re-Le]!=null;ve?h[re]=null:(M=le.getRowNumber(),G=1)}}}getRowHeights(){let u=this.getBarcodeMetadata();if(u==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(u);let h=new Int32Array(u.getRowCount());for(let x of this.getCodewords())if(x!=null){let b=x.getRowNumber();if(b>=h.length)continue;h[b]++}return h}adjustIncompleteIndicatorColumnRowNumbers(u){let h=this.getBoundingBox(),x=this._isLeft?h.getTopLeft():h.getTopRight(),b=this._isLeft?h.getBottomLeft():h.getBottomRight(),w=this.imageRowToCodewordIndex(Math.trunc(x.getY())),v=this.imageRowToCodewordIndex(Math.trunc(b.getY())),T=this.getCodewords(),M=-1;for(let D=w;D<v;D++){if(T[D]==null)continue;let G=T[D];G.setRowNumberAsRowIndicatorColumn();let re=G.getRowNumber()-M;re===0||(re===1?M=G.getRowNumber():G.getRowNumber()>=u.getRowCount()?T[D]=null:M=G.getRowNumber())}}getBarcodeMetadata(){let u=this.getCodewords(),h=new Zn,x=new Zn,b=new Zn,w=new Zn;for(let T of u){if(T==null)continue;T.setRowNumberAsRowIndicatorColumn();let M=T.getValue()%30,D=T.getRowNumber();switch(this._isLeft||(D+=2),D%3){case 0:x.setValue(M*3+1);break;case 1:w.setValue(M/3),b.setValue(M%3);break;case 2:h.setValue(M+1);break}}if(h.getValue().length===0||x.getValue().length===0||b.getValue().length===0||w.getValue().length===0||h.getValue()[0]<1||x.getValue()[0]+b.getValue()[0]<Tt.MIN_ROWS_IN_BARCODE||x.getValue()[0]+b.getValue()[0]>Tt.MAX_ROWS_IN_BARCODE)return null;let v=new kr(h.getValue()[0],x.getValue()[0],b.getValue()[0],w.getValue()[0]);return this.removeIncorrectCodewords(u,v),v}removeIncorrectCodewords(u,h){for(let x=0;x<u.length;x++){let b=u[x];if(u[x]==null)continue;let w=b.getValue()%30,v=b.getRowNumber();if(v>h.getRowCount()){u[x]=null;continue}switch(this._isLeft||(v+=2),v%3){case 0:w*3+1!==h.getRowCountUpperPart()&&(u[x]=null);break;case 1:(Math.trunc(w/3)!==h.getErrorCorrectionLevel()||w%3!==h.getRowCountLowerPart())&&(u[x]=null);break;case 2:w+1!==h.getColumnCount()&&(u[x]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Qn{constructor(u,h){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=u,this.barcodeColumnCount=u.getColumnCount(),this.boundingBox=h,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let u=Tt.MAX_CODEWORDS_IN_BARCODE,h;do h=u,u=this.adjustRowNumbersAndGetCount();while(u>0&&u<h);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(u){u!=null&&u.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let u=this.adjustRowNumbersByRow();if(u===0)return 0;for(let h=1;h<this.barcodeColumnCount+1;h++){let x=this.detectionResultColumns[h].getCodewords();for(let b=0;b<x.length;b++)x[b]!=null&&(x[b].hasValidRowNumber()||this.adjustRowNumbers(h,b,x))}return u}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let u=this.detectionResultColumns[0].getCodewords(),h=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let x=0;x<u.length;x++)if(u[x]!=null&&h[x]!=null&&u[x].getRowNumber()===h[x].getRowNumber())for(let b=1;b<=this.barcodeColumnCount;b++){let w=this.detectionResultColumns[b].getCodewords()[x];w!=null&&(w.setRowNumber(u[x].getRowNumber()),w.hasValidRowNumber()||(this.detectionResultColumns[b].getCodewords()[x]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let u=0,h=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let x=0;x<h.length;x++){if(h[x]==null)continue;let b=h[x].getRowNumber(),w=0;for(let v=this.barcodeColumnCount+1;v>0&&w<this.ADJUST_ROW_NUMBER_SKIP;v--){let T=this.detectionResultColumns[v].getCodewords()[x];T!=null&&(w=Qn.adjustRowNumberIfValid(b,w,T),T.hasValidRowNumber()||u++)}}return u}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let u=0,h=this.detectionResultColumns[0].getCodewords();for(let x=0;x<h.length;x++){if(h[x]==null)continue;let b=h[x].getRowNumber(),w=0;for(let v=1;v<this.barcodeColumnCount+1&&w<this.ADJUST_ROW_NUMBER_SKIP;v++){let T=this.detectionResultColumns[v].getCodewords()[x];T!=null&&(w=Qn.adjustRowNumberIfValid(b,w,T),T.hasValidRowNumber()||u++)}}return u}static adjustRowNumberIfValid(u,h,x){return x==null||x.hasValidRowNumber()||(x.isValidRowNumber(u)?(x.setRowNumber(u),h=0):++h),h}adjustRowNumbers(u,h,x){if(!this.detectionResultColumns[u-1])return;let b=x[h],w=this.detectionResultColumns[u-1].getCodewords(),v=w;this.detectionResultColumns[u+1]!=null&&(v=this.detectionResultColumns[u+1].getCodewords());let T=new Array(14);T[2]=w[h],T[3]=v[h],h>0&&(T[0]=x[h-1],T[4]=w[h-1],T[5]=v[h-1]),h>1&&(T[8]=x[h-2],T[10]=w[h-2],T[11]=v[h-2]),h<x.length-1&&(T[1]=x[h+1],T[6]=w[h+1],T[7]=v[h+1]),h<x.length-2&&(T[9]=x[h+2],T[12]=w[h+2],T[13]=v[h+2]);for(let M of T)if(Qn.adjustRowNumber(b,M))return}static adjustRowNumber(u,h){return h==null?!1:h.hasValidRowNumber()&&h.getBucket()===u.getBucket()?(u.setRowNumber(h.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(u){this.boundingBox=u}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(u,h){this.detectionResultColumns[u]=h}getDetectionResultColumn(u){return this.detectionResultColumns[u]}toString(){let u=this.detectionResultColumns[0];u==null&&(u=this.detectionResultColumns[this.barcodeColumnCount+1]);let h=new qn;for(let x=0;x<u.getCodewords().length;x++){h.format("CW %3d:",x);for(let b=0;b<this.barcodeColumnCount+2;b++){if(this.detectionResultColumns[b]==null){h.format("    |   ");continue}let w=this.detectionResultColumns[b].getCodewords()[x];if(w==null){h.format("    |   ");continue}h.format(" %3d|%3d",w.getRowNumber(),w.getValue())}h.format("%n")}return h.toString()}}class Jn{constructor(u,h,x,b){this.rowNumber=Jn.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(u),this.endX=Math.trunc(h),this.bucket=Math.trunc(x),this.value=Math.trunc(b)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(u){return u!==Jn.BARCODE_ROW_UNKNOWN&&this.bucket===u%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(u){this.rowNumber=u}toString(){return this.rowNumber+"|"+this.value}}Jn.BARCODE_ROW_UNKNOWN=-1;class En{static initialize(){for(let u=0;u<Tt.SYMBOL_TABLE.length;u++){let h=Tt.SYMBOL_TABLE[u],x=h&1;for(let b=0;b<Tt.BARS_IN_MODULE;b++){let w=0;for(;(h&1)===x;)w+=1,h>>=1;x=h&1,En.RATIOS_TABLE[u]||(En.RATIOS_TABLE[u]=new Array(Tt.BARS_IN_MODULE)),En.RATIOS_TABLE[u][Tt.BARS_IN_MODULE-b-1]=Math.fround(w/Tt.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(u){let h=En.getDecodedCodewordValue(En.sampleBitCounts(u));return h!==-1?h:En.getClosestDecodedValue(u)}static sampleBitCounts(u){let h=he.sum(u),x=new Int32Array(Tt.BARS_IN_MODULE),b=0,w=0;for(let v=0;v<Tt.MODULES_IN_CODEWORD;v++){let T=h/(2*Tt.MODULES_IN_CODEWORD)+v*h/Tt.MODULES_IN_CODEWORD;w+u[b]<=T&&(w+=u[b],b++),x[b]++}return x}static getDecodedCodewordValue(u){let h=En.getBitValue(u);return Tt.getCodeword(h)===-1?-1:h}static getBitValue(u){let h=0;for(let x=0;x<u.length;x++)for(let b=0;b<u[x];b++)h=h<<1|(x%2===0?1:0);return Math.trunc(h)}static getClosestDecodedValue(u){let h=he.sum(u),x=new Array(Tt.BARS_IN_MODULE);if(h>1)for(let v=0;v<x.length;v++)x[v]=Math.fround(u[v]/h);let b=ue.MAX_VALUE,w=-1;this.bSymbolTableReady||En.initialize();for(let v=0;v<En.RATIOS_TABLE.length;v++){let T=0,M=En.RATIOS_TABLE[v];for(let D=0;D<Tt.BARS_IN_MODULE;D++){let G=Math.fround(M[D]-x[D]);if(T+=Math.fround(G*G),T>=b)break}T<b&&(b=T,w=Tt.SYMBOL_TABLE[v])}return w}}En.bSymbolTableReady=!1,En.RATIOS_TABLE=new Array(Tt.SYMBOL_TABLE.length).map(ne=>new Array(Tt.BARS_IN_MODULE));class wr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(u){this.segmentIndex=u}getFileId(){return this.fileId}setFileId(u){this.fileId=u}getOptionalData(){return this.optionalData}setOptionalData(u){this.optionalData=u}isLastSegment(){return this.lastSegment}setLastSegment(u){this.lastSegment=u}getSegmentCount(){return this.segmentCount}setSegmentCount(u){this.segmentCount=u}getSender(){return this.sender||null}setSender(u){this.sender=u}getAddressee(){return this.addressee||null}setAddressee(u){this.addressee=u}getFileName(){return this.fileName}setFileName(u){this.fileName=u}getFileSize(){return this.fileSize}setFileSize(u){this.fileSize=u}getChecksum(){return this.checksum}setChecksum(u){this.checksum=u}getTimestamp(){return this.timestamp}setTimestamp(u){this.timestamp=u}}class Sr{static parseLong(u,h=void 0){return parseInt(u,h)}}class vr extends _{}vr.kind="NullPointerException";class Fr{writeBytes(u){this.writeBytesOffset(u,0,u.length)}writeBytesOffset(u,h,x){if(u==null)throw new vr;if(h<0||h>u.length||x<0||h+x>u.length||h+x<0)throw new I;if(x===0)return;for(let b=0;b<x;b++)this.write(u[h+b])}flush(){}close(){}}class Ur extends _{}class $r extends Fr{constructor(u=32){if(super(),this.count=0,u<0)throw new S("Negative initial size: "+u);this.buf=new Uint8Array(u)}ensureCapacity(u){u-this.buf.length>0&&this.grow(u)}grow(u){let x=this.buf.length<<1;if(x-u<0&&(x=u),x<0){if(u<0)throw new Ur;x=B.MAX_VALUE}this.buf=j.copyOfUint8Array(this.buf,x)}write(u){this.ensureCapacity(this.count+1),this.buf[this.count]=u,this.count+=1}writeBytesOffset(u,h,x){if(h<0||h>u.length||x<0||h+x-u.length>0)throw new I;this.ensureCapacity(this.count+x),O.arraycopy(u,h,this.buf,this.count,x),this.count+=x}writeTo(u){u.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return j.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(u){return u?typeof u=="string"?this.toString_string(u):this.toString_number(u):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(u){return new String(this.buf).toString()}toString_number(u){return new String(this.buf).toString()}close(){}}var Gt;(function(ne){ne[ne.ALPHA=0]="ALPHA",ne[ne.LOWER=1]="LOWER",ne[ne.MIXED=2]="MIXED",ne[ne.PUNCT=3]="PUNCT",ne[ne.ALPHA_SHIFT=4]="ALPHA_SHIFT",ne[ne.PUNCT_SHIFT=5]="PUNCT_SHIFT"})(Gt||(Gt={}));function Ar(){if(typeof window<"u")return window.BigInt||null;if(typeof globalThis<"u")return globalThis.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let rr;function kn(ne){if(typeof rr>"u"&&(rr=Ar()),rr===null)throw new Error("BigInt is not supported!");return rr(ne)}function Vr(){let ne=[];ne[0]=kn(1);let u=kn(900);ne[1]=u;for(let h=2;h<16;h++)ne[h]=ne[h-1]*u;return ne}class Be{static decode(u,h){let x=new V(""),b=Z.ISO8859_1;x.enableDecoding(b);let w=1,v=u[w++],T=new wr;for(;w<u[0];){switch(v){case Be.TEXT_COMPACTION_MODE_LATCH:w=Be.textCompaction(u,w,x);break;case Be.BYTE_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH_6:w=Be.byteCompaction(v,u,b,w,x);break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:x.append(u[w++]);break;case Be.NUMERIC_COMPACTION_MODE_LATCH:w=Be.numericCompaction(u,w,x);break;case Be.ECI_CHARSET:Z.getCharacterSetECIByValue(u[w++]);break;case Be.ECI_GENERAL_PURPOSE:w+=2;break;case Be.ECI_USER_DEFINED:w++;break;case Be.BEGIN_MACRO_PDF417_CONTROL_BLOCK:w=Be.decodeMacroBlock(u,w,T);break;case Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Be.MACRO_PDF417_TERMINATOR:throw new Q;default:w--,w=Be.textCompaction(u,w,x);break}if(w<u.length)v=u[w++];else throw Q.getFormatInstance()}if(x.length()===0)throw Q.getFormatInstance();let M=new Ke(null,x.toString(),null,h);return M.setOther(T),M}static decodeMacroBlock(u,h,x){if(h+Be.NUMBER_OF_SEQUENCE_CODEWORDS>u[0])throw Q.getFormatInstance();let b=new Int32Array(Be.NUMBER_OF_SEQUENCE_CODEWORDS);for(let T=0;T<Be.NUMBER_OF_SEQUENCE_CODEWORDS;T++,h++)b[T]=u[h];x.setSegmentIndex(B.parseInt(Be.decodeBase900toBase10(b,Be.NUMBER_OF_SEQUENCE_CODEWORDS)));let w=new V;h=Be.textCompaction(u,h,w),x.setFileId(w.toString());let v=-1;for(u[h]===Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(v=h+1);h<u[0];)switch(u[h]){case Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(h++,u[h]){case Be.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let T=new V;h=Be.textCompaction(u,h+1,T),x.setFileName(T.toString());break;case Be.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let M=new V;h=Be.textCompaction(u,h+1,M),x.setSender(M.toString());break;case Be.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let D=new V;h=Be.textCompaction(u,h+1,D),x.setAddressee(D.toString());break;case Be.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let G=new V;h=Be.numericCompaction(u,h+1,G),x.setSegmentCount(B.parseInt(G.toString()));break;case Be.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let re=new V;h=Be.numericCompaction(u,h+1,re),x.setTimestamp(Sr.parseLong(re.toString()));break;case Be.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let le=new V;h=Be.numericCompaction(u,h+1,le),x.setChecksum(B.parseInt(le.toString()));break;case Be.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let xe=new V;h=Be.numericCompaction(u,h+1,xe),x.setFileSize(Sr.parseLong(xe.toString()));break;default:throw Q.getFormatInstance()}break;case Be.MACRO_PDF417_TERMINATOR:h++,x.setLastSegment(!0);break;default:throw Q.getFormatInstance()}if(v!==-1){let T=h-v;x.isLastSegment()&&T--,x.setOptionalData(j.copyOfRange(u,v,v+T))}return h}static textCompaction(u,h,x){let b=new Int32Array((u[0]-h)*2),w=new Int32Array((u[0]-h)*2),v=0,T=!1;for(;h<u[0]&&!T;){let M=u[h++];if(M<Be.TEXT_COMPACTION_MODE_LATCH)b[v]=M/30,b[v+1]=M%30,v+=2;else switch(M){case Be.TEXT_COMPACTION_MODE_LATCH:b[v++]=Be.TEXT_COMPACTION_MODE_LATCH;break;case Be.BYTE_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH_6:case Be.NUMERIC_COMPACTION_MODE_LATCH:case Be.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Be.MACRO_PDF417_TERMINATOR:h--,T=!0;break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b[v]=Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,M=u[h++],w[v]=M,v++;break}}return Be.decodeTextCompaction(b,w,v,x),h}static decodeTextCompaction(u,h,x,b){let w=Gt.ALPHA,v=Gt.ALPHA,T=0;for(;T<x;){let M=u[T],D="";switch(w){case Gt.ALPHA:if(M<26)D=String.fromCharCode(65+M);else switch(M){case 26:D=" ";break;case Be.LL:w=Gt.LOWER;break;case Be.ML:w=Gt.MIXED;break;case Be.PS:v=w,w=Gt.PUNCT_SHIFT;break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b.append(h[T]);break;case Be.TEXT_COMPACTION_MODE_LATCH:w=Gt.ALPHA;break}break;case Gt.LOWER:if(M<26)D=String.fromCharCode(97+M);else switch(M){case 26:D=" ";break;case Be.AS:v=w,w=Gt.ALPHA_SHIFT;break;case Be.ML:w=Gt.MIXED;break;case Be.PS:v=w,w=Gt.PUNCT_SHIFT;break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b.append(h[T]);break;case Be.TEXT_COMPACTION_MODE_LATCH:w=Gt.ALPHA;break}break;case Gt.MIXED:if(M<Be.PL)D=Be.MIXED_CHARS[M];else switch(M){case Be.PL:w=Gt.PUNCT;break;case 26:D=" ";break;case Be.LL:w=Gt.LOWER;break;case Be.AL:w=Gt.ALPHA;break;case Be.PS:v=w,w=Gt.PUNCT_SHIFT;break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b.append(h[T]);break;case Be.TEXT_COMPACTION_MODE_LATCH:w=Gt.ALPHA;break}break;case Gt.PUNCT:if(M<Be.PAL)D=Be.PUNCT_CHARS[M];else switch(M){case Be.PAL:w=Gt.ALPHA;break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b.append(h[T]);break;case Be.TEXT_COMPACTION_MODE_LATCH:w=Gt.ALPHA;break}break;case Gt.ALPHA_SHIFT:if(w=v,M<26)D=String.fromCharCode(65+M);else switch(M){case 26:D=" ";break;case Be.TEXT_COMPACTION_MODE_LATCH:w=Gt.ALPHA;break}break;case Gt.PUNCT_SHIFT:if(w=v,M<Be.PAL)D=Be.PUNCT_CHARS[M];else switch(M){case Be.PAL:w=Gt.ALPHA;break;case Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:b.append(h[T]);break;case Be.TEXT_COMPACTION_MODE_LATCH:w=Gt.ALPHA;break}break}D!==""&&b.append(D),T++}}static byteCompaction(u,h,x,b,w){let v=new $r,T=0,M=0,D=!1;switch(u){case Be.BYTE_COMPACTION_MODE_LATCH:let G=new Int32Array(6),re=h[b++];for(;b<h[0]&&!D;)switch(G[T++]=re,M=900*M+re,re=h[b++],re){case Be.TEXT_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH:case Be.NUMERIC_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH_6:case Be.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Be.MACRO_PDF417_TERMINATOR:b--,D=!0;break;default:if(T%5===0&&T>0){for(let le=0;le<6;++le)v.write(Number(kn(M)>>kn(8*(5-le))));M=0,T=0}break}b===h[0]&&re<Be.TEXT_COMPACTION_MODE_LATCH&&(G[T++]=re);for(let le=0;le<T;le++)v.write(G[le]);break;case Be.BYTE_COMPACTION_MODE_LATCH_6:for(;b<h[0]&&!D;){let le=h[b++];if(le<Be.TEXT_COMPACTION_MODE_LATCH)T++,M=900*M+le;else switch(le){case Be.TEXT_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH:case Be.NUMERIC_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH_6:case Be.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Be.MACRO_PDF417_TERMINATOR:b--,D=!0;break}if(T%5===0&&T>0){for(let xe=0;xe<6;++xe)v.write(Number(kn(M)>>kn(8*(5-xe))));M=0,T=0}}break}return w.append(ge.decode(v.toByteArray(),x)),b}static numericCompaction(u,h,x){let b=0,w=!1,v=new Int32Array(Be.MAX_NUMERIC_CODEWORDS);for(;h<u[0]&&!w;){let T=u[h++];if(h===u[0]&&(w=!0),T<Be.TEXT_COMPACTION_MODE_LATCH)v[b]=T,b++;else switch(T){case Be.TEXT_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH:case Be.BYTE_COMPACTION_MODE_LATCH_6:case Be.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Be.MACRO_PDF417_TERMINATOR:h--,w=!0;break}(b%Be.MAX_NUMERIC_CODEWORDS===0||T===Be.NUMERIC_COMPACTION_MODE_LATCH||w)&&b>0&&(x.append(Be.decodeBase900toBase10(v,b)),b=0)}return h}static decodeBase900toBase10(u,h){let x=kn(0);for(let w=0;w<h;w++)x+=Be.EXP900[h-w-1]*kn(u[w]);let b=x.toString();if(b.charAt(0)!=="1")throw new Q;return b.substring(1)}}Be.TEXT_COMPACTION_MODE_LATCH=900,Be.BYTE_COMPACTION_MODE_LATCH=901,Be.NUMERIC_COMPACTION_MODE_LATCH=902,Be.BYTE_COMPACTION_MODE_LATCH_6=924,Be.ECI_USER_DEFINED=925,Be.ECI_GENERAL_PURPOSE=926,Be.ECI_CHARSET=927,Be.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Be.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Be.MACRO_PDF417_TERMINATOR=922,Be.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Be.MAX_NUMERIC_CODEWORDS=15,Be.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Be.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Be.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Be.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Be.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Be.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Be.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Be.PL=25,Be.LL=27,Be.AS=27,Be.ML=28,Be.AL=28,Be.PS=29,Be.PAL=29,Be.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,Be.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",Be.EXP900=Ar()?Vr():[],Be.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Ot{constructor(){}static decode(u,h,x,b,w,v,T){let M=new Un(u,h,x,b,w),D=null,G=null,re;for(let we=!0;;we=!1){if(h!=null&&(D=Ot.getRowIndicatorColumn(u,M,h,!0,v,T)),b!=null&&(G=Ot.getRowIndicatorColumn(u,M,b,!1,v,T)),re=Ot.merge(D,G),re==null)throw L.getNotFoundInstance();let ve=re.getBoundingBox();if(we&&ve!=null&&(ve.getMinY()<M.getMinY()||ve.getMaxY()>M.getMaxY()))M=ve;else break}re.setBoundingBox(M);let le=re.getBarcodeColumnCount()+1;re.setDetectionResultColumn(0,D),re.setDetectionResultColumn(le,G);let xe=D!=null;for(let we=1;we<=le;we++){let ve=xe?we:le-we;if(re.getDetectionResultColumn(ve)!==void 0)continue;let Le;ve===0||ve===le?Le=new Er(M,ve===0):Le=new Yn(M),re.setDetectionResultColumn(ve,Le);let ke=-1,Je=ke;for(let tt=M.getMinY();tt<=M.getMaxY();tt++){if(ke=Ot.getStartColumn(re,ve,tt,xe),ke<0||ke>M.getMaxX()){if(Je===-1)continue;ke=Je}let qe=Ot.detectCodeword(u,M.getMinX(),M.getMaxX(),xe,ke,tt,v,T);qe!=null&&(Le.setCodeword(tt,qe),Je=ke,v=Math.min(v,qe.getWidth()),T=Math.max(T,qe.getWidth()))}}return Ot.createDecoderResult(re)}static merge(u,h){if(u==null&&h==null)return null;let x=Ot.getBarcodeMetadata(u,h);if(x==null)return null;let b=Un.merge(Ot.adjustBoundingBox(u),Ot.adjustBoundingBox(h));return new Qn(x,b)}static adjustBoundingBox(u){if(u==null)return null;let h=u.getRowHeights();if(h==null)return null;let x=Ot.getMax(h),b=0;for(let T of h)if(b+=x-T,T>0)break;let w=u.getCodewords();for(let T=0;b>0&&w[T]==null;T++)b--;let v=0;for(let T=h.length-1;T>=0&&(v+=x-h[T],!(h[T]>0));T--);for(let T=w.length-1;v>0&&w[T]==null;T--)v--;return u.getBoundingBox().addMissingRows(b,v,u.isLeft())}static getMax(u){let h=-1;for(let x of u)h=Math.max(h,x);return h}static getBarcodeMetadata(u,h){let x;if(u==null||(x=u.getBarcodeMetadata())==null)return h==null?null:h.getBarcodeMetadata();let b;return h==null||(b=h.getBarcodeMetadata())==null?x:x.getColumnCount()!==b.getColumnCount()&&x.getErrorCorrectionLevel()!==b.getErrorCorrectionLevel()&&x.getRowCount()!==b.getRowCount()?null:x}static getRowIndicatorColumn(u,h,x,b,w,v){let T=new Er(h,b);for(let M=0;M<2;M++){let D=M===0?1:-1,G=Math.trunc(Math.trunc(x.getX()));for(let re=Math.trunc(Math.trunc(x.getY()));re<=h.getMaxY()&&re>=h.getMinY();re+=D){let le=Ot.detectCodeword(u,0,u.getWidth(),b,G,re,w,v);le!=null&&(T.setCodeword(re,le),b?G=le.getStartX():G=le.getEndX())}}return T}static adjustCodewordCount(u,h){let x=h[0][1],b=x.getValue(),w=u.getBarcodeColumnCount()*u.getBarcodeRowCount()-Ot.getNumberOfECCodeWords(u.getBarcodeECLevel());if(b.length===0){if(w<1||w>Tt.MAX_CODEWORDS_IN_BARCODE)throw L.getNotFoundInstance();x.setValue(w)}else b[0]!==w&&x.setValue(w)}static createDecoderResult(u){let h=Ot.createBarcodeMatrix(u);Ot.adjustCodewordCount(u,h);let x=new Array,b=new Int32Array(u.getBarcodeRowCount()*u.getBarcodeColumnCount()),w=[],v=new Array;for(let M=0;M<u.getBarcodeRowCount();M++)for(let D=0;D<u.getBarcodeColumnCount();D++){let G=h[M][D+1].getValue(),re=M*u.getBarcodeColumnCount()+D;G.length===0?x.push(re):G.length===1?b[re]=G[0]:(v.push(re),w.push(G))}let T=new Array(w.length);for(let M=0;M<T.length;M++)T[M]=w[M];return Ot.createDecoderResultFromAmbiguousValues(u.getBarcodeECLevel(),b,Tt.toIntArray(x),Tt.toIntArray(v),T)}static createDecoderResultFromAmbiguousValues(u,h,x,b,w){let v=new Int32Array(b.length),T=100;for(;T-- >0;){for(let M=0;M<v.length;M++)h[b[M]]=w[M][v[M]];try{return Ot.decodeCodewords(h,u,x)}catch(M){if(!(M instanceof C))throw M}if(v.length===0)throw C.getChecksumInstance();for(let M=0;M<v.length;M++)if(v[M]<w[M].length-1){v[M]++;break}else if(v[M]=0,M===v.length-1)throw C.getChecksumInstance()}throw C.getChecksumInstance()}static createBarcodeMatrix(u){let h=Array.from({length:u.getBarcodeRowCount()},()=>new Array(u.getBarcodeColumnCount()+2));for(let b=0;b<h.length;b++)for(let w=0;w<h[b].length;w++)h[b][w]=new Zn;let x=0;for(let b of u.getDetectionResultColumns()){if(b!=null){for(let w of b.getCodewords())if(w!=null){let v=w.getRowNumber();if(v>=0){if(v>=h.length)continue;h[v][x].setValue(w.getValue())}}}x++}return h}static isValidBarcodeColumn(u,h){return h>=0&&h<=u.getBarcodeColumnCount()+1}static getStartColumn(u,h,x,b){let w=b?1:-1,v=null;if(Ot.isValidBarcodeColumn(u,h-w)&&(v=u.getDetectionResultColumn(h-w).getCodeword(x)),v!=null)return b?v.getEndX():v.getStartX();if(v=u.getDetectionResultColumn(h).getCodewordNearby(x),v!=null)return b?v.getStartX():v.getEndX();if(Ot.isValidBarcodeColumn(u,h-w)&&(v=u.getDetectionResultColumn(h-w).getCodewordNearby(x)),v!=null)return b?v.getEndX():v.getStartX();let T=0;for(;Ot.isValidBarcodeColumn(u,h-w);){h-=w;for(let M of u.getDetectionResultColumn(h).getCodewords())if(M!=null)return(b?M.getEndX():M.getStartX())+w*T*(M.getEndX()-M.getStartX());T++}return b?u.getBoundingBox().getMinX():u.getBoundingBox().getMaxX()}static detectCodeword(u,h,x,b,w,v,T,M){w=Ot.adjustCodewordStartColumn(u,h,x,b,w,v);let D=Ot.getModuleBitCount(u,h,x,b,w,v);if(D==null)return null;let G,re=he.sum(D);if(b)G=w+re;else{for(let we=0;we<D.length/2;we++){let ve=D[we];D[we]=D[D.length-1-we],D[D.length-1-we]=ve}G=w,w=G-re}if(!Ot.checkCodewordSkew(re,T,M))return null;let le=En.getDecodedValue(D),xe=Tt.getCodeword(le);return xe===-1?null:new Jn(w,G,Ot.getCodewordBucketNumber(le),xe)}static getModuleBitCount(u,h,x,b,w,v){let T=w,M=new Int32Array(8),D=0,G=b?1:-1,re=b;for(;(b?T<x:T>=h)&&D<M.length;)u.get(T,v)===re?(M[D]++,T+=G):(D++,re=!re);return D===M.length||T===(b?x:h)&&D===M.length-1?M:null}static getNumberOfECCodeWords(u){return 2<<u}static adjustCodewordStartColumn(u,h,x,b,w,v){let T=w,M=b?-1:1;for(let D=0;D<2;D++){for(;(b?T>=h:T<x)&&b===u.get(T,v);){if(Math.abs(w-T)>Ot.CODEWORD_SKEW_SIZE)return w;T+=M}M=-M,b=!b}return T}static checkCodewordSkew(u,h,x){return h-Ot.CODEWORD_SKEW_SIZE<=u&&u<=x+Ot.CODEWORD_SKEW_SIZE}static decodeCodewords(u,h,x){if(u.length===0)throw Q.getFormatInstance();let b=1<<h+1,w=Ot.correctErrors(u,x,b);Ot.verifyCodewordCount(u,b);let v=Be.decode(u,""+h);return v.setErrorsCorrected(w),v.setErasures(x.length),v}static correctErrors(u,h,x){if(h!=null&&h.length>x/2+Ot.MAX_ERRORS||x<0||x>Ot.MAX_EC_CODEWORDS)throw C.getChecksumInstance();return Ot.errorCorrection.decode(u,x,h)}static verifyCodewordCount(u,h){if(u.length<4)throw Q.getFormatInstance();let x=u[0];if(x>u.length)throw Q.getFormatInstance();if(x===0)if(h<u.length)u[0]=u.length-h;else throw Q.getFormatInstance()}static getBitCountForCodeword(u){let h=new Int32Array(8),x=0,b=h.length-1;for(;!((u&1)!==x&&(x=u&1,b--,b<0));)h[b]++,u>>=1;return h}static getCodewordBucketNumber(u){return u instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(u):this.getCodewordBucketNumber_number(u)}static getCodewordBucketNumber_number(u){return Ot.getCodewordBucketNumber(Ot.getBitCountForCodeword(u))}static getCodewordBucketNumber_Int32Array(u){return(u[0]-u[2]+u[4]-u[6]+9)%9}static toString(u){let h=new qn;for(let x=0;x<u.length;x++){h.format("Row %2d: ",x);for(let b=0;b<u[x].length;b++){let w=u[x][b];w.getValue().length===0?h.format("        ",null):h.format("%4d(%2d)",w.getValue()[0],w.getConfidence(w.getValue()[0]))}h.format("%n")}return h.toString()}}Ot.CODEWORD_SKEW_SIZE=2,Ot.MAX_ERRORS=3,Ot.MAX_EC_CODEWORDS=512,Ot.errorCorrection=new br;class mn{decode(u,h=null){let x=mn.decode(u,h,!1);if(x==null||x.length===0||x[0]==null)throw L.getNotFoundInstance();return x[0]}decodeMultiple(u,h=null){try{return mn.decode(u,h,!0)}catch(x){throw x instanceof Q||x instanceof C?L.getNotFoundInstance():x}}static decode(u,h,x){const b=new Array,w=Pt.detectMultiple(u,h,x);for(const v of w.getPoints()){const T=Ot.decode(w.getBits(),v[4],v[5],v[6],v[7],mn.getMinCodewordWidth(v),mn.getMaxCodewordWidth(v)),M=new Ee(T.getText(),T.getRawBytes(),void 0,v,Te.PDF_417);M.putMetadata(ze.ERROR_CORRECTION_LEVEL,T.getECLevel());const D=T.getOther();D!=null&&M.putMetadata(ze.PDF417_EXTRA_METADATA,D),b.push(M)}return b.map(v=>v)}static getMaxWidth(u,h){return u==null||h==null?0:Math.trunc(Math.abs(u.getX()-h.getX()))}static getMinWidth(u,h){return u==null||h==null?B.MAX_VALUE:Math.trunc(Math.abs(u.getX()-h.getX()))}static getMaxCodewordWidth(u){return Math.floor(Math.max(Math.max(mn.getMaxWidth(u[0],u[4]),mn.getMaxWidth(u[6],u[2])*Tt.MODULES_IN_CODEWORD/Tt.MODULES_IN_STOP_PATTERN),Math.max(mn.getMaxWidth(u[1],u[5]),mn.getMaxWidth(u[7],u[3])*Tt.MODULES_IN_CODEWORD/Tt.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(u){return Math.floor(Math.min(Math.min(mn.getMinWidth(u[0],u[4]),mn.getMinWidth(u[6],u[2])*Tt.MODULES_IN_CODEWORD/Tt.MODULES_IN_STOP_PATTERN),Math.min(mn.getMinWidth(u[1],u[5]),mn.getMinWidth(u[7],u[3])*Tt.MODULES_IN_CODEWORD/Tt.MODULES_IN_STOP_PATTERN)))}reset(){}}class ir extends _{}ir.kind="ReaderException";class Tr{constructor(u,h){this.verbose=u===!0,h&&this.setHints(h)}decode(u,h){return h&&this.setHints(h),this.decodeInternal(u)}decodeWithState(u){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(u)}setHints(u){this.hints=u;const h=!o(u)&&u.get(oe.TRY_HARDER)===!0,x=o(u)?null:u.get(oe.POSSIBLE_FORMATS),b=new Array;if(!o(x)){const w=x.some(v=>v===Te.UPC_A||v===Te.UPC_E||v===Te.EAN_13||v===Te.EAN_8||v===Te.CODABAR||v===Te.CODE_39||v===Te.CODE_93||v===Te.CODE_128||v===Te.ITF||v===Te.RSS_14||v===Te.RSS_EXPANDED);w&&!h&&b.push(new Qt(u,this.verbose)),x.includes(Te.QR_CODE)&&b.push(new Bn),x.includes(Te.DATA_MATRIX)&&b.push(new xn),x.includes(Te.AZTEC)&&b.push(new be),x.includes(Te.PDF_417)&&b.push(new mn),w&&h&&b.push(new Qt(u,this.verbose))}b.length===0&&(h||b.push(new Qt(u,this.verbose)),b.push(new Bn),b.push(new xn),b.push(new be),b.push(new mn),h&&b.push(new Qt(u,this.verbose))),this.readers=b}reset(){if(this.readers!==null)for(const u of this.readers)u.reset()}decodeInternal(u){if(this.readers===null)throw new ir("No readers where selected, nothing can be read.");for(const h of this.readers)try{return h.decode(u,this.hints)}catch(x){if(x instanceof ir)continue}throw new L("No MultiFormat Readers were able to detect the code.")}}class Hr extends J{constructor(u=null,h=500){const x=new Tr;x.setHints(u),super(x,h)}decodeBitmap(u){return this.reader.decodeWithState(u)}}class zr extends J{constructor(u=500){super(new mn,u)}}class jr extends J{constructor(u=500){super(new Bn,u)}}var hr;(function(ne){ne[ne.ERROR_CORRECTION=0]="ERROR_CORRECTION",ne[ne.CHARACTER_SET=1]="CHARACTER_SET",ne[ne.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",ne[ne.MIN_SIZE=3]="MIN_SIZE",ne[ne.MAX_SIZE=4]="MAX_SIZE",ne[ne.MARGIN=5]="MARGIN",ne[ne.PDF417_COMPACT=6]="PDF417_COMPACT",ne[ne.PDF417_COMPACTION=7]="PDF417_COMPACTION",ne[ne.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",ne[ne.AZTEC_LAYERS=9]="AZTEC_LAYERS",ne[ne.QR_VERSION=10]="QR_VERSION"})(hr||(hr={}));var un=hr;class fr{constructor(u){this.field=u,this.cachedGenerators=[],this.cachedGenerators.push(new Ye(u,Int32Array.from([1])))}buildGenerator(u){const h=this.cachedGenerators;if(u>=h.length){let x=h[h.length-1];const b=this.field;for(let w=h.length;w<=u;w++){const v=x.multiply(new Ye(b,Int32Array.from([1,b.exp(w-1+b.getGeneratorBase())])));h.push(v),x=v}}return h[u]}encode(u,h){if(h===0)throw new S("No error correction bytes");const x=u.length-h;if(x<=0)throw new S("No data bytes provided");const b=this.buildGenerator(h),w=new Int32Array(x);O.arraycopy(u,0,w,0,x);let v=new Ye(this.field,w);v=v.multiplyByMonomial(h,1);const M=v.divide(b)[1].getCoefficients(),D=h-M.length;for(let G=0;G<D;G++)u[x+G]=0;O.arraycopy(M,0,u,x+D,M.length)}}class sn{constructor(){}static applyMaskPenaltyRule1(u){return sn.applyMaskPenaltyRule1Internal(u,!0)+sn.applyMaskPenaltyRule1Internal(u,!1)}static applyMaskPenaltyRule2(u){let h=0;const x=u.getArray(),b=u.getWidth(),w=u.getHeight();for(let v=0;v<w-1;v++){const T=x[v];for(let M=0;M<b-1;M++){const D=T[M];D===T[M+1]&&D===x[v+1][M]&&D===x[v+1][M+1]&&h++}}return sn.N2*h}static applyMaskPenaltyRule3(u){let h=0;const x=u.getArray(),b=u.getWidth(),w=u.getHeight();for(let v=0;v<w;v++)for(let T=0;T<b;T++){const M=x[v];T+6<b&&M[T]===1&&M[T+1]===0&&M[T+2]===1&&M[T+3]===1&&M[T+4]===1&&M[T+5]===0&&M[T+6]===1&&(sn.isWhiteHorizontal(M,T-4,T)||sn.isWhiteHorizontal(M,T+7,T+11))&&h++,v+6<w&&x[v][T]===1&&x[v+1][T]===0&&x[v+2][T]===1&&x[v+3][T]===1&&x[v+4][T]===1&&x[v+5][T]===0&&x[v+6][T]===1&&(sn.isWhiteVertical(x,T,v-4,v)||sn.isWhiteVertical(x,T,v+7,v+11))&&h++}return h*sn.N3}static isWhiteHorizontal(u,h,x){h=Math.max(h,0),x=Math.min(x,u.length);for(let b=h;b<x;b++)if(u[b]===1)return!1;return!0}static isWhiteVertical(u,h,x,b){x=Math.max(x,0),b=Math.min(b,u.length);for(let w=x;w<b;w++)if(u[w][h]===1)return!1;return!0}static applyMaskPenaltyRule4(u){let h=0;const x=u.getArray(),b=u.getWidth(),w=u.getHeight();for(let M=0;M<w;M++){const D=x[M];for(let G=0;G<b;G++)D[G]===1&&h++}const v=u.getHeight()*u.getWidth();return Math.floor(Math.abs(h*2-v)*10/v)*sn.N4}static getDataMaskBit(u,h,x){let b,w;switch(u){case 0:b=x+h&1;break;case 1:b=x&1;break;case 2:b=h%3;break;case 3:b=(x+h)%3;break;case 4:b=Math.floor(x/2)+Math.floor(h/3)&1;break;case 5:w=x*h,b=(w&1)+w%3;break;case 6:w=x*h,b=(w&1)+w%3&1;break;case 7:w=x*h,b=w%3+(x+h&1)&1;break;default:throw new S("Invalid mask pattern: "+u)}return b===0}static applyMaskPenaltyRule1Internal(u,h){let x=0;const b=h?u.getHeight():u.getWidth(),w=h?u.getWidth():u.getHeight(),v=u.getArray();for(let T=0;T<b;T++){let M=0,D=-1;for(let G=0;G<w;G++){const re=h?v[T][G]:v[G][T];re===D?M++:(M>=5&&(x+=sn.N1+(M-5)),M=1,D=re)}M>=5&&(x+=sn.N1+(M-5))}return x}}sn.N1=3,sn.N2=3,sn.N3=40,sn.N4=10;class sr{constructor(u,h){this.width=u,this.height=h;const x=new Array(h);for(let b=0;b!==h;b++)x[b]=new Uint8Array(u);this.bytes=x}getHeight(){return this.height}getWidth(){return this.width}get(u,h){return this.bytes[h][u]}getArray(){return this.bytes}setNumber(u,h,x){this.bytes[h][u]=x}setBoolean(u,h,x){this.bytes[h][u]=x?1:0}clear(u){for(const h of this.bytes)j.fill(h,u)}equals(u){if(!(u instanceof sr))return!1;const h=u;if(this.width!==h.width||this.height!==h.height)return!1;for(let x=0,b=this.height;x<b;++x){const w=this.bytes[x],v=h.bytes[x];for(let T=0,M=this.width;T<M;++T)if(w[T]!==v[T])return!1}return!0}toString(){const u=new V;for(let h=0,x=this.height;h<x;++h){const b=this.bytes[h];for(let w=0,v=this.width;w<v;++w)switch(b[w]){case 0:u.append(" 0");break;case 1:u.append(" 1");break;default:u.append("  ");break}u.append(`
`)}return u.toString()}}class $n{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const u=new V;return u.append(`<<
`),u.append(" mode: "),u.append(this.mode?this.mode.toString():"null"),u.append(`
 ecLevel: `),u.append(this.ecLevel?this.ecLevel.toString():"null"),u.append(`
 version: `),u.append(this.version?this.version.toString():"null"),u.append(`
 maskPattern: `),u.append(this.maskPattern.toString()),this.matrix?(u.append(`
 matrix:
`),u.append(this.matrix.toString())):u.append(`
 matrix: null
`),u.append(`>>
`),u.toString()}setMode(u){this.mode=u}setECLevel(u){this.ecLevel=u}setVersion(u){this.version=u}setMaskPattern(u){this.maskPattern=u}setMatrix(u){this.matrix=u}static isValidMaskPattern(u){return u>=0&&u<$n.NUM_MASK_PATTERNS}}$n.NUM_MASK_PATTERNS=8;class qt extends _{}qt.kind="WriterException";class At{constructor(){}static clearMatrix(u){u.clear(255)}static buildMatrix(u,h,x,b,w){At.clearMatrix(w),At.embedBasicPatterns(x,w),At.embedTypeInfo(h,b,w),At.maybeEmbedVersionInfo(x,w),At.embedDataBits(u,b,w)}static embedBasicPatterns(u,h){At.embedPositionDetectionPatternsAndSeparators(h),At.embedDarkDotAtLeftBottomCorner(h),At.maybeEmbedPositionAdjustmentPatterns(u,h),At.embedTimingPatterns(h)}static embedTypeInfo(u,h,x){const b=new H;At.makeTypeInfoBits(u,h,b);for(let w=0,v=b.getSize();w<v;++w){const T=b.get(b.getSize()-1-w),M=At.TYPE_INFO_COORDINATES[w],D=M[0],G=M[1];if(x.setBoolean(D,G,T),w<8){const re=x.getWidth()-w-1,le=8;x.setBoolean(re,le,T)}else{const le=x.getHeight()-7+(w-8);x.setBoolean(8,le,T)}}}static maybeEmbedVersionInfo(u,h){if(u.getVersionNumber()<7)return;const x=new H;At.makeVersionInfoBits(u,x);let b=6*3-1;for(let w=0;w<6;++w)for(let v=0;v<3;++v){const T=x.get(b);b--,h.setBoolean(w,h.getHeight()-11+v,T),h.setBoolean(h.getHeight()-11+v,w,T)}}static embedDataBits(u,h,x){let b=0,w=-1,v=x.getWidth()-1,T=x.getHeight()-1;for(;v>0;){for(v===6&&(v-=1);T>=0&&T<x.getHeight();){for(let M=0;M<2;++M){const D=v-M;if(!At.isEmpty(x.get(D,T)))continue;let G;b<u.getSize()?(G=u.get(b),++b):G=!1,h!==255&&sn.getDataMaskBit(h,D,T)&&(G=!G),x.setBoolean(D,T,G)}T+=w}w=-w,T+=w,v-=2}if(b!==u.getSize())throw new qt("Not all bits consumed: "+b+"/"+u.getSize())}static findMSBSet(u){return 32-B.numberOfLeadingZeros(u)}static calculateBCHCode(u,h){if(h===0)throw new S("0 polynomial");const x=At.findMSBSet(h);for(u<<=x-1;At.findMSBSet(u)>=x;)u^=h<<At.findMSBSet(u)-x;return u}static makeTypeInfoBits(u,h,x){if(!$n.isValidMaskPattern(h))throw new qt("Invalid mask pattern");const b=u.getBits()<<3|h;x.appendBits(b,5);const w=At.calculateBCHCode(b,At.TYPE_INFO_POLY);x.appendBits(w,10);const v=new H;if(v.appendBits(At.TYPE_INFO_MASK_PATTERN,15),x.xor(v),x.getSize()!==15)throw new qt("should not happen but we got: "+x.getSize())}static makeVersionInfoBits(u,h){h.appendBits(u.getVersionNumber(),6);const x=At.calculateBCHCode(u.getVersionNumber(),At.VERSION_INFO_POLY);if(h.appendBits(x,12),h.getSize()!==18)throw new qt("should not happen but we got: "+h.getSize())}static isEmpty(u){return u===255}static embedTimingPatterns(u){for(let h=8;h<u.getWidth()-8;++h){const x=(h+1)%2;At.isEmpty(u.get(h,6))&&u.setNumber(h,6,x),At.isEmpty(u.get(6,h))&&u.setNumber(6,h,x)}}static embedDarkDotAtLeftBottomCorner(u){if(u.get(8,u.getHeight()-8)===0)throw new qt;u.setNumber(8,u.getHeight()-8,1)}static embedHorizontalSeparationPattern(u,h,x){for(let b=0;b<8;++b){if(!At.isEmpty(x.get(u+b,h)))throw new qt;x.setNumber(u+b,h,0)}}static embedVerticalSeparationPattern(u,h,x){for(let b=0;b<7;++b){if(!At.isEmpty(x.get(u,h+b)))throw new qt;x.setNumber(u,h+b,0)}}static embedPositionAdjustmentPattern(u,h,x){for(let b=0;b<5;++b){const w=At.POSITION_ADJUSTMENT_PATTERN[b];for(let v=0;v<5;++v)x.setNumber(u+v,h+b,w[v])}}static embedPositionDetectionPattern(u,h,x){for(let b=0;b<7;++b){const w=At.POSITION_DETECTION_PATTERN[b];for(let v=0;v<7;++v)x.setNumber(u+v,h+b,w[v])}}static embedPositionDetectionPatternsAndSeparators(u){const h=At.POSITION_DETECTION_PATTERN[0].length;At.embedPositionDetectionPattern(0,0,u),At.embedPositionDetectionPattern(u.getWidth()-h,0,u),At.embedPositionDetectionPattern(0,u.getWidth()-h,u);const x=8;At.embedHorizontalSeparationPattern(0,x-1,u),At.embedHorizontalSeparationPattern(u.getWidth()-x,x-1,u),At.embedHorizontalSeparationPattern(0,u.getWidth()-x,u);const b=7;At.embedVerticalSeparationPattern(b,0,u),At.embedVerticalSeparationPattern(u.getHeight()-b-1,0,u),At.embedVerticalSeparationPattern(b,u.getHeight()-b,u)}static maybeEmbedPositionAdjustmentPatterns(u,h){if(u.getVersionNumber()<2)return;const x=u.getVersionNumber()-1,b=At.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[x];for(let w=0,v=b.length;w!==v;w++){const T=b[w];if(T>=0)for(let M=0;M!==v;M++){const D=b[M];D>=0&&At.isEmpty(h.get(D,T))&&At.embedPositionAdjustmentPattern(D-2,T-2,h)}}}}At.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),At.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),At.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),At.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),At.VERSION_INFO_POLY=7973,At.TYPE_INFO_POLY=1335,At.TYPE_INFO_MASK_PATTERN=21522;class Gr{constructor(u,h){this.dataBytes=u,this.errorCorrectionBytes=h}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Zt{constructor(){}static calculateMaskPenalty(u){return sn.applyMaskPenaltyRule1(u)+sn.applyMaskPenaltyRule2(u)+sn.applyMaskPenaltyRule3(u)+sn.applyMaskPenaltyRule4(u)}static encode(u,h,x=null){let b=Zt.DEFAULT_BYTE_MODE_ENCODING;const w=x!==null&&x.get(un.CHARACTER_SET)!==void 0;w&&(b=x.get(un.CHARACTER_SET).toString());const v=this.chooseMode(u,b),T=new H;if(v===vt.BYTE&&(w||Zt.DEFAULT_BYTE_MODE_ENCODING!==b)){const tt=Z.getCharacterSetECIByName(b);tt!==void 0&&this.appendECI(tt,T)}this.appendModeInfo(v,T);const M=new H;this.appendBytes(u,v,M,b);let D;if(x!==null&&x.get(un.QR_VERSION)!==void 0){const tt=Number.parseInt(x.get(un.QR_VERSION).toString(),10);D=wt.getVersionForNumber(tt);const qe=this.calculateBitsNeeded(v,T,M,D);if(!this.willFit(qe,D,h))throw new qt("Data too big for requested version")}else D=this.recommendVersion(h,v,T,M);const G=new H;G.appendBitArray(T);const re=v===vt.BYTE?M.getSizeInBytes():u.length;this.appendLengthInfo(re,D,v,G),G.appendBitArray(M);const le=D.getECBlocksForLevel(h),xe=D.getTotalCodewords()-le.getTotalECCodewords();this.terminateBits(xe,G);const we=this.interleaveWithECBytes(G,D.getTotalCodewords(),xe,le.getNumBlocks()),ve=new $n;ve.setECLevel(h),ve.setMode(v),ve.setVersion(D);const Le=D.getDimensionForVersion(),ke=new sr(Le,Le),Je=this.chooseMaskPattern(we,h,D,ke);return ve.setMaskPattern(Je),At.buildMatrix(we,h,D,Je,ke),ve.setMatrix(ke),ve}static recommendVersion(u,h,x,b){const w=this.calculateBitsNeeded(h,x,b,wt.getVersionForNumber(1)),v=this.chooseVersion(w,u),T=this.calculateBitsNeeded(h,x,b,v);return this.chooseVersion(T,u)}static calculateBitsNeeded(u,h,x,b){return h.getSize()+u.getCharacterCountBits(b)+x.getSize()}static getAlphanumericCode(u){return u<Zt.ALPHANUMERIC_TABLE.length?Zt.ALPHANUMERIC_TABLE[u]:-1}static chooseMode(u,h=null){if(Z.SJIS.getName()===h&&this.isOnlyDoubleByteKanji(u))return vt.KANJI;let x=!1,b=!1;for(let w=0,v=u.length;w<v;++w){const T=u.charAt(w);if(Zt.isDigit(T))x=!0;else if(this.getAlphanumericCode(T.charCodeAt(0))!==-1)b=!0;else return vt.BYTE}return b?vt.ALPHANUMERIC:x?vt.NUMERIC:vt.BYTE}static isOnlyDoubleByteKanji(u){let h;try{h=ge.encode(u,Z.SJIS)}catch{return!1}const x=h.length;if(x%2!==0)return!1;for(let b=0;b<x;b+=2){const w=h[b]&255;if((w<129||w>159)&&(w<224||w>235))return!1}return!0}static chooseMaskPattern(u,h,x,b){let w=Number.MAX_SAFE_INTEGER,v=-1;for(let T=0;T<$n.NUM_MASK_PATTERNS;T++){At.buildMatrix(u,h,x,T,b);let M=this.calculateMaskPenalty(b);M<w&&(w=M,v=T)}return v}static chooseVersion(u,h){for(let x=1;x<=40;x++){const b=wt.getVersionForNumber(x);if(Zt.willFit(u,b,h))return b}throw new qt("Data too big")}static willFit(u,h,x){const b=h.getTotalCodewords(),v=h.getECBlocksForLevel(x).getTotalECCodewords(),T=b-v,M=(u+7)/8;return T>=M}static terminateBits(u,h){const x=u*8;if(h.getSize()>x)throw new qt("data bits cannot fit in the QR Code"+h.getSize()+" > "+x);for(let v=0;v<4&&h.getSize()<x;++v)h.appendBit(!1);const b=h.getSize()&7;if(b>0)for(let v=b;v<8;v++)h.appendBit(!1);const w=u-h.getSizeInBytes();for(let v=0;v<w;++v)h.appendBits(v&1?17:236,8);if(h.getSize()!==x)throw new qt("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(u,h,x,b,w,v){if(b>=x)throw new qt("Block ID too large");const T=u%x,M=x-T,D=Math.floor(u/x),G=D+1,re=Math.floor(h/x),le=re+1,xe=D-re,we=G-le;if(xe!==we)throw new qt("EC bytes mismatch");if(x!==M+T)throw new qt("RS blocks mismatch");if(u!==(re+xe)*M+(le+we)*T)throw new qt("Total bytes mismatch");b<M?(w[0]=re,v[0]=xe):(w[0]=le,v[0]=we)}static interleaveWithECBytes(u,h,x,b){if(u.getSizeInBytes()!==x)throw new qt("Number of bits and data bytes does not match");let w=0,v=0,T=0;const M=new Array;for(let G=0;G<b;++G){const re=new Int32Array(1),le=new Int32Array(1);Zt.getNumDataBytesAndNumECBytesForBlockID(h,x,b,G,re,le);const xe=re[0],we=new Uint8Array(xe);u.toBytes(8*w,we,0,xe);const ve=Zt.generateECBytes(we,le[0]);M.push(new Gr(we,ve)),v=Math.max(v,xe),T=Math.max(T,ve.length),w+=re[0]}if(x!==w)throw new qt("Data bytes does not match offset");const D=new H;for(let G=0;G<v;++G)for(const re of M){const le=re.getDataBytes();G<le.length&&D.appendBits(le[G],8)}for(let G=0;G<T;++G)for(const re of M){const le=re.getErrorCorrectionBytes();G<le.length&&D.appendBits(le[G],8)}if(h!==D.getSizeInBytes())throw new qt("Interleaving error: "+h+" and "+D.getSizeInBytes()+" differ.");return D}static generateECBytes(u,h){const x=u.length,b=new Int32Array(x+h);for(let v=0;v<x;v++)b[v]=u[v]&255;new fr(ft.QR_CODE_FIELD_256).encode(b,h);const w=new Uint8Array(h);for(let v=0;v<h;v++)w[v]=b[x+v];return w}static appendModeInfo(u,h){h.appendBits(u.getBits(),4)}static appendLengthInfo(u,h,x,b){const w=x.getCharacterCountBits(h);if(u>=1<<w)throw new qt(u+" is bigger than "+((1<<w)-1));b.appendBits(u,w)}static appendBytes(u,h,x,b){switch(h){case vt.NUMERIC:Zt.appendNumericBytes(u,x);break;case vt.ALPHANUMERIC:Zt.appendAlphanumericBytes(u,x);break;case vt.BYTE:Zt.append8BitBytes(u,x,b);break;case vt.KANJI:Zt.appendKanjiBytes(u,x);break;default:throw new qt("Invalid mode: "+h)}}static getDigit(u){return u.charCodeAt(0)-48}static isDigit(u){const h=Zt.getDigit(u);return h>=0&&h<=9}static appendNumericBytes(u,h){const x=u.length;let b=0;for(;b<x;){const w=Zt.getDigit(u.charAt(b));if(b+2<x){const v=Zt.getDigit(u.charAt(b+1)),T=Zt.getDigit(u.charAt(b+2));h.appendBits(w*100+v*10+T,10),b+=3}else if(b+1<x){const v=Zt.getDigit(u.charAt(b+1));h.appendBits(w*10+v,7),b+=2}else h.appendBits(w,4),b++}}static appendAlphanumericBytes(u,h){const x=u.length;let b=0;for(;b<x;){const w=Zt.getAlphanumericCode(u.charCodeAt(b));if(w===-1)throw new qt;if(b+1<x){const v=Zt.getAlphanumericCode(u.charCodeAt(b+1));if(v===-1)throw new qt;h.appendBits(w*45+v,11),b+=2}else h.appendBits(w,6),b++}}static append8BitBytes(u,h,x){let b;try{b=ge.encode(u,x)}catch(w){throw new qt(w)}for(let w=0,v=b.length;w!==v;w++){const T=b[w];h.appendBits(T,8)}}static appendKanjiBytes(u,h){let x;try{x=ge.encode(u,Z.SJIS)}catch(w){throw new qt(w)}const b=x.length;for(let w=0;w<b;w+=2){const v=x[w]&255,T=x[w+1]&255,M=v<<8&4294967295|T;let D=-1;if(M>=33088&&M<=40956?D=M-33088:M>=57408&&M<=60351&&(D=M-49472),D===-1)throw new qt("Invalid byte sequence");const G=(D>>8)*192+(D&255);h.appendBits(G,13)}}static appendECI(u,h){h.appendBits(vt.ECI.getBits(),4),h.appendBits(u.getValue(),8)}}Zt.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Zt.DEFAULT_BYTE_MODE_ENCODING=Z.UTF8.getName();class Vn{write(u,h,x,b=null){if(u.length===0)throw new S("Found empty contents");if(h<0||x<0)throw new S("Requested dimensions are too small: "+h+"x"+x);let w=jt.L,v=Vn.QUIET_ZONE_SIZE;b!==null&&(b.get(un.ERROR_CORRECTION)!==void 0&&(w=jt.fromString(b.get(un.ERROR_CORRECTION).toString())),b.get(un.MARGIN)!==void 0&&(v=Number.parseInt(b.get(un.MARGIN).toString(),10)));const T=Zt.encode(u,w,b);return this.renderResult(T,h,x,v)}writeToDom(u,h,x,b,w=null){typeof u=="string"&&(u=document.querySelector(u));const v=this.write(h,x,b,w);u&&u.appendChild(v)}renderResult(u,h,x,b){const w=u.getMatrix();if(w===null)throw new nt;const v=w.getWidth(),T=w.getHeight(),M=v+b*2,D=T+b*2,G=Math.max(h,M),re=Math.max(x,D),le=Math.min(Math.floor(G/M),Math.floor(re/D)),xe=Math.floor((G-v*le)/2),we=Math.floor((re-T*le)/2),ve=this.createSVGElement(G,re);for(let Le=0,ke=we;Le<T;Le++,ke+=le)for(let Je=0,tt=xe;Je<v;Je++,tt+=le)if(w.get(Je,Le)===1){const qe=this.createSvgRectElement(tt,ke,le,le);ve.appendChild(qe)}return ve}createSVGElement(u,h){const x=document.createElementNS(Vn.SVG_NS,"svg");return x.setAttributeNS(null,"height",u.toString()),x.setAttributeNS(null,"width",h.toString()),x}createSvgRectElement(u,h,x,b){const w=document.createElementNS(Vn.SVG_NS,"rect");return w.setAttributeNS(null,"x",u.toString()),w.setAttributeNS(null,"y",h.toString()),w.setAttributeNS(null,"height",x.toString()),w.setAttributeNS(null,"width",b.toString()),w.setAttributeNS(null,"fill","#000000"),w}}Vn.QUIET_ZONE_SIZE=4,Vn.SVG_NS="http://www.w3.org/2000/svg";class Hn{encode(u,h,x,b,w){if(u.length===0)throw new S("Found empty contents");if(h!==Te.QR_CODE)throw new S("Can only encode QR_CODE, but got "+h);if(x<0||b<0)throw new S(`Requested dimensions are too small: ${x}x${b}`);let v=jt.L,T=Hn.QUIET_ZONE_SIZE;w!==null&&(w.get(un.ERROR_CORRECTION)!==void 0&&(v=jt.fromString(w.get(un.ERROR_CORRECTION).toString())),w.get(un.MARGIN)!==void 0&&(T=Number.parseInt(w.get(un.MARGIN).toString(),10)));const M=Zt.encode(u,v,w);return Hn.renderResult(M,x,b,T)}static renderResult(u,h,x,b){const w=u.getMatrix();if(w===null)throw new nt;const v=w.getWidth(),T=w.getHeight(),M=v+b*2,D=T+b*2,G=Math.max(h,M),re=Math.max(x,D),le=Math.min(Math.floor(G/M),Math.floor(re/D)),xe=Math.floor((G-v*le)/2),we=Math.floor((re-T*le)/2),ve=new R(G,re);for(let Le=0,ke=we;Le<T;Le++,ke+=le)for(let Je=0,tt=xe;Je<v;Je++,tt+=le)w.get(Je,Le)===1&&ve.setRegion(tt,ke,le,le);return ve}}Hn.QUIET_ZONE_SIZE=4;class Wr{encode(u,h,x,b,w){let v;switch(h){case Te.QR_CODE:v=new Hn;break;default:throw new S("No encoder available for format "+h)}return v.encode(u,h,x,b,w)}}class Pn extends W{constructor(u,h,x,b,w,v,T,M){if(super(v,T),this.yuvData=u,this.dataWidth=h,this.dataHeight=x,this.left=b,this.top=w,b+v>h||w+T>x)throw new S("Crop rectangle does not fit within image data.");M&&this.reverseHorizontal(v,T)}getRow(u,h){if(u<0||u>=this.getHeight())throw new S("Requested row is outside the image: "+u);const x=this.getWidth();(h==null||h.length<x)&&(h=new Uint8ClampedArray(x));const b=(u+this.top)*this.dataWidth+this.left;return O.arraycopy(this.yuvData,b,h,0,x),h}getMatrix(){const u=this.getWidth(),h=this.getHeight();if(u===this.dataWidth&&h===this.dataHeight)return this.yuvData;const x=u*h,b=new Uint8ClampedArray(x);let w=this.top*this.dataWidth+this.left;if(u===this.dataWidth)return O.arraycopy(this.yuvData,w,b,0,x),b;for(let v=0;v<h;v++){const T=v*u;O.arraycopy(this.yuvData,w,b,T,u),w+=this.dataWidth}return b}isCropSupported(){return!0}crop(u,h,x,b){return new Pn(this.yuvData,this.dataWidth,this.dataHeight,this.left+u,this.top+h,x,b,!1)}renderThumbnail(){const u=this.getWidth()/Pn.THUMBNAIL_SCALE_FACTOR,h=this.getHeight()/Pn.THUMBNAIL_SCALE_FACTOR,x=new Int32Array(u*h),b=this.yuvData;let w=this.top*this.dataWidth+this.left;for(let v=0;v<h;v++){const T=v*u;for(let M=0;M<u;M++){const D=b[w+M*Pn.THUMBNAIL_SCALE_FACTOR]&255;x[T+M]=4278190080|D*65793}w+=this.dataWidth*Pn.THUMBNAIL_SCALE_FACTOR}return x}getThumbnailWidth(){return this.getWidth()/Pn.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Pn.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(u,h){const x=this.yuvData;for(let b=0,w=this.top*this.dataWidth+this.left;b<h;b++,w+=this.dataWidth){const v=w+u/2;for(let T=w,M=w+u-1;T<v;T++,M--){const D=x[T];x[T]=x[M],x[M]=D}}}invert(){return new ee(this)}}Pn.THUMBNAIL_SCALE_FACTOR=2;class pr extends W{constructor(u,h,x,b,w,v,T){if(super(h,x),this.dataWidth=b,this.dataHeight=w,this.left=v,this.top=T,u.BYTES_PER_ELEMENT===4){const M=h*x,D=new Uint8ClampedArray(M);for(let G=0;G<M;G++){const re=u[G],le=re>>16&255,xe=re>>7&510,we=re&255;D[G]=(le+xe+we)/4&255}this.luminances=D}else this.luminances=u;if(b===void 0&&(this.dataWidth=h),w===void 0&&(this.dataHeight=x),v===void 0&&(this.left=0),T===void 0&&(this.top=0),this.left+h>this.dataWidth||this.top+x>this.dataHeight)throw new S("Crop rectangle does not fit within image data.")}getRow(u,h){if(u<0||u>=this.getHeight())throw new S("Requested row is outside the image: "+u);const x=this.getWidth();(h==null||h.length<x)&&(h=new Uint8ClampedArray(x));const b=(u+this.top)*this.dataWidth+this.left;return O.arraycopy(this.luminances,b,h,0,x),h}getMatrix(){const u=this.getWidth(),h=this.getHeight();if(u===this.dataWidth&&h===this.dataHeight)return this.luminances;const x=u*h,b=new Uint8ClampedArray(x);let w=this.top*this.dataWidth+this.left;if(u===this.dataWidth)return O.arraycopy(this.luminances,w,b,0,x),b;for(let v=0;v<h;v++){const T=v*u;O.arraycopy(this.luminances,w,b,T,u),w+=this.dataWidth}return b}isCropSupported(){return!0}crop(u,h,x,b){return new pr(this.luminances,x,b,this.dataWidth,this.dataHeight,this.left+u,this.top+h)}invert(){return new ee(this)}}class Cr extends Z{static forName(u){return this.getCharacterSetECIByName(u)}}class mr{}mr.ISO_8859_1=Z.ISO8859_1;class Rr{isCompact(){return this.compact}setCompact(u){this.compact=u}getSize(){return this.size}setSize(u){this.size=u}getLayers(){return this.layers}setLayers(u){this.layers=u}getCodeWords(){return this.codeWords}setCodeWords(u){this.codeWords=u}getMatrix(){return this.matrix}setMatrix(u){this.matrix=u}}class Mr{static singletonList(u){return[u]}static min(u,h){return u.sort(h)[0]}}class Kr{constructor(u){this.previous=u}getPrevious(){return this.previous}}class zn extends Kr{constructor(u,h,x){super(u),this.value=h,this.bitCount=x}appendTo(u,h){u.appendBits(this.value,this.bitCount)}add(u,h){return new zn(this,u,h)}addBinaryShift(u,h){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new zn(this,u,h)}toString(){let u=this.value&(1<<this.bitCount)-1;return u|=1<<this.bitCount,"<"+B.toBinaryString(u|1<<this.bitCount).substring(1)+">"}}class gr extends zn{constructor(u,h,x){super(u,0,0),this.binaryShiftStart=h,this.binaryShiftByteCount=x}appendTo(u,h){for(let x=0;x<this.binaryShiftByteCount;x++)(x===0||x===31&&this.binaryShiftByteCount<=62)&&(u.appendBits(31,5),this.binaryShiftByteCount>62?u.appendBits(this.binaryShiftByteCount-31,16):x===0?u.appendBits(Math.min(this.binaryShiftByteCount,31),5):u.appendBits(this.binaryShiftByteCount-31,5)),u.appendBits(h[this.binaryShiftStart+x],8)}addBinaryShift(u,h){return new gr(this,u,h)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Xr(ne,u,h){return new gr(ne,u,h)}function er(ne,u,h){return new zn(ne,u,h)}const qr=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Fn=0,or=1,Rn=2,Ir=3,On=4,Yr=new zn(null,0,0),xr=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,655360+928+30]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,917504+14336+928+30]),Int32Array.from([(5<<16)+29,(5<<16)+28,655360+928+30,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,655360+992+28,655360+992+30,655360+992+29,0])];function Zr(ne){for(let u of ne)j.fill(u,-1);return ne[Fn][On]=0,ne[or][On]=0,ne[or][Fn]=28,ne[Ir][On]=0,ne[Rn][On]=0,ne[Rn][Fn]=15,ne}const Lr=Zr(j.createInt32Array(6,6));class Dn{constructor(u,h,x,b){this.token=u,this.mode=h,this.binaryShiftByteCount=x,this.bitCount=b}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(u,h){let x=this.bitCount,b=this.token;if(u!==this.mode){let v=xr[this.mode][u];b=er(b,v&65535,v>>16),x+=v>>16}let w=u===Rn?4:5;return b=er(b,h,w),new Dn(b,u,0,x+w)}shiftAndAppend(u,h){let x=this.token,b=this.mode===Rn?4:5;return x=er(x,Lr[this.mode][u],b),x=er(x,h,5),new Dn(x,this.mode,0,this.bitCount+b+5)}addBinaryShiftChar(u){let h=this.token,x=this.mode,b=this.bitCount;if(this.mode===On||this.mode===Rn){let T=xr[x][Fn];h=er(h,T&65535,T>>16),b+=T>>16,x=Fn}let w=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,v=new Dn(h,x,this.binaryShiftByteCount+1,b+w);return v.binaryShiftByteCount===2047+31&&(v=v.endBinaryShift(u+1)),v}endBinaryShift(u){if(this.binaryShiftByteCount===0)return this;let h=this.token;return h=Xr(h,u-this.binaryShiftByteCount,this.binaryShiftByteCount),new Dn(h,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(u){let h=this.bitCount+(xr[this.mode][u.mode]>>16);return this.binaryShiftByteCount<u.binaryShiftByteCount?h+=Dn.calculateBinaryShiftCost(u)-Dn.calculateBinaryShiftCost(this):this.binaryShiftByteCount>u.binaryShiftByteCount&&u.binaryShiftByteCount>0&&(h+=10),h<=u.bitCount}toBitArray(u){let h=[];for(let b=this.endBinaryShift(u.length).token;b!==null;b=b.getPrevious())h.unshift(b);let x=new H;for(const b of h)b.appendTo(x,u);return x}toString(){return me.format("%s bits=%d bytes=%d",qr[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(u){return u.binaryShiftByteCount>62?21:u.binaryShiftByteCount>31?20:u.binaryShiftByteCount>0?10:0}}Dn.INITIAL_STATE=new Dn(Yr,Fn,0,0);function Qr(ne){const u=me.getCharCode(" "),h=me.getCharCode("."),x=me.getCharCode(",");ne[Fn][u]=1;const b=me.getCharCode("Z"),w=me.getCharCode("A");for(let le=w;le<=b;le++)ne[Fn][le]=le-w+2;ne[or][u]=1;const v=me.getCharCode("z"),T=me.getCharCode("a");for(let le=T;le<=v;le++)ne[or][le]=le-T+2;ne[Rn][u]=1;const M=me.getCharCode("9"),D=me.getCharCode("0");for(let le=D;le<=M;le++)ne[Rn][le]=le-D+2;ne[Rn][x]=12,ne[Rn][h]=13;const G=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let le=0;le<G.length;le++)ne[Ir][me.getCharCode(G[le])]=le;const re=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let le=0;le<re.length;le++)me.getCharCode(re[le])>0&&(ne[On][me.getCharCode(re[le])]=le);return ne}const yr=Qr(j.createInt32Array(5,256));class tr{constructor(u){this.text=u}encode(){const u=me.getCharCode(" "),h=me.getCharCode(`
`);let x=Mr.singletonList(Dn.INITIAL_STATE);for(let w=0;w<this.text.length;w++){let v,T=w+1<this.text.length?this.text[w+1]:0;switch(this.text[w]){case me.getCharCode("\r"):v=T===h?2:0;break;case me.getCharCode("."):v=T===u?3:0;break;case me.getCharCode(","):v=T===u?4:0;break;case me.getCharCode(":"):v=T===u?5:0;break;default:v=0}v>0?(x=tr.updateStateListForPair(x,w,v),w++):x=this.updateStateListForChar(x,w)}return Mr.min(x,(w,v)=>w.getBitCount()-v.getBitCount()).toBitArray(this.text)}updateStateListForChar(u,h){const x=[];for(let b of u)this.updateStateForChar(b,h,x);return tr.simplifyStates(x)}updateStateForChar(u,h,x){let b=this.text[h]&255,w=yr[u.getMode()][b]>0,v=null;for(let T=0;T<=On;T++){let M=yr[T][b];if(M>0){if(v==null&&(v=u.endBinaryShift(h)),!w||T===u.getMode()||T===Rn){const D=v.latchAndAppend(T,M);x.push(D)}if(!w&&Lr[u.getMode()][T]>=0){const D=v.shiftAndAppend(T,M);x.push(D)}}}if(u.getBinaryShiftByteCount()>0||yr[u.getMode()][b]===0){let T=u.addBinaryShiftChar(h);x.push(T)}}static updateStateListForPair(u,h,x){const b=[];for(let w of u)this.updateStateForPair(w,h,x,b);return this.simplifyStates(b)}static updateStateForPair(u,h,x,b){let w=u.endBinaryShift(h);if(b.push(w.latchAndAppend(On,x)),u.getMode()!==On&&b.push(w.shiftAndAppend(On,x)),x===3||x===4){let v=w.latchAndAppend(Rn,16-x).latchAndAppend(Rn,1);b.push(v)}if(u.getBinaryShiftByteCount()>0){let v=u.addBinaryShiftChar(h).addBinaryShiftChar(h+1);b.push(v)}}static simplifyStates(u){let h=[];for(const x of u){let b=!0;for(const w of h){if(w.isBetterThanOrEqualTo(x)){b=!1;break}x.isBetterThanOrEqualTo(w)&&(h=h.filter(v=>v!==w))}b&&h.push(x)}return h}}class Ht{constructor(){}static encodeBytes(u){return Ht.encode(u,Ht.DEFAULT_EC_PERCENT,Ht.DEFAULT_AZTEC_LAYERS)}static encode(u,h,x){let b=new tr(u).encode(),w=B.truncDivision(b.getSize()*h,100)+11,v=b.getSize()+w,T,M,D,G,re;if(x!==Ht.DEFAULT_AZTEC_LAYERS){if(T=x<0,M=Math.abs(x),M>(T?Ht.MAX_NB_BITS_COMPACT:Ht.MAX_NB_BITS))throw new S(me.format("Illegal value %s for layers",x));D=Ht.totalBitsInLayer(M,T),G=Ht.WORD_SIZE[M];let qe=D-D%G;if(re=Ht.stuffBits(b,G),re.getSize()+w>qe)throw new S("Data to large for user specified layer");if(T&&re.getSize()>G*64)throw new S("Data to large for user specified layer")}else{G=0,re=null;for(let qe=0;;qe++){if(qe>Ht.MAX_NB_BITS)throw new S("Data too large for an Aztec code");if(T=qe<=3,M=T?qe+1:qe,D=Ht.totalBitsInLayer(M,T),v>D)continue;(re==null||G!==Ht.WORD_SIZE[M])&&(G=Ht.WORD_SIZE[M],re=Ht.stuffBits(b,G));let $t=D-D%G;if(!(T&&re.getSize()>G*64)&&re.getSize()+w<=$t)break}}let le=Ht.generateCheckWords(re,D,G),xe=re.getSize()/G,we=Ht.generateModeMessage(T,M,xe),ve=(T?11:14)+M*4,Le=new Int32Array(ve),ke;if(T){ke=ve;for(let qe=0;qe<Le.length;qe++)Le[qe]=qe}else{ke=ve+1+2*B.truncDivision(B.truncDivision(ve,2)-1,15);let qe=B.truncDivision(ve,2),$t=B.truncDivision(ke,2);for(let Nt=0;Nt<qe;Nt++){let wn=Nt+B.truncDivision(Nt,15);Le[qe-Nt-1]=$t-wn-1,Le[qe+Nt]=$t+wn+1}}let Je=new R(ke);for(let qe=0,$t=0;qe<M;qe++){let Nt=(M-qe)*4+(T?9:12);for(let wn=0;wn<Nt;wn++){let Nn=wn*2;for(let Sn=0;Sn<2;Sn++)le.get($t+Nn+Sn)&&Je.set(Le[qe*2+Sn],Le[qe*2+wn]),le.get($t+Nt*2+Nn+Sn)&&Je.set(Le[qe*2+wn],Le[ve-1-qe*2-Sn]),le.get($t+Nt*4+Nn+Sn)&&Je.set(Le[ve-1-qe*2-Sn],Le[ve-1-qe*2-wn]),le.get($t+Nt*6+Nn+Sn)&&Je.set(Le[ve-1-qe*2-wn],Le[qe*2+Sn])}$t+=Nt*8}if(Ht.drawModeMessage(Je,T,ke,we),T)Ht.drawBullsEye(Je,B.truncDivision(ke,2),5);else{Ht.drawBullsEye(Je,B.truncDivision(ke,2),7);for(let qe=0,$t=0;qe<B.truncDivision(ve,2)-1;qe+=15,$t+=16)for(let Nt=B.truncDivision(ke,2)&1;Nt<ke;Nt+=2)Je.set(B.truncDivision(ke,2)-$t,Nt),Je.set(B.truncDivision(ke,2)+$t,Nt),Je.set(Nt,B.truncDivision(ke,2)-$t),Je.set(Nt,B.truncDivision(ke,2)+$t)}let tt=new Rr;return tt.setCompact(T),tt.setSize(ke),tt.setLayers(M),tt.setCodeWords(xe),tt.setMatrix(Je),tt}static drawBullsEye(u,h,x){for(let b=0;b<x;b+=2)for(let w=h-b;w<=h+b;w++)u.set(w,h-b),u.set(w,h+b),u.set(h-b,w),u.set(h+b,w);u.set(h-x,h-x),u.set(h-x+1,h-x),u.set(h-x,h-x+1),u.set(h+x,h-x),u.set(h+x,h-x+1),u.set(h+x,h+x-1)}static generateModeMessage(u,h,x){let b=new H;return u?(b.appendBits(h-1,2),b.appendBits(x-1,6),b=Ht.generateCheckWords(b,28,4)):(b.appendBits(h-1,5),b.appendBits(x-1,11),b=Ht.generateCheckWords(b,40,4)),b}static drawModeMessage(u,h,x,b){let w=B.truncDivision(x,2);if(h)for(let v=0;v<7;v++){let T=w-3+v;b.get(v)&&u.set(T,w-5),b.get(v+7)&&u.set(w+5,T),b.get(20-v)&&u.set(T,w+5),b.get(27-v)&&u.set(w-5,T)}else for(let v=0;v<10;v++){let T=w-5+v+B.truncDivision(v,5);b.get(v)&&u.set(T,w-7),b.get(v+10)&&u.set(w+7,T),b.get(29-v)&&u.set(T,w+7),b.get(39-v)&&u.set(w-7,T)}}static generateCheckWords(u,h,x){let b=u.getSize()/x,w=new fr(Ht.getGF(x)),v=B.truncDivision(h,x),T=Ht.bitsToWords(u,x,v);w.encode(T,v-b);let M=h%x,D=new H;D.appendBits(0,M);for(const G of Array.from(T))D.appendBits(G,x);return D}static bitsToWords(u,h,x){let b=new Int32Array(x),w,v;for(w=0,v=u.getSize()/h;w<v;w++){let T=0;for(let M=0;M<h;M++)T|=u.get(w*h+M)?1<<h-M-1:0;b[w]=T}return b}static getGF(u){switch(u){case 4:return ft.AZTEC_PARAM;case 6:return ft.AZTEC_DATA_6;case 8:return ft.AZTEC_DATA_8;case 10:return ft.AZTEC_DATA_10;case 12:return ft.AZTEC_DATA_12;default:throw new S("Unsupported word size "+u)}}static stuffBits(u,h){let x=new H,b=u.getSize(),w=(1<<h)-2;for(let v=0;v<b;v+=h){let T=0;for(let M=0;M<h;M++)(v+M>=b||u.get(v+M))&&(T|=1<<h-1-M);(T&w)===w?(x.appendBits(T&w,h),v--):T&w?x.appendBits(T,h):(x.appendBits(T|1,h),v--)}return x}static totalBitsInLayer(u,h){return((h?88:112)+16*u)*u}}Ht.DEFAULT_EC_PERCENT=33,Ht.DEFAULT_AZTEC_LAYERS=0,Ht.MAX_NB_BITS=32,Ht.MAX_NB_BITS_COMPACT=4,Ht.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class ar{encode(u,h,x,b){return this.encodeWithHints(u,h,x,b,null)}encodeWithHints(u,h,x,b,w){let v=mr.ISO_8859_1,T=Ht.DEFAULT_EC_PERCENT,M=Ht.DEFAULT_AZTEC_LAYERS;return w!=null&&(w.has(un.CHARACTER_SET)&&(v=Cr.forName(w.get(un.CHARACTER_SET).toString())),w.has(un.ERROR_CORRECTION)&&(T=B.parseInt(w.get(un.ERROR_CORRECTION).toString())),w.has(un.AZTEC_LAYERS)&&(M=B.parseInt(w.get(un.AZTEC_LAYERS).toString()))),ar.encodeLayers(u,h,x,b,v,T,M)}static encodeLayers(u,h,x,b,w,v,T){if(h!==Te.AZTEC)throw new S("Can only encode AZTEC, but got "+h);let M=Ht.encode(me.getBytes(u,w),v,T);return ar.renderResult(M,x,b)}static renderResult(u,h,x){let b=u.getMatrix();if(b==null)throw new nt;let w=b.getWidth(),v=b.getHeight(),T=Math.max(h,w),M=Math.max(x,v),D=Math.min(T/w,M/v),G=(T-w*D)/2,re=(M-v*D)/2,le=new R(T,M);for(let xe=0,we=re;xe<v;xe++,we+=D)for(let ve=0,Le=G;ve<w;ve++,Le+=D)b.get(ve,xe)&&le.setRegion(Le,we,D,D);return le}}t.AbstractExpandedDecoder=Kt,t.ArgumentException=E,t.ArithmeticException=Ce,t.AztecCode=Rr,t.AztecCodeReader=be,t.AztecCodeWriter=ar,t.AztecDecoder=et,t.AztecDetector=ae,t.AztecDetectorResult=He,t.AztecEncoder=Ht,t.AztecHighLevelEncoder=tr,t.AztecPoint=$,t.BarcodeFormat=Te,t.Binarizer=N,t.BinaryBitmap=A,t.BitArray=H,t.BitMatrix=R,t.BitSource=Ln,t.BrowserAztecCodeReader=Se,t.BrowserBarcodeReader=Jt,t.BrowserCodeReader=J,t.BrowserDatamatrixCodeReader=Kn,t.BrowserMultiFormatReader=Hr,t.BrowserPDF417Reader=zr,t.BrowserQRCodeReader=jr,t.BrowserQRCodeSvgWriter=Vn,t.CharacterSetECI=Z,t.ChecksumException=C,t.Code128Reader=Ie,t.Code39Reader=$e,t.DataMatrixDecodedBitStreamParser=_n,t.DataMatrixReader=xn,t.DecodeHintType=oe,t.DecoderResult=Ke,t.DefaultGridSampler=te,t.DetectorResult=Ge,t.EAN13Reader=Xe,t.EncodeHintType=un,t.Exception=_,t.FormatException=Q,t.GenericGF=ft,t.GenericGFPoly=Ye,t.GlobalHistogramBinarizer=z,t.GridSampler=pt,t.GridSamplerInstance=U,t.HTMLCanvasElementLuminanceSource=ie,t.HybridBinarizer=Y,t.ITFReader=je,t.IllegalArgumentException=S,t.IllegalStateException=nt,t.InvertedLuminanceSource=ee,t.LuminanceSource=W,t.MathUtils=he,t.MultiFormatOneDReader=Qt,t.MultiFormatReader=Tr,t.MultiFormatWriter=Wr,t.NotFoundException=L,t.OneDReader=Ae,t.PDF417DecodedBitStreamParser=Be,t.PDF417DecoderErrorCorrection=br,t.PDF417Reader=mn,t.PDF417ResultMetadata=wr,t.PerspectiveTransform=We,t.PlanarYUVLuminanceSource=Pn,t.QRCodeByteMatrix=sr,t.QRCodeDataMask=Tn,t.QRCodeDecodedBitStreamParser=nn,t.QRCodeDecoderErrorCorrectionLevel=jt,t.QRCodeDecoderFormatInformation=dn,t.QRCodeEncoder=Zt,t.QRCodeEncoderQRCode=$n,t.QRCodeMaskUtil=sn,t.QRCodeMatrixUtil=At,t.QRCodeMode=vt,t.QRCodeReader=Bn,t.QRCodeVersion=wt,t.QRCodeWriter=Hn,t.RGBLuminanceSource=pr,t.RSS14Reader=Ct,t.RSSExpandedReader=Oe,t.ReaderException=ir,t.ReedSolomonDecoder=dt,t.ReedSolomonEncoder=fr,t.ReedSolomonException=Ze,t.Result=Ee,t.ResultMetadataType=ze,t.ResultPoint=_e,t.StringUtils=me,t.UnsupportedOperationException=ce,t.VideoInputDevice=X,t.WhiteRectangleDetector=Ve,t.WriterException=qt,t.ZXingArrays=j,t.ZXingCharset=Cr,t.ZXingInteger=B,t.ZXingStandardCharsets=mr,t.ZXingStringBuilder=V,t.ZXingStringEncoding=ge,t.ZXingSystem=O,t.createAbstractExpandedDecoder=St,Object.defineProperty(t,"__esModule",{value:!0})})})(zxingJs_umd$1,zxingJs_umd$1.exports);var zxingJs_umdExports=zxingJs_umd$1.exports;const zxingJs_umd=getDefaultExportFromCjs$1(zxingJs_umdExports),ZXing=_mergeNamespaces({__proto__:null,default:zxingJs_umd},[zxingJs_umdExports]);var ZXingHtml5QrcodeDecoder=function(){function s(e,t,o){if(this.formatMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,zxingJs_umdExports.BarcodeFormat.QR_CODE],[Html5QrcodeSupportedFormats.AZTEC,zxingJs_umdExports.BarcodeFormat.AZTEC],[Html5QrcodeSupportedFormats.CODABAR,zxingJs_umdExports.BarcodeFormat.CODABAR],[Html5QrcodeSupportedFormats.CODE_39,zxingJs_umdExports.BarcodeFormat.CODE_39],[Html5QrcodeSupportedFormats.CODE_93,zxingJs_umdExports.BarcodeFormat.CODE_93],[Html5QrcodeSupportedFormats.CODE_128,zxingJs_umdExports.BarcodeFormat.CODE_128],[Html5QrcodeSupportedFormats.DATA_MATRIX,zxingJs_umdExports.BarcodeFormat.DATA_MATRIX],[Html5QrcodeSupportedFormats.MAXICODE,zxingJs_umdExports.BarcodeFormat.MAXICODE],[Html5QrcodeSupportedFormats.ITF,zxingJs_umdExports.BarcodeFormat.ITF],[Html5QrcodeSupportedFormats.EAN_13,zxingJs_umdExports.BarcodeFormat.EAN_13],[Html5QrcodeSupportedFormats.EAN_8,zxingJs_umdExports.BarcodeFormat.EAN_8],[Html5QrcodeSupportedFormats.PDF_417,zxingJs_umdExports.BarcodeFormat.PDF_417],[Html5QrcodeSupportedFormats.RSS_14,zxingJs_umdExports.BarcodeFormat.RSS_14],[Html5QrcodeSupportedFormats.RSS_EXPANDED,zxingJs_umdExports.BarcodeFormat.RSS_EXPANDED],[Html5QrcodeSupportedFormats.UPC_A,zxingJs_umdExports.BarcodeFormat.UPC_A],[Html5QrcodeSupportedFormats.UPC_E,zxingJs_umdExports.BarcodeFormat.UPC_E],[Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION,zxingJs_umdExports.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!ZXing)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=t,this.logger=o;var a=this.createZXingFormats(e),c=new Map;c.set(zxingJs_umdExports.DecodeHintType.POSSIBLE_FORMATS,a),c.set(zxingJs_umdExports.DecodeHintType.TRY_HARDER,!1),this.hints=c}return s.prototype.decodeAsync=function(e){var t=this;return new Promise(function(o,a){try{o(t.decode(e))}catch(c){a(c)}})},s.prototype.decode=function(e){var t=new zxingJs_umdExports.MultiFormatReader(this.verbose,this.hints),o=new zxingJs_umdExports.HTMLCanvasElementLuminanceSource(e),a=new zxingJs_umdExports.BinaryBitmap(new zxingJs_umdExports.HybridBinarizer(o)),c=t.decode(a);return{text:c.text,format:QrcodeResultFormat.create(this.toHtml5QrcodeSupportedFormats(c.format)),debugData:this.createDebugData()}},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,o,a){e.set(t,o)}),e},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createZXingFormats=function(e){for(var t=[],o=0,a=e;o<a.length;o++){var c=a[o];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.logError("".concat(c," is not supported by")+"ZXingHtml5QrcodeShim")}return t},s.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},s}(),__awaiter$6=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator$6=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},BarcodeDetectorDelegate=function(){function s(e,t,o){if(this.formatMap=new Map([[Html5QrcodeSupportedFormats.QR_CODE,"qr_code"],[Html5QrcodeSupportedFormats.AZTEC,"aztec"],[Html5QrcodeSupportedFormats.CODABAR,"codabar"],[Html5QrcodeSupportedFormats.CODE_39,"code_39"],[Html5QrcodeSupportedFormats.CODE_93,"code_93"],[Html5QrcodeSupportedFormats.CODE_128,"code_128"],[Html5QrcodeSupportedFormats.DATA_MATRIX,"data_matrix"],[Html5QrcodeSupportedFormats.ITF,"itf"],[Html5QrcodeSupportedFormats.EAN_13,"ean_13"],[Html5QrcodeSupportedFormats.EAN_8,"ean_8"],[Html5QrcodeSupportedFormats.PDF_417,"pdf417"],[Html5QrcodeSupportedFormats.UPC_A,"upc_a"],[Html5QrcodeSupportedFormats.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!s.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=t,this.logger=o;var a=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(a),!this.detector)throw"BarcodeDetector detector not supported"}return s.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},s.prototype.decodeAsync=function(e){return __awaiter$6(this,void 0,void 0,function(){var t,o;return __generator$6(this,function(a){switch(a.label){case 0:return[4,this.detector.detect(e)];case 1:if(t=a.sent(),!t||t.length===0)throw"No barcode or QR code detected.";return o=this.selectLargestBarcode(t),[2,{text:o.rawValue,format:QrcodeResultFormat.create(this.toHtml5QrcodeSupportedFormats(o.format)),debugData:this.createDebugData()}]}})})},s.prototype.selectLargestBarcode=function(e){for(var t=null,o=0,a=0,c=e;a<c.length;a++){var d=c[a],g=d.boundingBox.width*d.boundingBox.height;g>o&&(o=g,t=d)}if(!t)throw"No largest barcode found";return t},s.prototype.createBarcodeDetectorFormats=function(e){for(var t=[],o=0,a=e;o<a.length;o++){var c=a[o];this.formatMap.has(c)?t.push(this.formatMap.get(c)):this.logger.warn("".concat(c," is not supported by")+"BarcodeDetectorDelegate")}return{formats:t}},s.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},s.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(t,o,a){e.set(t,o)}),e},s.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},s}(),__awaiter$5=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator$5=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},Html5QrcodeShim=function(){function s(e,t,o,a){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=o,t&&BarcodeDetectorDelegate.isSupported()?(this.primaryDecoder=new BarcodeDetectorDelegate(e,o,a),this.secondaryDecoder=new ZXingHtml5QrcodeDecoder(e,o,a)):this.primaryDecoder=new ZXingHtml5QrcodeDecoder(e,o,a)}return s.prototype.decodeAsync=function(e){return __awaiter$5(this,void 0,void 0,function(){var t;return __generator$5(this,function(o){switch(o.label){case 0:t=performance.now(),o.label=1;case 1:return o.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,o.sent()];case 3:return this.possiblyLogPerformance(t),[7];case 4:return[2]}})})},s.prototype.decodeRobustlyAsync=function(e){return __awaiter$5(this,void 0,void 0,function(){var t,o;return __generator$5(this,function(a){switch(a.label){case 0:t=performance.now(),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,a.sent()];case 3:if(o=a.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw o;case 4:return this.possiblyLogPerformance(t),[7];case 5:return[2]}})})},s.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},s.prototype.possiblyLogPerformance=function(e){if(this.verbose){var t=performance.now()-e;this.executionResults.push(t),this.executions++,this.possiblyFlushPerformanceReport()}},s.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,t=0,o=this.executionResults;t<o.length;t++){var a=o[t];e+=a}var c=e/this.executionResults.length;console.log("".concat(c," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},s}(),__extends$1=globalThis&&globalThis.__extends||function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,a){o.__proto__=a}||function(o,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(o[c]=a[c])},s(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),__awaiter$4=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator$4=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},AbstractCameraCapability=function(){function s(e,t){this.name=e,this.track=t}return s.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},s.prototype.apply=function(e){var t={};t[this.name]=e;var o={advanced:[t]};return this.track.applyConstraints(o)},s.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var t=e[this.name];return t}return null},s}(),AbstractRangeCameraCapability=function(s){__extends$1(e,s);function e(t,o){return s.call(this,t,o)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(t){var o={};o[this.name]=t;var a={advanced:[o]};return this.track.applyConstraints(a)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var t=this.track.getCapabilities(),o=t[this.name];return{min:o.min,max:o.max,step:o.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(AbstractCameraCapability),ZoomFeatureImpl=function(s){__extends$1(e,s);function e(t){return s.call(this,"zoom",t)||this}return e}(AbstractRangeCameraCapability),TorchFeatureImpl=function(s){__extends$1(e,s);function e(t){return s.call(this,"torch",t)||this}return e}(AbstractCameraCapability),CameraCapabilitiesImpl=function(){function s(e){this.track=e}return s.prototype.zoomFeature=function(){return new ZoomFeatureImpl(this.track)},s.prototype.torchFeature=function(){return new TorchFeatureImpl(this.track)},s}(),RenderedCameraImpl=function(){function s(e,t,o){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=o,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return s.prototype.createVideoElement=function(e){var t=document.createElement("video");return t.style.width="".concat(e,"px"),t.style.display="block",t.muted=!0,t.setAttribute("muted","true"),t.playsInline=!0,t},s.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var o=e.surface.clientWidth,a=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(o,a),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},s.create=function(e,t,o,a){return __awaiter$4(this,void 0,void 0,function(){var c,d;return __generator$4(this,function(g){switch(g.label){case 0:return c=new s(e,t,a),o.aspectRatio?(d={aspectRatio:o.aspectRatio},[4,c.getFirstTrackOrFail().applyConstraints(d)]):[3,2];case 1:g.sent(),g.label=2;case 2:return c.setupSurface(),[2,c]}})})},s.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},s.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},s.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},s.prototype.resume=function(e){this.failIfClosed();var t=this,o=function(){setTimeout(e,200),t.surface.removeEventListener("playing",o)};this.surface.addEventListener("playing",o),this.surface.play()},s.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},s.prototype.getSurface=function(){return this.failIfClosed(),this.surface},s.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},s.prototype.applyVideoConstraints=function(e){return __awaiter$4(this,void 0,void 0,function(){return __generator$4(this,function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},s.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(t,o){var a=e.mediaStream.getVideoTracks(),c=a.length,d=0;e.mediaStream.getVideoTracks().forEach(function(g){e.mediaStream.removeTrack(g),g.stop(),++d,d>=c&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())})})},s.prototype.getCapabilities=function(){return new CameraCapabilitiesImpl(this.getFirstTrackOrFail())},s}(),CameraImpl=function(){function s(e){this.mediaStream=e}return s.prototype.render=function(e,t,o){return __awaiter$4(this,void 0,void 0,function(){return __generator$4(this,function(a){return[2,RenderedCameraImpl.create(e,this.mediaStream,t,o)]})})},s.create=function(e){return __awaiter$4(this,void 0,void 0,function(){var t,o;return __generator$4(this,function(a){switch(a.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return t={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(t)];case 1:return o=a.sent(),[2,new s(o)]}})})},s}(),__awaiter$3=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator$3=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},CameraFactory=function(){function s(){}return s.failIfNotSupported=function(){return __awaiter$3(this,void 0,void 0,function(){return __generator$3(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new s]})})},s.prototype.create=function(e){return __awaiter$3(this,void 0,void 0,function(){return __generator$3(this,function(t){return[2,CameraImpl.create(e)]})})},s}(),__awaiter$2=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator$2=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},CameraRetriever=function(){function s(){}return s.retrieve=function(){if(navigator.mediaDevices)return s.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?s.getCamerasFromMediaStreamTrack():s.rejectWithError()},s.rejectWithError=function(){var e=Html5QrcodeStrings.unableToQuerySupportedDevices();return s.isHttpsOrLocalhost()||(e=Html5QrcodeStrings.insecureContextCameraQueryError()),Promise.reject(e)},s.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},s.getCamerasFromMediaDevices=function(){return __awaiter$2(this,void 0,void 0,function(){var e,t,o,a,c,d,g;return __generator$2(this,function(y){switch(y.label){case 0:return e=function(_){for(var E=_.getVideoTracks(),S=0,A=E;S<A.length;S++){var C=A[S];C.enabled=!1,C.stop(),_.removeTrack(C)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=y.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(o=y.sent(),a=[],c=0,d=o;c<d.length;c++)g=d[c],g.kind==="videoinput"&&a.push({id:g.deviceId,label:g.label});return e(t),[2,a]}})})},s.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,t){var o=function(c){for(var d=[],g=0,y=c;g<y.length;g++){var _=y[g];_.kind==="video"&&d.push({id:_.id,label:_.label})}e(d)},a=MediaStreamTrack;a.getSources(o)})},s}(),Html5QrcodeScannerState;(function(s){s[s.UNKNOWN=0]="UNKNOWN",s[s.NOT_STARTED=1]="NOT_STARTED",s[s.SCANNING=2]="SCANNING",s[s.PAUSED=3]="PAUSED"})(Html5QrcodeScannerState||(Html5QrcodeScannerState={}));var StateManagerImpl=function(){function s(){this.state=Html5QrcodeScannerState.NOT_STARTED,this.onGoingTransactionNewState=Html5QrcodeScannerState.UNKNOWN}return s.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},s.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},s.prototype.execute=function(){if(this.onGoingTransactionNewState===Html5QrcodeScannerState.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=Html5QrcodeScannerState.UNKNOWN,this.directTransition(e)},s.prototype.cancel=function(){if(this.onGoingTransactionNewState===Html5QrcodeScannerState.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=Html5QrcodeScannerState.UNKNOWN},s.prototype.getState=function(){return this.state},s.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==Html5QrcodeScannerState.UNKNOWN)throw"Cannot transition to a new state, already under transition"},s.prototype.validateTransition=function(e){switch(this.state){case Html5QrcodeScannerState.UNKNOWN:throw"Transition from unknown is not allowed";case Html5QrcodeScannerState.NOT_STARTED:this.failIfNewStateIs(e,[Html5QrcodeScannerState.PAUSED]);break;case Html5QrcodeScannerState.SCANNING:break;case Html5QrcodeScannerState.PAUSED:break}},s.prototype.failIfNewStateIs=function(e,t){for(var o=0,a=t;o<a.length;o++){var c=a[o];if(e===c)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},s}(),StateManagerProxy=function(){function s(e){this.stateManager=e}return s.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},s.prototype.directTransition=function(e){this.stateManager.directTransition(e)},s.prototype.getState=function(){return this.stateManager.getState()},s.prototype.canScanFile=function(){return this.stateManager.getState()===Html5QrcodeScannerState.NOT_STARTED},s.prototype.isScanning=function(){return this.stateManager.getState()!==Html5QrcodeScannerState.NOT_STARTED},s.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===Html5QrcodeScannerState.SCANNING},s.prototype.isPaused=function(){return this.stateManager.getState()===Html5QrcodeScannerState.PAUSED},s}(),StateManagerFactory=function(){function s(){}return s.create=function(){return new StateManagerProxy(new StateManagerImpl)},s}(),__extends=globalThis&&globalThis.__extends||function(){var s=function(e,t){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,a){o.__proto__=a}||function(o,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(o[c]=a[c])},s(e,t)};return function(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");s(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}}(),Constants=function(s){__extends(e,s);function e(){return s!==null&&s.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(Html5QrcodeConstants),InternalHtml5QrcodeConfig=function(){function s(e,t){this.logger=t,this.fps=Constants.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=Constants.DEFAULT_DISABLE_FLIP}return s.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?VideoConstraintsUtil.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},s.prototype.isShadedBoxEnabled=function(){return!isNullOrUndefined(this.qrbox)},s.create=function(e,t){return new s(e,t)},s}(),Html5Qrcode=function(){function s(e,t){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var o;typeof t=="boolean"?this.verbose=t===!0:t&&(o=t,this.verbose=o.verbose===!0,o.experimentalFeatures),this.logger=new BaseLoggger(this.verbose),this.qrcode=new Html5QrcodeShim(this.getSupportedFormats(t),this.getUseBarCodeDetectorIfSupported(o),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=StateManagerFactory.create()}return s.prototype.start=function(e,t,o,a){var c=this;if(!e)throw"cameraIdOrConfig is required";if(!o||typeof o!="function")throw"qrCodeSuccessCallback is required and should be a function.";var d;a?d=a:d=this.verbose?this.logger.log:function(){};var g=InternalHtml5QrcodeConfig.create(t,this.logger);this.clearElement();var y=!1;g.videoConstraints&&(g.isMediaStreamConstraintsValid()?y=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var _=y,E=document.getElementById(this.elementId);E.clientWidth?E.clientWidth:Constants.DEFAULT_WIDTH,E.style.position="relative",this.shouldScan=!0,this.element=E;var S=this,A=this.stateManagerProxy.startTransition(Html5QrcodeScannerState.SCANNING);return new Promise(function(C,N){var O=_?g.videoConstraints:S.createVideoConstraints(e);if(!O){A.cancel(),N("videoConstraints should be defined");return}var I={};(!_||g.aspectRatio)&&(I.aspectRatio=g.aspectRatio);var P={onRenderSurfaceReady:function(j,B){S.setupUi(j,B,g),S.isScanning=!0,S.foreverScan(g,o,d)}};CameraFactory.failIfNotSupported().then(function(j){j.create(O).then(function(B){return B.render(c.element,I,P).then(function(H){S.renderedCamera=H,A.execute(),C(null)}).catch(function(H){A.cancel(),N(H)})}).catch(function(B){A.cancel(),N(Html5QrcodeStrings.errorGettingUserMedia(B))})}).catch(function(j){A.cancel(),N(Html5QrcodeStrings.cameraStreamingNotSupported())})})},s.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(Html5QrcodeScannerState.PAUSED),this.showPausedState(),(isNullOrUndefined(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},s.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,t=function(){e.stateManagerProxy.directTransition(Html5QrcodeScannerState.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){t();return}this.renderedCamera.resume(function(){t()})},s.prototype.getState=function(){return this.stateManagerProxy.getState()},s.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var t=this.stateManagerProxy.startTransition(Html5QrcodeScannerState.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var o=function(){if(e.element){var c=document.getElementById(Constants.SHADED_REGION_ELEMENT_ID);c&&e.element.removeChild(c)}},a=this;return this.renderedCamera.close().then(function(){return a.renderedCamera=null,a.element&&(a.element.removeChild(a.canvasElement),a.canvasElement=null),o(),a.qrRegion&&(a.qrRegion=null),a.context&&(a.context=null),t.execute(),a.hidePausedState(),a.isScanning=!1,Promise.resolve()})},s.prototype.scanFile=function(e,t){return this.scanFileV2(e,t).then(function(o){return o.decodedText})},s.prototype.scanFileV2=function(e,t){var o=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(isNullOrUndefined(t)&&(t=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(a,c){o.possiblyCloseLastScanImageFile(),o.clearElement(),o.lastScanImageFile=URL.createObjectURL(e);var d=new Image;d.onload=function(){var g=d.width,y=d.height,_=document.getElementById(o.elementId),E=_.clientWidth?_.clientWidth:Constants.DEFAULT_WIDTH,S=Math.max(_.clientHeight?_.clientHeight:y,Constants.FILE_SCAN_MIN_HEIGHT),A=o.computeCanvasDrawConfig(g,y,E,S);if(t){var C=o.createCanvasElement(E,S,"qr-canvas-visible");C.style.display="inline-block",_.appendChild(C);var N=C.getContext("2d");if(!N)throw"Unable to get 2d context from canvas";N.canvas.width=E,N.canvas.height=S,N.drawImage(d,0,0,g,y,A.x,A.y,A.width,A.height)}var O=Constants.FILE_SCAN_HIDDEN_CANVAS_PADDING,I=Math.max(d.width,A.width),P=Math.max(d.height,A.height),j=I+2*O,B=P+2*O,H=o.createCanvasElement(j,B);_.appendChild(H);var se=H.getContext("2d");if(!se)throw"Unable to get 2d context from canvas";se.canvas.width=j,se.canvas.height=B,se.drawImage(d,0,0,g,y,O,O,I,P);try{o.qrcode.decodeRobustlyAsync(H).then(function(oe){a(Html5QrcodeResultFactory.createFromQrcodeResult(oe))}).catch(c)}catch(oe){c("QR code parse error, error = ".concat(oe))}},d.onerror=c,d.onabort=c,d.onstalled=c,d.onsuspend=c,d.src=URL.createObjectURL(e)})},s.prototype.clear=function(){this.clearElement()},s.getCameras=function(){return CameraRetriever.retrieve()},s.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},s.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},s.prototype.applyVideoConstraints=function(e){if(e){if(!VideoConstraintsUtil.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},s.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},s.prototype.getSupportedFormats=function(e){var t=[Html5QrcodeSupportedFormats.QR_CODE,Html5QrcodeSupportedFormats.AZTEC,Html5QrcodeSupportedFormats.CODABAR,Html5QrcodeSupportedFormats.CODE_39,Html5QrcodeSupportedFormats.CODE_93,Html5QrcodeSupportedFormats.CODE_128,Html5QrcodeSupportedFormats.DATA_MATRIX,Html5QrcodeSupportedFormats.MAXICODE,Html5QrcodeSupportedFormats.ITF,Html5QrcodeSupportedFormats.EAN_13,Html5QrcodeSupportedFormats.EAN_8,Html5QrcodeSupportedFormats.PDF_417,Html5QrcodeSupportedFormats.RSS_14,Html5QrcodeSupportedFormats.RSS_EXPANDED,Html5QrcodeSupportedFormats.UPC_A,Html5QrcodeSupportedFormats.UPC_E,Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return t;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var o=[],a=0,c=e.formatsToSupport;a<c.length;a++){var d=c[a];isValidHtml5QrcodeSupportedFormats(d)?o.push(d):this.logger.warn("Invalid format: ".concat(d," passed in config, ignoring."))}if(o.length===0)throw"None of formatsToSupport match supported values.";return o},s.prototype.getUseBarCodeDetectorIfSupported=function(e){if(isNullOrUndefined(e))return!0;if(!isNullOrUndefined(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(isNullOrUndefined(e.experimentalFeatures))return!0;var t=e.experimentalFeatures;return isNullOrUndefined(t.useBarCodeDetectorIfSupported)?!0:t.useBarCodeDetectorIfSupported!==!1},s.prototype.validateQrboxSize=function(e,t,o){var a=this,c=o.qrbox;this.validateQrboxConfig(c);var d=this.toQrdimensions(e,t,c),g=function(_){if(_<Constants.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(Constants.MIN_QR_BOX_SIZE,"px.")},y=function(_){return _>e&&(a.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),_=e),_};g(d.width),g(d.height),d.width=y(d.width)},s.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},s.prototype.toQrdimensions=function(e,t,o){if(typeof o=="number")return{width:o,height:o};if(typeof o=="function")try{return o(e,t)}catch(a){throw new Error("qrbox config was passed as a function but it failed with unknown error"+a)}return o},s.prototype.setupUi=function(e,t,o){o.isShadedBoxEnabled()&&this.validateQrboxSize(e,t,o);var a=isNullOrUndefined(o.qrbox)?{width:e,height:t}:o.qrbox;this.validateQrboxConfig(a);var c=this.toQrdimensions(e,t,a);c.height>t&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var d=o.isShadedBoxEnabled()&&c.height<=t,g={x:0,y:0,width:e,height:t},y=d?this.getShadedRegionBounds(e,t,c):g,_=this.createCanvasElement(y.width,y.height),E={willReadFrequently:!0},S=_.getContext("2d",E);S.canvas.width=y.width,S.canvas.height=y.height,this.element.append(_),d&&this.possiblyInsertShadingElement(this.element,e,t,c),this.createScannerPausedUiElement(this.element),this.qrRegion=y,this.context=S,this.canvasElement=_},s.prototype.createScannerPausedUiElement=function(e){var t=document.createElement("div");t.innerText=Html5QrcodeStrings.scannerPaused(),t.style.display="none",t.style.position="absolute",t.style.top="0px",t.style.zIndex="1",t.style.background="rgba(9, 9, 9, 0.46)",t.style.color="#FFECEC",t.style.textAlign="center",t.style.width="100%",e.appendChild(t),this.scannerPausedUiElement=t},s.prototype.scanContext=function(e,t){var o=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(a){return e(a.text,Html5QrcodeResultFactory.createFromQrcodeResult(a)),o.possiblyUpdateShaders(!0),!0}).catch(function(a){o.possiblyUpdateShaders(!1);var c=Html5QrcodeStrings.codeParseError(a);return t(c,Html5QrcodeErrorFactory.createFrom(c)),!1})},s.prototype.foreverScan=function(e,t,o){var a=this;if(this.shouldScan&&this.renderedCamera){var c=this.renderedCamera.getSurface(),d=c.videoWidth/c.clientWidth,g=c.videoHeight/c.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var y=this.qrRegion.width*d,_=this.qrRegion.height*g,E=this.qrRegion.x*d,S=this.qrRegion.y*g;this.context.drawImage(c,E,S,y,_,0,0,this.qrRegion.width,this.qrRegion.height);var A=function(){a.foreverScanTimeout=setTimeout(function(){a.foreverScan(e,t,o)},a.getTimeoutFps(e.fps))};this.scanContext(t,o).then(function(C){!C&&e.disableFlip!==!0?(a.context.translate(a.context.canvas.width,0),a.context.scale(-1,1),a.scanContext(t,o).finally(function(){A()})):A()}).catch(function(C){a.logger.logError("Error happend while scanning context",C),A()})}},s.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var t="facingMode",o="deviceId",a={user:!0,environment:!0},c="exact",d=function(N){if(N in a)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(N,"'")},g=Object.keys(e);if(g.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(g.length," keys");var y=Object.keys(e)[0];if(y!==t&&y!==o)throw"Only '".concat(t,"' and '").concat(o,"' ")+" are supported for 'cameraIdOrConfig'";if(y===t){var _=e.facingMode;if(typeof _=="string"){if(d(_))return{facingMode:_}}else if(typeof _=="object")if(c in _){if(d(_["".concat(c)]))return{facingMode:{exact:_["".concat(c)]}}}else throw"'facingMode' should be string or object with"+" ".concat(c," as key.");else{var E=typeof _;throw"Invalid type of 'facingMode' = ".concat(E)}}else{var S=e.deviceId;if(typeof S=="string")return{deviceId:S};if(typeof S=="object"){if(c in S)return{deviceId:{exact:S["".concat(c)]}};throw"'deviceId' should be string or object with"+" ".concat(c," as key.")}else{var A=typeof S;throw"Invalid type of 'deviceId' = ".concat(A)}}}var C=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(C)},s.prototype.computeCanvasDrawConfig=function(e,t,o,a){if(e<=o&&t<=a){var c=(o-e)/2,d=(a-t)/2;return{x:c,y:d,width:e,height:t}}else{var g=e,y=t;return e>o&&(t=o/e*t,e=o),t>a&&(e=a/t*e,t=a),this.logger.log("Image downsampled from "+"".concat(g,"X").concat(y)+" to ".concat(e,"X").concat(t,".")),this.computeCanvasDrawConfig(e,t,o,a)}},s.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},s.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(t){t.style.backgroundColor=e?Constants.BORDER_SHADER_MATCH_COLOR:Constants.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},s.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},s.prototype.createCanvasElement=function(e,t,o){var a=e,c=t,d=document.createElement("canvas");return d.style.width="".concat(a,"px"),d.style.height="".concat(c,"px"),d.style.display="none",d.id=isNullOrUndefined(o)?"qr-canvas":o,d},s.prototype.getShadedRegionBounds=function(e,t,o){if(o.width>e||o.height>t)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-o.width)/2,y:(t-o.height)/2,width:o.width,height:o.height}},s.prototype.possiblyInsertShadingElement=function(e,t,o,a){if(!(t-a.width<1||o-a.height<1)){var c=document.createElement("div");c.style.position="absolute";var d=(t-a.width)/2,g=(o-a.height)/2;if(c.style.borderLeft="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderRight="".concat(d,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderTop="".concat(g,"px solid rgba(0, 0, 0, 0.48)"),c.style.borderBottom="".concat(g,"px solid rgba(0, 0, 0, 0.48)"),c.style.boxSizing="border-box",c.style.top="0px",c.style.bottom="0px",c.style.left="0px",c.style.right="0px",c.id="".concat(Constants.SHADED_REGION_ELEMENT_ID),t-a.width<11||o-a.height<11)this.hasBorderShaders=!1;else{var y=5,_=40;this.insertShaderBorders(c,_,y,-y,null,0,!0),this.insertShaderBorders(c,_,y,-y,null,0,!1),this.insertShaderBorders(c,_,y,null,-y,0,!0),this.insertShaderBorders(c,_,y,null,-y,0,!1),this.insertShaderBorders(c,y,_+y,-y,null,-y,!0),this.insertShaderBorders(c,y,_+y,null,-y,-y,!0),this.insertShaderBorders(c,y,_+y,-y,null,-y,!1),this.insertShaderBorders(c,y,_+y,null,-y,-y,!1),this.hasBorderShaders=!0}e.append(c)}},s.prototype.insertShaderBorders=function(e,t,o,a,c,d,g){var y=document.createElement("div");y.style.position="absolute",y.style.backgroundColor=Constants.BORDER_SHADER_DEFAULT_COLOR,y.style.width="".concat(t,"px"),y.style.height="".concat(o,"px"),a!==null&&(y.style.top="".concat(a,"px")),c!==null&&(y.style.bottom="".concat(c,"px")),g?y.style.left="".concat(d,"px"):y.style.right="".concat(d,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(y),e.appendChild(y)},s.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},s.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},s.prototype.getTimeoutFps=function(e){return 1e3/e},s}(),SVG_XML_PREFIX="data:image/svg+xml;base64,",ASSET_CAMERA_SCAN=SVG_XML_PREFIX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzNzEuNjQzIDM3MS42NDMiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDM3MS42NDMgMzcxLjY0MyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PHBhdGggZD0iTTEwNS4wODQgMzguMjcxaDE2My43Njh2MjBIMTA1LjA4NHoiLz48cGF0aCBkPSJNMzExLjU5NiAxOTAuMTg5Yy03LjQ0MS05LjM0Ny0xOC40MDMtMTYuMjA2LTMyLjc0My0yMC41MjJWMzBjMC0xNi41NDItMTMuNDU4LTMwLTMwLTMwSDEyNS4wODRjLTE2LjU0MiAwLTMwIDEzLjQ1OC0zMCAzMHYxMjAuMTQzaC04LjI5NmMtMTYuNTQyIDAtMzAgMTMuNDU4LTMwIDMwdjEuMzMzYTI5LjgwNCAyOS44MDQgMCAwIDAgNC42MDMgMTUuOTM5Yy03LjM0IDUuNDc0LTEyLjEwMyAxNC4yMjEtMTIuMTAzIDI0LjA2MXYxLjMzM2MwIDkuODQgNC43NjMgMTguNTg3IDEyLjEwMyAyNC4wNjJhMjkuODEgMjkuODEgMCAwIDAtNC42MDMgMTUuOTM4djEuMzMzYzAgMTYuNTQyIDEzLjQ1OCAzMCAzMCAzMGg4LjMyNGMuNDI3IDExLjYzMSA3LjUwMyAyMS41ODcgMTcuNTM0IDI2LjE3Ny45MzEgMTAuNTAzIDQuMDg0IDMwLjE4NyAxNC43NjggNDUuNTM3YTkuOTg4IDkuOTg4IDAgMCAwIDguMjE2IDQuMjg4IDkuOTU4IDkuOTU4IDAgMCAwIDUuNzA0LTEuNzkzYzQuNTMzLTMuMTU1IDUuNjUtOS4zODggMi40OTUtMTMuOTIxLTYuNzk4LTkuNzY3LTkuNjAyLTIyLjYwOC0xMC43Ni0zMS40aDgyLjY4NWMuMjcyLjQxNC41NDUuODE4LjgxNSAxLjIxIDMuMTQyIDQuNTQxIDkuMzcyIDUuNjc5IDEzLjkxMyAyLjUzNCA0LjU0Mi0zLjE0MiA1LjY3Ny05LjM3MSAyLjUzNS0xMy45MTMtMTEuOTE5LTE3LjIyOS04Ljc4Ny0zNS44ODQgOS41ODEtNTcuMDEyIDMuMDY3LTIuNjUyIDEyLjMwNy0xMS43MzIgMTEuMjE3LTI0LjAzMy0uODI4LTkuMzQzLTcuMTA5LTE3LjE5NC0xOC42NjktMjMuMzM3YTkuODU3IDkuODU3IDAgMCAwLTEuMDYxLS40ODZjLS40NjYtLjE4Mi0xMS40MDMtNC41NzktOS43NDEtMTUuNzA2IDEuMDA3LTYuNzM3IDE0Ljc2OC04LjI3MyAyMy43NjYtNy42NjYgMjMuMTU2IDEuNTY5IDM5LjY5OCA3LjgwMyA0Ny44MzYgMTguMDI2IDUuNzUyIDcuMjI1IDcuNjA3IDE2LjYyMyA1LjY3MyAyOC43MzMtLjQxMyAyLjU4NS0uODI0IDUuMjQxLTEuMjQ1IDcuOTU5LTUuNzU2IDM3LjE5NC0xMi45MTkgODMuNDgzLTQ5Ljg3IDExNC42NjEtNC4yMjEgMy41NjEtNC43NTYgOS44Ny0xLjE5NCAxNC4wOTJhOS45OCA5Ljk4IDAgMCAwIDcuNjQ4IDMuNTUxIDkuOTU1IDkuOTU1IDAgMCAwIDYuNDQ0LTIuMzU4YzQyLjY3Mi0zNi4wMDUgNTAuODAyLTg4LjUzMyA1Ni43MzctMTI2Ljg4OC40MTUtMi42ODQuODIxLTUuMzA5IDEuMjI5LTcuODYzIDIuODM0LTE3LjcyMS0uNDU1LTMyLjY0MS05Ljc3Mi00NC4zNDV6bS0yMzIuMzA4IDQyLjYyYy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM2MwLTUuNTE0IDQuNDg2LTEwIDEwLTEwaDE1djIxLjMzM2gtMTV6bS0yLjUtNTIuNjY2YzAtNS41MTQgNC40ODYtMTAgMTAtMTBoNy41djIxLjMzM2gtNy41Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi0xLjMzM3ptMTcuNSA5My45OTloLTcuNWMtNS41MTQgMC0xMC00LjQ4Ni0xMC0xMHYtMS4zMzNjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGg3LjV2MjEuMzMzem0zMC43OTYgMjguODg3Yy01LjUxNCAwLTEwLTQuNDg2LTEwLTEwdi04LjI3MWg5MS40NTdjLS44NTEgNi42NjgtLjQzNyAxMi43ODcuNzMxIDE4LjI3MWgtODIuMTg4em03OS40ODItMTEzLjY5OGMtMy4xMjQgMjAuOTA2IDEyLjQyNyAzMy4xODQgMjEuNjI1IDM3LjA0IDUuNDQxIDIuOTY4IDcuNTUxIDUuNjQ3IDcuNzAxIDcuMTg4LjIxIDIuMTUtMi41NTMgNS42ODQtNC40NzcgNy4yNTEtLjQ4Mi4zNzgtLjkyOS44LTEuMzM1IDEuMjYxLTYuOTg3IDcuOTM2LTExLjk4MiAxNS41Mi0xNS40MzIgMjIuNjg4aC05Ny41NjRWMzBjMC01LjUxNCA0LjQ4Ni0xMCAxMC0xMGgxMjMuNzY5YzUuNTE0IDAgMTAgNC40ODYgMTAgMTB2MTM1LjU3OWMtMy4wMzItLjM4MS02LjE1LS42OTQtOS4zODktLjkxNC0yNS4xNTktMS42OTQtNDIuMzcgNy43NDgtNDQuODk4IDI0LjY2NnoiLz48cGF0aCBkPSJNMTc5LjEyOSA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXpNMTcyLjYyOSAxNDIuODZoLTEyLjU2VjEzMC44YTUgNSAwIDEgMC0xMCAwdjE3LjA2MWE1IDUgMCAwIDAgNSA1aDE3LjU2YTUgNSAwIDEgMCAwLTEwLjAwMXpNMjE2LjU2OCA4My4xNjdoLTI0LjA2YTUgNSAwIDAgMC01IDV2MjQuMDYxYTUgNSAwIDAgMCA1IDVoMjQuMDZhNSA1IDAgMCAwIDUtNVY4OC4xNjdhNSA1IDAgMCAwLTUtNXptLTUgMjQuMDYxaC0xNC4wNlY5My4xNjdoMTQuMDZ2MTQuMDYxek0yMTEuNjY5IDEyNS45MzZIMTk3LjQxYTUgNSAwIDAgMC01IDV2MTQuMjU3YTUgNSAwIDAgMCA1IDVoMTQuMjU5YTUgNSAwIDAgMCA1LTV2LTE0LjI1N2E1IDUgMCAwIDAtNS01eiIvPjwvc3ZnPg==",ASSET_FILE_SCAN=SVG_XML_PREFIX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OS4wMTggNTkuMDE4IiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1OS4wMTggNTkuMDE4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJtNTguNzQxIDU0LjgwOS01Ljk2OS02LjI0NGExMC43NCAxMC43NCAwIDAgMCAyLjgyLTcuMjVjMC01Ljk1My00Ljg0My0xMC43OTYtMTAuNzk2LTEwLjc5NlMzNCAzNS4zNjEgMzQgNDEuMzE0IDM4Ljg0MyA1Mi4xMSA0NC43OTYgNTIuMTFjMi40NDEgMCA0LjY4OC0uODI0IDYuNDk5LTIuMTk2bDYuMDAxIDYuMjc3YS45OTguOTk4IDAgMCAwIDEuNDE0LjAzMiAxIDEgMCAwIDAgLjAzMS0xLjQxNHpNMzYgNDEuMzE0YzAtNC44NSAzLjk0Ni04Ljc5NiA4Ljc5Ni04Ljc5NnM4Ljc5NiAzLjk0NiA4Ljc5NiA4Ljc5Ni0zLjk0NiA4Ljc5Ni04Ljc5NiA4Ljc5NlMzNiA0Ni4xNjQgMzYgNDEuMzE0ek0xMC40MzEgMTYuMDg4YzAgMy4wNyAyLjQ5OCA1LjU2OCA1LjU2OSA1LjU2OHM1LjU2OS0yLjQ5OCA1LjU2OS01LjU2OGMwLTMuMDcxLTIuNDk4LTUuNTY5LTUuNTY5LTUuNTY5cy01LjU2OSAyLjQ5OC01LjU2OSA1LjU2OXptOS4xMzggMGMwIDEuOTY4LTEuNjAyIDMuNTY4LTMuNTY5IDMuNTY4cy0zLjU2OS0xLjYwMS0zLjU2OS0zLjU2OCAxLjYwMi0zLjU2OSAzLjU2OS0zLjU2OSAzLjU2OSAxLjYwMSAzLjU2OSAzLjU2OXoiLz48cGF0aCBkPSJtMzAuODgyIDI4Ljk4NyA5LjE4LTEwLjA1NCAxMS4yNjIgMTAuMzIzYTEgMSAwIDAgMCAxLjM1MS0xLjQ3NWwtMTItMTFhMSAxIDAgMCAwLTEuNDE0LjA2M2wtOS43OTQgMTAuNzI3LTQuNzQzLTQuNzQzYTEuMDAzIDEuMDAzIDAgMCAwLTEuMzY4LS4wNDRMNi4zMzkgMzcuNzY4YTEgMSAwIDEgMCAxLjMyMiAxLjUwMWwxNi4zMTMtMTQuMzYyIDcuMzE5IDcuMzE4YS45OTkuOTk5IDAgMSAwIDEuNDE0LTEuNDE0bC0xLjgyNS0xLjgyNHoiLz48cGF0aCBkPSJNMzAgNDYuNTE4SDJ2LTQyaDU0djI4YTEgMSAwIDEgMCAyIDB2LTI5YTEgMSAwIDAgMC0xLTFIMWExIDEgMCAwIDAtMSAxdjQ0YTEgMSAwIDAgMCAxIDFoMjlhMSAxIDAgMSAwIDAtMnoiLz48L3N2Zz4=",ASSET_INFO_ICON_16PX=SVG_XML_PREFIX+"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0NjAgNDYwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0NjAgNDYwIiB4bWw6c3BhY2U9InByZXNlcnZlIj48cGF0aCBkPSJNMjMwIDBDMTAyLjk3NSAwIDAgMTAyLjk3NSAwIDIzMHMxMDIuOTc1IDIzMCAyMzAgMjMwIDIzMC0xMDIuOTc0IDIzMC0yMzBTMzU3LjAyNSAwIDIzMCAwem0zOC4zMzMgMzc3LjM2YzAgOC42NzYtNy4wMzQgMTUuNzEtMTUuNzEgMTUuNzFoLTQzLjEwMWMtOC42NzYgMC0xNS43MS03LjAzNC0xNS43MS0xNS43MVYyMDIuNDc3YzAtOC42NzYgNy4wMzMtMTUuNzEgMTUuNzEtMTUuNzFoNDMuMTAxYzguNjc2IDAgMTUuNzEgNy4wMzMgMTUuNzEgMTUuNzFWMzc3LjM2ek0yMzAgMTU3Yy0yMS41MzkgMC0zOS0xNy40NjEtMzktMzlzMTcuNDYxLTM5IDM5LTM5IDM5IDE3LjQ2MSAzOSAzOS0xNy40NjEgMzktMzkgMzl6Ii8+PC9zdmc+",ASSET_CLOSE_ICON_16PX="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAQgAAAEIBarqQRAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAE1SURBVDiNfdI7S0NBEAXgLya1otFgpbYSbISAgpXYi6CmiH9KCAiChaVga6OiWPgfRDQ+0itaGVNosXtluWwcuMzePfM4M3sq8lbHBubwg1dc4m1E/J/N4ghDPOIsfk/4xiEao5KX0McFljN4C9d4QTPXuY99jP3DsIoDPGM6BY5i5yI5R7O4q+ImFkJY2DCh3cAH2klyB+9J1xUMMAG7eCh1a+Mr+k48b5diXrFVwwLuS+BJ9MfR7+G0FHOHhTHhnXNWS87VDF4pcnfQK4Ep7XScNLmPTZgURNKKYENYWDpzW1BhscS1WHS8CDgURFJQrWcoF3c13KKbgg1BYQfy8xZWEzTTw1QZbAoKu8FqJnktdu5hcVSHmchiILzzuaDQvjBzV2m8yohCE1jHfPx/xhU+y4G/D75ELlRJsSYAAAAASUVORK5CYII=",PersistedDataFactory=function(){function s(){}return s.createDefault=function(){return{hasPermission:!1,lastUsedCameraId:null}},s}(),PersistedDataManager=function(){function s(){this.data=PersistedDataFactory.createDefault();var e=localStorage.getItem(s.LOCAL_STORAGE_KEY);e?this.data=JSON.parse(e):this.reset()}return s.prototype.hasCameraPermissions=function(){return this.data.hasPermission},s.prototype.getLastUsedCameraId=function(){return this.data.lastUsedCameraId},s.prototype.setHasPermission=function(e){this.data.hasPermission=e,this.flush()},s.prototype.setLastUsedCameraId=function(e){this.data.lastUsedCameraId=e,this.flush()},s.prototype.resetLastUsedCameraId=function(){this.data.lastUsedCameraId=null,this.flush()},s.prototype.reset=function(){this.data=PersistedDataFactory.createDefault(),this.flush()},s.prototype.flush=function(){localStorage.setItem(s.LOCAL_STORAGE_KEY,JSON.stringify(this.data))},s.LOCAL_STORAGE_KEY="HTML5_QRCODE_DATA",s}(),LibraryInfoDiv=function(){function s(){this.infoDiv=document.createElement("div")}return s.prototype.renderInto=function(e){this.infoDiv.style.position="absolute",this.infoDiv.style.top="10px",this.infoDiv.style.right="10px",this.infoDiv.style.zIndex="2",this.infoDiv.style.display="none",this.infoDiv.style.padding="5pt",this.infoDiv.style.border="1px solid #171717",this.infoDiv.style.fontSize="10pt",this.infoDiv.style.background="rgb(0 0 0 / 69%)",this.infoDiv.style.borderRadius="5px",this.infoDiv.style.textAlign="center",this.infoDiv.style.fontWeight="400",this.infoDiv.style.color="white",this.infoDiv.innerText=LibraryInfoStrings.poweredBy();var t=document.createElement("a");t.innerText="ScanApp",t.href="https://scanapp.org",t.target="new",t.style.color="white",this.infoDiv.appendChild(t);var o=document.createElement("br"),a=document.createElement("br");this.infoDiv.appendChild(o),this.infoDiv.appendChild(a);var c=document.createElement("a");c.innerText=LibraryInfoStrings.reportIssues(),c.href="https://github.com/mebjas/html5-qrcode/issues",c.target="new",c.style.color="white",this.infoDiv.appendChild(c),e.appendChild(this.infoDiv)},s.prototype.show=function(){this.infoDiv.style.display="block"},s.prototype.hide=function(){this.infoDiv.style.display="none"},s}(),LibraryInfoIcon=function(){function s(e,t){this.isShowingInfoIcon=!0,this.onTapIn=e,this.onTapOut=t,this.infoIcon=document.createElement("img")}return s.prototype.renderInto=function(e){var t=this;this.infoIcon.alt="Info icon",this.infoIcon.src=ASSET_INFO_ICON_16PX,this.infoIcon.style.position="absolute",this.infoIcon.style.top="4px",this.infoIcon.style.right="4px",this.infoIcon.style.opacity="0.6",this.infoIcon.style.cursor="pointer",this.infoIcon.style.zIndex="2",this.infoIcon.style.width="16px",this.infoIcon.style.height="16px",this.infoIcon.onmouseover=function(o){return t.onHoverIn()},this.infoIcon.onmouseout=function(o){return t.onHoverOut()},this.infoIcon.onclick=function(o){return t.onClick()},e.appendChild(this.infoIcon)},s.prototype.onHoverIn=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="1")},s.prototype.onHoverOut=function(){this.isShowingInfoIcon&&(this.infoIcon.style.opacity="0.6")},s.prototype.onClick=function(){this.isShowingInfoIcon?(this.isShowingInfoIcon=!1,this.onTapIn(),this.infoIcon.src=ASSET_CLOSE_ICON_16PX,this.infoIcon.style.opacity="1"):(this.isShowingInfoIcon=!0,this.onTapOut(),this.infoIcon.src=ASSET_INFO_ICON_16PX,this.infoIcon.style.opacity="0.6")},s}(),LibraryInfoContainer=function(){function s(){var e=this;this.infoDiv=new LibraryInfoDiv,this.infoIcon=new LibraryInfoIcon(function(){e.infoDiv.show()},function(){e.infoDiv.hide()})}return s.prototype.renderInto=function(e){this.infoDiv.renderInto(e),this.infoIcon.renderInto(e)},s}(),__awaiter$1=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator$1=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},CameraPermissions=function(){function s(){}return s.hasPermissions=function(){return __awaiter$1(this,void 0,void 0,function(){var e,t,o,a;return __generator$1(this,function(c){switch(c.label){case 0:return[4,navigator.mediaDevices.enumerateDevices()];case 1:for(e=c.sent(),t=0,o=e;t<o.length;t++)if(a=o[t],a.kind==="videoinput"&&a.label)return[2,!0];return[2,!1]}})})},s}(),ScanTypeSelector=function(){function s(e){this.supportedScanTypes=this.validateAndReturnScanTypes(e)}return s.prototype.getDefaultScanType=function(){return this.supportedScanTypes[0]},s.prototype.hasMoreThanOneScanType=function(){return this.supportedScanTypes.length>1},s.prototype.isCameraScanRequired=function(){for(var e=0,t=this.supportedScanTypes;e<t.length;e++){var o=t[e];if(s.isCameraScanType(o))return!0}return!1},s.isCameraScanType=function(e){return e===Html5QrcodeScanType.SCAN_TYPE_CAMERA},s.isFileScanType=function(e){return e===Html5QrcodeScanType.SCAN_TYPE_FILE},s.prototype.validateAndReturnScanTypes=function(e){if(!e||e.length===0)return Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE;var t=Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE.length;if(e.length>t)throw"Max ".concat(t," values expected for ")+"supportedScanTypes";for(var o=0,a=e;o<a.length;o++){var c=a[o];if(!Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE.includes(c))throw"Unsupported scan type ".concat(c)}return e},s}(),PublicUiElementIdAndClasses=function(){function s(){}return s.ALL_ELEMENT_CLASS="html5-qrcode-element",s.CAMERA_PERMISSION_BUTTON_ID="html5-qrcode-button-camera-permission",s.CAMERA_START_BUTTON_ID="html5-qrcode-button-camera-start",s.CAMERA_STOP_BUTTON_ID="html5-qrcode-button-camera-stop",s.TORCH_BUTTON_ID="html5-qrcode-button-torch",s.CAMERA_SELECTION_SELECT_ID="html5-qrcode-select-camera",s.FILE_SELECTION_BUTTON_ID="html5-qrcode-button-file-selection",s.ZOOM_SLIDER_ID="html5-qrcode-input-range-zoom",s.SCAN_TYPE_CHANGE_ANCHOR_ID="html5-qrcode-anchor-scan-type-change",s.TORCH_BUTTON_CLASS_TORCH_ON="html5-qrcode-button-torch-on",s.TORCH_BUTTON_CLASS_TORCH_OFF="html5-qrcode-button-torch-off",s}(),BaseUiElementFactory=function(){function s(){}return s.createElement=function(e,t){var o=document.createElement(e);return o.id=t,o.classList.add(PublicUiElementIdAndClasses.ALL_ELEMENT_CLASS),e==="button"&&o.setAttribute("type","button"),o},s}(),__awaiter=globalThis&&globalThis.__awaiter||function(s,e,t,o){function a(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function g(E){try{_(o.next(E))}catch(S){d(S)}}function y(E){try{_(o.throw(E))}catch(S){d(S)}}function _(E){E.done?c(E.value):a(E.value).then(g,y)}_((o=o.apply(s,e||[])).next())})},__generator=globalThis&&globalThis.__generator||function(s,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},o,a,c,d;return d={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function g(_){return function(E){return y([_,E])}}function y(_){if(o)throw new TypeError("Generator is already executing.");for(;d&&(d=0,_[0]&&(t=0)),t;)try{if(o=1,a&&(c=_[0]&2?a.return:_[0]?a.throw||((c=a.return)&&c.call(a),0):a.next)&&!(c=c.call(a,_[1])).done)return c;switch(a=0,c&&(_=[_[0]&2,c.value]),_[0]){case 0:case 1:c=_;break;case 4:return t.label++,{value:_[1],done:!1};case 5:t.label++,a=_[1],_=[0];continue;case 7:_=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(_[0]===6||_[0]===2)){t=0;continue}if(_[0]===3&&(!c||_[1]>c[0]&&_[1]<c[3])){t.label=_[1];break}if(_[0]===6&&t.label<c[1]){t.label=c[1],c=_;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(_);break}c[2]&&t.ops.pop(),t.trys.pop();continue}_=e.call(s,t)}catch(E){_=[6,E],a=0}finally{o=c=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}},TorchController=function(){function s(e,t,o){this.isTorchOn=!1,this.torchCapability=e,this.buttonController=t,this.onTorchActionFailureCallback=o}return s.prototype.isTorchEnabled=function(){return this.isTorchOn},s.prototype.flipState=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(o){switch(o.label){case 0:this.buttonController.disable(),e=!this.isTorchOn,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.torchCapability.apply(e)];case 2:return o.sent(),this.updateUiBasedOnLatestSettings(this.torchCapability.value(),e),[3,4];case 3:return t=o.sent(),this.propagateFailure(e,t),this.buttonController.enable(),[3,4];case 4:return[2]}})})},s.prototype.updateUiBasedOnLatestSettings=function(e,t){e===t?(this.buttonController.setText(t?Html5QrcodeScannerStrings.torchOffButton():Html5QrcodeScannerStrings.torchOnButton()),this.isTorchOn=t):this.propagateFailure(t),this.buttonController.enable()},s.prototype.propagateFailure=function(e,t){var o=e?Html5QrcodeScannerStrings.torchOnFailedMessage():Html5QrcodeScannerStrings.torchOffFailedMessage();t&&(o+="; Error = "+t),this.onTorchActionFailureCallback(o)},s.prototype.reset=function(){this.isTorchOn=!1},s}(),TorchButton=function(){function s(e,t){this.onTorchActionFailureCallback=t,this.torchButton=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.TORCH_BUTTON_ID),this.torchController=new TorchController(e,this,t)}return s.prototype.render=function(e,t){var o=this;this.torchButton.innerText=Html5QrcodeScannerStrings.torchOnButton(),this.torchButton.style.display=t.display,this.torchButton.style.marginLeft=t.marginLeft;var a=this;this.torchButton.addEventListener("click",function(c){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(d){switch(d.label){case 0:return[4,a.torchController.flipState()];case 1:return d.sent(),a.torchController.isTorchEnabled()?(a.torchButton.classList.remove(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_OFF),a.torchButton.classList.add(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_ON)):(a.torchButton.classList.remove(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_ON),a.torchButton.classList.add(PublicUiElementIdAndClasses.TORCH_BUTTON_CLASS_TORCH_OFF)),[2]}})})}),e.appendChild(this.torchButton)},s.prototype.updateTorchCapability=function(e){this.torchController=new TorchController(e,this,this.onTorchActionFailureCallback)},s.prototype.getTorchButton=function(){return this.torchButton},s.prototype.hide=function(){this.torchButton.style.display="none"},s.prototype.show=function(){this.torchButton.style.display="inline-block"},s.prototype.disable=function(){this.torchButton.disabled=!0},s.prototype.enable=function(){this.torchButton.disabled=!1},s.prototype.setText=function(e){this.torchButton.innerText=e},s.prototype.reset=function(){this.torchButton.innerText=Html5QrcodeScannerStrings.torchOnButton(),this.torchController.reset()},s.create=function(e,t,o,a){var c=new s(t,a);return c.render(e,o),c},s}(),FileSelectionUi=function(){function s(e,t,o){this.fileBasedScanRegion=this.createFileBasedScanRegion(),this.fileBasedScanRegion.style.display=t?"block":"none",e.appendChild(this.fileBasedScanRegion);var a=document.createElement("label");a.setAttribute("for",this.getFileScanInputId()),a.style.display="inline-block",this.fileBasedScanRegion.appendChild(a),this.fileSelectionButton=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.FILE_SELECTION_BUTTON_ID),this.setInitialValueToButton(),this.fileSelectionButton.addEventListener("click",function(g){a.click()}),a.append(this.fileSelectionButton),this.fileScanInput=BaseUiElementFactory.createElement("input",this.getFileScanInputId()),this.fileScanInput.type="file",this.fileScanInput.accept="image/*",this.fileScanInput.style.display="none",a.appendChild(this.fileScanInput);var c=this;this.fileScanInput.addEventListener("change",function(g){if(!(g==null||g.target==null)){var y=g.target;if(!(y.files&&y.files.length===0)){var _=y.files,E=_[0],S=E.name;c.setImageNameToButton(S),o(E)}}});var d=this.createDragAndDropMessage();this.fileBasedScanRegion.appendChild(d),this.fileBasedScanRegion.addEventListener("dragenter",function(g){c.fileBasedScanRegion.style.border=c.fileBasedScanRegionActiveBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragleave",function(g){c.fileBasedScanRegion.style.border=c.fileBasedScanRegionDefaultBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("dragover",function(g){c.fileBasedScanRegion.style.border=c.fileBasedScanRegionActiveBorder(),g.stopPropagation(),g.preventDefault()}),this.fileBasedScanRegion.addEventListener("drop",function(g){g.stopPropagation(),g.preventDefault(),c.fileBasedScanRegion.style.border=c.fileBasedScanRegionDefaultBorder();var y=g.dataTransfer;if(y){var _=y.files;if(!_||_.length===0)return;for(var E=!1,S=0;S<_.length;++S){var A=_.item(S);if(A){var C=/image.*/;if(A.type.match(C)){E=!0;var N=A.name;c.setImageNameToButton(N),o(A),d.innerText=Html5QrcodeScannerStrings.dragAndDropMessage();break}}}E||(d.innerText=Html5QrcodeScannerStrings.dragAndDropMessageOnlyImages())}})}return s.prototype.hide=function(){this.fileBasedScanRegion.style.display="none",this.fileScanInput.disabled=!0},s.prototype.show=function(){this.fileBasedScanRegion.style.display="block",this.fileScanInput.disabled=!1},s.prototype.isShowing=function(){return this.fileBasedScanRegion.style.display==="block"},s.prototype.resetValue=function(){this.fileScanInput.value="",this.setInitialValueToButton()},s.prototype.createFileBasedScanRegion=function(){var e=document.createElement("div");return e.style.textAlign="center",e.style.margin="auto",e.style.width="80%",e.style.maxWidth="600px",e.style.border=this.fileBasedScanRegionDefaultBorder(),e.style.padding="10px",e.style.marginBottom="10px",e},s.prototype.fileBasedScanRegionDefaultBorder=function(){return"6px dashed #ebebeb"},s.prototype.fileBasedScanRegionActiveBorder=function(){return"6px dashed rgb(153 151 151)"},s.prototype.createDragAndDropMessage=function(){var e=document.createElement("div");return e.innerText=Html5QrcodeScannerStrings.dragAndDropMessage(),e.style.fontWeight="400",e},s.prototype.setImageNameToButton=function(e){var t=20;if(e.length>t){var o=e.substring(0,8),a=e.length,c=e.substring(a-8,a);e="".concat(o,"....").concat(c)}var d=Html5QrcodeScannerStrings.fileSelectionChooseAnother()+" - "+e;this.fileSelectionButton.innerText=d},s.prototype.setInitialValueToButton=function(){var e=Html5QrcodeScannerStrings.fileSelectionChooseImage()+" - "+Html5QrcodeScannerStrings.fileSelectionNoImageSelected();this.fileSelectionButton.innerText=e},s.prototype.getFileScanInputId=function(){return"html5-qrcode-private-filescan-input"},s.create=function(e,t,o){var a=new s(e,t,o);return a},s}(),CameraSelectionUi=function(){function s(e){this.selectElement=BaseUiElementFactory.createElement("select",PublicUiElementIdAndClasses.CAMERA_SELECTION_SELECT_ID),this.cameras=e,this.options=[]}return s.prototype.render=function(e){var t=document.createElement("span");t.style.marginRight="10px";var o=this.cameras.length;if(o===0)throw new Error("No cameras found");if(o===1)t.style.display="none";else{var a=Html5QrcodeScannerStrings.selectCamera();t.innerText="".concat(a," (").concat(this.cameras.length,")  ")}for(var c=1,d=0,g=this.cameras;d<g.length;d++){var y=g[d],_=y.id,E=y.label==null?_:y.label;(!E||E==="")&&(E=[Html5QrcodeScannerStrings.anonymousCameraPrefix(),c++].join(" "));var S=document.createElement("option");S.value=_,S.innerText=E,this.options.push(S),this.selectElement.appendChild(S)}t.appendChild(this.selectElement),e.appendChild(t)},s.prototype.disable=function(){this.selectElement.disabled=!0},s.prototype.isDisabled=function(){return this.selectElement.disabled===!0},s.prototype.enable=function(){this.selectElement.disabled=!1},s.prototype.getValue=function(){return this.selectElement.value},s.prototype.hasValue=function(e){for(var t=0,o=this.options;t<o.length;t++){var a=o[t];if(a.value===e)return!0}return!1},s.prototype.setValue=function(e){if(!this.hasValue(e))throw new Error("".concat(e," is not present in the camera list."));this.selectElement.value=e},s.prototype.hasSingleItem=function(){return this.cameras.length===1},s.prototype.numCameras=function(){return this.cameras.length},s.create=function(e,t){var o=new s(t);return o.render(e),o},s}(),CameraZoomUi=function(){function s(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.rangeInput=BaseUiElementFactory.createElement("input",PublicUiElementIdAndClasses.ZOOM_SLIDER_ID),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return s.prototype.render=function(e,t){this.zoomElementContainer.style.display=t?"block":"none",this.zoomElementContainer.style.padding="5px 10px",this.zoomElementContainer.style.textAlign="center",e.appendChild(this.zoomElementContainer),this.rangeInput.style.display="inline-block",this.rangeInput.style.width="50%",this.rangeInput.style.height="5px",this.rangeInput.style.background="#d3d3d3",this.rangeInput.style.outline="none",this.rangeInput.style.opacity="0.7";var o=Html5QrcodeScannerStrings.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(o),this.rangeText.style.marginRight="10px";var a=this;this.rangeInput.addEventListener("input",function(){return a.onValueChange()}),this.rangeInput.addEventListener("change",function(){return a.onValueChange()}),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},s.prototype.onValueChange=function(){var e=Html5QrcodeScannerStrings.zoom();this.rangeText.innerText="".concat(this.rangeInput.value,"x ").concat(e),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},s.prototype.setValues=function(e,t,o,a){this.rangeInput.min=e.toString(),this.rangeInput.max=t.toString(),this.rangeInput.step=a.toString(),this.rangeInput.value=o.toString(),this.onValueChange()},s.prototype.show=function(){this.zoomElementContainer.style.display="block"},s.prototype.hide=function(){this.zoomElementContainer.style.display="none"},s.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e},s.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},s.create=function(e,t){var o=new s;return o.render(e,t),o},s}(),Html5QrcodeScannerStatus;(function(s){s[s.STATUS_DEFAULT=0]="STATUS_DEFAULT",s[s.STATUS_SUCCESS=1]="STATUS_SUCCESS",s[s.STATUS_WARNING=2]="STATUS_WARNING",s[s.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(Html5QrcodeScannerStatus||(Html5QrcodeScannerStatus={}));function toHtml5QrcodeCameraScanConfig(s){return{fps:s.fps,qrbox:s.qrbox,aspectRatio:s.aspectRatio,disableFlip:s.disableFlip,videoConstraints:s.videoConstraints}}function toHtml5QrcodeFullConfig(s,e){return{formatsToSupport:s.formatsToSupport,useBarCodeDetectorIfSupported:s.useBarCodeDetectorIfSupported,experimentalFeatures:s.experimentalFeatures,verbose:e}}var Html5QrcodeScanner=function(){function s(e,t,o){if(this.lastMatchFound=null,this.cameraScanImage=null,this.fileScanImage=null,this.fileSelectionUi=null,this.elementId=e,this.config=this.createConfig(t),this.verbose=o===!0,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.scanTypeSelector=new ScanTypeSelector(this.config.supportedScanTypes),this.currentScanType=this.scanTypeSelector.getDefaultScanType(),this.sectionSwapAllowed=!0,this.logger=new BaseLoggger(this.verbose),this.persistedDataManager=new PersistedDataManager,t.rememberLastUsedCamera!==!0&&this.persistedDataManager.reset()}return s.prototype.render=function(e,t){var o=this;this.lastMatchFound=null,this.qrCodeSuccessCallback=function(c,d){if(e)e(c,d);else{if(o.lastMatchFound===c)return;o.lastMatchFound=c,o.setHeaderMessage(Html5QrcodeScannerStrings.lastMatch(c),Html5QrcodeScannerStatus.STATUS_SUCCESS)}},this.qrCodeErrorCallback=function(c,d){t&&t(c,d)};var a=document.getElementById(this.elementId);if(!a)throw"HTML Element with id=".concat(this.elementId," not found");a.innerHTML="",this.createBasicLayout(a),this.html5Qrcode=new Html5Qrcode(this.getScanRegionId(),toHtml5QrcodeFullConfig(this.config,this.verbose))},s.prototype.pause=function(e){(isNullOrUndefined(e)||e!==!0)&&(e=!1),this.getHtml5QrcodeOrFail().pause(e)},s.prototype.resume=function(){this.getHtml5QrcodeOrFail().resume()},s.prototype.getState=function(){return this.getHtml5QrcodeOrFail().getState()},s.prototype.clear=function(){var e=this,t=function(){var o=document.getElementById(e.elementId);o&&(o.innerHTML="",e.resetBasicLayout(o))};return this.html5Qrcode?new Promise(function(o,a){if(!e.html5Qrcode){o();return}e.html5Qrcode.isScanning?e.html5Qrcode.stop().then(function(c){if(!e.html5Qrcode){o();return}e.html5Qrcode.clear(),t(),o()}).catch(function(c){e.verbose&&e.logger.logError("Unable to stop qrcode scanner",c),a(c)}):(e.html5Qrcode.clear(),t(),o())}):Promise.resolve()},s.prototype.getRunningTrackCapabilities=function(){return this.getHtml5QrcodeOrFail().getRunningTrackCapabilities()},s.prototype.getRunningTrackSettings=function(){return this.getHtml5QrcodeOrFail().getRunningTrackSettings()},s.prototype.applyVideoConstraints=function(e){return this.getHtml5QrcodeOrFail().applyVideoConstraints(e)},s.prototype.getHtml5QrcodeOrFail=function(){if(!this.html5Qrcode)throw"Code scanner not initialized.";return this.html5Qrcode},s.prototype.createConfig=function(e){return e?(e.fps||(e.fps=Html5QrcodeConstants.SCAN_DEFAULT_FPS),e.rememberLastUsedCamera!==!Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED&&(e.rememberLastUsedCamera=Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED),e.supportedScanTypes||(e.supportedScanTypes=Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE),e):{fps:Html5QrcodeConstants.SCAN_DEFAULT_FPS,rememberLastUsedCamera:Html5QrcodeConstants.DEFAULT_REMEMBER_LAST_CAMERA_USED,supportedScanTypes:Html5QrcodeConstants.DEFAULT_SUPPORTED_SCAN_TYPE}},s.prototype.createBasicLayout=function(e){e.style.position="relative",e.style.padding="0px",e.style.border="1px solid silver",this.createHeader(e);var t=document.createElement("div"),o=this.getScanRegionId();t.id=o,t.style.width="100%",t.style.minHeight="100px",t.style.textAlign="center",e.appendChild(t),ScanTypeSelector.isCameraScanType(this.currentScanType)?this.insertCameraScanImageToScanRegion():this.insertFileScanImageToScanRegion();var a=document.createElement("div"),c=this.getDashboardId();a.id=c,a.style.width="100%",e.appendChild(a),this.setupInitialDashboard(a)},s.prototype.resetBasicLayout=function(e){e.style.border="none"},s.prototype.setupInitialDashboard=function(e){this.createSection(e),this.createSectionControlPanel(),this.scanTypeSelector.hasMoreThanOneScanType()&&this.createSectionSwap()},s.prototype.createHeader=function(e){var t=document.createElement("div");t.style.textAlign="left",t.style.margin="0px",e.appendChild(t);var o=new LibraryInfoContainer;o.renderInto(t);var a=document.createElement("div");a.id=this.getHeaderMessageContainerId(),a.style.display="none",a.style.textAlign="center",a.style.fontSize="14px",a.style.padding="2px 10px",a.style.margin="4px",a.style.borderTop="1px solid #f6f6f6",t.appendChild(a)},s.prototype.createSection=function(e){var t=document.createElement("div");t.id=this.getDashboardSectionId(),t.style.width="100%",t.style.padding="10px 0px 10px 0px",t.style.textAlign="left",e.appendChild(t)},s.prototype.createCameraListUi=function(e,t,o){var a=this;a.showHideScanTypeSwapLink(!1),a.setHeaderMessage(Html5QrcodeScannerStrings.cameraPermissionRequesting());var c=function(){o||a.createPermissionButton(e,t)};Html5Qrcode.getCameras().then(function(d){a.persistedDataManager.setHasPermission(!0),a.showHideScanTypeSwapLink(!0),a.resetHeaderMessage(),d&&d.length>0?(e.removeChild(t),a.renderCameraSelection(d)):(a.setHeaderMessage(Html5QrcodeScannerStrings.noCameraFound(),Html5QrcodeScannerStatus.STATUS_WARNING),c())}).catch(function(d){a.persistedDataManager.setHasPermission(!1),o?o.disabled=!1:c(),a.setHeaderMessage(d,Html5QrcodeScannerStatus.STATUS_WARNING),a.showHideScanTypeSwapLink(!0)})},s.prototype.createPermissionButton=function(e,t){var o=this,a=BaseUiElementFactory.createElement("button",this.getCameraPermissionButtonId());a.innerText=Html5QrcodeScannerStrings.cameraPermissionTitle(),a.addEventListener("click",function(){a.disabled=!0,o.createCameraListUi(e,t,a)}),t.appendChild(a)},s.prototype.createPermissionsUi=function(e,t){var o=this;if(ScanTypeSelector.isCameraScanType(this.currentScanType)&&this.persistedDataManager.hasCameraPermissions()){CameraPermissions.hasPermissions().then(function(a){a?o.createCameraListUi(e,t):(o.persistedDataManager.setHasPermission(!1),o.createPermissionButton(e,t))}).catch(function(a){o.persistedDataManager.setHasPermission(!1),o.createPermissionButton(e,t)});return}this.createPermissionButton(e,t)},s.prototype.createSectionControlPanel=function(){var e=document.getElementById(this.getDashboardSectionId()),t=document.createElement("div");e.appendChild(t);var o=document.createElement("div");o.id=this.getDashboardSectionCameraScanRegionId(),o.style.display=ScanTypeSelector.isCameraScanType(this.currentScanType)?"block":"none",t.appendChild(o);var a=document.createElement("div");a.style.textAlign="center",o.appendChild(a),this.scanTypeSelector.isCameraScanRequired()&&this.createPermissionsUi(o,a),this.renderFileScanUi(t)},s.prototype.renderFileScanUi=function(e){var t=ScanTypeSelector.isFileScanType(this.currentScanType),o=this,a=function(c){if(!o.html5Qrcode)throw"html5Qrcode not defined";ScanTypeSelector.isFileScanType(o.currentScanType)&&(o.setHeaderMessage(Html5QrcodeScannerStrings.loadingImage()),o.html5Qrcode.scanFileV2(c,!0).then(function(d){o.resetHeaderMessage(),o.qrCodeSuccessCallback(d.decodedText,d)}).catch(function(d){o.setHeaderMessage(d,Html5QrcodeScannerStatus.STATUS_WARNING),o.qrCodeErrorCallback(d,Html5QrcodeErrorFactory.createFrom(d))}))};this.fileSelectionUi=FileSelectionUi.create(e,t,a)},s.prototype.renderCameraSelection=function(e){var t=this,o=this,a=document.getElementById(this.getDashboardSectionCameraScanRegionId());a.style.textAlign="center";var c=CameraZoomUi.create(a,!1),d=function(O){var I=O.zoomFeature();if(I.isSupported()){c.setOnCameraZoomValueChangeCallback(function(j){I.apply(j)});var P=1;t.config.defaultZoomValueIfSupported&&(P=t.config.defaultZoomValueIfSupported),P=clip(P,I.min(),I.max()),c.setValues(I.min(),I.max(),P,I.step()),c.show()}},g=CameraSelectionUi.create(a,e),y=document.createElement("span"),_=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.CAMERA_START_BUTTON_ID);_.innerText=Html5QrcodeScannerStrings.scanButtonStartScanningText(),y.appendChild(_);var E=BaseUiElementFactory.createElement("button",PublicUiElementIdAndClasses.CAMERA_STOP_BUTTON_ID);E.innerText=Html5QrcodeScannerStrings.scanButtonStopScanningText(),E.style.display="none",E.disabled=!0,y.appendChild(E);var S,A=function(O){if(!O.torchFeature().isSupported()){S&&S.hide();return}S?S.updateTorchCapability(O.torchFeature()):S=TorchButton.create(y,O.torchFeature(),{display:"none",marginLeft:"5px"},function(I){o.setHeaderMessage(I,Html5QrcodeScannerStatus.STATUS_WARNING)}),S.show()};a.appendChild(y);var C=function(O){O||(_.style.display="none"),_.innerText=Html5QrcodeScannerStrings.scanButtonStartScanningText(),_.style.opacity="1",_.disabled=!1,O&&(_.style.display="inline-block")};if(_.addEventListener("click",function(O){_.innerText=Html5QrcodeScannerStrings.scanButtonScanningStarting(),g.disable(),_.disabled=!0,_.style.opacity="0.5",t.scanTypeSelector.hasMoreThanOneScanType()&&o.showHideScanTypeSwapLink(!1),o.resetHeaderMessage();var I=g.getValue();o.persistedDataManager.setLastUsedCameraId(I),o.html5Qrcode.start(I,toHtml5QrcodeCameraScanConfig(o.config),o.qrCodeSuccessCallback,o.qrCodeErrorCallback).then(function(P){E.disabled=!1,E.style.display="inline-block",C(!1);var j=o.html5Qrcode.getRunningTrackCameraCapabilities();t.config.showTorchButtonIfSupported===!0&&A(j),t.config.showZoomSliderIfSupported===!0&&d(j)}).catch(function(P){o.showHideScanTypeSwapLink(!0),g.enable(),C(!0),o.setHeaderMessage(P,Html5QrcodeScannerStatus.STATUS_WARNING)})}),g.hasSingleItem()&&_.click(),E.addEventListener("click",function(O){if(!o.html5Qrcode)throw"html5Qrcode not defined";E.disabled=!0,o.html5Qrcode.stop().then(function(I){t.scanTypeSelector.hasMoreThanOneScanType()&&o.showHideScanTypeSwapLink(!0),g.enable(),_.disabled=!1,E.style.display="none",_.style.display="inline-block",S&&(S.reset(),S.hide()),c.removeOnCameraZoomValueChangeCallback(),c.hide(),o.insertCameraScanImageToScanRegion()}).catch(function(I){E.disabled=!1,o.setHeaderMessage(I,Html5QrcodeScannerStatus.STATUS_WARNING)})}),o.persistedDataManager.getLastUsedCameraId()){var N=o.persistedDataManager.getLastUsedCameraId();g.hasValue(N)?(g.setValue(N),_.click()):o.persistedDataManager.resetLastUsedCameraId()}},s.prototype.createSectionSwap=function(){var e=this,t=Html5QrcodeScannerStrings.textIfCameraScanSelected(),o=Html5QrcodeScannerStrings.textIfFileScanSelected(),a=document.getElementById(this.getDashboardSectionId()),c=document.createElement("div");c.style.textAlign="center";var d=BaseUiElementFactory.createElement("span",this.getDashboardSectionSwapLinkId());d.style.textDecoration="underline",d.style.cursor="pointer",d.innerText=ScanTypeSelector.isCameraScanType(this.currentScanType)?t:o,d.addEventListener("click",function(){if(!e.sectionSwapAllowed){e.verbose&&e.logger.logError("Section swap called when not allowed");return}e.resetHeaderMessage(),e.fileSelectionUi.resetValue(),e.sectionSwapAllowed=!1,ScanTypeSelector.isCameraScanType(e.currentScanType)?(e.clearScanRegion(),e.getCameraScanRegion().style.display="none",e.fileSelectionUi.show(),d.innerText=o,e.currentScanType=Html5QrcodeScanType.SCAN_TYPE_FILE,e.insertFileScanImageToScanRegion()):(e.clearScanRegion(),e.getCameraScanRegion().style.display="block",e.fileSelectionUi.hide(),d.innerText=t,e.currentScanType=Html5QrcodeScanType.SCAN_TYPE_CAMERA,e.insertCameraScanImageToScanRegion(),e.startCameraScanIfPermissionExistsOnSwap()),e.sectionSwapAllowed=!0}),c.appendChild(d),a.appendChild(c)},s.prototype.startCameraScanIfPermissionExistsOnSwap=function(){var e=this,t=this;if(this.persistedDataManager.hasCameraPermissions()){CameraPermissions.hasPermissions().then(function(o){if(o){var a=document.getElementById(t.getCameraPermissionButtonId());if(!a)throw e.logger.logError("Permission button not found, fail;"),"Permission button not found";a.click()}else t.persistedDataManager.setHasPermission(!1)}).catch(function(o){t.persistedDataManager.setHasPermission(!1)});return}},s.prototype.resetHeaderMessage=function(){var e=document.getElementById(this.getHeaderMessageContainerId());e.style.display="none"},s.prototype.setHeaderMessage=function(e,t){t||(t=Html5QrcodeScannerStatus.STATUS_DEFAULT);var o=this.getHeaderMessageDiv();switch(o.innerText=e,o.style.display="block",t){case Html5QrcodeScannerStatus.STATUS_SUCCESS:o.style.background="rgba(106, 175, 80, 0.26)",o.style.color="#477735";break;case Html5QrcodeScannerStatus.STATUS_WARNING:o.style.background="rgba(203, 36, 49, 0.14)",o.style.color="#cb2431";break;case Html5QrcodeScannerStatus.STATUS_DEFAULT:default:o.style.background="rgba(0, 0, 0, 0)",o.style.color="rgb(17, 17, 17)";break}},s.prototype.showHideScanTypeSwapLink=function(e){this.scanTypeSelector.hasMoreThanOneScanType()&&(e!==!0&&(e=!1),this.sectionSwapAllowed=e,this.getDashboardSectionSwapLink().style.display=e?"inline-block":"none")},s.prototype.insertCameraScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.cameraScanImage){t.innerHTML="<br>",t.appendChild(this.cameraScanImage);return}this.cameraScanImage=new Image,this.cameraScanImage.onload=function(o){t.innerHTML="<br>",t.appendChild(e.cameraScanImage)},this.cameraScanImage.width=64,this.cameraScanImage.style.opacity="0.8",this.cameraScanImage.src=ASSET_CAMERA_SCAN,this.cameraScanImage.alt=Html5QrcodeScannerStrings.cameraScanAltText()},s.prototype.insertFileScanImageToScanRegion=function(){var e=this,t=document.getElementById(this.getScanRegionId());if(this.fileScanImage){t.innerHTML="<br>",t.appendChild(this.fileScanImage);return}this.fileScanImage=new Image,this.fileScanImage.onload=function(o){t.innerHTML="<br>",t.appendChild(e.fileScanImage)},this.fileScanImage.width=64,this.fileScanImage.style.opacity="0.8",this.fileScanImage.src=ASSET_FILE_SCAN,this.fileScanImage.alt=Html5QrcodeScannerStrings.fileScanAltText()},s.prototype.clearScanRegion=function(){var e=document.getElementById(this.getScanRegionId());e.innerHTML=""},s.prototype.getDashboardSectionId=function(){return"".concat(this.elementId,"__dashboard_section")},s.prototype.getDashboardSectionCameraScanRegionId=function(){return"".concat(this.elementId,"__dashboard_section_csr")},s.prototype.getDashboardSectionSwapLinkId=function(){return PublicUiElementIdAndClasses.SCAN_TYPE_CHANGE_ANCHOR_ID},s.prototype.getScanRegionId=function(){return"".concat(this.elementId,"__scan_region")},s.prototype.getDashboardId=function(){return"".concat(this.elementId,"__dashboard")},s.prototype.getHeaderMessageContainerId=function(){return"".concat(this.elementId,"__header_message")},s.prototype.getCameraPermissionButtonId=function(){return PublicUiElementIdAndClasses.CAMERA_PERMISSION_BUTTON_ID},s.prototype.getCameraScanRegion=function(){return document.getElementById(this.getDashboardSectionCameraScanRegionId())},s.prototype.getDashboardSectionSwapLink=function(){return document.getElementById(this.getDashboardSectionSwapLinkId())},s.prototype.getHeaderMessageDiv=function(){return document.getElementById(this.getHeaderMessageContainerId())},s}();const API_URL={}.VITE_API_URL||"http://localhost:3000",ScanPage=({handleQrScan:s})=>{var I;const[e,t]=reactExports.useState(""),[o,a]=reactExports.useState(!1),[c,d]=reactExports.useState(null),[g,y]=reactExports.useState(null),[_,E]=reactExports.useState(!1),S=reactExports.useRef(null);reactExports.useEffect(()=>(o&&!S.current&&(S.current=new Html5QrcodeScanner("qr-reader",{fps:10,qrbox:{width:250,height:250},aspectRatio:1},!1),S.current.render(A,C)),()=>{S.current&&(S.current.clear(),S.current=null)}),[o]);const A=async P=>{try{await N(P),S.current&&(S.current.clear(),S.current=null),a(!1)}catch(j){console.error("Error scanning QR code:",j)}},C=P=>{console.warn("QR Code scan failed:",P)},N=async P=>{E(!0),y(null);try{const j=await fetch(`${API_URL}/nft/${P}`);if(!j.ok)throw new Error("Failed to fetch NFT data");const B=await j.json();d(B)}catch(j){console.error("Error fetching NFT:",j),y(j.message)}finally{E(!1)}},O=P=>{P.preventDefault(),e.trim()&&N(e.trim())};return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black pt-20",children:jsxRuntimeExports.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-gray-800/50 rounded-2xl p-8 shadow-xl border border-gray-700/50",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-white mb-8 text-center",children:"Scan Product Passport"}),jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("form",{onSubmit:O,className:"flex gap-4",children:[jsxRuntimeExports.jsx("input",{type:"text",value:e,onChange:P=>t(P.target.value),placeholder:"Enter NFT address manually",className:"flex-1 bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 outline-none"}),jsxRuntimeExports.jsxs("button",{type:"submit",className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors",children:[jsxRuntimeExports.jsx(MagnifyingGlassIcon$1,{className:"h-5 w-5"}),"Сканувати"]})]}),jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("button",{onClick:()=>a(!o),className:"inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:shadow-lg hover:shadow-blue-500/25 transition-all",children:o?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(XMarkIcon$1,{className:"h-5 w-5"})," Stop Scanning"]}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(CameraIcon$1,{className:"h-5 w-5"})," Start Scanning"]})})}),o&&jsxRuntimeExports.jsx("div",{id:"qr-reader",className:"w-full max-w-sm mx-auto"}),_&&jsxRuntimeExports.jsxs("div",{className:"text-center text-gray-400",children:[jsxRuntimeExports.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-4 border-blue-500 border-t-transparent"}),jsxRuntimeExports.jsx("p",{className:"mt-2",children:"Loading NFT data..."})]}),g&&jsxRuntimeExports.jsx("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg",children:g}),c&&!_&&!g&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-700/30 rounded-xl p-6",children:jsxRuntimeExports.jsxs("div",{className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsx("h2",{className:"text-xl font-bold text-white",children:c.name}),jsxRuntimeExports.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-400 rounded-full text-sm",children:c.symbol})]}),c.image&&jsxRuntimeExports.jsx("div",{className:"aspect-square w-full max-w-sm mx-auto rounded-lg overflow-hidden",children:jsxRuntimeExports.jsx("img",{src:c.image,alt:c.name,className:"w-full h-full object-cover"})}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-2 gap-4",children:(I=c.attributes)==null?void 0:I.map((P,j)=>jsxRuntimeExports.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg",children:[jsxRuntimeExports.jsx("div",{className:"text-sm text-gray-400 mb-1",children:P.trait_type}),jsxRuntimeExports.jsx("div",{className:"text-white font-medium",children:P.value})]},j))}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-gray-700",children:jsxRuntimeExports.jsxs("a",{href:`https://explorer.solana.com/address/${c.address}?cluster=devnet`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-blue-400 hover:text-blue-300 transition-colors",children:["View on Solana Explorer ",jsxRuntimeExports.jsx(ArrowTopRightOnSquareIcon$1,{className:"h-4 w-4 text-xs"})]})})]})}),jsxRuntimeExports.jsxs("div",{className:"text-center mb-8",children:[jsxRuntimeExports.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-500/10 rounded-full mb-4",children:jsxRuntimeExports.jsx(CameraIcon$1,{className:"h-6 w-6 text-blue-400"})}),jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"Сканування QR-коду"}),jsxRuntimeExports.jsx("p",{className:"text-gray-400",children:"Наведіть камеру на QR-код продукту для перевірки автентичності"})]})]})]})})})};var __defProp=Object.defineProperty,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(s,e,t)=>e in s?__defProp(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,__spreadValues=(s,e)=>{for(var t in e||(e={}))__hasOwnProp.call(e,t)&&__defNormalProp(s,t,e[t]);if(__getOwnPropSymbols)for(var t of __getOwnPropSymbols(e))__propIsEnum.call(e,t)&&__defNormalProp(s,t,e[t]);return s},__objRest=(s,e)=>{var t={};for(var o in s)__hasOwnProp.call(s,o)&&e.indexOf(o)<0&&(t[o]=s[o]);if(s!=null&&__getOwnPropSymbols)for(var o of __getOwnPropSymbols(s))e.indexOf(o)<0&&__propIsEnum.call(s,o)&&(t[o]=s[o]);return t};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var qrcodegen;(s=>{const e=class{constructor(y,_,E,S){if(this.version=y,this.errorCorrectionLevel=_,this.modules=[],this.isFunction=[],y<e.MIN_VERSION||y>e.MAX_VERSION)throw new RangeError("Version value out of range");if(S<-1||S>7)throw new RangeError("Mask value out of range");this.size=y*4+17;let A=[];for(let N=0;N<this.size;N++)A.push(!1);for(let N=0;N<this.size;N++)this.modules.push(A.slice()),this.isFunction.push(A.slice());this.drawFunctionPatterns();const C=this.addEccAndInterleave(E);if(this.drawCodewords(C),S==-1){let N=1e9;for(let O=0;O<8;O++){this.applyMask(O),this.drawFormatBits(O);const I=this.getPenaltyScore();I<N&&(S=O,N=I),this.applyMask(O)}}c(0<=S&&S<=7),this.mask=S,this.applyMask(S),this.drawFormatBits(S),this.isFunction=[]}static encodeText(y,_){const E=s.QrSegment.makeSegments(y);return e.encodeSegments(E,_)}static encodeBinary(y,_){const E=s.QrSegment.makeBytes(y);return e.encodeSegments([E],_)}static encodeSegments(y,_,E=1,S=40,A=-1,C=!0){if(!(e.MIN_VERSION<=E&&E<=S&&S<=e.MAX_VERSION)||A<-1||A>7)throw new RangeError("Invalid value");let N,O;for(N=E;;N++){const B=e.getNumDataCodewords(N,_)*8,H=g.getTotalBits(y,N);if(H<=B){O=H;break}if(N>=S)throw new RangeError("Data too long")}for(const B of[e.Ecc.MEDIUM,e.Ecc.QUARTILE,e.Ecc.HIGH])C&&O<=e.getNumDataCodewords(N,B)*8&&(_=B);let I=[];for(const B of y){o(B.mode.modeBits,4,I),o(B.numChars,B.mode.numCharCountBits(N),I);for(const H of B.getData())I.push(H)}c(I.length==O);const P=e.getNumDataCodewords(N,_)*8;c(I.length<=P),o(0,Math.min(4,P-I.length),I),o(0,(8-I.length%8)%8,I),c(I.length%8==0);for(let B=236;I.length<P;B^=253)o(B,8,I);let j=[];for(;j.length*8<I.length;)j.push(0);return I.forEach((B,H)=>j[H>>>3]|=B<<7-(H&7)),new e(N,_,j,A)}getModule(y,_){return 0<=y&&y<this.size&&0<=_&&_<this.size&&this.modules[_][y]}getModules(){return this.modules}drawFunctionPatterns(){for(let E=0;E<this.size;E++)this.setFunctionModule(6,E,E%2==0),this.setFunctionModule(E,6,E%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const y=this.getAlignmentPatternPositions(),_=y.length;for(let E=0;E<_;E++)for(let S=0;S<_;S++)E==0&&S==0||E==0&&S==_-1||E==_-1&&S==0||this.drawAlignmentPattern(y[E],y[S]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(y){const _=this.errorCorrectionLevel.formatBits<<3|y;let E=_;for(let A=0;A<10;A++)E=E<<1^(E>>>9)*1335;const S=(_<<10|E)^21522;c(S>>>15==0);for(let A=0;A<=5;A++)this.setFunctionModule(8,A,a(S,A));this.setFunctionModule(8,7,a(S,6)),this.setFunctionModule(8,8,a(S,7)),this.setFunctionModule(7,8,a(S,8));for(let A=9;A<15;A++)this.setFunctionModule(14-A,8,a(S,A));for(let A=0;A<8;A++)this.setFunctionModule(this.size-1-A,8,a(S,A));for(let A=8;A<15;A++)this.setFunctionModule(8,this.size-15+A,a(S,A));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let y=this.version;for(let E=0;E<12;E++)y=y<<1^(y>>>11)*7973;const _=this.version<<12|y;c(_>>>18==0);for(let E=0;E<18;E++){const S=a(_,E),A=this.size-11+E%3,C=Math.floor(E/3);this.setFunctionModule(A,C,S),this.setFunctionModule(C,A,S)}}drawFinderPattern(y,_){for(let E=-4;E<=4;E++)for(let S=-4;S<=4;S++){const A=Math.max(Math.abs(S),Math.abs(E)),C=y+S,N=_+E;0<=C&&C<this.size&&0<=N&&N<this.size&&this.setFunctionModule(C,N,A!=2&&A!=4)}}drawAlignmentPattern(y,_){for(let E=-2;E<=2;E++)for(let S=-2;S<=2;S++)this.setFunctionModule(y+S,_+E,Math.max(Math.abs(S),Math.abs(E))!=1)}setFunctionModule(y,_,E){this.modules[_][y]=E,this.isFunction[_][y]=!0}addEccAndInterleave(y){const _=this.version,E=this.errorCorrectionLevel;if(y.length!=e.getNumDataCodewords(_,E))throw new RangeError("Invalid argument");const S=e.NUM_ERROR_CORRECTION_BLOCKS[E.ordinal][_],A=e.ECC_CODEWORDS_PER_BLOCK[E.ordinal][_],C=Math.floor(e.getNumRawDataModules(_)/8),N=S-C%S,O=Math.floor(C/S);let I=[];const P=e.reedSolomonComputeDivisor(A);for(let B=0,H=0;B<S;B++){let se=y.slice(H,H+O-A+(B<N?0:1));H+=se.length;const oe=e.reedSolomonComputeRemainder(se,P);B<N&&se.push(0),I.push(se.concat(oe))}let j=[];for(let B=0;B<I[0].length;B++)I.forEach((H,se)=>{(B!=O-A||se>=N)&&j.push(H[B])});return c(j.length==C),j}drawCodewords(y){if(y.length!=Math.floor(e.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let _=0;for(let E=this.size-1;E>=1;E-=2){E==6&&(E=5);for(let S=0;S<this.size;S++)for(let A=0;A<2;A++){const C=E-A,O=(E+1&2)==0?this.size-1-S:S;!this.isFunction[O][C]&&_<y.length*8&&(this.modules[O][C]=a(y[_>>>3],7-(_&7)),_++)}}c(_==y.length*8)}applyMask(y){if(y<0||y>7)throw new RangeError("Mask value out of range");for(let _=0;_<this.size;_++)for(let E=0;E<this.size;E++){let S;switch(y){case 0:S=(E+_)%2==0;break;case 1:S=_%2==0;break;case 2:S=E%3==0;break;case 3:S=(E+_)%3==0;break;case 4:S=(Math.floor(E/3)+Math.floor(_/2))%2==0;break;case 5:S=E*_%2+E*_%3==0;break;case 6:S=(E*_%2+E*_%3)%2==0;break;case 7:S=((E+_)%2+E*_%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[_][E]&&S&&(this.modules[_][E]=!this.modules[_][E])}}getPenaltyScore(){let y=0;for(let A=0;A<this.size;A++){let C=!1,N=0,O=[0,0,0,0,0,0,0];for(let I=0;I<this.size;I++)this.modules[A][I]==C?(N++,N==5?y+=e.PENALTY_N1:N>5&&y++):(this.finderPenaltyAddHistory(N,O),C||(y+=this.finderPenaltyCountPatterns(O)*e.PENALTY_N3),C=this.modules[A][I],N=1);y+=this.finderPenaltyTerminateAndCount(C,N,O)*e.PENALTY_N3}for(let A=0;A<this.size;A++){let C=!1,N=0,O=[0,0,0,0,0,0,0];for(let I=0;I<this.size;I++)this.modules[I][A]==C?(N++,N==5?y+=e.PENALTY_N1:N>5&&y++):(this.finderPenaltyAddHistory(N,O),C||(y+=this.finderPenaltyCountPatterns(O)*e.PENALTY_N3),C=this.modules[I][A],N=1);y+=this.finderPenaltyTerminateAndCount(C,N,O)*e.PENALTY_N3}for(let A=0;A<this.size-1;A++)for(let C=0;C<this.size-1;C++){const N=this.modules[A][C];N==this.modules[A][C+1]&&N==this.modules[A+1][C]&&N==this.modules[A+1][C+1]&&(y+=e.PENALTY_N2)}let _=0;for(const A of this.modules)_=A.reduce((C,N)=>C+(N?1:0),_);const E=this.size*this.size,S=Math.ceil(Math.abs(_*20-E*10)/E)-1;return c(0<=S&&S<=9),y+=S*e.PENALTY_N4,c(0<=y&&y<=2568888),y}getAlignmentPatternPositions(){if(this.version==1)return[];{const y=Math.floor(this.version/7)+2,_=this.version==32?26:Math.ceil((this.version*4+4)/(y*2-2))*2;let E=[6];for(let S=this.size-7;E.length<y;S-=_)E.splice(1,0,S);return E}}static getNumRawDataModules(y){if(y<e.MIN_VERSION||y>e.MAX_VERSION)throw new RangeError("Version number out of range");let _=(16*y+128)*y+64;if(y>=2){const E=Math.floor(y/7)+2;_-=(25*E-10)*E-55,y>=7&&(_-=36)}return c(208<=_&&_<=29648),_}static getNumDataCodewords(y,_){return Math.floor(e.getNumRawDataModules(y)/8)-e.ECC_CODEWORDS_PER_BLOCK[_.ordinal][y]*e.NUM_ERROR_CORRECTION_BLOCKS[_.ordinal][y]}static reedSolomonComputeDivisor(y){if(y<1||y>255)throw new RangeError("Degree out of range");let _=[];for(let S=0;S<y-1;S++)_.push(0);_.push(1);let E=1;for(let S=0;S<y;S++){for(let A=0;A<_.length;A++)_[A]=e.reedSolomonMultiply(_[A],E),A+1<_.length&&(_[A]^=_[A+1]);E=e.reedSolomonMultiply(E,2)}return _}static reedSolomonComputeRemainder(y,_){let E=_.map(S=>0);for(const S of y){const A=S^E.shift();E.push(0),_.forEach((C,N)=>E[N]^=e.reedSolomonMultiply(C,A))}return E}static reedSolomonMultiply(y,_){if(y>>>8||_>>>8)throw new RangeError("Byte out of range");let E=0;for(let S=7;S>=0;S--)E=E<<1^(E>>>7)*285,E^=(_>>>S&1)*y;return c(E>>>8==0),E}finderPenaltyCountPatterns(y){const _=y[1];c(_<=this.size*3);const E=_>0&&y[2]==_&&y[3]==_*3&&y[4]==_&&y[5]==_;return(E&&y[0]>=_*4&&y[6]>=_?1:0)+(E&&y[6]>=_*4&&y[0]>=_?1:0)}finderPenaltyTerminateAndCount(y,_,E){return y&&(this.finderPenaltyAddHistory(_,E),_=0),_+=this.size,this.finderPenaltyAddHistory(_,E),this.finderPenaltyCountPatterns(E)}finderPenaltyAddHistory(y,_){_[0]==0&&(y+=this.size),_.pop(),_.unshift(y)}};let t=e;t.MIN_VERSION=1,t.MAX_VERSION=40,t.PENALTY_N1=3,t.PENALTY_N2=3,t.PENALTY_N3=40,t.PENALTY_N4=10,t.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],t.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],s.QrCode=t;function o(y,_,E){if(_<0||_>31||y>>>_)throw new RangeError("Value out of range");for(let S=_-1;S>=0;S--)E.push(y>>>S&1)}function a(y,_){return(y>>>_&1)!=0}function c(y){if(!y)throw new Error("Assertion error")}const d=class{constructor(y,_,E){if(this.mode=y,this.numChars=_,this.bitData=E,_<0)throw new RangeError("Invalid argument");this.bitData=E.slice()}static makeBytes(y){let _=[];for(const E of y)o(E,8,_);return new d(d.Mode.BYTE,y.length,_)}static makeNumeric(y){if(!d.isNumeric(y))throw new RangeError("String contains non-numeric characters");let _=[];for(let E=0;E<y.length;){const S=Math.min(y.length-E,3);o(parseInt(y.substr(E,S),10),S*3+1,_),E+=S}return new d(d.Mode.NUMERIC,y.length,_)}static makeAlphanumeric(y){if(!d.isAlphanumeric(y))throw new RangeError("String contains unencodable characters in alphanumeric mode");let _=[],E;for(E=0;E+2<=y.length;E+=2){let S=d.ALPHANUMERIC_CHARSET.indexOf(y.charAt(E))*45;S+=d.ALPHANUMERIC_CHARSET.indexOf(y.charAt(E+1)),o(S,11,_)}return E<y.length&&o(d.ALPHANUMERIC_CHARSET.indexOf(y.charAt(E)),6,_),new d(d.Mode.ALPHANUMERIC,y.length,_)}static makeSegments(y){return y==""?[]:d.isNumeric(y)?[d.makeNumeric(y)]:d.isAlphanumeric(y)?[d.makeAlphanumeric(y)]:[d.makeBytes(d.toUtf8ByteArray(y))]}static makeEci(y){let _=[];if(y<0)throw new RangeError("ECI assignment value out of range");if(y<128)o(y,8,_);else if(y<16384)o(2,2,_),o(y,14,_);else if(y<1e6)o(6,3,_),o(y,21,_);else throw new RangeError("ECI assignment value out of range");return new d(d.Mode.ECI,0,_)}static isNumeric(y){return d.NUMERIC_REGEX.test(y)}static isAlphanumeric(y){return d.ALPHANUMERIC_REGEX.test(y)}getData(){return this.bitData.slice()}static getTotalBits(y,_){let E=0;for(const S of y){const A=S.mode.numCharCountBits(_);if(S.numChars>=1<<A)return 1/0;E+=4+A+S.bitData.length}return E}static toUtf8ByteArray(y){y=encodeURI(y);let _=[];for(let E=0;E<y.length;E++)y.charAt(E)!="%"?_.push(y.charCodeAt(E)):(_.push(parseInt(y.substr(E+1,2),16)),E+=2);return _}};let g=d;g.NUMERIC_REGEX=/^[0-9]*$/,g.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,g.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",s.QrSegment=g})(qrcodegen||(qrcodegen={}));(s=>{(e=>{const t=class{constructor(a,c){this.ordinal=a,this.formatBits=c}};let o=t;o.LOW=new t(0,1),o.MEDIUM=new t(1,0),o.QUARTILE=new t(2,3),o.HIGH=new t(3,2),e.Ecc=o})(s.QrCode||(s.QrCode={}))})(qrcodegen||(qrcodegen={}));(s=>{(e=>{const t=class{constructor(a,c){this.modeBits=a,this.numBitsCharCount=c}numCharCountBits(a){return this.numBitsCharCount[Math.floor((a+7)/17)]}};let o=t;o.NUMERIC=new t(1,[10,12,14]),o.ALPHANUMERIC=new t(2,[9,11,13]),o.BYTE=new t(4,[8,16,16]),o.KANJI=new t(8,[8,10,12]),o.ECI=new t(7,[0,0,0]),e.Mode=o})(s.QrSegment||(s.QrSegment={}))})(qrcodegen||(qrcodegen={}));var qrcodegen_default=qrcodegen;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var ERROR_LEVEL_MAP={L:qrcodegen_default.QrCode.Ecc.LOW,M:qrcodegen_default.QrCode.Ecc.MEDIUM,Q:qrcodegen_default.QrCode.Ecc.QUARTILE,H:qrcodegen_default.QrCode.Ecc.HIGH},DEFAULT_SIZE=128,DEFAULT_LEVEL="L",DEFAULT_BGCOLOR="#FFFFFF",DEFAULT_FGCOLOR="#000000",DEFAULT_INCLUDEMARGIN=!1,MARGIN_SIZE=4,DEFAULT_IMG_SCALE=.1;function generatePath(s,e=0){const t=[];return s.forEach(function(o,a){let c=null;o.forEach(function(d,g){if(!d&&c!==null){t.push(`M${c+e} ${a+e}h${g-c}v1H${c+e}z`),c=null;return}if(g===o.length-1){if(!d)return;c===null?t.push(`M${g+e},${a+e} h1v1H${g+e}z`):t.push(`M${c+e},${a+e} h${g+1-c}v1H${c+e}z`);return}d&&c===null&&(c=g)})}),t.join("")}function excavateModules(s,e){return s.slice().map((t,o)=>o<e.y||o>=e.y+e.h?t:t.map((a,c)=>c<e.x||c>=e.x+e.w?a:!1))}function getImageSettings(s,e,t,o){if(o==null)return null;const a=t?MARGIN_SIZE:0,c=s.length+a*2,d=Math.floor(e*DEFAULT_IMG_SCALE),g=c/e,y=(o.width||d)*g,_=(o.height||d)*g,E=o.x==null?s.length/2-y/2:o.x*g,S=o.y==null?s.length/2-_/2:o.y*g;let A=null;if(o.excavate){let C=Math.floor(E),N=Math.floor(S),O=Math.ceil(y+E-C),I=Math.ceil(_+S-N);A={x:C,y:N,w:O,h:I}}return{x:E,y:S,h:_,w:y,excavation:A}}var SUPPORTS_PATH2D=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}();function QRCodeCanvas(s){const e=s,{value:t,size:o=DEFAULT_SIZE,level:a=DEFAULT_LEVEL,bgColor:c=DEFAULT_BGCOLOR,fgColor:d=DEFAULT_FGCOLOR,includeMargin:g=DEFAULT_INCLUDEMARGIN,style:y,imageSettings:_}=e,E=__objRest(e,["value","size","level","bgColor","fgColor","includeMargin","style","imageSettings"]),S=_==null?void 0:_.src,A=React$1.useRef(null),C=React$1.useRef(null),[N,O]=React$1.useState(!1);React$1.useEffect(()=>{if(A.current!=null){const j=A.current,B=j.getContext("2d");if(!B)return;let H=qrcodegen_default.QrCode.encodeText(t,ERROR_LEVEL_MAP[a]).getModules();const se=g?MARGIN_SIZE:0,oe=H.length+se*2,Q=getImageSettings(H,o,g,_),fe=C.current,Z=Q!=null&&fe!==null&&fe.complete&&fe.naturalHeight!==0&&fe.naturalWidth!==0;Z&&Q.excavation!=null&&(H=excavateModules(H,Q.excavation));const ce=window.devicePixelRatio||1;j.height=j.width=o*ce;const ge=o/oe*ce;B.scale(ge,ge),B.fillStyle=c,B.fillRect(0,0,oe,oe),B.fillStyle=d,SUPPORTS_PATH2D?B.fill(new Path2D(generatePath(H,se))):H.forEach(function(me,V){me.forEach(function(R,L){R&&B.fillRect(L+se,V+se,1,1)})}),Z&&B.drawImage(fe,Q.x+se,Q.y+se,Q.w,Q.h)}}),React$1.useEffect(()=>{O(!1)},[S]);const I=__spreadValues({height:o,width:o},y);let P=null;return S!=null&&(P=React$1.createElement("img",{src:S,key:S,style:{display:"none"},onLoad:()=>{O(!0)},ref:C})),React$1.createElement(React$1.Fragment,null,React$1.createElement("canvas",__spreadValues({style:I,height:o,width:o,ref:A},E)),P)}function QRCodeSVG(s){const e=s,{value:t,size:o=DEFAULT_SIZE,level:a=DEFAULT_LEVEL,bgColor:c=DEFAULT_BGCOLOR,fgColor:d=DEFAULT_FGCOLOR,includeMargin:g=DEFAULT_INCLUDEMARGIN,imageSettings:y}=e,_=__objRest(e,["value","size","level","bgColor","fgColor","includeMargin","imageSettings"]);let E=qrcodegen_default.QrCode.encodeText(t,ERROR_LEVEL_MAP[a]).getModules();const S=g?MARGIN_SIZE:0,A=E.length+S*2,C=getImageSettings(E,o,g,y);let N=null;y!=null&&C!=null&&(C.excavation!=null&&(E=excavateModules(E,C.excavation)),N=React$1.createElement("image",{xlinkHref:y.src,height:C.h,width:C.w,x:C.x+S,y:C.y+S,preserveAspectRatio:"none"}));const O=generatePath(E,S);return React$1.createElement("svg",__spreadValues({height:o,width:o,viewBox:`0 0 ${A} ${A}`},_),React$1.createElement("path",{fill:c,d:`M0,0 h${A}v${A}H0z`,shapeRendering:"crispEdges"}),React$1.createElement("path",{fill:d,d:O,shapeRendering:"crispEdges"}),N)}var QRCode=s=>{const e=s,{renderAs:t}=e,o=__objRest(e,["renderAs"]);return t==="svg"?React$1.createElement(QRCodeSVG,__spreadValues({},o)):React$1.createElement(QRCodeCanvas,__spreadValues({},o))};function warn(){if(console&&console.warn){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];typeof e[0]=="string"&&(e[0]=`react-i18next:: ${e[0]}`),console.warn(...e)}}const alreadyWarned={};function warnOnce$1(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];typeof e[0]=="string"&&alreadyWarned[e[0]]||(typeof e[0]=="string"&&(alreadyWarned[e[0]]=new Date),warn(...e))}const loadedClb=(s,e)=>()=>{if(s.isInitialized)e();else{const t=()=>{setTimeout(()=>{s.off("initialized",t)},0),e()};s.on("initialized",t)}};function loadNamespaces(s,e,t){s.loadNamespaces(e,loadedClb(s,t))}function loadLanguages(s,e,t,o){typeof t=="string"&&(t=[t]),t.forEach(a=>{s.options.ns.indexOf(a)<0&&s.options.ns.push(a)}),s.loadLanguages(e,loadedClb(s,o))}function oldI18nextHasLoadedNamespace(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=e.languages[0],a=e.options?e.options.fallbackLng:!1,c=e.languages[e.languages.length-1];if(o.toLowerCase()==="cimode")return!0;const d=(g,y)=>{const _=e.services.backendConnector.state[`${g}|${y}`];return _===-1||_===2};return t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&e.services.backendConnector.backend&&e.isLanguageChangingTo&&!d(e.isLanguageChangingTo,s)?!1:!!(e.hasResourceBundle(o,s)||!e.services.backendConnector.backend||e.options.resources&&!e.options.partialBundledLanguages||d(o,s)&&(!a||d(c,s)))}function hasLoadedNamespace(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!e.languages||!e.languages.length?(warnOnce$1("i18n.languages were undefined or empty",e.languages),!0):e.options.ignoreJSONStructure!==void 0?e.hasLoadedNamespace(s,{lng:t.lng,precheck:(a,c)=>{if(t.bindI18n&&t.bindI18n.indexOf("languageChanging")>-1&&a.services.backendConnector.backend&&a.isLanguageChangingTo&&!c(a.isLanguageChangingTo,s))return!1}}):oldI18nextHasLoadedNamespace(s,e,t)}const matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=s=>htmlEntities[s],unescape$1=s=>s.replace(matchHtmlEntity,unescapeHtmlEntity);let defaultOptions={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:unescape$1};function setDefaults(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};defaultOptions={...defaultOptions,...s}}function getDefaults(){return defaultOptions}let i18nInstance;function setI18n(s){i18nInstance=s}function getI18n(){return i18nInstance}const initReactI18next={type:"3rdParty",init(s){setDefaults(s.options.react),setI18n(s)}},I18nContext=reactExports.createContext();class ReportNamespaces{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(t=>{this.usedNamespaces[t]||(this.usedNamespaces[t]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const usePrevious=(s,e)=>{const t=reactExports.useRef();return reactExports.useEffect(()=>{t.current=e?t.current:s},[s,e]),t.current};function useTranslation(s){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:t}=e,{i18n:o,defaultNS:a}=reactExports.useContext(I18nContext)||{},c=t||o||getI18n();if(c&&!c.reportNamespaces&&(c.reportNamespaces=new ReportNamespaces),!c){warnOnce$1("You will need to pass in an i18next instance by using initReactI18next");const B=(se,oe)=>typeof oe=="string"?oe:oe&&typeof oe=="object"&&typeof oe.defaultValue=="string"?oe.defaultValue:Array.isArray(se)?se[se.length-1]:se,H=[B,{},!1];return H.t=B,H.i18n={},H.ready=!1,H}c.options.react&&c.options.react.wait!==void 0&&warnOnce$1("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const d={...getDefaults(),...c.options.react,...e},{useSuspense:g,keyPrefix:y}=d;let _=s||a||c.options&&c.options.defaultNS;_=typeof _=="string"?[_]:_||["translation"],c.reportNamespaces.addUsedNamespaces&&c.reportNamespaces.addUsedNamespaces(_);const E=(c.isInitialized||c.initializedStoreOnce)&&_.every(B=>hasLoadedNamespace(B,c,d));function S(){return c.getFixedT(e.lng||null,d.nsMode==="fallback"?_:_[0],y)}const[A,C]=reactExports.useState(S);let N=_.join();e.lng&&(N=`${e.lng}${N}`);const O=usePrevious(N),I=reactExports.useRef(!0);reactExports.useEffect(()=>{const{bindI18n:B,bindI18nStore:H}=d;I.current=!0,!E&&!g&&(e.lng?loadLanguages(c,e.lng,_,()=>{I.current&&C(S)}):loadNamespaces(c,_,()=>{I.current&&C(S)})),E&&O&&O!==N&&I.current&&C(S);function se(){I.current&&C(S)}return B&&c&&c.on(B,se),H&&c&&c.store.on(H,se),()=>{I.current=!1,B&&c&&B.split(" ").forEach(oe=>c.off(oe,se)),H&&c&&H.split(" ").forEach(oe=>c.store.off(oe,se))}},[c,N]);const P=reactExports.useRef(!0);reactExports.useEffect(()=>{I.current&&!P.current&&C(S),P.current=!1},[c,y]);const j=[A,c,E];if(j.t=A,j.i18n=c,j.ready=E,E||!E&&!g)return j;throw new Promise(B=>{e.lng?loadLanguages(c,e.lng,_,()=>B()):loadNamespaces(c,_,()=>B())})}const CreateNFTPage=({handleInputChange:s,handleFileChange:e,formData:t,file:o,status:a,isProcessing:c})=>{useTranslation();const[d,g]=reactExports.useState(null),[y,_]=reactExports.useState(null),[E,S]=reactExports.useState(null),[A,C]=reactExports.useState(""),N=()=>{const P="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let j="";for(let B=0;B<32;B++)j+=P.charAt(Math.floor(Math.random()*P.length));return j},O=P=>{if(P.target.files&&P.target.files[0]){const j=P.target.files[0];e(P);const B=URL.createObjectURL(j);g(B)}},I=async P=>{P.preventDefault(),C("Creating passport...");try{const j=N(),B={address:j,...t,imageUrl:d,createdAt:new Date().toISOString()},H=JSON.parse(localStorage.getItem("passports")||"[]");H.push(B),localStorage.setItem("passports",JSON.stringify(H)),_(j),S(`https://explorer.solana.com/address/${j}?cluster=devnet`),C("Passport created successfully!"),P.target.reset(),g(null),e({target:{files:[]}}),s({target:{name:"serialNumber",value:""}}),s({target:{name:"productionDate",value:""}}),s({target:{name:"deviceModel",value:""}}),s({target:{name:"warrantyPeriod",value:""}}),s({target:{name:"countryOfOrigin",value:""}}),s({target:{name:"manufacturerId",value:""}})}catch(j){console.error("Error creating passport:",j),C(`Error creating passport: ${j.message}`)}};return reactExports.useEffect(()=>()=>{d&&URL.revokeObjectURL(d)},[d]),jsxRuntimeExports.jsx("div",{className:"min-h-screen pt-24 pb-12 px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsx("div",{className:"max-w-3xl mx-auto",children:jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-800/50 rounded-2xl p-6 sm:p-8 shadow-xl border border-gray-700/50",children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl font-bold text-white mb-8 text-center",children:"Create Product Passport"}),y?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:"NFT Passport Created!"}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-700/30 p-6 rounded-xl mb-6",children:[jsxRuntimeExports.jsx(QRCode,{value:E,size:256,level:"H",includeMargin:!0,className:"mx-auto mb-4"}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 mb-4",children:"Scan this QR code to view the product passport"}),jsxRuntimeExports.jsx("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 transition-colors",children:"View on Solana Explorer"})]}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{_(null),S(null)},className:"px-6 py-3 rounded-lg bg-gradient-to-r from-blue-500 to-purple-500 text-white font-medium hover:shadow-lg hover:shadow-blue-500/25 transition-all",children:"Create Another Passport"})]}):jsxRuntimeExports.jsxs("form",{onSubmit:I,className:"space-y-6",children:[jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Serial Number"}),jsxRuntimeExports.jsx("input",{type:"text",name:"serialNumber",value:t.serialNumber,onChange:s,required:!0,className:"w-full bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"Enter serial number"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Production Date"}),jsxRuntimeExports.jsx("input",{type:"date",name:"productionDate",value:t.productionDate,onChange:s,required:!0,className:"w-full bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Device Model"}),jsxRuntimeExports.jsx("input",{type:"text",name:"deviceModel",value:t.deviceModel,onChange:s,required:!0,className:"w-full bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"Enter device model"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Warranty Period"}),jsxRuntimeExports.jsx("input",{type:"text",name:"warrantyPeriod",value:t.warrantyPeriod,onChange:s,required:!0,className:"w-full bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"Enter warranty period"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Country of Origin"}),jsxRuntimeExports.jsx("input",{type:"text",name:"countryOfOrigin",value:t.countryOfOrigin,onChange:s,required:!0,className:"w-full bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"Enter country of origin"})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Manufacturer ID (optional)"}),jsxRuntimeExports.jsx("input",{type:"text",name:"manufacturerId",value:t.manufacturerId,onChange:s,className:"w-full bg-gray-700/50 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition-colors",placeholder:"Enter manufacturer ID (optional)"})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-6",children:[jsxRuntimeExports.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Product Image"}),jsxRuntimeExports.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-600 border-dashed rounded-lg hover:border-blue-500 transition-colors",children:jsxRuntimeExports.jsxs("div",{className:"space-y-1 text-center",children:[jsxRuntimeExports.jsx(ArrowUpTrayIcon$1,{className:"mx-auto h-12 w-12 text-gray-400"}),jsxRuntimeExports.jsxs("div",{className:"flex text-sm text-gray-400",children:[jsxRuntimeExports.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-transparent rounded-md font-medium text-blue-400 hover:text-blue-300 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500",children:[jsxRuntimeExports.jsx("span",{children:"Upload a file"}),jsxRuntimeExports.jsx("input",{id:"file-upload",name:"file-upload",type:"file",accept:"image/*",onChange:O,className:"sr-only"})]}),jsxRuntimeExports.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})]}),jsxRuntimeExports.jsx(motion.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:c,className:`w-full py-3 px-6 rounded-lg text-white font-medium transition-all ${c?"bg-gray-600 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-purple-500 hover:shadow-lg hover:shadow-blue-500/25"}`,children:c?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-2",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Creating Passport..."]}):"Create Passport"})]}),(a||A)&&jsxRuntimeExports.jsx("div",{className:"mt-6 p-4 rounded-lg bg-gray-700/50 text-white text-center",children:a||A})]})})})},LoadingSpinner=({size:s="md",text:e="Loading..."})=>{const t={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[jsxRuntimeExports.jsx(motion.div,{className:`${t[s]} border-4 border-blue-500/20 border-t-blue-500 rounded-full`,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}}),e&&jsxRuntimeExports.jsx(motion.p,{initial:{opacity:0},animate:{opacity:1},className:"text-gray-400 text-sm",children:e})]})},LanguageSwitcher=()=>{const{i18n:s}=useTranslation(),[e,t]=reactExports.useState(!1),o=[{code:"en",label:"EN"},{code:"uk",label:"UA"}],a=o.find(c=>c.code===s.language)||o[0];return jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{onClick:()=>t(!e),className:"w-12 h-8 flex items-center justify-center rounded-lg bg-gray-800/50 border border-gray-700/50 hover:bg-gray-700/50 transition-all",children:jsxRuntimeExports.jsx("span",{className:"text-sm font-medium text-gray-300",children:a.label})}),jsxRuntimeExports.jsx(AnimatePresence,{children:e&&jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-12 bg-gray-800 rounded-lg shadow-xl border border-gray-700/50 overflow-hidden",children:o.map(c=>jsxRuntimeExports.jsx("button",{onClick:()=>{s.changeLanguage(c.code),t(!1)},className:`w-full px-2 py-1.5 flex items-center justify-center text-sm font-medium transition-colors ${c.code===a.code?"bg-gray-700/50 text-white":"text-gray-300 hover:bg-gray-700/30"}`,children:c.label},c.code))})})]})},logo="/assets/SPP_logo-ac223606.png",FAQItem=({question:s,answer:e,isOpen:t,onClick:o})=>jsxRuntimeExports.jsxs("div",{className:"border-b border-gray-700/50",children:[jsxRuntimeExports.jsxs("button",{onClick:o,className:`w-full py-4 px-6 flex items-center justify-between text-left transition-colors no-underline focus:outline-none focus:ring-0 focus:shadow-none ${t?"bg-gray-800/80":"hover:bg-gray-800/30"}`,children:[jsxRuntimeExports.jsx("span",{className:"text-lg font-medium text-white",children:s}),jsxRuntimeExports.jsx(motion.div,{animate:{rotate:t?180:0},transition:{duration:.2},children:jsxRuntimeExports.jsx(ChevronDownIcon$1,{className:"w-5 h-5 text-gray-400"})})]}),jsxRuntimeExports.jsx(AnimatePresence,{children:t&&jsxRuntimeExports.jsx(motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:jsxRuntimeExports.jsx("div",{className:"px-6 pb-4 text-gray-300 mt-4",children:e})})})]}),FAQ=()=>{const{t:s}=useTranslation(),[e,t]=reactExports.useState(null),o=[{question:s("faq_manufacturer_q"),answer:s("faq_manufacturer_a")},{question:s("faq_consumer_q"),answer:s("faq_consumer_a")},{question:s("faq_retailer_q"),answer:s("faq_retailer_a")},{question:s("faq_warranty_q"),answer:s("faq_warranty_a")},{question:s("faq_authenticity_q"),answer:s("faq_authenticity_a")}];return jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:1},className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold text-white mb-8 text-center",children:s("faq_title")}),jsxRuntimeExports.jsx("div",{className:"bg-gray-800/30 rounded-xl border border-gray-700/50 overflow-hidden",children:o.map((a,c)=>jsxRuntimeExports.jsx(FAQItem,{question:a.question,answer:a.answer,isOpen:e===c,onClick:()=>t(e===c?null:c)},c))})]})},Card=reactExports.forwardRef(({className:s,...e},t)=>jsxRuntimeExports.jsx("div",{ref:t,className:cn("rounded-xl border bg-card text-card-foreground shadow",s),...e}));Card.displayName="Card";const CardHeader=reactExports.forwardRef(({className:s,...e},t)=>jsxRuntimeExports.jsx("div",{ref:t,className:cn("flex flex-col space-y-1.5 p-6",s),...e}));CardHeader.displayName="CardHeader";const CardTitle=reactExports.forwardRef(({className:s,...e},t)=>jsxRuntimeExports.jsx("h3",{ref:t,className:cn("font-semibold leading-none tracking-tight",s),...e}));CardTitle.displayName="CardTitle";const CardDescription=reactExports.forwardRef(({className:s,...e},t)=>jsxRuntimeExports.jsx("p",{ref:t,className:cn("text-sm text-muted-foreground",s),...e}));CardDescription.displayName="CardDescription";const CardContent=reactExports.forwardRef(({className:s,...e},t)=>jsxRuntimeExports.jsx("div",{ref:t,className:cn("p-6 pt-0",s),...e}));CardContent.displayName="CardContent";const CardFooter=reactExports.forwardRef(({className:s,...e},t)=>jsxRuntimeExports.jsx("div",{ref:t,className:cn("flex items-center p-6 pt-0",s),...e}));CardFooter.displayName="CardFooter";function Community(){return jsxRuntimeExports.jsx("section",{className:"py-16 md:py-24 container mx-auto",children:jsxRuntimeExports.jsx("div",{className:"mx-auto container",children:jsxRuntimeExports.jsxs(Card,{className:"border-none shadow-none",children:[jsxRuntimeExports.jsx(CardHeader,{className:"px-8 pt-8",children:jsxRuntimeExports.jsxs(CardTitle,{className:"flex flex-col items-center space-y-4",children:[jsxRuntimeExports.jsx("img",{src:"https://svgl.app/library/discord.svg",alt:"Discord",className:"w-10 h-10"}),jsxRuntimeExports.jsx("div",{className:"text-center space-y-2",children:jsxRuntimeExports.jsxs("h2",{className:"text-3xl font-bold sm:text-5xl tracking-tight leading-tight",children:["Ready to join our "," ",jsxRuntimeExports.jsx("span",{className:"inline-block text-primary",children:"Amazing Community?"})]})})]})}),jsxRuntimeExports.jsxs(CardContent,{className:"mx-auto px-8",children:[jsxRuntimeExports.jsx("p",{className:"text-lg text-muted-foreground leading-relaxed mb-8 text-center",children:"Join our Smart Product Passport Discord community! Connect, share, and grow with like-minded enthusiasts. Experience collaboration like never before! 🚀"}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center space-x-2 p-4 rounded-lg bg-muted/50 border",children:[jsxRuntimeExports.jsx(UsersIcon$1,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsx("span",{className:"font-semibold text-foreground",children:"10K+ Members"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center space-x-2 p-4 rounded-lg bg-muted/50 border",children:[jsxRuntimeExports.jsx(ChatBubbleLeftRightIcon$1,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsx("span",{className:"font-semibold text-foreground",children:"Active Daily"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center space-x-2 p-4 rounded-lg bg-muted/50 border",children:[jsxRuntimeExports.jsx(SparklesIcon$1,{className:"w-5 h-5 text-primary"}),jsxRuntimeExports.jsx("span",{className:"font-semibold text-foreground",children:"24/7 Support"})]})]})]}),jsxRuntimeExports.jsxs(CardFooter,{className:"flex flex-col sm:flex-row gap-4 justify-center px-8 pb-8",children:[jsxRuntimeExports.jsx(Button,{asChild:!0,size:"lg",className:"text-base font-semibold transition-all duration-300 hover:scale-105",children:jsxRuntimeExports.jsxs("a",{href:"https://discord.gg/UGKBgREr",target:"_blank",className:"flex items-center space-x-2",rel:"noreferrer",children:[jsxRuntimeExports.jsx("img",{src:"https://svgl.app/library/discord.svg",alt:"Discord",className:"w-5 h-5"}),jsxRuntimeExports.jsx("span",{children:"Join Discord"})]})}),jsxRuntimeExports.jsx(Button,{variant:"outline",size:"lg",className:"text-base font-semibold transition-all duration-300",children:"Learn More"})]})]})})})}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const REVISION="160",CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,ConstantColorFactor=211,OneMinusConstantColorFactor=212,ConstantAlphaFactor=213,OneMinusConstantAlphaFactor=214,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,CineonToneMapping=3,ACESFilmicToneMapping=4,CustomToneMapping=5,AgXToneMapping=6,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,CubeUVReflectionMapping=306,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipmapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipmapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedInt248Type=1020,AlphaFormat=1021,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGB_ETC2_Format=37492,RGBA_ETC2_EAC_Format=37496,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,RGBA_BPTC_Format=36492,RGB_BPTC_SIGNED_Format=36494,RGB_BPTC_UNSIGNED_Format=36495,RED_RGTC1_Format=36283,SIGNED_RED_RGTC1_Format=36284,RED_GREEN_RGTC2_Format=36285,SIGNED_RED_GREEN_RGTC2_Format=36286,LinearEncoding=3e3,sRGBEncoding=3001,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,NoColorSpace="",SRGBColorSpace="srgb",LinearSRGBColorSpace="srgb-linear",DisplayP3ColorSpace="display-p3",LinearDisplayP3ColorSpace="display-p3-linear",LinearTransfer="linear",SRGBTransfer="srgb",Rec709Primaries="rec709",P3Primaries="p3",KeepStencilOp=7680,AlwaysStencilFunc=519,NeverCompare=512,LessCompare=513,EqualCompare=514,LessEqualCompare=515,GreaterCompare=516,NotEqualCompare=517,GreaterEqualCompare=518,AlwaysCompare=519,StaticDrawUsage=35044,GLSL3="300 es",_SRGBAFormat=1035,WebGLCoordinateSystem=2e3,WebGPUCoordinateSystem=2001;class EventDispatcher{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[e]===void 0&&(o[e]=[]),o[e].indexOf(t)===-1&&o[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const o=this._listeners;return o[e]!==void 0&&o[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const a=this._listeners[e];if(a!==void 0){const c=a.indexOf(t);c!==-1&&a.splice(c,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const o=this._listeners[e.type];if(o!==void 0){e.target=this;const a=o.slice(0);for(let c=0,d=a.length;c<d;c++)a[c].call(this,e);e.target=null}}}const _lut=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],DEG2RAD=Math.PI/180,RAD2DEG=180/Math.PI;function generateUUID(){const s=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(_lut[s&255]+_lut[s>>8&255]+_lut[s>>16&255]+_lut[s>>24&255]+"-"+_lut[e&255]+_lut[e>>8&255]+"-"+_lut[e>>16&15|64]+_lut[e>>24&255]+"-"+_lut[t&63|128]+_lut[t>>8&255]+"-"+_lut[t>>16&255]+_lut[t>>24&255]+_lut[o&255]+_lut[o>>8&255]+_lut[o>>16&255]+_lut[o>>24&255]).toLowerCase()}function clamp(s,e,t){return Math.max(e,Math.min(t,s))}function euclideanModulo(s,e){return(s%e+e)%e}function lerp(s,e,t){return(1-t)*s+t*e}function isPowerOfTwo(s){return(s&s-1)===0&&s!==0}function floorPowerOfTwo(s){return Math.pow(2,Math.floor(Math.log(s)/Math.LN2))}function denormalize(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return s/4294967295;case Uint16Array:return s/65535;case Uint8Array:return s/255;case Int32Array:return Math.max(s/2147483647,-1);case Int16Array:return Math.max(s/32767,-1);case Int8Array:return Math.max(s/127,-1);default:throw new Error("Invalid component type.")}}function normalize(s,e){switch(e.constructor){case Float32Array:return s;case Uint32Array:return Math.round(s*4294967295);case Uint16Array:return Math.round(s*65535);case Uint8Array:return Math.round(s*255);case Int32Array:return Math.round(s*2147483647);case Int16Array:return Math.round(s*32767);case Int8Array:return Math.round(s*127);default:throw new Error("Invalid component type.")}}class Vector2{constructor(e=0,t=0){Vector2.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,o=this.y,a=e.elements;return this.x=a[0]*t+a[3]*o+a[6],this.y=a[1]*t+a[4]*o+a[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const o=this.dot(e)/t;return Math.acos(clamp(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,o=this.y-e.y;return t*t+o*o}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,o){return this.x=e.x+(t.x-e.x)*o,this.y=e.y+(t.y-e.y)*o,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const o=Math.cos(t),a=Math.sin(t),c=this.x-e.x,d=this.y-e.y;return this.x=c*o-d*a+e.x,this.y=c*a+d*o+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Matrix3{constructor(e,t,o,a,c,d,g,y,_){Matrix3.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,o,a,c,d,g,y,_)}set(e,t,o,a,c,d,g,y,_){const E=this.elements;return E[0]=e,E[1]=a,E[2]=g,E[3]=t,E[4]=c,E[5]=y,E[6]=o,E[7]=d,E[8]=_,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],this}extractBasis(e,t,o){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const o=e.elements,a=t.elements,c=this.elements,d=o[0],g=o[3],y=o[6],_=o[1],E=o[4],S=o[7],A=o[2],C=o[5],N=o[8],O=a[0],I=a[3],P=a[6],j=a[1],B=a[4],H=a[7],se=a[2],oe=a[5],Q=a[8];return c[0]=d*O+g*j+y*se,c[3]=d*I+g*B+y*oe,c[6]=d*P+g*H+y*Q,c[1]=_*O+E*j+S*se,c[4]=_*I+E*B+S*oe,c[7]=_*P+E*H+S*Q,c[2]=A*O+C*j+N*se,c[5]=A*I+C*B+N*oe,c[8]=A*P+C*H+N*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],o=e[1],a=e[2],c=e[3],d=e[4],g=e[5],y=e[6],_=e[7],E=e[8];return t*d*E-t*g*_-o*c*E+o*g*y+a*c*_-a*d*y}invert(){const e=this.elements,t=e[0],o=e[1],a=e[2],c=e[3],d=e[4],g=e[5],y=e[6],_=e[7],E=e[8],S=E*d-g*_,A=g*y-E*c,C=_*c-d*y,N=t*S+o*A+a*C;if(N===0)return this.set(0,0,0,0,0,0,0,0,0);const O=1/N;return e[0]=S*O,e[1]=(a*_-E*o)*O,e[2]=(g*o-a*d)*O,e[3]=A*O,e[4]=(E*t-a*y)*O,e[5]=(a*c-g*t)*O,e[6]=C*O,e[7]=(o*y-_*t)*O,e[8]=(d*t-o*c)*O,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,o,a,c,d,g){const y=Math.cos(c),_=Math.sin(c);return this.set(o*y,o*_,-o*(y*d+_*g)+d+e,-a*_,a*y,-a*(-_*d+y*g)+g+t,0,0,1),this}scale(e,t){return this.premultiply(_m3.makeScale(e,t)),this}rotate(e){return this.premultiply(_m3.makeRotation(-e)),this}translate(e,t){return this.premultiply(_m3.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),o=Math.sin(e);return this.set(t,-o,0,o,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,o=e.elements;for(let a=0;a<9;a++)if(t[a]!==o[a])return!1;return!0}fromArray(e,t=0){for(let o=0;o<9;o++)this.elements[o]=e[o+t];return this}toArray(e=[],t=0){const o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const _m3=new Matrix3;function arrayNeedsUint32(s){for(let e=s.length-1;e>=0;--e)if(s[e]>=65535)return!0;return!1}function createElementNS(s){return document.createElementNS("http://www.w3.org/1999/xhtml",s)}function createCanvasElement(){const s=createElementNS("canvas");return s.style.display="block",s}const _cache={};function warnOnce(s){s in _cache||(_cache[s]=!0,console.warn(s))}const LINEAR_SRGB_TO_LINEAR_DISPLAY_P3=new Matrix3().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),LINEAR_DISPLAY_P3_TO_LINEAR_SRGB=new Matrix3().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),COLOR_SPACES={[LinearSRGBColorSpace]:{transfer:LinearTransfer,primaries:Rec709Primaries,toReference:s=>s,fromReference:s=>s},[SRGBColorSpace]:{transfer:SRGBTransfer,primaries:Rec709Primaries,toReference:s=>s.convertSRGBToLinear(),fromReference:s=>s.convertLinearToSRGB()},[LinearDisplayP3ColorSpace]:{transfer:LinearTransfer,primaries:P3Primaries,toReference:s=>s.applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:s=>s.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3)},[DisplayP3ColorSpace]:{transfer:SRGBTransfer,primaries:P3Primaries,toReference:s=>s.convertSRGBToLinear().applyMatrix3(LINEAR_DISPLAY_P3_TO_LINEAR_SRGB),fromReference:s=>s.applyMatrix3(LINEAR_SRGB_TO_LINEAR_DISPLAY_P3).convertLinearToSRGB()}},SUPPORTED_WORKING_COLOR_SPACES=new Set([LinearSRGBColorSpace,LinearDisplayP3ColorSpace]),ColorManagement={enabled:!0,_workingColorSpace:LinearSRGBColorSpace,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(s){if(!SUPPORTED_WORKING_COLOR_SPACES.has(s))throw new Error(`Unsupported working color space, "${s}".`);this._workingColorSpace=s},convert:function(s,e,t){if(this.enabled===!1||e===t||!e||!t)return s;const o=COLOR_SPACES[e].toReference,a=COLOR_SPACES[t].fromReference;return a(o(s))},fromWorkingColorSpace:function(s,e){return this.convert(s,this._workingColorSpace,e)},toWorkingColorSpace:function(s,e){return this.convert(s,e,this._workingColorSpace)},getPrimaries:function(s){return COLOR_SPACES[s].primaries},getTransfer:function(s){return s===NoColorSpace?LinearTransfer:COLOR_SPACES[s].transfer}};function SRGBToLinear(s){return s<.04045?s*.0773993808:Math.pow(s*.9478672986+.0521327014,2.4)}function LinearToSRGB(s){return s<.0031308?s*12.92:1.055*Math.pow(s,.41666)-.055}let _canvas;class ImageUtils{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{_canvas===void 0&&(_canvas=createElementNS("canvas")),_canvas.width=e.width,_canvas.height=e.height;const o=_canvas.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),t=_canvas}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=createElementNS("canvas");t.width=e.width,t.height=e.height;const o=t.getContext("2d");o.drawImage(e,0,0,e.width,e.height);const a=o.getImageData(0,0,e.width,e.height),c=a.data;for(let d=0;d<c.length;d++)c[d]=SRGBToLinear(c[d]/255)*255;return o.putImageData(a,0,0),t}else if(e.data){const t=e.data.slice(0);for(let o=0;o<t.length;o++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[o]=Math.floor(SRGBToLinear(t[o]/255)*255):t[o]=SRGBToLinear(t[o]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _sourceId=0;class Source{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_sourceId++}),this.uuid=generateUUID(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const o={uuid:this.uuid,url:""},a=this.data;if(a!==null){let c;if(Array.isArray(a)){c=[];for(let d=0,g=a.length;d<g;d++)a[d].isDataTexture?c.push(serializeImage(a[d].image)):c.push(serializeImage(a[d]))}else c=serializeImage(a);o.url=c}return t||(e.images[this.uuid]=o),o}}function serializeImage(s){return typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap?ImageUtils.getDataURL(s):s.data?{data:Array.from(s.data),width:s.width,height:s.height,type:s.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let _textureId=0;class Texture extends EventDispatcher{constructor(e=Texture.DEFAULT_IMAGE,t=Texture.DEFAULT_MAPPING,o=ClampToEdgeWrapping,a=ClampToEdgeWrapping,c=LinearFilter,d=LinearMipmapLinearFilter,g=RGBAFormat,y=UnsignedByteType,_=Texture.DEFAULT_ANISOTROPY,E=NoColorSpace){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:_textureId++}),this.uuid=generateUUID(),this.name="",this.source=new Source(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=o,this.wrapT=a,this.magFilter=c,this.minFilter=d,this.anisotropy=_,this.format=g,this.internalFormat=null,this.type=y,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof E=="string"?this.colorSpace=E:(warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=E===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const o={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),t||(e.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==UVMapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case ClampToEdgeWrapping:e.x=e.x<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case ClampToEdgeWrapping:e.y=e.y<0?0:1;break;case MirroredRepeatWrapping:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set encoding(e){warnOnce("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===sRGBEncoding?SRGBColorSpace:NoColorSpace}}Texture.DEFAULT_IMAGE=null;Texture.DEFAULT_MAPPING=UVMapping;Texture.DEFAULT_ANISOTROPY=1;class Vector4{constructor(e=0,t=0,o=0,a=1){Vector4.prototype.isVector4=!0,this.x=e,this.y=t,this.z=o,this.w=a}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,o,a){return this.x=e,this.y=t,this.z=o,this.w=a,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,o=this.y,a=this.z,c=this.w,d=e.elements;return this.x=d[0]*t+d[4]*o+d[8]*a+d[12]*c,this.y=d[1]*t+d[5]*o+d[9]*a+d[13]*c,this.z=d[2]*t+d[6]*o+d[10]*a+d[14]*c,this.w=d[3]*t+d[7]*o+d[11]*a+d[15]*c,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,o,a,c;const y=e.elements,_=y[0],E=y[4],S=y[8],A=y[1],C=y[5],N=y[9],O=y[2],I=y[6],P=y[10];if(Math.abs(E-A)<.01&&Math.abs(S-O)<.01&&Math.abs(N-I)<.01){if(Math.abs(E+A)<.1&&Math.abs(S+O)<.1&&Math.abs(N+I)<.1&&Math.abs(_+C+P-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const B=(_+1)/2,H=(C+1)/2,se=(P+1)/2,oe=(E+A)/4,Q=(S+O)/4,fe=(N+I)/4;return B>H&&B>se?B<.01?(o=0,a=.707106781,c=.707106781):(o=Math.sqrt(B),a=oe/o,c=Q/o):H>se?H<.01?(o=.707106781,a=0,c=.707106781):(a=Math.sqrt(H),o=oe/a,c=fe/a):se<.01?(o=.707106781,a=.707106781,c=0):(c=Math.sqrt(se),o=Q/c,a=fe/c),this.set(o,a,c,t),this}let j=Math.sqrt((I-N)*(I-N)+(S-O)*(S-O)+(A-E)*(A-E));return Math.abs(j)<.001&&(j=1),this.x=(I-N)/j,this.y=(S-O)/j,this.z=(A-E)/j,this.w=Math.acos((_+C+P-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,o){return this.x=e.x+(t.x-e.x)*o,this.y=e.y+(t.y-e.y)*o,this.z=e.z+(t.z-e.z)*o,this.w=e.w+(t.w-e.w)*o,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class RenderTarget extends EventDispatcher{constructor(e=1,t=1,o={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Vector4(0,0,e,t),this.scissorTest=!1,this.viewport=new Vector4(0,0,e,t);const a={width:e,height:t,depth:1};o.encoding!==void 0&&(warnOnce("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),o.colorSpace=o.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),o=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:LinearFilter,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},o),this.texture=new Texture(a,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=o.generateMipmaps,this.texture.internalFormat=o.internalFormat,this.depthBuffer=o.depthBuffer,this.stencilBuffer=o.stencilBuffer,this.depthTexture=o.depthTexture,this.samples=o.samples}setSize(e,t,o=1){(this.width!==e||this.height!==t||this.depth!==o)&&(this.width=e,this.height=t,this.depth=o,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=o,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Source(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class WebGLRenderTarget extends RenderTarget{constructor(e=1,t=1,o={}){super(e,t,o),this.isWebGLRenderTarget=!0}}class DataArrayTexture extends Texture{constructor(e=null,t=1,o=1,a=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:o,depth:a},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Data3DTexture extends Texture{constructor(e=null,t=1,o=1,a=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:o,depth:a},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Quaternion{constructor(e=0,t=0,o=0,a=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=o,this._w=a}static slerpFlat(e,t,o,a,c,d,g){let y=o[a+0],_=o[a+1],E=o[a+2],S=o[a+3];const A=c[d+0],C=c[d+1],N=c[d+2],O=c[d+3];if(g===0){e[t+0]=y,e[t+1]=_,e[t+2]=E,e[t+3]=S;return}if(g===1){e[t+0]=A,e[t+1]=C,e[t+2]=N,e[t+3]=O;return}if(S!==O||y!==A||_!==C||E!==N){let I=1-g;const P=y*A+_*C+E*N+S*O,j=P>=0?1:-1,B=1-P*P;if(B>Number.EPSILON){const se=Math.sqrt(B),oe=Math.atan2(se,P*j);I=Math.sin(I*oe)/se,g=Math.sin(g*oe)/se}const H=g*j;if(y=y*I+A*H,_=_*I+C*H,E=E*I+N*H,S=S*I+O*H,I===1-g){const se=1/Math.sqrt(y*y+_*_+E*E+S*S);y*=se,_*=se,E*=se,S*=se}}e[t]=y,e[t+1]=_,e[t+2]=E,e[t+3]=S}static multiplyQuaternionsFlat(e,t,o,a,c,d){const g=o[a],y=o[a+1],_=o[a+2],E=o[a+3],S=c[d],A=c[d+1],C=c[d+2],N=c[d+3];return e[t]=g*N+E*S+y*C-_*A,e[t+1]=y*N+E*A+_*S-g*C,e[t+2]=_*N+E*C+g*A-y*S,e[t+3]=E*N-g*S-y*A-_*C,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,o,a){return this._x=e,this._y=t,this._z=o,this._w=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const o=e._x,a=e._y,c=e._z,d=e._order,g=Math.cos,y=Math.sin,_=g(o/2),E=g(a/2),S=g(c/2),A=y(o/2),C=y(a/2),N=y(c/2);switch(d){case"XYZ":this._x=A*E*S+_*C*N,this._y=_*C*S-A*E*N,this._z=_*E*N+A*C*S,this._w=_*E*S-A*C*N;break;case"YXZ":this._x=A*E*S+_*C*N,this._y=_*C*S-A*E*N,this._z=_*E*N-A*C*S,this._w=_*E*S+A*C*N;break;case"ZXY":this._x=A*E*S-_*C*N,this._y=_*C*S+A*E*N,this._z=_*E*N+A*C*S,this._w=_*E*S-A*C*N;break;case"ZYX":this._x=A*E*S-_*C*N,this._y=_*C*S+A*E*N,this._z=_*E*N-A*C*S,this._w=_*E*S+A*C*N;break;case"YZX":this._x=A*E*S+_*C*N,this._y=_*C*S+A*E*N,this._z=_*E*N-A*C*S,this._w=_*E*S-A*C*N;break;case"XZY":this._x=A*E*S-_*C*N,this._y=_*C*S-A*E*N,this._z=_*E*N+A*C*S,this._w=_*E*S+A*C*N;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const o=t/2,a=Math.sin(o);return this._x=e.x*a,this._y=e.y*a,this._z=e.z*a,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,o=t[0],a=t[4],c=t[8],d=t[1],g=t[5],y=t[9],_=t[2],E=t[6],S=t[10],A=o+g+S;if(A>0){const C=.5/Math.sqrt(A+1);this._w=.25/C,this._x=(E-y)*C,this._y=(c-_)*C,this._z=(d-a)*C}else if(o>g&&o>S){const C=2*Math.sqrt(1+o-g-S);this._w=(E-y)/C,this._x=.25*C,this._y=(a+d)/C,this._z=(c+_)/C}else if(g>S){const C=2*Math.sqrt(1+g-o-S);this._w=(c-_)/C,this._x=(a+d)/C,this._y=.25*C,this._z=(y+E)/C}else{const C=2*Math.sqrt(1+S-o-g);this._w=(d-a)/C,this._x=(c+_)/C,this._y=(y+E)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let o=e.dot(t)+1;return o<Number.EPSILON?(o=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=o):(this._x=0,this._y=-e.z,this._z=e.y,this._w=o)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=o),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(clamp(this.dot(e),-1,1)))}rotateTowards(e,t){const o=this.angleTo(e);if(o===0)return this;const a=Math.min(1,t/o);return this.slerp(e,a),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const o=e._x,a=e._y,c=e._z,d=e._w,g=t._x,y=t._y,_=t._z,E=t._w;return this._x=o*E+d*g+a*_-c*y,this._y=a*E+d*y+c*g-o*_,this._z=c*E+d*_+o*y-a*g,this._w=d*E-o*g-a*y-c*_,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const o=this._x,a=this._y,c=this._z,d=this._w;let g=d*e._w+o*e._x+a*e._y+c*e._z;if(g<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,g=-g):this.copy(e),g>=1)return this._w=d,this._x=o,this._y=a,this._z=c,this;const y=1-g*g;if(y<=Number.EPSILON){const C=1-t;return this._w=C*d+t*this._w,this._x=C*o+t*this._x,this._y=C*a+t*this._y,this._z=C*c+t*this._z,this.normalize(),this}const _=Math.sqrt(y),E=Math.atan2(_,g),S=Math.sin((1-t)*E)/_,A=Math.sin(t*E)/_;return this._w=d*S+this._w*A,this._x=o*S+this._x*A,this._y=a*S+this._y*A,this._z=c*S+this._z*A,this._onChangeCallback(),this}slerpQuaternions(e,t,o){return this.copy(e).slerp(t,o)}random(){const e=Math.random(),t=Math.sqrt(1-e),o=Math.sqrt(e),a=2*Math.PI*Math.random(),c=2*Math.PI*Math.random();return this.set(t*Math.cos(a),o*Math.sin(c),o*Math.cos(c),t*Math.sin(a))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Vector3{constructor(e=0,t=0,o=0){Vector3.prototype.isVector3=!0,this.x=e,this.y=t,this.z=o}set(e,t,o){return o===void 0&&(o=this.z),this.x=e,this.y=t,this.z=o,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(_quaternion$4.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(_quaternion$4.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,o=this.y,a=this.z,c=e.elements;return this.x=c[0]*t+c[3]*o+c[6]*a,this.y=c[1]*t+c[4]*o+c[7]*a,this.z=c[2]*t+c[5]*o+c[8]*a,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,o=this.y,a=this.z,c=e.elements,d=1/(c[3]*t+c[7]*o+c[11]*a+c[15]);return this.x=(c[0]*t+c[4]*o+c[8]*a+c[12])*d,this.y=(c[1]*t+c[5]*o+c[9]*a+c[13])*d,this.z=(c[2]*t+c[6]*o+c[10]*a+c[14])*d,this}applyQuaternion(e){const t=this.x,o=this.y,a=this.z,c=e.x,d=e.y,g=e.z,y=e.w,_=2*(d*a-g*o),E=2*(g*t-c*a),S=2*(c*o-d*t);return this.x=t+y*_+d*S-g*E,this.y=o+y*E+g*_-c*S,this.z=a+y*S+c*E-d*_,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,o=this.y,a=this.z,c=e.elements;return this.x=c[0]*t+c[4]*o+c[8]*a,this.y=c[1]*t+c[5]*o+c[9]*a,this.z=c[2]*t+c[6]*o+c[10]*a,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(e,Math.min(t,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,o){return this.x=e.x+(t.x-e.x)*o,this.y=e.y+(t.y-e.y)*o,this.z=e.z+(t.z-e.z)*o,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const o=e.x,a=e.y,c=e.z,d=t.x,g=t.y,y=t.z;return this.x=a*y-c*g,this.y=c*d-o*y,this.z=o*g-a*d,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const o=e.dot(this)/t;return this.copy(e).multiplyScalar(o)}projectOnPlane(e){return _vector$c.copy(this).projectOnVector(e),this.sub(_vector$c)}reflect(e){return this.sub(_vector$c.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const o=this.dot(e)/t;return Math.acos(clamp(o,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,o=this.y-e.y,a=this.z-e.z;return t*t+o*o+a*a}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,o){const a=Math.sin(t)*e;return this.x=a*Math.sin(o),this.y=Math.cos(t)*e,this.z=a*Math.cos(o),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,o){return this.x=e*Math.sin(t),this.y=o,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),o=this.setFromMatrixColumn(e,1).length(),a=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=o,this.z=a,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,o=Math.sqrt(1-e**2);return this.x=o*Math.cos(t),this.y=o*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const _vector$c=new Vector3,_quaternion$4=new Quaternion;class Box3{constructor(e=new Vector3(1/0,1/0,1/0),t=new Vector3(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,o=e.length;t<o;t+=3)this.expandByPoint(_vector$b.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,o=e.count;t<o;t++)this.expandByPoint(_vector$b.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,o=e.length;t<o;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const o=_vector$b.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(o),this.max.copy(e).add(o),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const o=e.geometry;if(o!==void 0){const c=o.getAttribute("position");if(t===!0&&c!==void 0&&e.isInstancedMesh!==!0)for(let d=0,g=c.count;d<g;d++)e.isMesh===!0?e.getVertexPosition(d,_vector$b):_vector$b.fromBufferAttribute(c,d),_vector$b.applyMatrix4(e.matrixWorld),this.expandByPoint(_vector$b);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),_box$4.copy(e.boundingBox)):(o.boundingBox===null&&o.computeBoundingBox(),_box$4.copy(o.boundingBox)),_box$4.applyMatrix4(e.matrixWorld),this.union(_box$4)}const a=e.children;for(let c=0,d=a.length;c<d;c++)this.expandByObject(a[c],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,_vector$b),_vector$b.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,o;return e.normal.x>0?(t=e.normal.x*this.min.x,o=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,o=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,o+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,o+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,o+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,o+=e.normal.z*this.min.z),t<=-e.constant&&o>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0$2.subVectors(e.a,_center),_v1$7.subVectors(e.b,_center),_v2$4.subVectors(e.c,_center),_f0.subVectors(_v1$7,_v0$2),_f1.subVectors(_v2$4,_v1$7),_f2.subVectors(_v0$2,_v2$4);let t=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!satForAxes(t,_v0$2,_v1$7,_v2$4,_extents)||(t=[1,0,0,0,1,0,0,0,1],!satForAxes(t,_v0$2,_v1$7,_v2$4,_extents))?!1:(_triangleNormal.crossVectors(_f0,_f1),t=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],satForAxes(t,_v0$2,_v1$7,_v2$4,_extents))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,_vector$b).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(_vector$b).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_points),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$b=new Vector3,_box$4=new Box3,_v0$2=new Vector3,_v1$7=new Vector3,_v2$4=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function satForAxes(s,e,t,o,a){for(let c=0,d=s.length-3;c<=d;c+=3){_testAxis.fromArray(s,c);const g=a.x*Math.abs(_testAxis.x)+a.y*Math.abs(_testAxis.y)+a.z*Math.abs(_testAxis.z),y=e.dot(_testAxis),_=t.dot(_testAxis),E=o.dot(_testAxis);if(Math.max(-Math.max(y,_,E),Math.min(y,_,E))>g)return!1}return!0}const _box$3=new Box3,_v1$6=new Vector3,_v2$3=new Vector3;class Sphere{constructor(e=new Vector3,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const o=this.center;t!==void 0?o.copy(t):_box$3.setFromPoints(e).getCenter(o);let a=0;for(let c=0,d=e.length;c<d;c++)a=Math.max(a,o.distanceToSquared(e[c]));return this.radius=Math.sqrt(a),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const o=this.center.distanceToSquared(e);return t.copy(e),o>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_v1$6.subVectors(e,this.center);const t=_v1$6.lengthSq();if(t>this.radius*this.radius){const o=Math.sqrt(t),a=(o-this.radius)*.5;this.center.addScaledVector(_v1$6,a/o),this.radius+=a}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(_v2$3.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_v1$6.copy(e.center).add(_v2$3)),this.expandByPoint(_v1$6.copy(e.center).sub(_v2$3))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const _vector$a=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal$1=new Vector3;class Ray{constructor(e=new Vector3,t=new Vector3(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,_vector$a)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const o=t.dot(this.direction);return o<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,o)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=_vector$a.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(_vector$a.copy(this.origin).addScaledVector(this.direction,t),_vector$a.distanceToSquared(e))}distanceSqToSegment(e,t,o,a){_segCenter.copy(e).add(t).multiplyScalar(.5),_segDir.copy(t).sub(e).normalize(),_diff.copy(this.origin).sub(_segCenter);const c=e.distanceTo(t)*.5,d=-this.direction.dot(_segDir),g=_diff.dot(this.direction),y=-_diff.dot(_segDir),_=_diff.lengthSq(),E=Math.abs(1-d*d);let S,A,C,N;if(E>0)if(S=d*y-g,A=d*g-y,N=c*E,S>=0)if(A>=-N)if(A<=N){const O=1/E;S*=O,A*=O,C=S*(S+d*A+2*g)+A*(d*S+A+2*y)+_}else A=c,S=Math.max(0,-(d*A+g)),C=-S*S+A*(A+2*y)+_;else A=-c,S=Math.max(0,-(d*A+g)),C=-S*S+A*(A+2*y)+_;else A<=-N?(S=Math.max(0,-(-d*c+g)),A=S>0?-c:Math.min(Math.max(-c,-y),c),C=-S*S+A*(A+2*y)+_):A<=N?(S=0,A=Math.min(Math.max(-c,-y),c),C=A*(A+2*y)+_):(S=Math.max(0,-(d*c+g)),A=S>0?c:Math.min(Math.max(-c,-y),c),C=-S*S+A*(A+2*y)+_);else A=d>0?-c:c,S=Math.max(0,-(d*A+g)),C=-S*S+A*(A+2*y)+_;return o&&o.copy(this.origin).addScaledVector(this.direction,S),a&&a.copy(_segCenter).addScaledVector(_segDir,A),C}intersectSphere(e,t){_vector$a.subVectors(e.center,this.origin);const o=_vector$a.dot(this.direction),a=_vector$a.dot(_vector$a)-o*o,c=e.radius*e.radius;if(a>c)return null;const d=Math.sqrt(c-a),g=o-d,y=o+d;return y<0?null:g<0?this.at(y,t):this.at(g,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(e.normal)+e.constant)/t;return o>=0?o:null}intersectPlane(e,t){const o=this.distanceToPlane(e);return o===null?null:this.at(o,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let o,a,c,d,g,y;const _=1/this.direction.x,E=1/this.direction.y,S=1/this.direction.z,A=this.origin;return _>=0?(o=(e.min.x-A.x)*_,a=(e.max.x-A.x)*_):(o=(e.max.x-A.x)*_,a=(e.min.x-A.x)*_),E>=0?(c=(e.min.y-A.y)*E,d=(e.max.y-A.y)*E):(c=(e.max.y-A.y)*E,d=(e.min.y-A.y)*E),o>d||c>a||((c>o||isNaN(o))&&(o=c),(d<a||isNaN(a))&&(a=d),S>=0?(g=(e.min.z-A.z)*S,y=(e.max.z-A.z)*S):(g=(e.max.z-A.z)*S,y=(e.min.z-A.z)*S),o>y||g>a)||((g>o||o!==o)&&(o=g),(y<a||a!==a)&&(a=y),a<0)?null:this.at(o>=0?o:a,t)}intersectsBox(e){return this.intersectBox(e,_vector$a)!==null}intersectTriangle(e,t,o,a,c){_edge1.subVectors(t,e),_edge2.subVectors(o,e),_normal$1.crossVectors(_edge1,_edge2);let d=this.direction.dot(_normal$1),g;if(d>0){if(a)return null;g=1}else if(d<0)g=-1,d=-d;else return null;_diff.subVectors(this.origin,e);const y=g*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(y<0)return null;const _=g*this.direction.dot(_edge1.cross(_diff));if(_<0||y+_>d)return null;const E=-g*_diff.dot(_normal$1);return E<0?null:this.at(E/d,c)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Matrix4{constructor(e,t,o,a,c,d,g,y,_,E,S,A,C,N,O,I){Matrix4.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,o,a,c,d,g,y,_,E,S,A,C,N,O,I)}set(e,t,o,a,c,d,g,y,_,E,S,A,C,N,O,I){const P=this.elements;return P[0]=e,P[4]=t,P[8]=o,P[12]=a,P[1]=c,P[5]=d,P[9]=g,P[13]=y,P[2]=_,P[6]=E,P[10]=S,P[14]=A,P[3]=C,P[7]=N,P[11]=O,P[15]=I,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Matrix4().fromArray(this.elements)}copy(e){const t=this.elements,o=e.elements;return t[0]=o[0],t[1]=o[1],t[2]=o[2],t[3]=o[3],t[4]=o[4],t[5]=o[5],t[6]=o[6],t[7]=o[7],t[8]=o[8],t[9]=o[9],t[10]=o[10],t[11]=o[11],t[12]=o[12],t[13]=o[13],t[14]=o[14],t[15]=o[15],this}copyPosition(e){const t=this.elements,o=e.elements;return t[12]=o[12],t[13]=o[13],t[14]=o[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,o){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(e,t,o){return this.set(e.x,t.x,o.x,0,e.y,t.y,o.y,0,e.z,t.z,o.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,o=e.elements,a=1/_v1$5.setFromMatrixColumn(e,0).length(),c=1/_v1$5.setFromMatrixColumn(e,1).length(),d=1/_v1$5.setFromMatrixColumn(e,2).length();return t[0]=o[0]*a,t[1]=o[1]*a,t[2]=o[2]*a,t[3]=0,t[4]=o[4]*c,t[5]=o[5]*c,t[6]=o[6]*c,t[7]=0,t[8]=o[8]*d,t[9]=o[9]*d,t[10]=o[10]*d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,o=e.x,a=e.y,c=e.z,d=Math.cos(o),g=Math.sin(o),y=Math.cos(a),_=Math.sin(a),E=Math.cos(c),S=Math.sin(c);if(e.order==="XYZ"){const A=d*E,C=d*S,N=g*E,O=g*S;t[0]=y*E,t[4]=-y*S,t[8]=_,t[1]=C+N*_,t[5]=A-O*_,t[9]=-g*y,t[2]=O-A*_,t[6]=N+C*_,t[10]=d*y}else if(e.order==="YXZ"){const A=y*E,C=y*S,N=_*E,O=_*S;t[0]=A+O*g,t[4]=N*g-C,t[8]=d*_,t[1]=d*S,t[5]=d*E,t[9]=-g,t[2]=C*g-N,t[6]=O+A*g,t[10]=d*y}else if(e.order==="ZXY"){const A=y*E,C=y*S,N=_*E,O=_*S;t[0]=A-O*g,t[4]=-d*S,t[8]=N+C*g,t[1]=C+N*g,t[5]=d*E,t[9]=O-A*g,t[2]=-d*_,t[6]=g,t[10]=d*y}else if(e.order==="ZYX"){const A=d*E,C=d*S,N=g*E,O=g*S;t[0]=y*E,t[4]=N*_-C,t[8]=A*_+O,t[1]=y*S,t[5]=O*_+A,t[9]=C*_-N,t[2]=-_,t[6]=g*y,t[10]=d*y}else if(e.order==="YZX"){const A=d*y,C=d*_,N=g*y,O=g*_;t[0]=y*E,t[4]=O-A*S,t[8]=N*S+C,t[1]=S,t[5]=d*E,t[9]=-g*E,t[2]=-_*E,t[6]=C*S+N,t[10]=A-O*S}else if(e.order==="XZY"){const A=d*y,C=d*_,N=g*y,O=g*_;t[0]=y*E,t[4]=-S,t[8]=_*E,t[1]=A*S+O,t[5]=d*E,t[9]=C*S-N,t[2]=N*S-C,t[6]=g*E,t[10]=O*S+A}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(_zero,e,_one)}lookAt(e,t,o){const a=this.elements;return _z.subVectors(e,t),_z.lengthSq()===0&&(_z.z=1),_z.normalize(),_x.crossVectors(o,_z),_x.lengthSq()===0&&(Math.abs(o.z)===1?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(o,_z)),_x.normalize(),_y.crossVectors(_z,_x),a[0]=_x.x,a[4]=_y.x,a[8]=_z.x,a[1]=_x.y,a[5]=_y.y,a[9]=_z.y,a[2]=_x.z,a[6]=_y.z,a[10]=_z.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const o=e.elements,a=t.elements,c=this.elements,d=o[0],g=o[4],y=o[8],_=o[12],E=o[1],S=o[5],A=o[9],C=o[13],N=o[2],O=o[6],I=o[10],P=o[14],j=o[3],B=o[7],H=o[11],se=o[15],oe=a[0],Q=a[4],fe=a[8],Z=a[12],ce=a[1],ge=a[5],me=a[9],V=a[13],R=a[2],L=a[6],z=a[10],Y=a[14],W=a[3],ee=a[7],ie=a[11],X=a[15];return c[0]=d*oe+g*ce+y*R+_*W,c[4]=d*Q+g*ge+y*L+_*ee,c[8]=d*fe+g*me+y*z+_*ie,c[12]=d*Z+g*V+y*Y+_*X,c[1]=E*oe+S*ce+A*R+C*W,c[5]=E*Q+S*ge+A*L+C*ee,c[9]=E*fe+S*me+A*z+C*ie,c[13]=E*Z+S*V+A*Y+C*X,c[2]=N*oe+O*ce+I*R+P*W,c[6]=N*Q+O*ge+I*L+P*ee,c[10]=N*fe+O*me+I*z+P*ie,c[14]=N*Z+O*V+I*Y+P*X,c[3]=j*oe+B*ce+H*R+se*W,c[7]=j*Q+B*ge+H*L+se*ee,c[11]=j*fe+B*me+H*z+se*ie,c[15]=j*Z+B*V+H*Y+se*X,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],o=e[4],a=e[8],c=e[12],d=e[1],g=e[5],y=e[9],_=e[13],E=e[2],S=e[6],A=e[10],C=e[14],N=e[3],O=e[7],I=e[11],P=e[15];return N*(+c*y*S-a*_*S-c*g*A+o*_*A+a*g*C-o*y*C)+O*(+t*y*C-t*_*A+c*d*A-a*d*C+a*_*E-c*y*E)+I*(+t*_*S-t*g*C-c*d*S+o*d*C+c*g*E-o*_*E)+P*(-a*g*E-t*y*S+t*g*A+a*d*S-o*d*A+o*y*E)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,o){const a=this.elements;return e.isVector3?(a[12]=e.x,a[13]=e.y,a[14]=e.z):(a[12]=e,a[13]=t,a[14]=o),this}invert(){const e=this.elements,t=e[0],o=e[1],a=e[2],c=e[3],d=e[4],g=e[5],y=e[6],_=e[7],E=e[8],S=e[9],A=e[10],C=e[11],N=e[12],O=e[13],I=e[14],P=e[15],j=S*I*_-O*A*_+O*y*C-g*I*C-S*y*P+g*A*P,B=N*A*_-E*I*_-N*y*C+d*I*C+E*y*P-d*A*P,H=E*O*_-N*S*_+N*g*C-d*O*C-E*g*P+d*S*P,se=N*S*y-E*O*y-N*g*A+d*O*A+E*g*I-d*S*I,oe=t*j+o*B+a*H+c*se;if(oe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const Q=1/oe;return e[0]=j*Q,e[1]=(O*A*c-S*I*c-O*a*C+o*I*C+S*a*P-o*A*P)*Q,e[2]=(g*I*c-O*y*c+O*a*_-o*I*_-g*a*P+o*y*P)*Q,e[3]=(S*y*c-g*A*c-S*a*_+o*A*_+g*a*C-o*y*C)*Q,e[4]=B*Q,e[5]=(E*I*c-N*A*c+N*a*C-t*I*C-E*a*P+t*A*P)*Q,e[6]=(N*y*c-d*I*c-N*a*_+t*I*_+d*a*P-t*y*P)*Q,e[7]=(d*A*c-E*y*c+E*a*_-t*A*_-d*a*C+t*y*C)*Q,e[8]=H*Q,e[9]=(N*S*c-E*O*c-N*o*C+t*O*C+E*o*P-t*S*P)*Q,e[10]=(d*O*c-N*g*c+N*o*_-t*O*_-d*o*P+t*g*P)*Q,e[11]=(E*g*c-d*S*c-E*o*_+t*S*_+d*o*C-t*g*C)*Q,e[12]=se*Q,e[13]=(E*O*a-N*S*a+N*o*A-t*O*A-E*o*I+t*S*I)*Q,e[14]=(N*g*a-d*O*a-N*o*y+t*O*y+d*o*I-t*g*I)*Q,e[15]=(d*S*a-E*g*a+E*o*y-t*S*y-d*o*A+t*g*A)*Q,this}scale(e){const t=this.elements,o=e.x,a=e.y,c=e.z;return t[0]*=o,t[4]*=a,t[8]*=c,t[1]*=o,t[5]*=a,t[9]*=c,t[2]*=o,t[6]*=a,t[10]*=c,t[3]*=o,t[7]*=a,t[11]*=c,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],o=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],a=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,o,a))}makeTranslation(e,t,o){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,o,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),o=Math.sin(e);return this.set(1,0,0,0,0,t,-o,0,0,o,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),o=Math.sin(e);return this.set(t,0,o,0,0,1,0,0,-o,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),o=Math.sin(e);return this.set(t,-o,0,0,o,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const o=Math.cos(t),a=Math.sin(t),c=1-o,d=e.x,g=e.y,y=e.z,_=c*d,E=c*g;return this.set(_*d+o,_*g-a*y,_*y+a*g,0,_*g+a*y,E*g+o,E*y-a*d,0,_*y-a*g,E*y+a*d,c*y*y+o,0,0,0,0,1),this}makeScale(e,t,o){return this.set(e,0,0,0,0,t,0,0,0,0,o,0,0,0,0,1),this}makeShear(e,t,o,a,c,d){return this.set(1,o,c,0,e,1,d,0,t,a,1,0,0,0,0,1),this}compose(e,t,o){const a=this.elements,c=t._x,d=t._y,g=t._z,y=t._w,_=c+c,E=d+d,S=g+g,A=c*_,C=c*E,N=c*S,O=d*E,I=d*S,P=g*S,j=y*_,B=y*E,H=y*S,se=o.x,oe=o.y,Q=o.z;return a[0]=(1-(O+P))*se,a[1]=(C+H)*se,a[2]=(N-B)*se,a[3]=0,a[4]=(C-H)*oe,a[5]=(1-(A+P))*oe,a[6]=(I+j)*oe,a[7]=0,a[8]=(N+B)*Q,a[9]=(I-j)*Q,a[10]=(1-(A+O))*Q,a[11]=0,a[12]=e.x,a[13]=e.y,a[14]=e.z,a[15]=1,this}decompose(e,t,o){const a=this.elements;let c=_v1$5.set(a[0],a[1],a[2]).length();const d=_v1$5.set(a[4],a[5],a[6]).length(),g=_v1$5.set(a[8],a[9],a[10]).length();this.determinant()<0&&(c=-c),e.x=a[12],e.y=a[13],e.z=a[14],_m1$2.copy(this);const _=1/c,E=1/d,S=1/g;return _m1$2.elements[0]*=_,_m1$2.elements[1]*=_,_m1$2.elements[2]*=_,_m1$2.elements[4]*=E,_m1$2.elements[5]*=E,_m1$2.elements[6]*=E,_m1$2.elements[8]*=S,_m1$2.elements[9]*=S,_m1$2.elements[10]*=S,t.setFromRotationMatrix(_m1$2),o.x=c,o.y=d,o.z=g,this}makePerspective(e,t,o,a,c,d,g=WebGLCoordinateSystem){const y=this.elements,_=2*c/(t-e),E=2*c/(o-a),S=(t+e)/(t-e),A=(o+a)/(o-a);let C,N;if(g===WebGLCoordinateSystem)C=-(d+c)/(d-c),N=-2*d*c/(d-c);else if(g===WebGPUCoordinateSystem)C=-d/(d-c),N=-d*c/(d-c);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+g);return y[0]=_,y[4]=0,y[8]=S,y[12]=0,y[1]=0,y[5]=E,y[9]=A,y[13]=0,y[2]=0,y[6]=0,y[10]=C,y[14]=N,y[3]=0,y[7]=0,y[11]=-1,y[15]=0,this}makeOrthographic(e,t,o,a,c,d,g=WebGLCoordinateSystem){const y=this.elements,_=1/(t-e),E=1/(o-a),S=1/(d-c),A=(t+e)*_,C=(o+a)*E;let N,O;if(g===WebGLCoordinateSystem)N=(d+c)*S,O=-2*S;else if(g===WebGPUCoordinateSystem)N=c*S,O=-1*S;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+g);return y[0]=2*_,y[4]=0,y[8]=0,y[12]=-A,y[1]=0,y[5]=2*E,y[9]=0,y[13]=-C,y[2]=0,y[6]=0,y[10]=O,y[14]=-N,y[3]=0,y[7]=0,y[11]=0,y[15]=1,this}equals(e){const t=this.elements,o=e.elements;for(let a=0;a<16;a++)if(t[a]!==o[a])return!1;return!0}fromArray(e,t=0){for(let o=0;o<16;o++)this.elements[o]=e[o+t];return this}toArray(e=[],t=0){const o=this.elements;return e[t]=o[0],e[t+1]=o[1],e[t+2]=o[2],e[t+3]=o[3],e[t+4]=o[4],e[t+5]=o[5],e[t+6]=o[6],e[t+7]=o[7],e[t+8]=o[8],e[t+9]=o[9],e[t+10]=o[10],e[t+11]=o[11],e[t+12]=o[12],e[t+13]=o[13],e[t+14]=o[14],e[t+15]=o[15],e}}const _v1$5=new Vector3,_m1$2=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3,_matrix$1=new Matrix4,_quaternion$3=new Quaternion;class Euler{constructor(e=0,t=0,o=0,a=Euler.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=o,this._order=a}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,o,a=this._order){return this._x=e,this._y=t,this._z=o,this._order=a,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,o=!0){const a=e.elements,c=a[0],d=a[4],g=a[8],y=a[1],_=a[5],E=a[9],S=a[2],A=a[6],C=a[10];switch(t){case"XYZ":this._y=Math.asin(clamp(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(-E,C),this._z=Math.atan2(-d,c)):(this._x=Math.atan2(A,_),this._z=0);break;case"YXZ":this._x=Math.asin(-clamp(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(g,C),this._z=Math.atan2(y,_)):(this._y=Math.atan2(-S,c),this._z=0);break;case"ZXY":this._x=Math.asin(clamp(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(-S,C),this._z=Math.atan2(-d,_)):(this._y=0,this._z=Math.atan2(y,c));break;case"ZYX":this._y=Math.asin(-clamp(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(A,C),this._z=Math.atan2(y,c)):(this._x=0,this._z=Math.atan2(-d,_));break;case"YZX":this._z=Math.asin(clamp(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(-E,_),this._y=Math.atan2(-S,c)):(this._x=0,this._y=Math.atan2(g,C));break;case"XZY":this._z=Math.asin(-clamp(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(A,_),this._y=Math.atan2(g,c)):(this._x=Math.atan2(-E,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,o===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,o){return _matrix$1.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_matrix$1,t,o)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return _quaternion$3.setFromEuler(this),this.setFromQuaternion(_quaternion$3,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Euler.DEFAULT_ORDER="XYZ";class Layers{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let _object3DId=0;const _v1$4=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position$3=new Vector3,_scale$2=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};class Object3D extends EventDispatcher{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DEFAULT_UP.clone();const e=new Vector3,t=new Euler,o=new Quaternion,a=new Vector3(1,1,1);function c(){o.setFromEuler(t,!1)}function d(){t.setFromQuaternion(o,void 0,!1)}t._onChange(c),o._onChange(d),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return _q1.setFromAxisAngle(e,t),this.quaternion.multiply(_q1),this}rotateOnWorldAxis(e,t){return _q1.setFromAxisAngle(e,t),this.quaternion.premultiply(_q1),this}rotateX(e){return this.rotateOnAxis(_xAxis,e)}rotateY(e){return this.rotateOnAxis(_yAxis,e)}rotateZ(e){return this.rotateOnAxis(_zAxis,e)}translateOnAxis(e,t){return _v1$4.copy(e).applyQuaternion(this.quaternion),this.position.add(_v1$4.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(_xAxis,e)}translateY(e){return this.translateOnAxis(_yAxis,e)}translateZ(e){return this.translateOnAxis(_zAxis,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(_m1$1.copy(this.matrixWorld).invert())}lookAt(e,t,o){e.isVector3?_target.copy(e):_target.set(e,t,o);const a=this.parent;this.updateWorldMatrix(!0,!1),_position$3.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position$3,_target,this.up):_m1$1.lookAt(_target,_position$3,this.up),this.quaternion.setFromRotationMatrix(_m1$1),a&&(_m1$1.extractRotation(a.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(_addedEvent)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(_removedEvent)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),_m1$1.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(e.parent.matrixWorld)),e.applyMatrix4(_m1$1),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let o=0,a=this.children.length;o<a;o++){const d=this.children[o].getObjectByProperty(e,t);if(d!==void 0)return d}}getObjectsByProperty(e,t,o=[]){this[e]===t&&o.push(this);const a=this.children;for(let c=0,d=a.length;c<d;c++)a[c].getObjectsByProperty(e,t,o);return o}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,e,_scale$2),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(_position$3,_quaternion$2,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let o=0,a=t.length;o<a;o++)t[o].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let o=0,a=t.length;o<a;o++)t[o].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let o=0,a=t.length;o<a;o++){const c=t[o];(c.matrixWorldAutoUpdate===!0||e===!0)&&c.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const o=this.parent;if(e===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const a=this.children;for(let c=0,d=a.length;c<d;c++){const g=a[c];g.matrixWorldAutoUpdate===!0&&g.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",o={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.visibility=this._visibility,a.active=this._active,a.bounds=this._bounds.map(g=>({boxInitialized:g.boxInitialized,boxMin:g.box.min.toArray(),boxMax:g.box.max.toArray(),sphereInitialized:g.sphereInitialized,sphereRadius:g.sphere.radius,sphereCenter:g.sphere.center.toArray()})),a.maxGeometryCount=this._maxGeometryCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.geometryCount=this._geometryCount,a.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(a.boundingSphere={center:a.boundingSphere.center.toArray(),radius:a.boundingSphere.radius}),this.boundingBox!==null&&(a.boundingBox={min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}));function c(g,y){return g[y.uuid]===void 0&&(g[y.uuid]=y.toJSON(e)),y.uuid}if(this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=c(e.geometries,this.geometry);const g=this.geometry.parameters;if(g!==void 0&&g.shapes!==void 0){const y=g.shapes;if(Array.isArray(y))for(let _=0,E=y.length;_<E;_++){const S=y[_];c(e.shapes,S)}else c(e.shapes,y)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(c(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const g=[];for(let y=0,_=this.material.length;y<_;y++)g.push(c(e.materials,this.material[y]));a.material=g}else a.material=c(e.materials,this.material);if(this.children.length>0){a.children=[];for(let g=0;g<this.children.length;g++)a.children.push(this.children[g].toJSON(e).object)}if(this.animations.length>0){a.animations=[];for(let g=0;g<this.animations.length;g++){const y=this.animations[g];a.animations.push(c(e.animations,y))}}if(t){const g=d(e.geometries),y=d(e.materials),_=d(e.textures),E=d(e.images),S=d(e.shapes),A=d(e.skeletons),C=d(e.animations),N=d(e.nodes);g.length>0&&(o.geometries=g),y.length>0&&(o.materials=y),_.length>0&&(o.textures=_),E.length>0&&(o.images=E),S.length>0&&(o.shapes=S),A.length>0&&(o.skeletons=A),C.length>0&&(o.animations=C),N.length>0&&(o.nodes=N)}return o.object=a,o;function d(g){const y=[];for(const _ in g){const E=g[_];delete E.metadata,y.push(E)}return y}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let o=0;o<e.children.length;o++){const a=e.children[o];this.add(a.clone())}return this}}Object3D.DEFAULT_UP=new Vector3(0,1,0);Object3D.DEFAULT_MATRIX_AUTO_UPDATE=!0;Object3D.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const _v0$1=new Vector3,_v1$3=new Vector3,_v2$2=new Vector3,_v3$1=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;let warnedGetUV=!1;class Triangle{constructor(e=new Vector3,t=new Vector3,o=new Vector3){this.a=e,this.b=t,this.c=o}static getNormal(e,t,o,a){a.subVectors(o,t),_v0$1.subVectors(e,t),a.cross(_v0$1);const c=a.lengthSq();return c>0?a.multiplyScalar(1/Math.sqrt(c)):a.set(0,0,0)}static getBarycoord(e,t,o,a,c){_v0$1.subVectors(a,t),_v1$3.subVectors(o,t),_v2$2.subVectors(e,t);const d=_v0$1.dot(_v0$1),g=_v0$1.dot(_v1$3),y=_v0$1.dot(_v2$2),_=_v1$3.dot(_v1$3),E=_v1$3.dot(_v2$2),S=d*_-g*g;if(S===0)return c.set(0,0,0),null;const A=1/S,C=(_*y-g*E)*A,N=(d*E-g*y)*A;return c.set(1-C-N,N,C)}static containsPoint(e,t,o,a){return this.getBarycoord(e,t,o,a,_v3$1)===null?!1:_v3$1.x>=0&&_v3$1.y>=0&&_v3$1.x+_v3$1.y<=1}static getUV(e,t,o,a,c,d,g,y){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),this.getInterpolation(e,t,o,a,c,d,g,y)}static getInterpolation(e,t,o,a,c,d,g,y){return this.getBarycoord(e,t,o,a,_v3$1)===null?(y.x=0,y.y=0,"z"in y&&(y.z=0),"w"in y&&(y.w=0),null):(y.setScalar(0),y.addScaledVector(c,_v3$1.x),y.addScaledVector(d,_v3$1.y),y.addScaledVector(g,_v3$1.z),y)}static isFrontFacing(e,t,o,a){return _v0$1.subVectors(o,t),_v1$3.subVectors(e,t),_v0$1.cross(_v1$3).dot(a)<0}set(e,t,o){return this.a.copy(e),this.b.copy(t),this.c.copy(o),this}setFromPointsAndIndices(e,t,o,a){return this.a.copy(e[t]),this.b.copy(e[o]),this.c.copy(e[a]),this}setFromAttributeAndIndices(e,t,o,a){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,o),this.c.fromBufferAttribute(e,a),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),_v0$1.cross(_v1$3).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Triangle.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Triangle.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,o,a,c){return warnedGetUV===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),warnedGetUV=!0),Triangle.getInterpolation(e,this.a,this.b,this.c,t,o,a,c)}getInterpolation(e,t,o,a,c){return Triangle.getInterpolation(e,this.a,this.b,this.c,t,o,a,c)}containsPoint(e){return Triangle.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Triangle.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const o=this.a,a=this.b,c=this.c;let d,g;_vab.subVectors(a,o),_vac.subVectors(c,o),_vap.subVectors(e,o);const y=_vab.dot(_vap),_=_vac.dot(_vap);if(y<=0&&_<=0)return t.copy(o);_vbp.subVectors(e,a);const E=_vab.dot(_vbp),S=_vac.dot(_vbp);if(E>=0&&S<=E)return t.copy(a);const A=y*S-E*_;if(A<=0&&y>=0&&E<=0)return d=y/(y-E),t.copy(o).addScaledVector(_vab,d);_vcp.subVectors(e,c);const C=_vab.dot(_vcp),N=_vac.dot(_vcp);if(N>=0&&C<=N)return t.copy(c);const O=C*_-y*N;if(O<=0&&_>=0&&N<=0)return g=_/(_-N),t.copy(o).addScaledVector(_vac,g);const I=E*N-C*S;if(I<=0&&S-E>=0&&C-N>=0)return _vbc.subVectors(c,a),g=(S-E)/(S-E+(C-N)),t.copy(a).addScaledVector(_vbc,g);const P=1/(I+O+A);return d=O*P,g=A*P,t.copy(o).addScaledVector(_vab,d).addScaledVector(_vac,g)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function hue2rgb(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*6*(2/3-t):s}class Color{constructor(e,t,o){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,o)}set(e,t,o){if(t===void 0&&o===void 0){const a=e;a&&a.isColor?this.copy(a):typeof a=="number"?this.setHex(a):typeof a=="string"&&this.setStyle(a)}else this.setRGB(e,t,o);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=SRGBColorSpace){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,ColorManagement.toWorkingColorSpace(this,t),this}setRGB(e,t,o,a=ColorManagement.workingColorSpace){return this.r=e,this.g=t,this.b=o,ColorManagement.toWorkingColorSpace(this,a),this}setHSL(e,t,o,a=ColorManagement.workingColorSpace){if(e=euclideanModulo(e,1),t=clamp(t,0,1),o=clamp(o,0,1),t===0)this.r=this.g=this.b=o;else{const c=o<=.5?o*(1+t):o+t-o*t,d=2*o-c;this.r=hue2rgb(d,c,e+1/3),this.g=hue2rgb(d,c,e),this.b=hue2rgb(d,c,e-1/3)}return ColorManagement.toWorkingColorSpace(this,a),this}setStyle(e,t=SRGBColorSpace){function o(c){c!==void 0&&parseFloat(c)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let a;if(a=/^(\w+)\(([^\)]*)\)/.exec(e)){let c;const d=a[1],g=a[2];switch(d){case"rgb":case"rgba":if(c=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return o(c[4]),this.setRGB(Math.min(255,parseInt(c[1],10))/255,Math.min(255,parseInt(c[2],10))/255,Math.min(255,parseInt(c[3],10))/255,t);if(c=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return o(c[4]),this.setRGB(Math.min(100,parseInt(c[1],10))/100,Math.min(100,parseInt(c[2],10))/100,Math.min(100,parseInt(c[3],10))/100,t);break;case"hsl":case"hsla":if(c=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return o(c[4]),this.setHSL(parseFloat(c[1])/360,parseFloat(c[2])/100,parseFloat(c[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(a=/^\#([A-Fa-f\d]+)$/.exec(e)){const c=a[1],d=c.length;if(d===3)return this.setRGB(parseInt(c.charAt(0),16)/15,parseInt(c.charAt(1),16)/15,parseInt(c.charAt(2),16)/15,t);if(d===6)return this.setHex(parseInt(c,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=SRGBColorSpace){const o=_colorKeywords[e.toLowerCase()];return o!==void 0?this.setHex(o,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=SRGBToLinear(e.r),this.g=SRGBToLinear(e.g),this.b=SRGBToLinear(e.b),this}copyLinearToSRGB(e){return this.r=LinearToSRGB(e.r),this.g=LinearToSRGB(e.g),this.b=LinearToSRGB(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=SRGBColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),e),Math.round(clamp(_color.r*255,0,255))*65536+Math.round(clamp(_color.g*255,0,255))*256+Math.round(clamp(_color.b*255,0,255))}getHexString(e=SRGBColorSpace){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=ColorManagement.workingColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),t);const o=_color.r,a=_color.g,c=_color.b,d=Math.max(o,a,c),g=Math.min(o,a,c);let y,_;const E=(g+d)/2;if(g===d)y=0,_=0;else{const S=d-g;switch(_=E<=.5?S/(d+g):S/(2-d-g),d){case o:y=(a-c)/S+(a<c?6:0);break;case a:y=(c-o)/S+2;break;case c:y=(o-a)/S+4;break}y/=6}return e.h=y,e.s=_,e.l=E,e}getRGB(e,t=ColorManagement.workingColorSpace){return ColorManagement.fromWorkingColorSpace(_color.copy(this),t),e.r=_color.r,e.g=_color.g,e.b=_color.b,e}getStyle(e=SRGBColorSpace){ColorManagement.fromWorkingColorSpace(_color.copy(this),e);const t=_color.r,o=_color.g,a=_color.b;return e!==SRGBColorSpace?`color(${e} ${t.toFixed(3)} ${o.toFixed(3)} ${a.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(o*255)},${Math.round(a*255)})`}offsetHSL(e,t,o){return this.getHSL(_hslA),this.setHSL(_hslA.h+e,_hslA.s+t,_hslA.l+o)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,o){return this.r=e.r+(t.r-e.r)*o,this.g=e.g+(t.g-e.g)*o,this.b=e.b+(t.b-e.b)*o,this}lerpHSL(e,t){this.getHSL(_hslA),e.getHSL(_hslB);const o=lerp(_hslA.h,_hslB.h,t),a=lerp(_hslA.s,_hslB.s,t),c=lerp(_hslA.l,_hslB.l,t);return this.setHSL(o,a,c),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,o=this.g,a=this.b,c=e.elements;return this.r=c[0]*t+c[3]*o+c[6]*a,this.g=c[1]*t+c[4]*o+c[7]*a,this.b=c[2]*t+c[5]*o+c[8]*a,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const _color=new Color;Color.NAMES=_colorKeywords;let _materialId=0;class Material extends EventDispatcher{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:_materialId++}),this.uuid=generateUUID(),this.name="",this.type="Material",this.blending=NormalBlending,this.side=FrontSide,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Color(0,0,0),this.blendAlpha=0,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const o=e[t];if(o===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const a=this[t];if(a===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}a&&a.isColor?a.set(o):a&&a.isVector3&&o&&o.isVector3?a.copy(o):this[t]=o}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const o={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(o.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(o.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(o.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(o.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(o.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(o.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(o.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(e).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(e).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(e).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(e).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(e).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(o.blending=this.blending),this.side!==FrontSide&&(o.side=this.side),this.vertexColors===!0&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=!0),this.blendSrc!==SrcAlphaFactor&&(o.blendSrc=this.blendSrc),this.blendDst!==OneMinusSrcAlphaFactor&&(o.blendDst=this.blendDst),this.blendEquation!==AddEquation&&(o.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(o.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(o.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(o.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(o.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(o.blendAlpha=this.blendAlpha),this.depthFunc!==LessEqualDepth&&(o.depthFunc=this.depthFunc),this.depthTest===!1&&(o.depthTest=this.depthTest),this.depthWrite===!1&&(o.depthWrite=this.depthWrite),this.colorWrite===!1&&(o.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(o.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==AlwaysStencilFunc&&(o.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(o.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(o.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==KeepStencilOp&&(o.stencilFail=this.stencilFail),this.stencilZFail!==KeepStencilOp&&(o.stencilZFail=this.stencilZFail),this.stencilZPass!==KeepStencilOp&&(o.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(o.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaHash===!0&&(o.alphaHash=!0),this.alphaToCoverage===!0&&(o.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=!0),this.forceSinglePass===!0&&(o.forceSinglePass=!0),this.wireframe===!0&&(o.wireframe=!0),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=!0),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),this.fog===!1&&(o.fog=!1),Object.keys(this.userData).length>0&&(o.userData=this.userData);function a(c){const d=[];for(const g in c){const y=c[g];delete y.metadata,d.push(y)}return d}if(t){const c=a(e.textures),d=a(e.images);c.length>0&&(o.textures=c),d.length>0&&(o.images=d)}return o}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let o=null;if(t!==null){const a=t.length;o=new Array(a);for(let c=0;c!==a;++c)o[c]=t[c].clone()}return this.clippingPlanes=o,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class MeshBasicMaterial extends Material{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const _vector$9=new Vector3,_vector2$1=new Vector2;class BufferAttribute{constructor(e,t,o=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=o,this.usage=StaticDrawUsage,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=FloatType,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,o){e*=this.itemSize,o*=t.itemSize;for(let a=0,c=this.itemSize;a<c;a++)this.array[e+a]=t.array[o+a];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,o=this.count;t<o;t++)_vector2$1.fromBufferAttribute(this,t),_vector2$1.applyMatrix3(e),this.setXY(t,_vector2$1.x,_vector2$1.y);else if(this.itemSize===3)for(let t=0,o=this.count;t<o;t++)_vector$9.fromBufferAttribute(this,t),_vector$9.applyMatrix3(e),this.setXYZ(t,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyMatrix4(e){for(let t=0,o=this.count;t<o;t++)_vector$9.fromBufferAttribute(this,t),_vector$9.applyMatrix4(e),this.setXYZ(t,_vector$9.x,_vector$9.y,_vector$9.z);return this}applyNormalMatrix(e){for(let t=0,o=this.count;t<o;t++)_vector$9.fromBufferAttribute(this,t),_vector$9.applyNormalMatrix(e),this.setXYZ(t,_vector$9.x,_vector$9.y,_vector$9.z);return this}transformDirection(e){for(let t=0,o=this.count;t<o;t++)_vector$9.fromBufferAttribute(this,t),_vector$9.transformDirection(e),this.setXYZ(t,_vector$9.x,_vector$9.y,_vector$9.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let o=this.array[e*this.itemSize+t];return this.normalized&&(o=denormalize(o,this.array)),o}setComponent(e,t,o){return this.normalized&&(o=normalize(o,this.array)),this.array[e*this.itemSize+t]=o,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=denormalize(t,this.array)),t}setX(e,t){return this.normalized&&(t=normalize(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=denormalize(t,this.array)),t}setY(e,t){return this.normalized&&(t=normalize(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=denormalize(t,this.array)),t}setZ(e,t){return this.normalized&&(t=normalize(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=denormalize(t,this.array)),t}setW(e,t){return this.normalized&&(t=normalize(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,o){return e*=this.itemSize,this.normalized&&(t=normalize(t,this.array),o=normalize(o,this.array)),this.array[e+0]=t,this.array[e+1]=o,this}setXYZ(e,t,o,a){return e*=this.itemSize,this.normalized&&(t=normalize(t,this.array),o=normalize(o,this.array),a=normalize(a,this.array)),this.array[e+0]=t,this.array[e+1]=o,this.array[e+2]=a,this}setXYZW(e,t,o,a,c){return e*=this.itemSize,this.normalized&&(t=normalize(t,this.array),o=normalize(o,this.array),a=normalize(a,this.array),c=normalize(c,this.array)),this.array[e+0]=t,this.array[e+1]=o,this.array[e+2]=a,this.array[e+3]=c,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==StaticDrawUsage&&(e.usage=this.usage),e}}class Uint16BufferAttribute extends BufferAttribute{constructor(e,t,o){super(new Uint16Array(e),t,o)}}class Uint32BufferAttribute extends BufferAttribute{constructor(e,t,o){super(new Uint32Array(e),t,o)}}class Float32BufferAttribute extends BufferAttribute{constructor(e,t,o){super(new Float32Array(e),t,o)}}let _id$2=0;const _m1=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$8=new Vector3;class BufferGeometry extends EventDispatcher{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:_id$2++}),this.uuid=generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(arrayNeedsUint32(e)?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,o=0){this.groups.push({start:e,count:t,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const c=new Matrix3().getNormalMatrix(e);o.applyNormalMatrix(c),o.needsUpdate=!0}const a=this.attributes.tangent;return a!==void 0&&(a.transformDirection(e),a.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return _m1.makeRotationFromQuaternion(e),this.applyMatrix4(_m1),this}rotateX(e){return _m1.makeRotationX(e),this.applyMatrix4(_m1),this}rotateY(e){return _m1.makeRotationY(e),this.applyMatrix4(_m1),this}rotateZ(e){return _m1.makeRotationZ(e),this.applyMatrix4(_m1),this}translate(e,t,o){return _m1.makeTranslation(e,t,o),this.applyMatrix4(_m1),this}scale(e,t,o){return _m1.makeScale(e,t,o),this.applyMatrix4(_m1),this}lookAt(e){return _obj.lookAt(e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this}setFromPoints(e){const t=[];for(let o=0,a=e.length;o<a;o++){const c=e[o];t.push(c.x,c.y,c.z||0)}return this.setAttribute("position",new Float32BufferAttribute(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Box3);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Vector3(-1/0,-1/0,-1/0),new Vector3(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let o=0,a=t.length;o<a;o++){const c=t[o];_box$2.setFromBufferAttribute(c),this.morphTargetsRelative?(_vector$8.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$8),_vector$8.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$8)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sphere);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Vector3,1/0);return}if(e){const o=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(e),t)for(let c=0,d=t.length;c<d;c++){const g=t[c];_boxMorphTargets.setFromBufferAttribute(g),this.morphTargetsRelative?(_vector$8.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$8),_vector$8.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$8)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max))}_box$2.getCenter(o);let a=0;for(let c=0,d=e.count;c<d;c++)_vector$8.fromBufferAttribute(e,c),a=Math.max(a,o.distanceToSquared(_vector$8));if(t)for(let c=0,d=t.length;c<d;c++){const g=t[c],y=this.morphTargetsRelative;for(let _=0,E=g.count;_<E;_++)_vector$8.fromBufferAttribute(g,_),y&&(_offset.fromBufferAttribute(e,_),_vector$8.add(_offset)),a=Math.max(a,o.distanceToSquared(_vector$8))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=e.array,a=t.position.array,c=t.normal.array,d=t.uv.array,g=a.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new BufferAttribute(new Float32Array(4*g),4));const y=this.getAttribute("tangent").array,_=[],E=[];for(let ce=0;ce<g;ce++)_[ce]=new Vector3,E[ce]=new Vector3;const S=new Vector3,A=new Vector3,C=new Vector3,N=new Vector2,O=new Vector2,I=new Vector2,P=new Vector3,j=new Vector3;function B(ce,ge,me){S.fromArray(a,ce*3),A.fromArray(a,ge*3),C.fromArray(a,me*3),N.fromArray(d,ce*2),O.fromArray(d,ge*2),I.fromArray(d,me*2),A.sub(S),C.sub(S),O.sub(N),I.sub(N);const V=1/(O.x*I.y-I.x*O.y);isFinite(V)&&(P.copy(A).multiplyScalar(I.y).addScaledVector(C,-O.y).multiplyScalar(V),j.copy(C).multiplyScalar(O.x).addScaledVector(A,-I.x).multiplyScalar(V),_[ce].add(P),_[ge].add(P),_[me].add(P),E[ce].add(j),E[ge].add(j),E[me].add(j))}let H=this.groups;H.length===0&&(H=[{start:0,count:o.length}]);for(let ce=0,ge=H.length;ce<ge;++ce){const me=H[ce],V=me.start,R=me.count;for(let L=V,z=V+R;L<z;L+=3)B(o[L+0],o[L+1],o[L+2])}const se=new Vector3,oe=new Vector3,Q=new Vector3,fe=new Vector3;function Z(ce){Q.fromArray(c,ce*3),fe.copy(Q);const ge=_[ce];se.copy(ge),se.sub(Q.multiplyScalar(Q.dot(ge))).normalize(),oe.crossVectors(fe,ge);const V=oe.dot(E[ce])<0?-1:1;y[ce*4]=se.x,y[ce*4+1]=se.y,y[ce*4+2]=se.z,y[ce*4+3]=V}for(let ce=0,ge=H.length;ce<ge;++ce){const me=H[ce],V=me.start,R=me.count;for(let L=V,z=V+R;L<z;L+=3)Z(o[L+0]),Z(o[L+1]),Z(o[L+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new BufferAttribute(new Float32Array(t.count*3),3),this.setAttribute("normal",o);else for(let A=0,C=o.count;A<C;A++)o.setXYZ(A,0,0,0);const a=new Vector3,c=new Vector3,d=new Vector3,g=new Vector3,y=new Vector3,_=new Vector3,E=new Vector3,S=new Vector3;if(e)for(let A=0,C=e.count;A<C;A+=3){const N=e.getX(A+0),O=e.getX(A+1),I=e.getX(A+2);a.fromBufferAttribute(t,N),c.fromBufferAttribute(t,O),d.fromBufferAttribute(t,I),E.subVectors(d,c),S.subVectors(a,c),E.cross(S),g.fromBufferAttribute(o,N),y.fromBufferAttribute(o,O),_.fromBufferAttribute(o,I),g.add(E),y.add(E),_.add(E),o.setXYZ(N,g.x,g.y,g.z),o.setXYZ(O,y.x,y.y,y.z),o.setXYZ(I,_.x,_.y,_.z)}else for(let A=0,C=t.count;A<C;A+=3)a.fromBufferAttribute(t,A+0),c.fromBufferAttribute(t,A+1),d.fromBufferAttribute(t,A+2),E.subVectors(d,c),S.subVectors(a,c),E.cross(S),o.setXYZ(A+0,E.x,E.y,E.z),o.setXYZ(A+1,E.x,E.y,E.z),o.setXYZ(A+2,E.x,E.y,E.z);this.normalizeNormals(),o.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,o=e.count;t<o;t++)_vector$8.fromBufferAttribute(e,t),_vector$8.normalize(),e.setXYZ(t,_vector$8.x,_vector$8.y,_vector$8.z)}toNonIndexed(){function e(g,y){const _=g.array,E=g.itemSize,S=g.normalized,A=new _.constructor(y.length*E);let C=0,N=0;for(let O=0,I=y.length;O<I;O++){g.isInterleavedBufferAttribute?C=y[O]*g.data.stride+g.offset:C=y[O]*E;for(let P=0;P<E;P++)A[N++]=_[C++]}return new BufferAttribute(A,E,S)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new BufferGeometry,o=this.index.array,a=this.attributes;for(const g in a){const y=a[g],_=e(y,o);t.setAttribute(g,_)}const c=this.morphAttributes;for(const g in c){const y=[],_=c[g];for(let E=0,S=_.length;E<S;E++){const A=_[E],C=e(A,o);y.push(C)}t.morphAttributes[g]=y}t.morphTargetsRelative=this.morphTargetsRelative;const d=this.groups;for(let g=0,y=d.length;g<y;g++){const _=d[g];t.addGroup(_.start,_.count,_.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const y=this.parameters;for(const _ in y)y[_]!==void 0&&(e[_]=y[_]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const o=this.attributes;for(const y in o){const _=o[y];e.data.attributes[y]=_.toJSON(e.data)}const a={};let c=!1;for(const y in this.morphAttributes){const _=this.morphAttributes[y],E=[];for(let S=0,A=_.length;S<A;S++){const C=_[S];E.push(C.toJSON(e.data))}E.length>0&&(a[y]=E,c=!0)}c&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);const d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));const g=this.boundingSphere;return g!==null&&(e.data.boundingSphere={center:g.center.toArray(),radius:g.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const o=e.index;o!==null&&this.setIndex(o.clone(t));const a=e.attributes;for(const _ in a){const E=a[_];this.setAttribute(_,E.clone(t))}const c=e.morphAttributes;for(const _ in c){const E=[],S=c[_];for(let A=0,C=S.length;A<C;A++)E.push(S[A].clone(t));this.morphAttributes[_]=E}this.morphTargetsRelative=e.morphTargetsRelative;const d=e.groups;for(let _=0,E=d.length;_<E;_++){const S=d[_];this.addGroup(S.start,S.count,S.materialIndex)}const g=e.boundingBox;g!==null&&(this.boundingBox=g.clone());const y=e.boundingSphere;return y!==null&&(this.boundingSphere=y.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const _inverseMatrix$3=new Matrix4,_ray$3=new Ray,_sphere$6=new Sphere,_sphereHitAt=new Vector3,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_tempA=new Vector3,_morphA=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2,_normalA=new Vector3,_normalB=new Vector3,_normalC=new Vector3,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;class Mesh extends Object3D{constructor(e=new BufferGeometry,t=new MeshBasicMaterial){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,o=Object.keys(t);if(o.length>0){const a=t[o[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let c=0,d=a.length;c<d;c++){const g=a[c].name||String(c);this.morphTargetInfluences.push(0),this.morphTargetDictionary[g]=c}}}}getVertexPosition(e,t){const o=this.geometry,a=o.attributes.position,c=o.morphAttributes.position,d=o.morphTargetsRelative;t.fromBufferAttribute(a,e);const g=this.morphTargetInfluences;if(c&&g){_morphA.set(0,0,0);for(let y=0,_=c.length;y<_;y++){const E=g[y],S=c[y];E!==0&&(_tempA.fromBufferAttribute(S,e),d?_morphA.addScaledVector(_tempA,E):_morphA.addScaledVector(_tempA.sub(t),E))}t.add(_morphA)}return t}raycast(e,t){const o=this.geometry,a=this.material,c=this.matrixWorld;a!==void 0&&(o.boundingSphere===null&&o.computeBoundingSphere(),_sphere$6.copy(o.boundingSphere),_sphere$6.applyMatrix4(c),_ray$3.copy(e.ray).recast(e.near),!(_sphere$6.containsPoint(_ray$3.origin)===!1&&(_ray$3.intersectSphere(_sphere$6,_sphereHitAt)===null||_ray$3.origin.distanceToSquared(_sphereHitAt)>(e.far-e.near)**2))&&(_inverseMatrix$3.copy(c).invert(),_ray$3.copy(e.ray).applyMatrix4(_inverseMatrix$3),!(o.boundingBox!==null&&_ray$3.intersectsBox(o.boundingBox)===!1)&&this._computeIntersections(e,t,_ray$3)))}_computeIntersections(e,t,o){let a;const c=this.geometry,d=this.material,g=c.index,y=c.attributes.position,_=c.attributes.uv,E=c.attributes.uv1,S=c.attributes.normal,A=c.groups,C=c.drawRange;if(g!==null)if(Array.isArray(d))for(let N=0,O=A.length;N<O;N++){const I=A[N],P=d[I.materialIndex],j=Math.max(I.start,C.start),B=Math.min(g.count,Math.min(I.start+I.count,C.start+C.count));for(let H=j,se=B;H<se;H+=3){const oe=g.getX(H),Q=g.getX(H+1),fe=g.getX(H+2);a=checkGeometryIntersection(this,P,e,o,_,E,S,oe,Q,fe),a&&(a.faceIndex=Math.floor(H/3),a.face.materialIndex=I.materialIndex,t.push(a))}}else{const N=Math.max(0,C.start),O=Math.min(g.count,C.start+C.count);for(let I=N,P=O;I<P;I+=3){const j=g.getX(I),B=g.getX(I+1),H=g.getX(I+2);a=checkGeometryIntersection(this,d,e,o,_,E,S,j,B,H),a&&(a.faceIndex=Math.floor(I/3),t.push(a))}}else if(y!==void 0)if(Array.isArray(d))for(let N=0,O=A.length;N<O;N++){const I=A[N],P=d[I.materialIndex],j=Math.max(I.start,C.start),B=Math.min(y.count,Math.min(I.start+I.count,C.start+C.count));for(let H=j,se=B;H<se;H+=3){const oe=H,Q=H+1,fe=H+2;a=checkGeometryIntersection(this,P,e,o,_,E,S,oe,Q,fe),a&&(a.faceIndex=Math.floor(H/3),a.face.materialIndex=I.materialIndex,t.push(a))}}else{const N=Math.max(0,C.start),O=Math.min(y.count,C.start+C.count);for(let I=N,P=O;I<P;I+=3){const j=I,B=I+1,H=I+2;a=checkGeometryIntersection(this,d,e,o,_,E,S,j,B,H),a&&(a.faceIndex=Math.floor(I/3),t.push(a))}}}}function checkIntersection(s,e,t,o,a,c,d,g){let y;if(e.side===BackSide?y=o.intersectTriangle(d,c,a,!0,g):y=o.intersectTriangle(a,c,d,e.side===FrontSide,g),y===null)return null;_intersectionPointWorld.copy(g),_intersectionPointWorld.applyMatrix4(s.matrixWorld);const _=t.ray.origin.distanceTo(_intersectionPointWorld);return _<t.near||_>t.far?null:{distance:_,point:_intersectionPointWorld.clone(),object:s}}function checkGeometryIntersection(s,e,t,o,a,c,d,g,y,_){s.getVertexPosition(g,_vA$1),s.getVertexPosition(y,_vB$1),s.getVertexPosition(_,_vC$1);const E=checkIntersection(s,e,t,o,_vA$1,_vB$1,_vC$1,_intersectionPoint);if(E){a&&(_uvA$1.fromBufferAttribute(a,g),_uvB$1.fromBufferAttribute(a,y),_uvC$1.fromBufferAttribute(a,_),E.uv=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2)),c&&(_uvA$1.fromBufferAttribute(c,g),_uvB$1.fromBufferAttribute(c,y),_uvC$1.fromBufferAttribute(c,_),E.uv1=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),E.uv2=E.uv1),d&&(_normalA.fromBufferAttribute(d,g),_normalB.fromBufferAttribute(d,y),_normalC.fromBufferAttribute(d,_),E.normal=Triangle.getInterpolation(_intersectionPoint,_vA$1,_vB$1,_vC$1,_normalA,_normalB,_normalC,new Vector3),E.normal.dot(o.direction)>0&&E.normal.multiplyScalar(-1));const S={a:g,b:y,c:_,normal:new Vector3,materialIndex:0};Triangle.getNormal(_vA$1,_vB$1,_vC$1,S.normal),E.face=S}return E}class BoxGeometry extends BufferGeometry{constructor(e=1,t=1,o=1,a=1,c=1,d=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:o,widthSegments:a,heightSegments:c,depthSegments:d};const g=this;a=Math.floor(a),c=Math.floor(c),d=Math.floor(d);const y=[],_=[],E=[],S=[];let A=0,C=0;N("z","y","x",-1,-1,o,t,e,d,c,0),N("z","y","x",1,-1,o,t,-e,d,c,1),N("x","z","y",1,1,e,o,t,a,d,2),N("x","z","y",1,-1,e,o,-t,a,d,3),N("x","y","z",1,-1,e,t,o,a,c,4),N("x","y","z",-1,-1,e,t,-o,a,c,5),this.setIndex(y),this.setAttribute("position",new Float32BufferAttribute(_,3)),this.setAttribute("normal",new Float32BufferAttribute(E,3)),this.setAttribute("uv",new Float32BufferAttribute(S,2));function N(O,I,P,j,B,H,se,oe,Q,fe,Z){const ce=H/Q,ge=se/fe,me=H/2,V=se/2,R=oe/2,L=Q+1,z=fe+1;let Y=0,W=0;const ee=new Vector3;for(let ie=0;ie<z;ie++){const X=ie*ge-V;for(let F=0;F<L;F++){const J=F*ce-me;ee[O]=J*j,ee[I]=X*B,ee[P]=R,_.push(ee.x,ee.y,ee.z),ee[O]=0,ee[I]=0,ee[P]=oe>0?1:-1,E.push(ee.x,ee.y,ee.z),S.push(F/Q),S.push(1-ie/fe),Y+=1}}for(let ie=0;ie<fe;ie++)for(let X=0;X<Q;X++){const F=A+X+L*ie,J=A+X+L*(ie+1),Ee=A+(X+1)+L*(ie+1),Re=A+(X+1)+L*ie;y.push(F,J,Re),y.push(J,Ee,Re),W+=6}g.addGroup(C,W,Z),C+=W,A+=Y}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new BoxGeometry(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function cloneUniforms(s){const e={};for(const t in s){e[t]={};for(const o in s[t]){const a=s[t][o];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][o]=null):e[t][o]=a.clone():Array.isArray(a)?e[t][o]=a.slice():e[t][o]=a}}return e}function mergeUniforms(s){const e={};for(let t=0;t<s.length;t++){const o=cloneUniforms(s[t]);for(const a in o)e[a]=o[a]}return e}function cloneUniformsGroups(s){const e=[];for(let t=0;t<s.length;t++)e.push(s[t].clone());return e}function getUnlitUniformColorSpace(s){return s.getRenderTarget()===null?s.outputColorSpace:ColorManagement.workingColorSpace}const UniformsUtils={clone:cloneUniforms,merge:mergeUniforms};var default_vertex=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,default_fragment=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ShaderMaterial extends Material{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=cloneUniforms(e.uniforms),this.uniformsGroups=cloneUniformsGroups(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const a in this.uniforms){const d=this.uniforms[a].value;d&&d.isTexture?t.uniforms[a]={type:"t",value:d.toJSON(e).uuid}:d&&d.isColor?t.uniforms[a]={type:"c",value:d.getHex()}:d&&d.isVector2?t.uniforms[a]={type:"v2",value:d.toArray()}:d&&d.isVector3?t.uniforms[a]={type:"v3",value:d.toArray()}:d&&d.isVector4?t.uniforms[a]={type:"v4",value:d.toArray()}:d&&d.isMatrix3?t.uniforms[a]={type:"m3",value:d.toArray()}:d&&d.isMatrix4?t.uniforms[a]={type:"m4",value:d.toArray()}:t.uniforms[a]={value:d}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const o={};for(const a in this.extensions)this.extensions[a]===!0&&(o[a]=!0);return Object.keys(o).length>0&&(t.extensions=o),t}}class Camera extends Object3D{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4,this.coordinateSystem=WebGLCoordinateSystem}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class PerspectiveCamera extends Camera{constructor(e=50,t=1,o=.1,a=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=o,this.far=a,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=RAD2DEG*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return RAD2DEG*2*Math.atan(Math.tan(DEG2RAD*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,o,a,c,d){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=o,this.view.offsetY=a,this.view.width=c,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(DEG2RAD*.5*this.fov)/this.zoom,o=2*t,a=this.aspect*o,c=-.5*a;const d=this.view;if(this.view!==null&&this.view.enabled){const y=d.fullWidth,_=d.fullHeight;c+=d.offsetX*a/y,t-=d.offsetY*o/_,a*=d.width/y,o*=d.height/_}const g=this.filmOffset;g!==0&&(c+=e*g/this.getFilmWidth()),this.projectionMatrix.makePerspective(c,c+a,t,t-o,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const fov=-90,aspect=1;class CubeCamera extends Object3D{constructor(e,t,o){super(),this.type="CubeCamera",this.renderTarget=o,this.coordinateSystem=null,this.activeMipmapLevel=0;const a=new PerspectiveCamera(fov,aspect,e,t);a.layers=this.layers,this.add(a);const c=new PerspectiveCamera(fov,aspect,e,t);c.layers=this.layers,this.add(c);const d=new PerspectiveCamera(fov,aspect,e,t);d.layers=this.layers,this.add(d);const g=new PerspectiveCamera(fov,aspect,e,t);g.layers=this.layers,this.add(g);const y=new PerspectiveCamera(fov,aspect,e,t);y.layers=this.layers,this.add(y);const _=new PerspectiveCamera(fov,aspect,e,t);_.layers=this.layers,this.add(_)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[o,a,c,d,g,y]=t;for(const _ of t)this.remove(_);if(e===WebGLCoordinateSystem)o.up.set(0,1,0),o.lookAt(1,0,0),a.up.set(0,1,0),a.lookAt(-1,0,0),c.up.set(0,0,-1),c.lookAt(0,1,0),d.up.set(0,0,1),d.lookAt(0,-1,0),g.up.set(0,1,0),g.lookAt(0,0,1),y.up.set(0,1,0),y.lookAt(0,0,-1);else if(e===WebGPUCoordinateSystem)o.up.set(0,-1,0),o.lookAt(-1,0,0),a.up.set(0,-1,0),a.lookAt(1,0,0),c.up.set(0,0,1),c.lookAt(0,1,0),d.up.set(0,0,-1),d.lookAt(0,-1,0),g.up.set(0,-1,0),g.lookAt(0,0,1),y.up.set(0,-1,0),y.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const _ of t)this.add(_),_.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:o,activeMipmapLevel:a}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[c,d,g,y,_,E]=this.children,S=e.getRenderTarget(),A=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),N=e.xr.enabled;e.xr.enabled=!1;const O=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,e.setRenderTarget(o,0,a),e.render(t,c),e.setRenderTarget(o,1,a),e.render(t,d),e.setRenderTarget(o,2,a),e.render(t,g),e.setRenderTarget(o,3,a),e.render(t,y),e.setRenderTarget(o,4,a),e.render(t,_),o.texture.generateMipmaps=O,e.setRenderTarget(o,5,a),e.render(t,E),e.setRenderTarget(S,A,C),e.xr.enabled=N,o.texture.needsPMREMUpdate=!0}}class CubeTexture extends Texture{constructor(e,t,o,a,c,d,g,y,_,E){e=e!==void 0?e:[],t=t!==void 0?t:CubeReflectionMapping,super(e,t,o,a,c,d,g,y,_,E),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class WebGLCubeRenderTarget extends WebGLRenderTarget{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const o={width:e,height:e,depth:1},a=[o,o,o,o,o,o];t.encoding!==void 0&&(warnOnce("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===sRGBEncoding?SRGBColorSpace:NoColorSpace),this.texture=new CubeTexture(a,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:LinearFilter}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const o={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},a=new BoxGeometry(5,5,5),c=new ShaderMaterial({name:"CubemapFromEquirect",uniforms:cloneUniforms(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:BackSide,blending:NoBlending});c.uniforms.tEquirect.value=t;const d=new Mesh(a,c),g=t.minFilter;return t.minFilter===LinearMipmapLinearFilter&&(t.minFilter=LinearFilter),new CubeCamera(1,10,this).update(e,d),t.minFilter=g,d.geometry.dispose(),d.material.dispose(),this}clear(e,t,o,a){const c=e.getRenderTarget();for(let d=0;d<6;d++)e.setRenderTarget(this,d),e.clear(t,o,a);e.setRenderTarget(c)}}const _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;class Plane{constructor(e=new Vector3(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,o,a){return this.normal.set(e,t,o),this.constant=a,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,o){const a=_vector1.subVectors(o,t).cross(_vector2.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(a,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const o=e.delta(_vector1),a=this.normal.dot(o);if(a===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const c=-(e.start.dot(this.normal)+this.constant)/a;return c<0||c>1?null:t.copy(e.start).addScaledVector(o,c)}intersectsLine(e){const t=this.distanceToPoint(e.start),o=this.distanceToPoint(e.end);return t<0&&o>0||o<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const o=t||_normalMatrix.getNormalMatrix(e),a=this.coplanarPoint(_vector1).applyMatrix4(e),c=this.normal.applyMatrix3(o).normalize();return this.constant=-a.dot(c),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _sphere$5=new Sphere,_vector$7=new Vector3;class Frustum{constructor(e=new Plane,t=new Plane,o=new Plane,a=new Plane,c=new Plane,d=new Plane){this.planes=[e,t,o,a,c,d]}set(e,t,o,a,c,d){const g=this.planes;return g[0].copy(e),g[1].copy(t),g[2].copy(o),g[3].copy(a),g[4].copy(c),g[5].copy(d),this}copy(e){const t=this.planes;for(let o=0;o<6;o++)t[o].copy(e.planes[o]);return this}setFromProjectionMatrix(e,t=WebGLCoordinateSystem){const o=this.planes,a=e.elements,c=a[0],d=a[1],g=a[2],y=a[3],_=a[4],E=a[5],S=a[6],A=a[7],C=a[8],N=a[9],O=a[10],I=a[11],P=a[12],j=a[13],B=a[14],H=a[15];if(o[0].setComponents(y-c,A-_,I-C,H-P).normalize(),o[1].setComponents(y+c,A+_,I+C,H+P).normalize(),o[2].setComponents(y+d,A+E,I+N,H+j).normalize(),o[3].setComponents(y-d,A-E,I-N,H-j).normalize(),o[4].setComponents(y-g,A-S,I-O,H-B).normalize(),t===WebGLCoordinateSystem)o[5].setComponents(y+g,A+S,I+O,H+B).normalize();else if(t===WebGPUCoordinateSystem)o[5].setComponents(g,S,O,B).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),_sphere$5.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),_sphere$5.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(_sphere$5)}intersectsSprite(e){return _sphere$5.center.set(0,0,0),_sphere$5.radius=.7071067811865476,_sphere$5.applyMatrix4(e.matrixWorld),this.intersectsSphere(_sphere$5)}intersectsSphere(e){const t=this.planes,o=e.center,a=-e.radius;for(let c=0;c<6;c++)if(t[c].distanceToPoint(o)<a)return!1;return!0}intersectsBox(e){const t=this.planes;for(let o=0;o<6;o++){const a=t[o];if(_vector$7.x=a.normal.x>0?e.max.x:e.min.x,_vector$7.y=a.normal.y>0?e.max.y:e.min.y,_vector$7.z=a.normal.z>0?e.max.z:e.min.z,a.distanceToPoint(_vector$7)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let o=0;o<6;o++)if(t[o].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function WebGLAnimation(){let s=null,e=!1,t=null,o=null;function a(c,d){t(c,d),o=s.requestAnimationFrame(a)}return{start:function(){e!==!0&&t!==null&&(o=s.requestAnimationFrame(a),e=!0)},stop:function(){s.cancelAnimationFrame(o),e=!1},setAnimationLoop:function(c){t=c},setContext:function(c){s=c}}}function WebGLAttributes(s,e){const t=e.isWebGL2,o=new WeakMap;function a(_,E){const S=_.array,A=_.usage,C=S.byteLength,N=s.createBuffer();s.bindBuffer(E,N),s.bufferData(E,S,A),_.onUploadCallback();let O;if(S instanceof Float32Array)O=s.FLOAT;else if(S instanceof Uint16Array)if(_.isFloat16BufferAttribute)if(t)O=s.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else O=s.UNSIGNED_SHORT;else if(S instanceof Int16Array)O=s.SHORT;else if(S instanceof Uint32Array)O=s.UNSIGNED_INT;else if(S instanceof Int32Array)O=s.INT;else if(S instanceof Int8Array)O=s.BYTE;else if(S instanceof Uint8Array)O=s.UNSIGNED_BYTE;else if(S instanceof Uint8ClampedArray)O=s.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+S);return{buffer:N,type:O,bytesPerElement:S.BYTES_PER_ELEMENT,version:_.version,size:C}}function c(_,E,S){const A=E.array,C=E._updateRange,N=E.updateRanges;if(s.bindBuffer(S,_),C.count===-1&&N.length===0&&s.bufferSubData(S,0,A),N.length!==0){for(let O=0,I=N.length;O<I;O++){const P=N[O];t?s.bufferSubData(S,P.start*A.BYTES_PER_ELEMENT,A,P.start,P.count):s.bufferSubData(S,P.start*A.BYTES_PER_ELEMENT,A.subarray(P.start,P.start+P.count))}E.clearUpdateRanges()}C.count!==-1&&(t?s.bufferSubData(S,C.offset*A.BYTES_PER_ELEMENT,A,C.offset,C.count):s.bufferSubData(S,C.offset*A.BYTES_PER_ELEMENT,A.subarray(C.offset,C.offset+C.count)),C.count=-1),E.onUploadCallback()}function d(_){return _.isInterleavedBufferAttribute&&(_=_.data),o.get(_)}function g(_){_.isInterleavedBufferAttribute&&(_=_.data);const E=o.get(_);E&&(s.deleteBuffer(E.buffer),o.delete(_))}function y(_,E){if(_.isGLBufferAttribute){const A=o.get(_);(!A||A.version<_.version)&&o.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version});return}_.isInterleavedBufferAttribute&&(_=_.data);const S=o.get(_);if(S===void 0)o.set(_,a(_,E));else if(S.version<_.version){if(S.size!==_.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");c(S.buffer,_,E),S.version=_.version}}return{get:d,remove:g,update:y}}class PlaneGeometry extends BufferGeometry{constructor(e=1,t=1,o=1,a=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:o,heightSegments:a};const c=e/2,d=t/2,g=Math.floor(o),y=Math.floor(a),_=g+1,E=y+1,S=e/g,A=t/y,C=[],N=[],O=[],I=[];for(let P=0;P<E;P++){const j=P*A-d;for(let B=0;B<_;B++){const H=B*S-c;N.push(H,-j,0),O.push(0,0,1),I.push(B/g),I.push(1-P/y)}}for(let P=0;P<y;P++)for(let j=0;j<g;j++){const B=j+_*P,H=j+_*(P+1),se=j+1+_*(P+1),oe=j+1+_*P;C.push(B,H,oe),C.push(H,se,oe)}this.setIndex(C),this.setAttribute("position",new Float32BufferAttribute(N,3)),this.setAttribute("normal",new Float32BufferAttribute(O,3)),this.setAttribute("uv",new Float32BufferAttribute(I,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new PlaneGeometry(e.width,e.height,e.widthSegments,e.heightSegments)}}var alphahash_fragment=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,alphahash_pars_fragment=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,alphamap_fragment=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,alphamap_pars_fragment=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,alphatest_pars_fragment=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,aomap_fragment=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,aomap_pars_fragment=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,batching_pars_vertex=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,batching_vertex=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,begin_vertex=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,beginnormal_vertex=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,iridescence_fragment=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,bumpmap_pars_fragment=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,cube_uv_reflection_fragment=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,colorspace_fragment="gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,envmap_fragment=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_vertex=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,fog_pars_vertex=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,fog_fragment=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lightmap_fragment=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,lightmap_pars_fragment=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_fragment=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,lights_lambert_pars_fragment=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,lights_pars_begin=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,envmap_physical_pars_fragment=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,lights_toon_fragment=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lights_phong_fragment=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,lights_physical_fragment=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,lights_physical_pars_fragment=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,lights_fragment_end=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,logdepthbuf_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,map_pars_fragment=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphcolor_vertex=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,morphnormal_vertex=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,morphtarget_pars_vertex=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,morphtarget_vertex=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,normal_fragment_begin=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,normal_fragment_maps=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normal_pars_fragment=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_pars_vertex=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,normal_vertex=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,normalmap_pars_fragment=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,clearcoat_normal_fragment_begin=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,clearcoat_normal_fragment_maps=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,clearcoat_pars_fragment=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,iridescence_pars_fragment=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,opaque_fragment=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,packing=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,premultiplied_alpha_fragment=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,shadowmask_pars_fragment=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,skinning_vertex=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmission_fragment=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,transmission_pars_fragment=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,uv_pars_fragment=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_pars_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,uv_vertex=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,worldpos_vertex=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const vertex$h=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,fragment$h=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$g=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$g=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$f=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,fragment$f=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$e=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,fragment$e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,vertex$d=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,fragment$d=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,vertex$c=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragment$c=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,vertex$b=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$b=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$a=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fragment$a=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$8=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,fragment$8=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,fragment$7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vertex$6=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$6=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$5=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fragment$5=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$4=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$4=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vertex$3=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,fragment$3=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vertex$2=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fragment$2=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,vertex$1=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fragment$1=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ShaderChunk={alphahash_fragment,alphahash_pars_fragment,alphamap_fragment,alphamap_pars_fragment,alphatest_fragment,alphatest_pars_fragment,aomap_fragment,aomap_pars_fragment,batching_pars_vertex,batching_vertex,begin_vertex,beginnormal_vertex,bsdfs,iridescence_fragment,bumpmap_pars_fragment,clipping_planes_fragment,clipping_planes_pars_fragment,clipping_planes_pars_vertex,clipping_planes_vertex,color_fragment,color_pars_fragment,color_pars_vertex,color_vertex,common,cube_uv_reflection_fragment,defaultnormal_vertex,displacementmap_pars_vertex,displacementmap_vertex,emissivemap_fragment,emissivemap_pars_fragment,colorspace_fragment,colorspace_pars_fragment,envmap_fragment,envmap_common_pars_fragment,envmap_pars_fragment,envmap_pars_vertex,envmap_physical_pars_fragment,envmap_vertex,fog_vertex,fog_pars_vertex,fog_fragment,fog_pars_fragment,gradientmap_pars_fragment,lightmap_fragment,lightmap_pars_fragment,lights_lambert_fragment,lights_lambert_pars_fragment,lights_pars_begin,lights_toon_fragment,lights_toon_pars_fragment,lights_phong_fragment,lights_phong_pars_fragment,lights_physical_fragment,lights_physical_pars_fragment,lights_fragment_begin,lights_fragment_maps,lights_fragment_end,logdepthbuf_fragment,logdepthbuf_pars_fragment,logdepthbuf_pars_vertex,logdepthbuf_vertex,map_fragment,map_pars_fragment,map_particle_fragment,map_particle_pars_fragment,metalnessmap_fragment,metalnessmap_pars_fragment,morphcolor_vertex,morphnormal_vertex,morphtarget_pars_vertex,morphtarget_vertex,normal_fragment_begin,normal_fragment_maps,normal_pars_fragment,normal_pars_vertex,normal_vertex,normalmap_pars_fragment,clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps,clearcoat_pars_fragment,iridescence_pars_fragment,opaque_fragment,packing,premultiplied_alpha_fragment,project_vertex,dithering_fragment,dithering_pars_fragment,roughnessmap_fragment,roughnessmap_pars_fragment,shadowmap_pars_fragment,shadowmap_pars_vertex,shadowmap_vertex,shadowmask_pars_fragment,skinbase_vertex,skinning_pars_vertex,skinning_vertex,skinnormal_vertex,specularmap_fragment,specularmap_pars_fragment,tonemapping_fragment,tonemapping_pars_fragment,transmission_fragment,transmission_pars_fragment,uv_pars_fragment,uv_pars_vertex,uv_vertex,worldpos_vertex,background_vert:vertex$h,background_frag:fragment$h,backgroundCube_vert:vertex$g,backgroundCube_frag:fragment$g,cube_vert:vertex$f,cube_frag:fragment$f,depth_vert:vertex$e,depth_frag:fragment$e,distanceRGBA_vert:vertex$d,distanceRGBA_frag:fragment$d,equirect_vert:vertex$c,equirect_frag:fragment$c,linedashed_vert:vertex$b,linedashed_frag:fragment$b,meshbasic_vert:vertex$a,meshbasic_frag:fragment$a,meshlambert_vert:vertex$9,meshlambert_frag:fragment$9,meshmatcap_vert:vertex$8,meshmatcap_frag:fragment$8,meshnormal_vert:vertex$7,meshnormal_frag:fragment$7,meshphong_vert:vertex$6,meshphong_frag:fragment$6,meshphysical_vert:vertex$5,meshphysical_frag:fragment$5,meshtoon_vert:vertex$4,meshtoon_frag:fragment$4,points_vert:vertex$3,points_frag:fragment$3,shadow_vert:vertex$2,shadow_frag:fragment$2,sprite_vert:vertex$1,sprite_frag:fragment$1},UniformsLib={common:{diffuse:{value:new Color(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Matrix3}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Matrix3}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Matrix3}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Matrix3},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Matrix3},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Matrix3},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Matrix3}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Matrix3}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Matrix3}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Color(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(16777215)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Matrix3},alphaMap:{value:null},alphaMapTransform:{value:new Matrix3},alphaTest:{value:0}}},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.meshnormal_vert,fragmentShader:ShaderChunk.meshnormal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:ShaderChunk.backgroundCube_vert,fragmentShader:ShaderChunk.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Matrix3},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Matrix3},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Matrix3},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Matrix3},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Matrix3},sheen:{value:0},sheenColor:{value:new Color(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Matrix3},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Matrix3},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Matrix3},transmissionSamplerSize:{value:new Vector2},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Matrix3},attenuationDistance:{value:0},attenuationColor:{value:new Color(0)},specularColor:{value:new Color(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Matrix3},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Matrix3},anisotropyVector:{value:new Vector2},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Matrix3}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};const _rgb={r:0,b:0,g:0};function WebGLBackground(s,e,t,o,a,c,d){const g=new Color(0);let y=c===!0?0:1,_,E,S=null,A=0,C=null;function N(I,P){let j=!1,B=P.isScene===!0?P.background:null;B&&B.isTexture&&(B=(P.backgroundBlurriness>0?t:e).get(B)),B===null?O(g,y):B&&B.isColor&&(O(B,1),j=!0);const H=s.xr.getEnvironmentBlendMode();H==="additive"?o.buffers.color.setClear(0,0,0,1,d):H==="alpha-blend"&&o.buffers.color.setClear(0,0,0,0,d),(s.autoClear||j)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),B&&(B.isCubeTexture||B.mapping===CubeUVReflectionMapping)?(E===void 0&&(E=new Mesh(new BoxGeometry(1,1,1),new ShaderMaterial({name:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.backgroundCube.uniforms),vertexShader:ShaderLib.backgroundCube.vertexShader,fragmentShader:ShaderLib.backgroundCube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1})),E.geometry.deleteAttribute("normal"),E.geometry.deleteAttribute("uv"),E.onBeforeRender=function(se,oe,Q){this.matrixWorld.copyPosition(Q.matrixWorld)},Object.defineProperty(E.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(E)),E.material.uniforms.envMap.value=B,E.material.uniforms.flipEnvMap.value=B.isCubeTexture&&B.isRenderTargetTexture===!1?-1:1,E.material.uniforms.backgroundBlurriness.value=P.backgroundBlurriness,E.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,E.material.toneMapped=ColorManagement.getTransfer(B.colorSpace)!==SRGBTransfer,(S!==B||A!==B.version||C!==s.toneMapping)&&(E.material.needsUpdate=!0,S=B,A=B.version,C=s.toneMapping),E.layers.enableAll(),I.unshift(E,E.geometry,E.material,0,0,null)):B&&B.isTexture&&(_===void 0&&(_=new Mesh(new PlaneGeometry(2,2),new ShaderMaterial({name:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),Object.defineProperty(_.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(_)),_.material.uniforms.t2D.value=B,_.material.uniforms.backgroundIntensity.value=P.backgroundIntensity,_.material.toneMapped=ColorManagement.getTransfer(B.colorSpace)!==SRGBTransfer,B.matrixAutoUpdate===!0&&B.updateMatrix(),_.material.uniforms.uvTransform.value.copy(B.matrix),(S!==B||A!==B.version||C!==s.toneMapping)&&(_.material.needsUpdate=!0,S=B,A=B.version,C=s.toneMapping),_.layers.enableAll(),I.unshift(_,_.geometry,_.material,0,0,null))}function O(I,P){I.getRGB(_rgb,getUnlitUniformColorSpace(s)),o.buffers.color.setClear(_rgb.r,_rgb.g,_rgb.b,P,d)}return{getClearColor:function(){return g},setClearColor:function(I,P=1){g.set(I),y=P,O(g,y)},getClearAlpha:function(){return y},setClearAlpha:function(I){y=I,O(g,y)},render:N}}function WebGLBindingStates(s,e,t,o){const a=s.getParameter(s.MAX_VERTEX_ATTRIBS),c=o.isWebGL2?null:e.get("OES_vertex_array_object"),d=o.isWebGL2||c!==null,g={},y=I(null);let _=y,E=!1;function S(R,L,z,Y,W){let ee=!1;if(d){const ie=O(Y,z,L);_!==ie&&(_=ie,C(_.object)),ee=P(R,Y,z,W),ee&&j(R,Y,z,W)}else{const ie=L.wireframe===!0;(_.geometry!==Y.id||_.program!==z.id||_.wireframe!==ie)&&(_.geometry=Y.id,_.program=z.id,_.wireframe=ie,ee=!0)}W!==null&&t.update(W,s.ELEMENT_ARRAY_BUFFER),(ee||E)&&(E=!1,fe(R,L,z,Y),W!==null&&s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t.get(W).buffer))}function A(){return o.isWebGL2?s.createVertexArray():c.createVertexArrayOES()}function C(R){return o.isWebGL2?s.bindVertexArray(R):c.bindVertexArrayOES(R)}function N(R){return o.isWebGL2?s.deleteVertexArray(R):c.deleteVertexArrayOES(R)}function O(R,L,z){const Y=z.wireframe===!0;let W=g[R.id];W===void 0&&(W={},g[R.id]=W);let ee=W[L.id];ee===void 0&&(ee={},W[L.id]=ee);let ie=ee[Y];return ie===void 0&&(ie=I(A()),ee[Y]=ie),ie}function I(R){const L=[],z=[],Y=[];for(let W=0;W<a;W++)L[W]=0,z[W]=0,Y[W]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:L,enabledAttributes:z,attributeDivisors:Y,object:R,attributes:{},index:null}}function P(R,L,z,Y){const W=_.attributes,ee=L.attributes;let ie=0;const X=z.getAttributes();for(const F in X)if(X[F].location>=0){const Ee=W[F];let Re=ee[F];if(Re===void 0&&(F==="instanceMatrix"&&R.instanceMatrix&&(Re=R.instanceMatrix),F==="instanceColor"&&R.instanceColor&&(Re=R.instanceColor)),Ee===void 0||Ee.attribute!==Re||Re&&Ee.data!==Re.data)return!0;ie++}return _.attributesNum!==ie||_.index!==Y}function j(R,L,z,Y){const W={},ee=L.attributes;let ie=0;const X=z.getAttributes();for(const F in X)if(X[F].location>=0){let Ee=ee[F];Ee===void 0&&(F==="instanceMatrix"&&R.instanceMatrix&&(Ee=R.instanceMatrix),F==="instanceColor"&&R.instanceColor&&(Ee=R.instanceColor));const Re={};Re.attribute=Ee,Ee&&Ee.data&&(Re.data=Ee.data),W[F]=Re,ie++}_.attributes=W,_.attributesNum=ie,_.index=Y}function B(){const R=_.newAttributes;for(let L=0,z=R.length;L<z;L++)R[L]=0}function H(R){se(R,0)}function se(R,L){const z=_.newAttributes,Y=_.enabledAttributes,W=_.attributeDivisors;z[R]=1,Y[R]===0&&(s.enableVertexAttribArray(R),Y[R]=1),W[R]!==L&&((o.isWebGL2?s:e.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,L),W[R]=L)}function oe(){const R=_.newAttributes,L=_.enabledAttributes;for(let z=0,Y=L.length;z<Y;z++)L[z]!==R[z]&&(s.disableVertexAttribArray(z),L[z]=0)}function Q(R,L,z,Y,W,ee,ie){ie===!0?s.vertexAttribIPointer(R,L,z,W,ee):s.vertexAttribPointer(R,L,z,Y,W,ee)}function fe(R,L,z,Y){if(o.isWebGL2===!1&&(R.isInstancedMesh||Y.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;B();const W=Y.attributes,ee=z.getAttributes(),ie=L.defaultAttributeValues;for(const X in ee){const F=ee[X];if(F.location>=0){let J=W[X];if(J===void 0&&(X==="instanceMatrix"&&R.instanceMatrix&&(J=R.instanceMatrix),X==="instanceColor"&&R.instanceColor&&(J=R.instanceColor)),J!==void 0){const Ee=J.normalized,Re=J.itemSize,Te=t.get(J);if(Te===void 0)continue;const Ue=Te.buffer,ze=Te.type,Ke=Te.bytesPerElement,it=o.isWebGL2===!0&&(ze===s.INT||ze===s.UNSIGNED_INT||J.gpuType===IntType);if(J.isInterleavedBufferAttribute){const Ye=J.data,Ce=Ye.stride,ft=J.offset;if(Ye.isInstancedInterleavedBuffer){for(let Ze=0;Ze<F.locationSize;Ze++)se(F.location+Ze,Ye.meshPerAttribute);R.isInstancedMesh!==!0&&Y._maxInstanceCount===void 0&&(Y._maxInstanceCount=Ye.meshPerAttribute*Ye.count)}else for(let Ze=0;Ze<F.locationSize;Ze++)H(F.location+Ze);s.bindBuffer(s.ARRAY_BUFFER,Ue);for(let Ze=0;Ze<F.locationSize;Ze++)Q(F.location+Ze,Re/F.locationSize,ze,Ee,Ce*Ke,(ft+Re/F.locationSize*Ze)*Ke,it)}else{if(J.isInstancedBufferAttribute){for(let Ye=0;Ye<F.locationSize;Ye++)se(F.location+Ye,J.meshPerAttribute);R.isInstancedMesh!==!0&&Y._maxInstanceCount===void 0&&(Y._maxInstanceCount=J.meshPerAttribute*J.count)}else for(let Ye=0;Ye<F.locationSize;Ye++)H(F.location+Ye);s.bindBuffer(s.ARRAY_BUFFER,Ue);for(let Ye=0;Ye<F.locationSize;Ye++)Q(F.location+Ye,Re/F.locationSize,ze,Ee,Re*Ke,Re/F.locationSize*Ye*Ke,it)}}else if(ie!==void 0){const Ee=ie[X];if(Ee!==void 0)switch(Ee.length){case 2:s.vertexAttrib2fv(F.location,Ee);break;case 3:s.vertexAttrib3fv(F.location,Ee);break;case 4:s.vertexAttrib4fv(F.location,Ee);break;default:s.vertexAttrib1fv(F.location,Ee)}}}}oe()}function Z(){me();for(const R in g){const L=g[R];for(const z in L){const Y=L[z];for(const W in Y)N(Y[W].object),delete Y[W];delete L[z]}delete g[R]}}function ce(R){if(g[R.id]===void 0)return;const L=g[R.id];for(const z in L){const Y=L[z];for(const W in Y)N(Y[W].object),delete Y[W];delete L[z]}delete g[R.id]}function ge(R){for(const L in g){const z=g[L];if(z[R.id]===void 0)continue;const Y=z[R.id];for(const W in Y)N(Y[W].object),delete Y[W];delete z[R.id]}}function me(){V(),E=!0,_!==y&&(_=y,C(_.object))}function V(){y.geometry=null,y.program=null,y.wireframe=!1}return{setup:S,reset:me,resetDefaultState:V,dispose:Z,releaseStatesOfGeometry:ce,releaseStatesOfProgram:ge,initAttributes:B,enableAttribute:H,disableUnusedAttributes:oe}}function WebGLBufferRenderer(s,e,t,o){const a=o.isWebGL2;let c;function d(E){c=E}function g(E,S){s.drawArrays(c,E,S),t.update(S,c,1)}function y(E,S,A){if(A===0)return;let C,N;if(a)C=s,N="drawArraysInstanced";else if(C=e.get("ANGLE_instanced_arrays"),N="drawArraysInstancedANGLE",C===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}C[N](c,E,S,A),t.update(S,c,A)}function _(E,S,A){if(A===0)return;const C=e.get("WEBGL_multi_draw");if(C===null)for(let N=0;N<A;N++)this.render(E[N],S[N]);else{C.multiDrawArraysWEBGL(c,E,0,S,0,A);let N=0;for(let O=0;O<A;O++)N+=S[O];t.update(N,c,1)}}this.setMode=d,this.render=g,this.renderInstances=y,this.renderMultiDraw=_}function WebGLCapabilities(s,e,t){let o;function a(){if(o!==void 0)return o;if(e.has("EXT_texture_filter_anisotropic")===!0){const Q=e.get("EXT_texture_filter_anisotropic");o=s.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function c(Q){if(Q==="highp"){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";Q="mediump"}return Q==="mediump"&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const d=typeof WebGL2RenderingContext<"u"&&s.constructor.name==="WebGL2RenderingContext";let g=t.precision!==void 0?t.precision:"highp";const y=c(g);y!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",y,"instead."),g=y);const _=d||e.has("WEBGL_draw_buffers"),E=t.logarithmicDepthBuffer===!0,S=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),A=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),C=s.getParameter(s.MAX_TEXTURE_SIZE),N=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),O=s.getParameter(s.MAX_VERTEX_ATTRIBS),I=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),P=s.getParameter(s.MAX_VARYING_VECTORS),j=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),B=A>0,H=d||e.has("OES_texture_float"),se=B&&H,oe=d?s.getParameter(s.MAX_SAMPLES):0;return{isWebGL2:d,drawBuffers:_,getMaxAnisotropy:a,getMaxPrecision:c,precision:g,logarithmicDepthBuffer:E,maxTextures:S,maxVertexTextures:A,maxTextureSize:C,maxCubemapSize:N,maxAttributes:O,maxVertexUniforms:I,maxVaryings:P,maxFragmentUniforms:j,vertexTextures:B,floatFragmentTextures:H,floatVertexTextures:se,maxSamples:oe}}function WebGLClipping(s){const e=this;let t=null,o=0,a=!1,c=!1;const d=new Plane,g=new Matrix3,y={value:null,needsUpdate:!1};this.uniform=y,this.numPlanes=0,this.numIntersection=0,this.init=function(S,A){const C=S.length!==0||A||o!==0||a;return a=A,o=S.length,C},this.beginShadows=function(){c=!0,E(null)},this.endShadows=function(){c=!1},this.setGlobalState=function(S,A){t=E(S,A,0)},this.setState=function(S,A,C){const N=S.clippingPlanes,O=S.clipIntersection,I=S.clipShadows,P=s.get(S);if(!a||N===null||N.length===0||c&&!I)c?E(null):_();else{const j=c?0:o,B=j*4;let H=P.clippingState||null;y.value=H,H=E(N,A,B,C);for(let se=0;se!==B;++se)H[se]=t[se];P.clippingState=H,this.numIntersection=O?this.numPlanes:0,this.numPlanes+=j}};function _(){y.value!==t&&(y.value=t,y.needsUpdate=o>0),e.numPlanes=o,e.numIntersection=0}function E(S,A,C,N){const O=S!==null?S.length:0;let I=null;if(O!==0){if(I=y.value,N!==!0||I===null){const P=C+O*4,j=A.matrixWorldInverse;g.getNormalMatrix(j),(I===null||I.length<P)&&(I=new Float32Array(P));for(let B=0,H=C;B!==O;++B,H+=4)d.copy(S[B]).applyMatrix4(j,g),d.normal.toArray(I,H),I[H+3]=d.constant}y.value=I,y.needsUpdate=!0}return e.numPlanes=O,e.numIntersection=0,I}}function WebGLCubeMaps(s){let e=new WeakMap;function t(d,g){return g===EquirectangularReflectionMapping?d.mapping=CubeReflectionMapping:g===EquirectangularRefractionMapping&&(d.mapping=CubeRefractionMapping),d}function o(d){if(d&&d.isTexture){const g=d.mapping;if(g===EquirectangularReflectionMapping||g===EquirectangularRefractionMapping)if(e.has(d)){const y=e.get(d).texture;return t(y,d.mapping)}else{const y=d.image;if(y&&y.height>0){const _=new WebGLCubeRenderTarget(y.height/2);return _.fromEquirectangularTexture(s,d),e.set(d,_),d.addEventListener("dispose",a),t(_.texture,d.mapping)}else return null}}return d}function a(d){const g=d.target;g.removeEventListener("dispose",a);const y=e.get(g);y!==void 0&&(e.delete(g),y.dispose())}function c(){e=new WeakMap}return{get:o,dispose:c}}class OrthographicCamera extends Camera{constructor(e=-1,t=1,o=1,a=-1,c=.1,d=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=o,this.bottom=a,this.near=c,this.far=d,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,o,a,c,d){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=o,this.view.offsetY=a,this.view.width=c,this.view.height=d,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,a=(this.top+this.bottom)/2;let c=o-e,d=o+e,g=a+t,y=a-t;if(this.view!==null&&this.view.enabled){const _=(this.right-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;c+=_*this.view.offsetX,d=c+_*this.view.width,g-=E*this.view.offsetY,y=g-E*this.view.height}this.projectionMatrix.makeOrthographic(c,d,g,y,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const LOD_MIN=4,EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],MAX_SAMPLES=20,_flatCamera=new OrthographicCamera,_clearColor=new Color;let _oldTarget=null,_oldActiveCubeFace=0,_oldActiveMipmapLevel=0;const PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];class PMREMGenerator{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,o=.1,a=100){_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel(),this._setSize(256);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,o,a,c),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_oldTarget,_oldActiveCubeFace,_oldActiveMipmapLevel),e.scissorTest=!1,_setViewport(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===CubeReflectionMapping||e.mapping===CubeRefractionMapping?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_oldTarget=this._renderer.getRenderTarget(),_oldActiveCubeFace=this._renderer.getActiveCubeFace(),_oldActiveMipmapLevel=this._renderer.getActiveMipmapLevel();const o=t||this._allocateTargets();return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,o={magFilter:LinearFilter,minFilter:LinearFilter,generateMipmaps:!1,type:HalfFloatType,format:RGBAFormat,colorSpace:LinearSRGBColorSpace,depthBuffer:!1},a=_createRenderTarget(e,t,o);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=_createRenderTarget(e,t,o);const{_lodMax:c}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_createPlanes(c)),this._blurMaterial=_getBlurShader(c,e,t)}return a}_compileMaterial(e){const t=new Mesh(this._lodPlanes[0],e);this._renderer.compile(t,_flatCamera)}_sceneToCubeUV(e,t,o,a){const g=new PerspectiveCamera(90,1,t,o),y=[1,-1,1,1,1,1],_=[1,1,1,-1,-1,-1],E=this._renderer,S=E.autoClear,A=E.toneMapping;E.getClearColor(_clearColor),E.toneMapping=NoToneMapping,E.autoClear=!1;const C=new MeshBasicMaterial({name:"PMREM.Background",side:BackSide,depthWrite:!1,depthTest:!1}),N=new Mesh(new BoxGeometry,C);let O=!1;const I=e.background;I?I.isColor&&(C.color.copy(I),e.background=null,O=!0):(C.color.copy(_clearColor),O=!0);for(let P=0;P<6;P++){const j=P%3;j===0?(g.up.set(0,y[P],0),g.lookAt(_[P],0,0)):j===1?(g.up.set(0,0,y[P]),g.lookAt(0,_[P],0)):(g.up.set(0,y[P],0),g.lookAt(0,0,_[P]));const B=this._cubeSize;_setViewport(a,j*B,P>2?B:0,B,B),E.setRenderTarget(a),O&&E.render(N,g),E.render(e,g)}N.geometry.dispose(),N.material.dispose(),E.toneMapping=A,E.autoClear=S,e.background=I}_textureToCubeUV(e,t){const o=this._renderer,a=e.mapping===CubeReflectionMapping||e.mapping===CubeRefractionMapping;a?(this._cubemapMaterial===null&&(this._cubemapMaterial=_getCubemapMaterial()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=_getEquirectMaterial());const c=a?this._cubemapMaterial:this._equirectMaterial,d=new Mesh(this._lodPlanes[0],c),g=c.uniforms;g.envMap.value=e;const y=this._cubeSize;_setViewport(t,0,0,3*y,2*y),o.setRenderTarget(t),o.render(d,_flatCamera)}_applyPMREM(e){const t=this._renderer,o=t.autoClear;t.autoClear=!1;for(let a=1;a<this._lodPlanes.length;a++){const c=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),d=_axisDirections[(a-1)%_axisDirections.length];this._blur(e,a-1,a,c,d)}t.autoClear=o}_blur(e,t,o,a,c){const d=this._pingPongRenderTarget;this._halfBlur(e,d,t,o,a,"latitudinal",c),this._halfBlur(d,e,o,o,a,"longitudinal",c)}_halfBlur(e,t,o,a,c,d,g){const y=this._renderer,_=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const E=3,S=new Mesh(this._lodPlanes[a],_),A=_.uniforms,C=this._sizeLods[o]-1,N=isFinite(c)?Math.PI/(2*C):2*Math.PI/(2*MAX_SAMPLES-1),O=c/N,I=isFinite(c)?1+Math.floor(E*O):MAX_SAMPLES;I>MAX_SAMPLES&&console.warn(`sigmaRadians, ${c}, is too large and will clip, as it requested ${I} samples when the maximum is set to ${MAX_SAMPLES}`);const P=[];let j=0;for(let Q=0;Q<MAX_SAMPLES;++Q){const fe=Q/O,Z=Math.exp(-fe*fe/2);P.push(Z),Q===0?j+=Z:Q<I&&(j+=2*Z)}for(let Q=0;Q<P.length;Q++)P[Q]=P[Q]/j;A.envMap.value=e.texture,A.samples.value=I,A.weights.value=P,A.latitudinal.value=d==="latitudinal",g&&(A.poleAxis.value=g);const{_lodMax:B}=this;A.dTheta.value=N,A.mipInt.value=B-o;const H=this._sizeLods[a],se=3*H*(a>B-LOD_MIN?a-B+LOD_MIN:0),oe=4*(this._cubeSize-H);_setViewport(t,se,oe,3*H,2*H),y.setRenderTarget(t),y.render(S,_flatCamera)}}function _createPlanes(s){const e=[],t=[],o=[];let a=s;const c=s-LOD_MIN+1+EXTRA_LOD_SIGMA.length;for(let d=0;d<c;d++){const g=Math.pow(2,a);t.push(g);let y=1/g;d>s-LOD_MIN?y=EXTRA_LOD_SIGMA[d-s+LOD_MIN-1]:d===0&&(y=0),o.push(y);const _=1/(g-2),E=-_,S=1+_,A=[E,E,S,E,S,S,E,E,S,S,E,S],C=6,N=6,O=3,I=2,P=1,j=new Float32Array(O*N*C),B=new Float32Array(I*N*C),H=new Float32Array(P*N*C);for(let oe=0;oe<C;oe++){const Q=oe%3*2/3-1,fe=oe>2?0:-1,Z=[Q,fe,0,Q+2/3,fe,0,Q+2/3,fe+1,0,Q,fe,0,Q+2/3,fe+1,0,Q,fe+1,0];j.set(Z,O*N*oe),B.set(A,I*N*oe);const ce=[oe,oe,oe,oe,oe,oe];H.set(ce,P*N*oe)}const se=new BufferGeometry;se.setAttribute("position",new BufferAttribute(j,O)),se.setAttribute("uv",new BufferAttribute(B,I)),se.setAttribute("faceIndex",new BufferAttribute(H,P)),e.push(se),a>LOD_MIN&&a--}return{lodPlanes:e,sizeLods:t,sigmas:o}}function _createRenderTarget(s,e,t){const o=new WebGLRenderTarget(s,e,t);return o.texture.mapping=CubeUVReflectionMapping,o.texture.name="PMREM.cubeUv",o.scissorTest=!0,o}function _setViewport(s,e,t,o,a){s.viewport.set(e,t,o,a),s.scissor.set(e,t,o,a)}function _getBlurShader(s,e,t){const o=new Float32Array(MAX_SAMPLES),a=new Vector3(0,1,0);return new ShaderMaterial({name:"SphericalGaussianBlur",defines:{n:MAX_SAMPLES,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${s}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:o},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getEquirectMaterial(){return new ShaderMaterial({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCubemapMaterial(){return new ShaderMaterial({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:_getCommonVertexShader(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:NoBlending,depthTest:!1,depthWrite:!1})}function _getCommonVertexShader(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function WebGLCubeUVMaps(s){let e=new WeakMap,t=null;function o(g){if(g&&g.isTexture){const y=g.mapping,_=y===EquirectangularReflectionMapping||y===EquirectangularRefractionMapping,E=y===CubeReflectionMapping||y===CubeRefractionMapping;if(_||E)if(g.isRenderTargetTexture&&g.needsPMREMUpdate===!0){g.needsPMREMUpdate=!1;let S=e.get(g);return t===null&&(t=new PMREMGenerator(s)),S=_?t.fromEquirectangular(g,S):t.fromCubemap(g,S),e.set(g,S),S.texture}else{if(e.has(g))return e.get(g).texture;{const S=g.image;if(_&&S&&S.height>0||E&&S&&a(S)){t===null&&(t=new PMREMGenerator(s));const A=_?t.fromEquirectangular(g):t.fromCubemap(g);return e.set(g,A),g.addEventListener("dispose",c),A.texture}else return null}}}return g}function a(g){let y=0;const _=6;for(let E=0;E<_;E++)g[E]!==void 0&&y++;return y===_}function c(g){const y=g.target;y.removeEventListener("dispose",c);const _=e.get(y);_!==void 0&&(e.delete(y),_.dispose())}function d(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:o,dispose:d}}function WebGLExtensions(s){const e={};function t(o){if(e[o]!==void 0)return e[o];let a;switch(o){case"WEBGL_depth_texture":a=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=s.getExtension(o)}return e[o]=a,a}return{has:function(o){return t(o)!==null},init:function(o){o.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(o){const a=t(o);return a===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),a}}}function WebGLGeometries(s,e,t,o){const a={},c=new WeakMap;function d(S){const A=S.target;A.index!==null&&e.remove(A.index);for(const N in A.attributes)e.remove(A.attributes[N]);for(const N in A.morphAttributes){const O=A.morphAttributes[N];for(let I=0,P=O.length;I<P;I++)e.remove(O[I])}A.removeEventListener("dispose",d),delete a[A.id];const C=c.get(A);C&&(e.remove(C),c.delete(A)),o.releaseStatesOfGeometry(A),A.isInstancedBufferGeometry===!0&&delete A._maxInstanceCount,t.memory.geometries--}function g(S,A){return a[A.id]===!0||(A.addEventListener("dispose",d),a[A.id]=!0,t.memory.geometries++),A}function y(S){const A=S.attributes;for(const N in A)e.update(A[N],s.ARRAY_BUFFER);const C=S.morphAttributes;for(const N in C){const O=C[N];for(let I=0,P=O.length;I<P;I++)e.update(O[I],s.ARRAY_BUFFER)}}function _(S){const A=[],C=S.index,N=S.attributes.position;let O=0;if(C!==null){const j=C.array;O=C.version;for(let B=0,H=j.length;B<H;B+=3){const se=j[B+0],oe=j[B+1],Q=j[B+2];A.push(se,oe,oe,Q,Q,se)}}else if(N!==void 0){const j=N.array;O=N.version;for(let B=0,H=j.length/3-1;B<H;B+=3){const se=B+0,oe=B+1,Q=B+2;A.push(se,oe,oe,Q,Q,se)}}else return;const I=new(arrayNeedsUint32(A)?Uint32BufferAttribute:Uint16BufferAttribute)(A,1);I.version=O;const P=c.get(S);P&&e.remove(P),c.set(S,I)}function E(S){const A=c.get(S);if(A){const C=S.index;C!==null&&A.version<C.version&&_(S)}else _(S);return c.get(S)}return{get:g,update:y,getWireframeAttribute:E}}function WebGLIndexedBufferRenderer(s,e,t,o){const a=o.isWebGL2;let c;function d(C){c=C}let g,y;function _(C){g=C.type,y=C.bytesPerElement}function E(C,N){s.drawElements(c,N,g,C*y),t.update(N,c,1)}function S(C,N,O){if(O===0)return;let I,P;if(a)I=s,P="drawElementsInstanced";else if(I=e.get("ANGLE_instanced_arrays"),P="drawElementsInstancedANGLE",I===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}I[P](c,N,g,C*y,O),t.update(N,c,O)}function A(C,N,O){if(O===0)return;const I=e.get("WEBGL_multi_draw");if(I===null)for(let P=0;P<O;P++)this.render(C[P]/y,N[P]);else{I.multiDrawElementsWEBGL(c,N,0,g,C,0,O);let P=0;for(let j=0;j<O;j++)P+=N[j];t.update(P,c,1)}}this.setMode=d,this.setIndex=_,this.render=E,this.renderInstances=S,this.renderMultiDraw=A}function WebGLInfo(s){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function o(c,d,g){switch(t.calls++,d){case s.TRIANGLES:t.triangles+=g*(c/3);break;case s.LINES:t.lines+=g*(c/2);break;case s.LINE_STRIP:t.lines+=g*(c-1);break;case s.LINE_LOOP:t.lines+=g*c;break;case s.POINTS:t.points+=g*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",d);break}}function a(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:a,update:o}}function numericalSort(s,e){return s[0]-e[0]}function absNumericalSort(s,e){return Math.abs(e[1])-Math.abs(s[1])}function WebGLMorphtargets(s,e,t){const o={},a=new Float32Array(8),c=new WeakMap,d=new Vector4,g=[];for(let _=0;_<8;_++)g[_]=[_,0];function y(_,E,S){const A=_.morphTargetInfluences;if(e.isWebGL2===!0){const C=E.morphAttributes.position||E.morphAttributes.normal||E.morphAttributes.color,N=C!==void 0?C.length:0;let O=c.get(E);if(O===void 0||O.count!==N){let R=function(){me.dispose(),c.delete(E),E.removeEventListener("dispose",R)};O!==void 0&&O.texture.dispose();const j=E.morphAttributes.position!==void 0,B=E.morphAttributes.normal!==void 0,H=E.morphAttributes.color!==void 0,se=E.morphAttributes.position||[],oe=E.morphAttributes.normal||[],Q=E.morphAttributes.color||[];let fe=0;j===!0&&(fe=1),B===!0&&(fe=2),H===!0&&(fe=3);let Z=E.attributes.position.count*fe,ce=1;Z>e.maxTextureSize&&(ce=Math.ceil(Z/e.maxTextureSize),Z=e.maxTextureSize);const ge=new Float32Array(Z*ce*4*N),me=new DataArrayTexture(ge,Z,ce,N);me.type=FloatType,me.needsUpdate=!0;const V=fe*4;for(let L=0;L<N;L++){const z=se[L],Y=oe[L],W=Q[L],ee=Z*ce*4*L;for(let ie=0;ie<z.count;ie++){const X=ie*V;j===!0&&(d.fromBufferAttribute(z,ie),ge[ee+X+0]=d.x,ge[ee+X+1]=d.y,ge[ee+X+2]=d.z,ge[ee+X+3]=0),B===!0&&(d.fromBufferAttribute(Y,ie),ge[ee+X+4]=d.x,ge[ee+X+5]=d.y,ge[ee+X+6]=d.z,ge[ee+X+7]=0),H===!0&&(d.fromBufferAttribute(W,ie),ge[ee+X+8]=d.x,ge[ee+X+9]=d.y,ge[ee+X+10]=d.z,ge[ee+X+11]=W.itemSize===4?d.w:1)}}O={count:N,texture:me,size:new Vector2(Z,ce)},c.set(E,O),E.addEventListener("dispose",R)}let I=0;for(let j=0;j<A.length;j++)I+=A[j];const P=E.morphTargetsRelative?1:1-I;S.getUniforms().setValue(s,"morphTargetBaseInfluence",P),S.getUniforms().setValue(s,"morphTargetInfluences",A),S.getUniforms().setValue(s,"morphTargetsTexture",O.texture,t),S.getUniforms().setValue(s,"morphTargetsTextureSize",O.size)}else{const C=A===void 0?0:A.length;let N=o[E.id];if(N===void 0||N.length!==C){N=[];for(let B=0;B<C;B++)N[B]=[B,0];o[E.id]=N}for(let B=0;B<C;B++){const H=N[B];H[0]=B,H[1]=A[B]}N.sort(absNumericalSort);for(let B=0;B<8;B++)B<C&&N[B][1]?(g[B][0]=N[B][0],g[B][1]=N[B][1]):(g[B][0]=Number.MAX_SAFE_INTEGER,g[B][1]=0);g.sort(numericalSort);const O=E.morphAttributes.position,I=E.morphAttributes.normal;let P=0;for(let B=0;B<8;B++){const H=g[B],se=H[0],oe=H[1];se!==Number.MAX_SAFE_INTEGER&&oe?(O&&E.getAttribute("morphTarget"+B)!==O[se]&&E.setAttribute("morphTarget"+B,O[se]),I&&E.getAttribute("morphNormal"+B)!==I[se]&&E.setAttribute("morphNormal"+B,I[se]),a[B]=oe,P+=oe):(O&&E.hasAttribute("morphTarget"+B)===!0&&E.deleteAttribute("morphTarget"+B),I&&E.hasAttribute("morphNormal"+B)===!0&&E.deleteAttribute("morphNormal"+B),a[B]=0)}const j=E.morphTargetsRelative?1:1-P;S.getUniforms().setValue(s,"morphTargetBaseInfluence",j),S.getUniforms().setValue(s,"morphTargetInfluences",a)}}return{update:y}}function WebGLObjects(s,e,t,o){let a=new WeakMap;function c(y){const _=o.render.frame,E=y.geometry,S=e.get(y,E);if(a.get(S)!==_&&(e.update(S),a.set(S,_)),y.isInstancedMesh&&(y.hasEventListener("dispose",g)===!1&&y.addEventListener("dispose",g),a.get(y)!==_&&(t.update(y.instanceMatrix,s.ARRAY_BUFFER),y.instanceColor!==null&&t.update(y.instanceColor,s.ARRAY_BUFFER),a.set(y,_))),y.isSkinnedMesh){const A=y.skeleton;a.get(A)!==_&&(A.update(),a.set(A,_))}return S}function d(){a=new WeakMap}function g(y){const _=y.target;_.removeEventListener("dispose",g),t.remove(_.instanceMatrix),_.instanceColor!==null&&t.remove(_.instanceColor)}return{update:c,dispose:d}}class DepthTexture extends Texture{constructor(e,t,o,a,c,d,g,y,_,E){if(E=E!==void 0?E:DepthFormat,E!==DepthFormat&&E!==DepthStencilFormat)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&E===DepthFormat&&(o=UnsignedIntType),o===void 0&&E===DepthStencilFormat&&(o=UnsignedInt248Type),super(null,a,c,d,g,y,E,o,_),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=g!==void 0?g:NearestFilter,this.minFilter=y!==void 0?y:NearestFilter,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const emptyTexture=new Texture,emptyShadowTexture=new DepthTexture(1,1);emptyShadowTexture.compareFunction=LessEqualCompare;const emptyArrayTexture=new DataArrayTexture,empty3dTexture=new Data3DTexture,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(s,e,t){const o=s[0];if(o<=0||o>0)return s;const a=e*t;let c=arrayCacheF32[a];if(c===void 0&&(c=new Float32Array(a),arrayCacheF32[a]=c),e!==0){o.toArray(c,0);for(let d=1,g=0;d!==e;++d)g+=t,s[d].toArray(c,g)}return c}function arraysEqual(s,e){if(s.length!==e.length)return!1;for(let t=0,o=s.length;t<o;t++)if(s[t]!==e[t])return!1;return!0}function copyArray(s,e){for(let t=0,o=e.length;t<o;t++)s[t]=e[t]}function allocTexUnits(s,e){let t=arrayCacheI32[e];t===void 0&&(t=new Int32Array(e),arrayCacheI32[e]=t);for(let o=0;o!==e;++o)t[o]=s.allocateTextureUnit();return t}function setValueV1f(s,e){const t=this.cache;t[0]!==e&&(s.uniform1f(this.addr,e),t[0]=e)}function setValueV2f(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(arraysEqual(t,e))return;s.uniform2fv(this.addr,e),copyArray(t,e)}}function setValueV3f(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(arraysEqual(t,e))return;s.uniform3fv(this.addr,e),copyArray(t,e)}}function setValueV4f(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(arraysEqual(t,e))return;s.uniform4fv(this.addr,e),copyArray(t,e)}}function setValueM2(s,e){const t=this.cache,o=e.elements;if(o===void 0){if(arraysEqual(t,e))return;s.uniformMatrix2fv(this.addr,!1,e),copyArray(t,e)}else{if(arraysEqual(t,o))return;mat2array.set(o),s.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(t,o)}}function setValueM3(s,e){const t=this.cache,o=e.elements;if(o===void 0){if(arraysEqual(t,e))return;s.uniformMatrix3fv(this.addr,!1,e),copyArray(t,e)}else{if(arraysEqual(t,o))return;mat3array.set(o),s.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(t,o)}}function setValueM4(s,e){const t=this.cache,o=e.elements;if(o===void 0){if(arraysEqual(t,e))return;s.uniformMatrix4fv(this.addr,!1,e),copyArray(t,e)}else{if(arraysEqual(t,o))return;mat4array.set(o),s.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(t,o)}}function setValueV1i(s,e){const t=this.cache;t[0]!==e&&(s.uniform1i(this.addr,e),t[0]=e)}function setValueV2i(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(arraysEqual(t,e))return;s.uniform2iv(this.addr,e),copyArray(t,e)}}function setValueV3i(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(arraysEqual(t,e))return;s.uniform3iv(this.addr,e),copyArray(t,e)}}function setValueV4i(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(arraysEqual(t,e))return;s.uniform4iv(this.addr,e),copyArray(t,e)}}function setValueV1ui(s,e){const t=this.cache;t[0]!==e&&(s.uniform1ui(this.addr,e),t[0]=e)}function setValueV2ui(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(s.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(arraysEqual(t,e))return;s.uniform2uiv(this.addr,e),copyArray(t,e)}}function setValueV3ui(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(s.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(arraysEqual(t,e))return;s.uniform3uiv(this.addr,e),copyArray(t,e)}}function setValueV4ui(s,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(s.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(arraysEqual(t,e))return;s.uniform4uiv(this.addr,e),copyArray(t,e)}}function setValueT1(s,e,t){const o=this.cache,a=t.allocateTextureUnit();o[0]!==a&&(s.uniform1i(this.addr,a),o[0]=a);const c=this.type===s.SAMPLER_2D_SHADOW?emptyShadowTexture:emptyTexture;t.setTexture2D(e||c,a)}function setValueT3D1(s,e,t){const o=this.cache,a=t.allocateTextureUnit();o[0]!==a&&(s.uniform1i(this.addr,a),o[0]=a),t.setTexture3D(e||empty3dTexture,a)}function setValueT6(s,e,t){const o=this.cache,a=t.allocateTextureUnit();o[0]!==a&&(s.uniform1i(this.addr,a),o[0]=a),t.setTextureCube(e||emptyCubeTexture,a)}function setValueT2DArray1(s,e,t){const o=this.cache,a=t.allocateTextureUnit();o[0]!==a&&(s.uniform1i(this.addr,a),o[0]=a),t.setTexture2DArray(e||emptyArrayTexture,a)}function getSingularSetter(s){switch(s){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 36294:return setValueV2ui;case 36295:return setValueV3ui;case 36296:return setValueV4ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(s,e){s.uniform1fv(this.addr,e)}function setValueV2fArray(s,e){const t=flatten(e,this.size,2);s.uniform2fv(this.addr,t)}function setValueV3fArray(s,e){const t=flatten(e,this.size,3);s.uniform3fv(this.addr,t)}function setValueV4fArray(s,e){const t=flatten(e,this.size,4);s.uniform4fv(this.addr,t)}function setValueM2Array(s,e){const t=flatten(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,t)}function setValueM3Array(s,e){const t=flatten(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,t)}function setValueM4Array(s,e){const t=flatten(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,t)}function setValueV1iArray(s,e){s.uniform1iv(this.addr,e)}function setValueV2iArray(s,e){s.uniform2iv(this.addr,e)}function setValueV3iArray(s,e){s.uniform3iv(this.addr,e)}function setValueV4iArray(s,e){s.uniform4iv(this.addr,e)}function setValueV1uiArray(s,e){s.uniform1uiv(this.addr,e)}function setValueV2uiArray(s,e){s.uniform2uiv(this.addr,e)}function setValueV3uiArray(s,e){s.uniform3uiv(this.addr,e)}function setValueV4uiArray(s,e){s.uniform4uiv(this.addr,e)}function setValueT1Array(s,e,t){const o=this.cache,a=e.length,c=allocTexUnits(t,a);arraysEqual(o,c)||(s.uniform1iv(this.addr,c),copyArray(o,c));for(let d=0;d!==a;++d)t.setTexture2D(e[d]||emptyTexture,c[d])}function setValueT3DArray(s,e,t){const o=this.cache,a=e.length,c=allocTexUnits(t,a);arraysEqual(o,c)||(s.uniform1iv(this.addr,c),copyArray(o,c));for(let d=0;d!==a;++d)t.setTexture3D(e[d]||empty3dTexture,c[d])}function setValueT6Array(s,e,t){const o=this.cache,a=e.length,c=allocTexUnits(t,a);arraysEqual(o,c)||(s.uniform1iv(this.addr,c),copyArray(o,c));for(let d=0;d!==a;++d)t.setTextureCube(e[d]||emptyCubeTexture,c[d])}function setValueT2DArrayArray(s,e,t){const o=this.cache,a=e.length,c=allocTexUnits(t,a);arraysEqual(o,c)||(s.uniform1iv(this.addr,c),copyArray(o,c));for(let d=0;d!==a;++d)t.setTexture2DArray(e[d]||emptyArrayTexture,c[d])}function getPureArraySetter(s){switch(s){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 5125:return setValueV1uiArray;case 36294:return setValueV2uiArray;case 36295:return setValueV3uiArray;case 36296:return setValueV4uiArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35679:case 36299:case 36307:return setValueT3DArray;case 35680:case 36300:case 36308:case 36293:return setValueT6Array;case 36289:case 36303:case 36311:case 36292:return setValueT2DArrayArray}}class SingleUniform{constructor(e,t,o){this.id=e,this.addr=o,this.cache=[],this.type=t.type,this.setValue=getSingularSetter(t.type)}}class PureArrayUniform{constructor(e,t,o){this.id=e,this.addr=o,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=getPureArraySetter(t.type)}}class StructuredUniform{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,o){const a=this.seq;for(let c=0,d=a.length;c!==d;++c){const g=a[c];g.setValue(e,t[g.id],o)}}}const RePathPart=/(\w+)(\])?(\[|\.)?/g;function addUniform(s,e){s.seq.push(e),s.map[e.id]=e}function parseUniform(s,e,t){const o=s.name,a=o.length;for(RePathPart.lastIndex=0;;){const c=RePathPart.exec(o),d=RePathPart.lastIndex;let g=c[1];const y=c[2]==="]",_=c[3];if(y&&(g=g|0),_===void 0||_==="["&&d+2===a){addUniform(t,_===void 0?new SingleUniform(g,s,e):new PureArrayUniform(g,s,e));break}else{let S=t.map[g];S===void 0&&(S=new StructuredUniform(g),addUniform(t,S)),t=S}}}class WebGLUniforms{constructor(e,t){this.seq=[],this.map={};const o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<o;++a){const c=e.getActiveUniform(t,a),d=e.getUniformLocation(t,c.name);parseUniform(c,d,this)}}setValue(e,t,o,a){const c=this.map[t];c!==void 0&&c.setValue(e,o,a)}setOptional(e,t,o){const a=t[o];a!==void 0&&this.setValue(e,o,a)}static upload(e,t,o,a){for(let c=0,d=t.length;c!==d;++c){const g=t[c],y=o[g.id];y.needsUpdate!==!1&&g.setValue(e,y.value,a)}}static seqWithValue(e,t){const o=[];for(let a=0,c=e.length;a!==c;++a){const d=e[a];d.id in t&&o.push(d)}return o}}function WebGLShader(s,e,t){const o=s.createShader(e);return s.shaderSource(o,t),s.compileShader(o),o}const COMPLETION_STATUS_KHR=37297;let programIdCount=0;function handleSource(s,e){const t=s.split(`
`),o=[],a=Math.max(e-6,0),c=Math.min(e+6,t.length);for(let d=a;d<c;d++){const g=d+1;o.push(`${g===e?">":" "} ${g}: ${t[d]}`)}return o.join(`
`)}function getEncodingComponents(s){const e=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),t=ColorManagement.getPrimaries(s);let o;switch(e===t?o="":e===P3Primaries&&t===Rec709Primaries?o="LinearDisplayP3ToLinearSRGB":e===Rec709Primaries&&t===P3Primaries&&(o="LinearSRGBToLinearDisplayP3"),s){case LinearSRGBColorSpace:case LinearDisplayP3ColorSpace:return[o,"LinearTransferOETF"];case SRGBColorSpace:case DisplayP3ColorSpace:return[o,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",s),[o,"LinearTransferOETF"]}}function getShaderErrors(s,e,t){const o=s.getShaderParameter(e,s.COMPILE_STATUS),a=s.getShaderInfoLog(e).trim();if(o&&a==="")return"";const c=/ERROR: 0:(\d+)/.exec(a);if(c){const d=parseInt(c[1]);return t.toUpperCase()+`

`+a+`

`+handleSource(s.getShaderSource(e),d)}else return a}function getTexelEncodingFunction(s,e){const t=getEncodingComponents(e);return`vec4 ${s}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function getToneMappingFunction(s,e){let t;switch(e){case LinearToneMapping:t="Linear";break;case ReinhardToneMapping:t="Reinhard";break;case CineonToneMapping:t="OptimizedCineon";break;case ACESFilmicToneMapping:t="ACESFilmic";break;case AgXToneMapping:t="AgX";break;case CustomToneMapping:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+s+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function generateExtensions(s){return[s.extensionDerivatives||s.envMapCubeUVHeight||s.bumpMap||s.normalMapTangentSpace||s.clearcoatNormalMap||s.flatShading||s.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(s.extensionFragDepth||s.logarithmicDepthBuffer)&&s.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",s.extensionDrawBuffers&&s.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(s.extensionShaderTextureLOD||s.envMap||s.transmission)&&s.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join(`
`)}function generateVertexExtensions(s){return[s.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(filterEmptyLine).join(`
`)}function generateDefines(s){const e=[];for(const t in s){const o=s[t];o!==!1&&e.push("#define "+t+" "+o)}return e.join(`
`)}function fetchAttributeLocations(s,e){const t={},o=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES);for(let a=0;a<o;a++){const c=s.getActiveAttrib(e,a),d=c.name;let g=1;c.type===s.FLOAT_MAT2&&(g=2),c.type===s.FLOAT_MAT3&&(g=3),c.type===s.FLOAT_MAT4&&(g=4),t[d]={type:c.type,location:s.getAttribLocation(e,d),locationSize:g}}return t}function filterEmptyLine(s){return s!==""}function replaceLightNums(s,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function replaceClippingPlaneNums(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(s){return s.replace(includePattern,includeReplacer)}const shaderChunkMap=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function includeReplacer(s,e){let t=ShaderChunk[e];if(t===void 0){const o=shaderChunkMap.get(e);if(o!==void 0)t=ShaderChunk[o],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,o);else throw new Error("Can not resolve #include <"+e+">")}return resolveIncludes(t)}const unrollLoopPattern=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function unrollLoops(s){return s.replace(unrollLoopPattern,loopReplacer)}function loopReplacer(s,e,t,o){let a="";for(let c=parseInt(e);c<parseInt(t);c++)a+=o.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return a}function generatePrecision(s){let e="precision "+s.precision+` float;
precision `+s.precision+" int;";return s.precision==="highp"?e+=`
#define HIGH_PRECISION`:s.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:s.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function generateShadowMapTypeDefine(s){let e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===PCFShadowMap?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===PCFSoftShadowMap?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===VSMShadowMap&&(e="SHADOWMAP_TYPE_VSM"),e}function generateEnvMapTypeDefine(s){let e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:e="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:e="ENVMAP_TYPE_CUBE_UV";break}return e}function generateEnvMapModeDefine(s){let e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case CubeRefractionMapping:e="ENVMAP_MODE_REFRACTION";break}return e}function generateEnvMapBlendingDefine(s){let e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case MultiplyOperation:e="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:e="ENVMAP_BLENDING_MIX";break;case AddOperation:e="ENVMAP_BLENDING_ADD";break}return e}function generateCubeUVSize(s){const e=s.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,o=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:o,maxMip:t}}function WebGLProgram(s,e,t,o){const a=s.getContext(),c=t.defines;let d=t.vertexShader,g=t.fragmentShader;const y=generateShadowMapTypeDefine(t),_=generateEnvMapTypeDefine(t),E=generateEnvMapModeDefine(t),S=generateEnvMapBlendingDefine(t),A=generateCubeUVSize(t),C=t.isWebGL2?"":generateExtensions(t),N=generateVertexExtensions(t),O=generateDefines(c),I=a.createProgram();let P,j,B=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(P=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,O].filter(filterEmptyLine).join(`
`),P.length>0&&(P+=`
`),j=[C,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,O].filter(filterEmptyLine).join(`
`),j.length>0&&(j+=`
`)):(P=[generatePrecision(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,O,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+E:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+y:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(filterEmptyLine).join(`
`),j=[C,generatePrecision(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,O,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+_:"",t.envMap?"#define "+E:"",t.envMap?"#define "+S:"",A?"#define CUBEUV_TEXEL_WIDTH "+A.texelWidth:"",A?"#define CUBEUV_TEXEL_HEIGHT "+A.texelHeight:"",A?"#define CUBEUV_MAX_MIP "+A.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+y:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",t.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",t.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ShaderChunk.colorspace_pars_fragment,getTexelEncodingFunction("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(filterEmptyLine).join(`
`)),d=resolveIncludes(d),d=replaceLightNums(d,t),d=replaceClippingPlaneNums(d,t),g=resolveIncludes(g),g=replaceLightNums(g,t),g=replaceClippingPlaneNums(g,t),d=unrollLoops(d),g=unrollLoops(g),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(B=`#version 300 es
`,P=[N,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+P,j=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===GLSL3?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===GLSL3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+j);const H=B+P+d,se=B+j+g,oe=WebGLShader(a,a.VERTEX_SHADER,H),Q=WebGLShader(a,a.FRAGMENT_SHADER,se);a.attachShader(I,oe),a.attachShader(I,Q),t.index0AttributeName!==void 0?a.bindAttribLocation(I,0,t.index0AttributeName):t.morphTargets===!0&&a.bindAttribLocation(I,0,"position"),a.linkProgram(I);function fe(me){if(s.debug.checkShaderErrors){const V=a.getProgramInfoLog(I).trim(),R=a.getShaderInfoLog(oe).trim(),L=a.getShaderInfoLog(Q).trim();let z=!0,Y=!0;if(a.getProgramParameter(I,a.LINK_STATUS)===!1)if(z=!1,typeof s.debug.onShaderError=="function")s.debug.onShaderError(a,I,oe,Q);else{const W=getShaderErrors(a,oe,"vertex"),ee=getShaderErrors(a,Q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+a.getError()+" - VALIDATE_STATUS "+a.getProgramParameter(I,a.VALIDATE_STATUS)+`

Program Info Log: `+V+`
`+W+`
`+ee)}else V!==""?console.warn("THREE.WebGLProgram: Program Info Log:",V):(R===""||L==="")&&(Y=!1);Y&&(me.diagnostics={runnable:z,programLog:V,vertexShader:{log:R,prefix:P},fragmentShader:{log:L,prefix:j}})}a.deleteShader(oe),a.deleteShader(Q),Z=new WebGLUniforms(a,I),ce=fetchAttributeLocations(a,I)}let Z;this.getUniforms=function(){return Z===void 0&&fe(this),Z};let ce;this.getAttributes=function(){return ce===void 0&&fe(this),ce};let ge=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return ge===!1&&(ge=a.getProgramParameter(I,COMPLETION_STATUS_KHR)),ge},this.destroy=function(){o.releaseStatesOfProgram(this),a.deleteProgram(I),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=programIdCount++,this.cacheKey=e,this.usedTimes=1,this.program=I,this.vertexShader=oe,this.fragmentShader=Q,this}let _id$1=0;class WebGLShaderCache{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,o=e.fragmentShader,a=this._getShaderStage(t),c=this._getShaderStage(o),d=this._getShaderCacheForMaterial(e);return d.has(a)===!1&&(d.add(a),a.usedTimes++),d.has(c)===!1&&(d.add(c),c.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const o of t)o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let o=t.get(e);return o===void 0&&(o=new Set,t.set(e,o)),o}_getShaderStage(e){const t=this.shaderCache;let o=t.get(e);return o===void 0&&(o=new WebGLShaderStage(e),t.set(e,o)),o}}class WebGLShaderStage{constructor(e){this.id=_id$1++,this.code=e,this.usedTimes=0}}function WebGLPrograms(s,e,t,o,a,c,d){const g=new Layers,y=new WebGLShaderCache,_=[],E=a.isWebGL2,S=a.logarithmicDepthBuffer,A=a.vertexTextures;let C=a.precision;const N={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function O(Z){return Z===0?"uv":`uv${Z}`}function I(Z,ce,ge,me,V){const R=me.fog,L=V.geometry,z=Z.isMeshStandardMaterial?me.environment:null,Y=(Z.isMeshStandardMaterial?t:e).get(Z.envMap||z),W=Y&&Y.mapping===CubeUVReflectionMapping?Y.image.height:null,ee=N[Z.type];Z.precision!==null&&(C=a.getMaxPrecision(Z.precision),C!==Z.precision&&console.warn("THREE.WebGLProgram.getParameters:",Z.precision,"not supported, using",C,"instead."));const ie=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,X=ie!==void 0?ie.length:0;let F=0;L.morphAttributes.position!==void 0&&(F=1),L.morphAttributes.normal!==void 0&&(F=2),L.morphAttributes.color!==void 0&&(F=3);let J,Ee,Re,Te;if(ee){const tn=ShaderLib[ee];J=tn.vertexShader,Ee=tn.fragmentShader}else J=Z.vertexShader,Ee=Z.fragmentShader,y.update(Z),Re=y.getVertexShaderID(Z),Te=y.getFragmentShaderID(Z);const Ue=s.getRenderTarget(),ze=V.isInstancedMesh===!0,Ke=V.isBatchedMesh===!0,it=!!Z.map,Ye=!!Z.matcap,Ce=!!Y,ft=!!Z.aoMap,Ze=!!Z.lightMap,nt=!!Z.bumpMap,dt=!!Z.normalMap,gt=!!Z.displacementMap,et=!!Z.emissiveMap,he=!!Z.metalnessMap,ue=!!Z.roughnessMap,_e=Z.anisotropy>0,Ge=Z.clearcoat>0,He=Z.iridescence>0,Ve=Z.sheen>0,pt=Z.transmission>0,We=_e&&!!Z.anisotropyMap,te=Ge&&!!Z.clearcoatMap,U=Ge&&!!Z.clearcoatNormalMap,$=Ge&&!!Z.clearcoatRoughnessMap,ae=He&&!!Z.iridescenceMap,be=He&&!!Z.iridescenceThicknessMap,Se=Ve&&!!Z.sheenColorMap,Ae=Ve&&!!Z.sheenRoughnessMap,Ie=!!Z.specularMap,$e=!!Z.specularColorMap,je=!!Z.specularIntensityMap,lt=pt&&!!Z.transmissionMap,ht=pt&&!!Z.thicknessMap,yt=!!Z.gradientMap,st=!!Z.alphaMap,ye=Z.alphaTest>0,Xe=!!Z.alphaHash,ct=!!Z.extensions,mt=!!L.attributes.uv1,at=!!L.attributes.uv2,Vt=!!L.attributes.uv3;let xt=NoToneMapping;return Z.toneMapped&&(Ue===null||Ue.isXRRenderTarget===!0)&&(xt=s.toneMapping),{isWebGL2:E,shaderID:ee,shaderType:Z.type,shaderName:Z.name,vertexShader:J,fragmentShader:Ee,defines:Z.defines,customVertexShaderID:Re,customFragmentShaderID:Te,isRawShaderMaterial:Z.isRawShaderMaterial===!0,glslVersion:Z.glslVersion,precision:C,batching:Ke,instancing:ze,instancingColor:ze&&V.instanceColor!==null,supportsVertexTextures:A,outputColorSpace:Ue===null?s.outputColorSpace:Ue.isXRRenderTarget===!0?Ue.texture.colorSpace:LinearSRGBColorSpace,map:it,matcap:Ye,envMap:Ce,envMapMode:Ce&&Y.mapping,envMapCubeUVHeight:W,aoMap:ft,lightMap:Ze,bumpMap:nt,normalMap:dt,displacementMap:A&&gt,emissiveMap:et,normalMapObjectSpace:dt&&Z.normalMapType===ObjectSpaceNormalMap,normalMapTangentSpace:dt&&Z.normalMapType===TangentSpaceNormalMap,metalnessMap:he,roughnessMap:ue,anisotropy:_e,anisotropyMap:We,clearcoat:Ge,clearcoatMap:te,clearcoatNormalMap:U,clearcoatRoughnessMap:$,iridescence:He,iridescenceMap:ae,iridescenceThicknessMap:be,sheen:Ve,sheenColorMap:Se,sheenRoughnessMap:Ae,specularMap:Ie,specularColorMap:$e,specularIntensityMap:je,transmission:pt,transmissionMap:lt,thicknessMap:ht,gradientMap:yt,opaque:Z.transparent===!1&&Z.blending===NormalBlending,alphaMap:st,alphaTest:ye,alphaHash:Xe,combine:Z.combine,mapUv:it&&O(Z.map.channel),aoMapUv:ft&&O(Z.aoMap.channel),lightMapUv:Ze&&O(Z.lightMap.channel),bumpMapUv:nt&&O(Z.bumpMap.channel),normalMapUv:dt&&O(Z.normalMap.channel),displacementMapUv:gt&&O(Z.displacementMap.channel),emissiveMapUv:et&&O(Z.emissiveMap.channel),metalnessMapUv:he&&O(Z.metalnessMap.channel),roughnessMapUv:ue&&O(Z.roughnessMap.channel),anisotropyMapUv:We&&O(Z.anisotropyMap.channel),clearcoatMapUv:te&&O(Z.clearcoatMap.channel),clearcoatNormalMapUv:U&&O(Z.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:$&&O(Z.clearcoatRoughnessMap.channel),iridescenceMapUv:ae&&O(Z.iridescenceMap.channel),iridescenceThicknessMapUv:be&&O(Z.iridescenceThicknessMap.channel),sheenColorMapUv:Se&&O(Z.sheenColorMap.channel),sheenRoughnessMapUv:Ae&&O(Z.sheenRoughnessMap.channel),specularMapUv:Ie&&O(Z.specularMap.channel),specularColorMapUv:$e&&O(Z.specularColorMap.channel),specularIntensityMapUv:je&&O(Z.specularIntensityMap.channel),transmissionMapUv:lt&&O(Z.transmissionMap.channel),thicknessMapUv:ht&&O(Z.thicknessMap.channel),alphaMapUv:st&&O(Z.alphaMap.channel),vertexTangents:!!L.attributes.tangent&&(dt||_e),vertexColors:Z.vertexColors,vertexAlphas:Z.vertexColors===!0&&!!L.attributes.color&&L.attributes.color.itemSize===4,vertexUv1s:mt,vertexUv2s:at,vertexUv3s:Vt,pointsUvs:V.isPoints===!0&&!!L.attributes.uv&&(it||st),fog:!!R,useFog:Z.fog===!0,fogExp2:R&&R.isFogExp2,flatShading:Z.flatShading===!0,sizeAttenuation:Z.sizeAttenuation===!0,logarithmicDepthBuffer:S,skinning:V.isSkinnedMesh===!0,morphTargets:L.morphAttributes.position!==void 0,morphNormals:L.morphAttributes.normal!==void 0,morphColors:L.morphAttributes.color!==void 0,morphTargetsCount:X,morphTextureStride:F,numDirLights:ce.directional.length,numPointLights:ce.point.length,numSpotLights:ce.spot.length,numSpotLightMaps:ce.spotLightMap.length,numRectAreaLights:ce.rectArea.length,numHemiLights:ce.hemi.length,numDirLightShadows:ce.directionalShadowMap.length,numPointLightShadows:ce.pointShadowMap.length,numSpotLightShadows:ce.spotShadowMap.length,numSpotLightShadowsWithMaps:ce.numSpotLightShadowsWithMaps,numLightProbes:ce.numLightProbes,numClippingPlanes:d.numPlanes,numClipIntersection:d.numIntersection,dithering:Z.dithering,shadowMapEnabled:s.shadowMap.enabled&&ge.length>0,shadowMapType:s.shadowMap.type,toneMapping:xt,useLegacyLights:s._useLegacyLights,decodeVideoTexture:it&&Z.map.isVideoTexture===!0&&ColorManagement.getTransfer(Z.map.colorSpace)===SRGBTransfer,premultipliedAlpha:Z.premultipliedAlpha,doubleSided:Z.side===DoubleSide,flipSided:Z.side===BackSide,useDepthPacking:Z.depthPacking>=0,depthPacking:Z.depthPacking||0,index0AttributeName:Z.index0AttributeName,extensionDerivatives:ct&&Z.extensions.derivatives===!0,extensionFragDepth:ct&&Z.extensions.fragDepth===!0,extensionDrawBuffers:ct&&Z.extensions.drawBuffers===!0,extensionShaderTextureLOD:ct&&Z.extensions.shaderTextureLOD===!0,extensionClipCullDistance:ct&&Z.extensions.clipCullDistance&&o.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:E||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:E||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:E||o.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:o.has("KHR_parallel_shader_compile"),customProgramCacheKey:Z.customProgramCacheKey()}}function P(Z){const ce=[];if(Z.shaderID?ce.push(Z.shaderID):(ce.push(Z.customVertexShaderID),ce.push(Z.customFragmentShaderID)),Z.defines!==void 0)for(const ge in Z.defines)ce.push(ge),ce.push(Z.defines[ge]);return Z.isRawShaderMaterial===!1&&(j(ce,Z),B(ce,Z),ce.push(s.outputColorSpace)),ce.push(Z.customProgramCacheKey),ce.join()}function j(Z,ce){Z.push(ce.precision),Z.push(ce.outputColorSpace),Z.push(ce.envMapMode),Z.push(ce.envMapCubeUVHeight),Z.push(ce.mapUv),Z.push(ce.alphaMapUv),Z.push(ce.lightMapUv),Z.push(ce.aoMapUv),Z.push(ce.bumpMapUv),Z.push(ce.normalMapUv),Z.push(ce.displacementMapUv),Z.push(ce.emissiveMapUv),Z.push(ce.metalnessMapUv),Z.push(ce.roughnessMapUv),Z.push(ce.anisotropyMapUv),Z.push(ce.clearcoatMapUv),Z.push(ce.clearcoatNormalMapUv),Z.push(ce.clearcoatRoughnessMapUv),Z.push(ce.iridescenceMapUv),Z.push(ce.iridescenceThicknessMapUv),Z.push(ce.sheenColorMapUv),Z.push(ce.sheenRoughnessMapUv),Z.push(ce.specularMapUv),Z.push(ce.specularColorMapUv),Z.push(ce.specularIntensityMapUv),Z.push(ce.transmissionMapUv),Z.push(ce.thicknessMapUv),Z.push(ce.combine),Z.push(ce.fogExp2),Z.push(ce.sizeAttenuation),Z.push(ce.morphTargetsCount),Z.push(ce.morphAttributeCount),Z.push(ce.numDirLights),Z.push(ce.numPointLights),Z.push(ce.numSpotLights),Z.push(ce.numSpotLightMaps),Z.push(ce.numHemiLights),Z.push(ce.numRectAreaLights),Z.push(ce.numDirLightShadows),Z.push(ce.numPointLightShadows),Z.push(ce.numSpotLightShadows),Z.push(ce.numSpotLightShadowsWithMaps),Z.push(ce.numLightProbes),Z.push(ce.shadowMapType),Z.push(ce.toneMapping),Z.push(ce.numClippingPlanes),Z.push(ce.numClipIntersection),Z.push(ce.depthPacking)}function B(Z,ce){g.disableAll(),ce.isWebGL2&&g.enable(0),ce.supportsVertexTextures&&g.enable(1),ce.instancing&&g.enable(2),ce.instancingColor&&g.enable(3),ce.matcap&&g.enable(4),ce.envMap&&g.enable(5),ce.normalMapObjectSpace&&g.enable(6),ce.normalMapTangentSpace&&g.enable(7),ce.clearcoat&&g.enable(8),ce.iridescence&&g.enable(9),ce.alphaTest&&g.enable(10),ce.vertexColors&&g.enable(11),ce.vertexAlphas&&g.enable(12),ce.vertexUv1s&&g.enable(13),ce.vertexUv2s&&g.enable(14),ce.vertexUv3s&&g.enable(15),ce.vertexTangents&&g.enable(16),ce.anisotropy&&g.enable(17),ce.alphaHash&&g.enable(18),ce.batching&&g.enable(19),Z.push(g.mask),g.disableAll(),ce.fog&&g.enable(0),ce.useFog&&g.enable(1),ce.flatShading&&g.enable(2),ce.logarithmicDepthBuffer&&g.enable(3),ce.skinning&&g.enable(4),ce.morphTargets&&g.enable(5),ce.morphNormals&&g.enable(6),ce.morphColors&&g.enable(7),ce.premultipliedAlpha&&g.enable(8),ce.shadowMapEnabled&&g.enable(9),ce.useLegacyLights&&g.enable(10),ce.doubleSided&&g.enable(11),ce.flipSided&&g.enable(12),ce.useDepthPacking&&g.enable(13),ce.dithering&&g.enable(14),ce.transmission&&g.enable(15),ce.sheen&&g.enable(16),ce.opaque&&g.enable(17),ce.pointsUvs&&g.enable(18),ce.decodeVideoTexture&&g.enable(19),Z.push(g.mask)}function H(Z){const ce=N[Z.type];let ge;if(ce){const me=ShaderLib[ce];ge=UniformsUtils.clone(me.uniforms)}else ge=Z.uniforms;return ge}function se(Z,ce){let ge;for(let me=0,V=_.length;me<V;me++){const R=_[me];if(R.cacheKey===ce){ge=R,++ge.usedTimes;break}}return ge===void 0&&(ge=new WebGLProgram(s,ce,Z,c),_.push(ge)),ge}function oe(Z){if(--Z.usedTimes===0){const ce=_.indexOf(Z);_[ce]=_[_.length-1],_.pop(),Z.destroy()}}function Q(Z){y.remove(Z)}function fe(){y.dispose()}return{getParameters:I,getProgramCacheKey:P,getUniforms:H,acquireProgram:se,releaseProgram:oe,releaseShaderCache:Q,programs:_,dispose:fe}}function WebGLProperties(){let s=new WeakMap;function e(c){let d=s.get(c);return d===void 0&&(d={},s.set(c,d)),d}function t(c){s.delete(c)}function o(c,d,g){s.get(c)[d]=g}function a(){s=new WeakMap}return{get:e,remove:t,update:o,dispose:a}}function painterSortStable(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function reversePainterSortStable(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function WebGLRenderList(){const s=[];let e=0;const t=[],o=[],a=[];function c(){e=0,t.length=0,o.length=0,a.length=0}function d(S,A,C,N,O,I){let P=s[e];return P===void 0?(P={id:S.id,object:S,geometry:A,material:C,groupOrder:N,renderOrder:S.renderOrder,z:O,group:I},s[e]=P):(P.id=S.id,P.object=S,P.geometry=A,P.material=C,P.groupOrder=N,P.renderOrder=S.renderOrder,P.z=O,P.group=I),e++,P}function g(S,A,C,N,O,I){const P=d(S,A,C,N,O,I);C.transmission>0?o.push(P):C.transparent===!0?a.push(P):t.push(P)}function y(S,A,C,N,O,I){const P=d(S,A,C,N,O,I);C.transmission>0?o.unshift(P):C.transparent===!0?a.unshift(P):t.unshift(P)}function _(S,A){t.length>1&&t.sort(S||painterSortStable),o.length>1&&o.sort(A||reversePainterSortStable),a.length>1&&a.sort(A||reversePainterSortStable)}function E(){for(let S=e,A=s.length;S<A;S++){const C=s[S];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:t,transmissive:o,transparent:a,init:c,push:g,unshift:y,finish:E,sort:_}}function WebGLRenderLists(){let s=new WeakMap;function e(o,a){const c=s.get(o);let d;return c===void 0?(d=new WebGLRenderList,s.set(o,[d])):a>=c.length?(d=new WebGLRenderList,c.push(d)):d=c[a],d}function t(){s=new WeakMap}return{get:e,dispose:t}}function UniformsCache(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Vector3,color:new Color};break;case"SpotLight":t={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Vector3,color:new Color,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":t={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3};break}return s[e.id]=t,t}}}function ShadowUniformsCache(){const s={};return{get:function(e){if(s[e.id]!==void 0)return s[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break}return s[e.id]=t,t}}}let nextVersion=0;function shadowCastingAndTexturingLightsFirst(s,e){return(e.castShadow?2:0)-(s.castShadow?2:0)+(e.map?1:0)-(s.map?1:0)}function WebGLLights(s,e){const t=new UniformsCache,o=ShadowUniformsCache(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let E=0;E<9;E++)a.probe.push(new Vector3);const c=new Vector3,d=new Matrix4,g=new Matrix4;function y(E,S){let A=0,C=0,N=0;for(let me=0;me<9;me++)a.probe[me].set(0,0,0);let O=0,I=0,P=0,j=0,B=0,H=0,se=0,oe=0,Q=0,fe=0,Z=0;E.sort(shadowCastingAndTexturingLightsFirst);const ce=S===!0?Math.PI:1;for(let me=0,V=E.length;me<V;me++){const R=E[me],L=R.color,z=R.intensity,Y=R.distance,W=R.shadow&&R.shadow.map?R.shadow.map.texture:null;if(R.isAmbientLight)A+=L.r*z*ce,C+=L.g*z*ce,N+=L.b*z*ce;else if(R.isLightProbe){for(let ee=0;ee<9;ee++)a.probe[ee].addScaledVector(R.sh.coefficients[ee],z);Z++}else if(R.isDirectionalLight){const ee=t.get(R);if(ee.color.copy(R.color).multiplyScalar(R.intensity*ce),R.castShadow){const ie=R.shadow,X=o.get(R);X.shadowBias=ie.bias,X.shadowNormalBias=ie.normalBias,X.shadowRadius=ie.radius,X.shadowMapSize=ie.mapSize,a.directionalShadow[O]=X,a.directionalShadowMap[O]=W,a.directionalShadowMatrix[O]=R.shadow.matrix,H++}a.directional[O]=ee,O++}else if(R.isSpotLight){const ee=t.get(R);ee.position.setFromMatrixPosition(R.matrixWorld),ee.color.copy(L).multiplyScalar(z*ce),ee.distance=Y,ee.coneCos=Math.cos(R.angle),ee.penumbraCos=Math.cos(R.angle*(1-R.penumbra)),ee.decay=R.decay,a.spot[P]=ee;const ie=R.shadow;if(R.map&&(a.spotLightMap[Q]=R.map,Q++,ie.updateMatrices(R),R.castShadow&&fe++),a.spotLightMatrix[P]=ie.matrix,R.castShadow){const X=o.get(R);X.shadowBias=ie.bias,X.shadowNormalBias=ie.normalBias,X.shadowRadius=ie.radius,X.shadowMapSize=ie.mapSize,a.spotShadow[P]=X,a.spotShadowMap[P]=W,oe++}P++}else if(R.isRectAreaLight){const ee=t.get(R);ee.color.copy(L).multiplyScalar(z),ee.halfWidth.set(R.width*.5,0,0),ee.halfHeight.set(0,R.height*.5,0),a.rectArea[j]=ee,j++}else if(R.isPointLight){const ee=t.get(R);if(ee.color.copy(R.color).multiplyScalar(R.intensity*ce),ee.distance=R.distance,ee.decay=R.decay,R.castShadow){const ie=R.shadow,X=o.get(R);X.shadowBias=ie.bias,X.shadowNormalBias=ie.normalBias,X.shadowRadius=ie.radius,X.shadowMapSize=ie.mapSize,X.shadowCameraNear=ie.camera.near,X.shadowCameraFar=ie.camera.far,a.pointShadow[I]=X,a.pointShadowMap[I]=W,a.pointShadowMatrix[I]=R.shadow.matrix,se++}a.point[I]=ee,I++}else if(R.isHemisphereLight){const ee=t.get(R);ee.skyColor.copy(R.color).multiplyScalar(z*ce),ee.groundColor.copy(R.groundColor).multiplyScalar(z*ce),a.hemi[B]=ee,B++}}j>0&&(e.isWebGL2?s.has("OES_texture_float_linear")===!0?(a.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,a.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):(a.rectAreaLTC1=UniformsLib.LTC_HALF_1,a.rectAreaLTC2=UniformsLib.LTC_HALF_2):s.has("OES_texture_float_linear")===!0?(a.rectAreaLTC1=UniformsLib.LTC_FLOAT_1,a.rectAreaLTC2=UniformsLib.LTC_FLOAT_2):s.has("OES_texture_half_float_linear")===!0?(a.rectAreaLTC1=UniformsLib.LTC_HALF_1,a.rectAreaLTC2=UniformsLib.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=A,a.ambient[1]=C,a.ambient[2]=N;const ge=a.hash;(ge.directionalLength!==O||ge.pointLength!==I||ge.spotLength!==P||ge.rectAreaLength!==j||ge.hemiLength!==B||ge.numDirectionalShadows!==H||ge.numPointShadows!==se||ge.numSpotShadows!==oe||ge.numSpotMaps!==Q||ge.numLightProbes!==Z)&&(a.directional.length=O,a.spot.length=P,a.rectArea.length=j,a.point.length=I,a.hemi.length=B,a.directionalShadow.length=H,a.directionalShadowMap.length=H,a.pointShadow.length=se,a.pointShadowMap.length=se,a.spotShadow.length=oe,a.spotShadowMap.length=oe,a.directionalShadowMatrix.length=H,a.pointShadowMatrix.length=se,a.spotLightMatrix.length=oe+Q-fe,a.spotLightMap.length=Q,a.numSpotLightShadowsWithMaps=fe,a.numLightProbes=Z,ge.directionalLength=O,ge.pointLength=I,ge.spotLength=P,ge.rectAreaLength=j,ge.hemiLength=B,ge.numDirectionalShadows=H,ge.numPointShadows=se,ge.numSpotShadows=oe,ge.numSpotMaps=Q,ge.numLightProbes=Z,a.version=nextVersion++)}function _(E,S){let A=0,C=0,N=0,O=0,I=0;const P=S.matrixWorldInverse;for(let j=0,B=E.length;j<B;j++){const H=E[j];if(H.isDirectionalLight){const se=a.directional[A];se.direction.setFromMatrixPosition(H.matrixWorld),c.setFromMatrixPosition(H.target.matrixWorld),se.direction.sub(c),se.direction.transformDirection(P),A++}else if(H.isSpotLight){const se=a.spot[N];se.position.setFromMatrixPosition(H.matrixWorld),se.position.applyMatrix4(P),se.direction.setFromMatrixPosition(H.matrixWorld),c.setFromMatrixPosition(H.target.matrixWorld),se.direction.sub(c),se.direction.transformDirection(P),N++}else if(H.isRectAreaLight){const se=a.rectArea[O];se.position.setFromMatrixPosition(H.matrixWorld),se.position.applyMatrix4(P),g.identity(),d.copy(H.matrixWorld),d.premultiply(P),g.extractRotation(d),se.halfWidth.set(H.width*.5,0,0),se.halfHeight.set(0,H.height*.5,0),se.halfWidth.applyMatrix4(g),se.halfHeight.applyMatrix4(g),O++}else if(H.isPointLight){const se=a.point[C];se.position.setFromMatrixPosition(H.matrixWorld),se.position.applyMatrix4(P),C++}else if(H.isHemisphereLight){const se=a.hemi[I];se.direction.setFromMatrixPosition(H.matrixWorld),se.direction.transformDirection(P),I++}}}return{setup:y,setupView:_,state:a}}function WebGLRenderState(s,e){const t=new WebGLLights(s,e),o=[],a=[];function c(){o.length=0,a.length=0}function d(S){o.push(S)}function g(S){a.push(S)}function y(S){t.setup(o,S)}function _(S){t.setupView(o,S)}return{init:c,state:{lightsArray:o,shadowsArray:a,lights:t},setupLights:y,setupLightsView:_,pushLight:d,pushShadow:g}}function WebGLRenderStates(s,e){let t=new WeakMap;function o(c,d=0){const g=t.get(c);let y;return g===void 0?(y=new WebGLRenderState(s,e),t.set(c,[y])):d>=g.length?(y=new WebGLRenderState(s,e),g.push(y)):y=g[d],y}function a(){t=new WeakMap}return{get:o,dispose:a}}class MeshDepthMaterial extends Material{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class MeshDistanceMaterial extends Material{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const vertex=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragment=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function WebGLShadowMap(s,e,t){let o=new Frustum;const a=new Vector2,c=new Vector2,d=new Vector4,g=new MeshDepthMaterial({depthPacking:RGBADepthPacking}),y=new MeshDistanceMaterial,_={},E=t.maxTextureSize,S={[FrontSide]:BackSide,[BackSide]:FrontSide,[DoubleSide]:DoubleSide},A=new ShaderMaterial({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vertex,fragmentShader:fragment}),C=A.clone();C.defines.HORIZONTAL_PASS=1;const N=new BufferGeometry;N.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const O=new Mesh(N,A),I=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap;let P=this.type;this.render=function(oe,Q,fe){if(I.enabled===!1||I.autoUpdate===!1&&I.needsUpdate===!1||oe.length===0)return;const Z=s.getRenderTarget(),ce=s.getActiveCubeFace(),ge=s.getActiveMipmapLevel(),me=s.state;me.setBlending(NoBlending),me.buffers.color.setClear(1,1,1,1),me.buffers.depth.setTest(!0),me.setScissorTest(!1);const V=P!==VSMShadowMap&&this.type===VSMShadowMap,R=P===VSMShadowMap&&this.type!==VSMShadowMap;for(let L=0,z=oe.length;L<z;L++){const Y=oe[L],W=Y.shadow;if(W===void 0){console.warn("THREE.WebGLShadowMap:",Y,"has no shadow.");continue}if(W.autoUpdate===!1&&W.needsUpdate===!1)continue;a.copy(W.mapSize);const ee=W.getFrameExtents();if(a.multiply(ee),c.copy(W.mapSize),(a.x>E||a.y>E)&&(a.x>E&&(c.x=Math.floor(E/ee.x),a.x=c.x*ee.x,W.mapSize.x=c.x),a.y>E&&(c.y=Math.floor(E/ee.y),a.y=c.y*ee.y,W.mapSize.y=c.y)),W.map===null||V===!0||R===!0){const X=this.type!==VSMShadowMap?{minFilter:NearestFilter,magFilter:NearestFilter}:{};W.map!==null&&W.map.dispose(),W.map=new WebGLRenderTarget(a.x,a.y,X),W.map.texture.name=Y.name+".shadowMap",W.camera.updateProjectionMatrix()}s.setRenderTarget(W.map),s.clear();const ie=W.getViewportCount();for(let X=0;X<ie;X++){const F=W.getViewport(X);d.set(c.x*F.x,c.y*F.y,c.x*F.z,c.y*F.w),me.viewport(d),W.updateMatrices(Y,X),o=W.getFrustum(),H(Q,fe,W.camera,Y,this.type)}W.isPointLightShadow!==!0&&this.type===VSMShadowMap&&j(W,fe),W.needsUpdate=!1}P=this.type,I.needsUpdate=!1,s.setRenderTarget(Z,ce,ge)};function j(oe,Q){const fe=e.update(O);A.defines.VSM_SAMPLES!==oe.blurSamples&&(A.defines.VSM_SAMPLES=oe.blurSamples,C.defines.VSM_SAMPLES=oe.blurSamples,A.needsUpdate=!0,C.needsUpdate=!0),oe.mapPass===null&&(oe.mapPass=new WebGLRenderTarget(a.x,a.y)),A.uniforms.shadow_pass.value=oe.map.texture,A.uniforms.resolution.value=oe.mapSize,A.uniforms.radius.value=oe.radius,s.setRenderTarget(oe.mapPass),s.clear(),s.renderBufferDirect(Q,null,fe,A,O,null),C.uniforms.shadow_pass.value=oe.mapPass.texture,C.uniforms.resolution.value=oe.mapSize,C.uniforms.radius.value=oe.radius,s.setRenderTarget(oe.map),s.clear(),s.renderBufferDirect(Q,null,fe,C,O,null)}function B(oe,Q,fe,Z){let ce=null;const ge=fe.isPointLight===!0?oe.customDistanceMaterial:oe.customDepthMaterial;if(ge!==void 0)ce=ge;else if(ce=fe.isPointLight===!0?y:g,s.localClippingEnabled&&Q.clipShadows===!0&&Array.isArray(Q.clippingPlanes)&&Q.clippingPlanes.length!==0||Q.displacementMap&&Q.displacementScale!==0||Q.alphaMap&&Q.alphaTest>0||Q.map&&Q.alphaTest>0){const me=ce.uuid,V=Q.uuid;let R=_[me];R===void 0&&(R={},_[me]=R);let L=R[V];L===void 0&&(L=ce.clone(),R[V]=L,Q.addEventListener("dispose",se)),ce=L}if(ce.visible=Q.visible,ce.wireframe=Q.wireframe,Z===VSMShadowMap?ce.side=Q.shadowSide!==null?Q.shadowSide:Q.side:ce.side=Q.shadowSide!==null?Q.shadowSide:S[Q.side],ce.alphaMap=Q.alphaMap,ce.alphaTest=Q.alphaTest,ce.map=Q.map,ce.clipShadows=Q.clipShadows,ce.clippingPlanes=Q.clippingPlanes,ce.clipIntersection=Q.clipIntersection,ce.displacementMap=Q.displacementMap,ce.displacementScale=Q.displacementScale,ce.displacementBias=Q.displacementBias,ce.wireframeLinewidth=Q.wireframeLinewidth,ce.linewidth=Q.linewidth,fe.isPointLight===!0&&ce.isMeshDistanceMaterial===!0){const me=s.properties.get(ce);me.light=fe}return ce}function H(oe,Q,fe,Z,ce){if(oe.visible===!1)return;if(oe.layers.test(Q.layers)&&(oe.isMesh||oe.isLine||oe.isPoints)&&(oe.castShadow||oe.receiveShadow&&ce===VSMShadowMap)&&(!oe.frustumCulled||o.intersectsObject(oe))){oe.modelViewMatrix.multiplyMatrices(fe.matrixWorldInverse,oe.matrixWorld);const V=e.update(oe),R=oe.material;if(Array.isArray(R)){const L=V.groups;for(let z=0,Y=L.length;z<Y;z++){const W=L[z],ee=R[W.materialIndex];if(ee&&ee.visible){const ie=B(oe,ee,Z,ce);oe.onBeforeShadow(s,oe,Q,fe,V,ie,W),s.renderBufferDirect(fe,null,V,ie,oe,W),oe.onAfterShadow(s,oe,Q,fe,V,ie,W)}}}else if(R.visible){const L=B(oe,R,Z,ce);oe.onBeforeShadow(s,oe,Q,fe,V,L,null),s.renderBufferDirect(fe,null,V,L,oe,null),oe.onAfterShadow(s,oe,Q,fe,V,L,null)}}const me=oe.children;for(let V=0,R=me.length;V<R;V++)H(me[V],Q,fe,Z,ce)}function se(oe){oe.target.removeEventListener("dispose",se);for(const fe in _){const Z=_[fe],ce=oe.target.uuid;ce in Z&&(Z[ce].dispose(),delete Z[ce])}}}function WebGLState(s,e,t){const o=t.isWebGL2;function a(){let ye=!1;const Xe=new Vector4;let ct=null;const mt=new Vector4(0,0,0,0);return{setMask:function(at){ct!==at&&!ye&&(s.colorMask(at,at,at,at),ct=at)},setLocked:function(at){ye=at},setClear:function(at,Vt,xt,It,tn){tn===!0&&(at*=It,Vt*=It,xt*=It),Xe.set(at,Vt,xt,It),mt.equals(Xe)===!1&&(s.clearColor(at,Vt,xt,It),mt.copy(Xe))},reset:function(){ye=!1,ct=null,mt.set(-1,0,0,0)}}}function c(){let ye=!1,Xe=null,ct=null,mt=null;return{setTest:function(at){at?Ke(s.DEPTH_TEST):it(s.DEPTH_TEST)},setMask:function(at){Xe!==at&&!ye&&(s.depthMask(at),Xe=at)},setFunc:function(at){if(ct!==at){switch(at){case NeverDepth:s.depthFunc(s.NEVER);break;case AlwaysDepth:s.depthFunc(s.ALWAYS);break;case LessDepth:s.depthFunc(s.LESS);break;case LessEqualDepth:s.depthFunc(s.LEQUAL);break;case EqualDepth:s.depthFunc(s.EQUAL);break;case GreaterEqualDepth:s.depthFunc(s.GEQUAL);break;case GreaterDepth:s.depthFunc(s.GREATER);break;case NotEqualDepth:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}ct=at}},setLocked:function(at){ye=at},setClear:function(at){mt!==at&&(s.clearDepth(at),mt=at)},reset:function(){ye=!1,Xe=null,ct=null,mt=null}}}function d(){let ye=!1,Xe=null,ct=null,mt=null,at=null,Vt=null,xt=null,It=null,tn=null;return{setTest:function(bt){ye||(bt?Ke(s.STENCIL_TEST):it(s.STENCIL_TEST))},setMask:function(bt){Xe!==bt&&!ye&&(s.stencilMask(bt),Xe=bt)},setFunc:function(bt,Dt,on){(ct!==bt||mt!==Dt||at!==on)&&(s.stencilFunc(bt,Dt,on),ct=bt,mt=Dt,at=on)},setOp:function(bt,Dt,on){(Vt!==bt||xt!==Dt||It!==on)&&(s.stencilOp(bt,Dt,on),Vt=bt,xt=Dt,It=on)},setLocked:function(bt){ye=bt},setClear:function(bt){tn!==bt&&(s.clearStencil(bt),tn=bt)},reset:function(){ye=!1,Xe=null,ct=null,mt=null,at=null,Vt=null,xt=null,It=null,tn=null}}}const g=new a,y=new c,_=new d,E=new WeakMap,S=new WeakMap;let A={},C={},N=new WeakMap,O=[],I=null,P=!1,j=null,B=null,H=null,se=null,oe=null,Q=null,fe=null,Z=new Color(0,0,0),ce=0,ge=!1,me=null,V=null,R=null,L=null,z=null;const Y=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,ee=0;const ie=s.getParameter(s.VERSION);ie.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(ie)[1]),W=ee>=1):ie.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(ie)[1]),W=ee>=2);let X=null,F={};const J=s.getParameter(s.SCISSOR_BOX),Ee=s.getParameter(s.VIEWPORT),Re=new Vector4().fromArray(J),Te=new Vector4().fromArray(Ee);function Ue(ye,Xe,ct,mt){const at=new Uint8Array(4),Vt=s.createTexture();s.bindTexture(ye,Vt),s.texParameteri(ye,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(ye,s.TEXTURE_MAG_FILTER,s.NEAREST);for(let xt=0;xt<ct;xt++)o&&(ye===s.TEXTURE_3D||ye===s.TEXTURE_2D_ARRAY)?s.texImage3D(Xe,0,s.RGBA,1,1,mt,0,s.RGBA,s.UNSIGNED_BYTE,at):s.texImage2D(Xe+xt,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,at);return Vt}const ze={};ze[s.TEXTURE_2D]=Ue(s.TEXTURE_2D,s.TEXTURE_2D,1),ze[s.TEXTURE_CUBE_MAP]=Ue(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),o&&(ze[s.TEXTURE_2D_ARRAY]=Ue(s.TEXTURE_2D_ARRAY,s.TEXTURE_2D_ARRAY,1,1),ze[s.TEXTURE_3D]=Ue(s.TEXTURE_3D,s.TEXTURE_3D,1,1)),g.setClear(0,0,0,1),y.setClear(1),_.setClear(0),Ke(s.DEPTH_TEST),y.setFunc(LessEqualDepth),et(!1),he(CullFaceBack),Ke(s.CULL_FACE),dt(NoBlending);function Ke(ye){A[ye]!==!0&&(s.enable(ye),A[ye]=!0)}function it(ye){A[ye]!==!1&&(s.disable(ye),A[ye]=!1)}function Ye(ye,Xe){return C[ye]!==Xe?(s.bindFramebuffer(ye,Xe),C[ye]=Xe,o&&(ye===s.DRAW_FRAMEBUFFER&&(C[s.FRAMEBUFFER]=Xe),ye===s.FRAMEBUFFER&&(C[s.DRAW_FRAMEBUFFER]=Xe)),!0):!1}function Ce(ye,Xe){let ct=O,mt=!1;if(ye)if(ct=N.get(Xe),ct===void 0&&(ct=[],N.set(Xe,ct)),ye.isWebGLMultipleRenderTargets){const at=ye.texture;if(ct.length!==at.length||ct[0]!==s.COLOR_ATTACHMENT0){for(let Vt=0,xt=at.length;Vt<xt;Vt++)ct[Vt]=s.COLOR_ATTACHMENT0+Vt;ct.length=at.length,mt=!0}}else ct[0]!==s.COLOR_ATTACHMENT0&&(ct[0]=s.COLOR_ATTACHMENT0,mt=!0);else ct[0]!==s.BACK&&(ct[0]=s.BACK,mt=!0);mt&&(t.isWebGL2?s.drawBuffers(ct):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ct))}function ft(ye){return I!==ye?(s.useProgram(ye),I=ye,!0):!1}const Ze={[AddEquation]:s.FUNC_ADD,[SubtractEquation]:s.FUNC_SUBTRACT,[ReverseSubtractEquation]:s.FUNC_REVERSE_SUBTRACT};if(o)Ze[MinEquation]=s.MIN,Ze[MaxEquation]=s.MAX;else{const ye=e.get("EXT_blend_minmax");ye!==null&&(Ze[MinEquation]=ye.MIN_EXT,Ze[MaxEquation]=ye.MAX_EXT)}const nt={[ZeroFactor]:s.ZERO,[OneFactor]:s.ONE,[SrcColorFactor]:s.SRC_COLOR,[SrcAlphaFactor]:s.SRC_ALPHA,[SrcAlphaSaturateFactor]:s.SRC_ALPHA_SATURATE,[DstColorFactor]:s.DST_COLOR,[DstAlphaFactor]:s.DST_ALPHA,[OneMinusSrcColorFactor]:s.ONE_MINUS_SRC_COLOR,[OneMinusSrcAlphaFactor]:s.ONE_MINUS_SRC_ALPHA,[OneMinusDstColorFactor]:s.ONE_MINUS_DST_COLOR,[OneMinusDstAlphaFactor]:s.ONE_MINUS_DST_ALPHA,[ConstantColorFactor]:s.CONSTANT_COLOR,[OneMinusConstantColorFactor]:s.ONE_MINUS_CONSTANT_COLOR,[ConstantAlphaFactor]:s.CONSTANT_ALPHA,[OneMinusConstantAlphaFactor]:s.ONE_MINUS_CONSTANT_ALPHA};function dt(ye,Xe,ct,mt,at,Vt,xt,It,tn,bt){if(ye===NoBlending){P===!0&&(it(s.BLEND),P=!1);return}if(P===!1&&(Ke(s.BLEND),P=!0),ye!==CustomBlending){if(ye!==j||bt!==ge){if((B!==AddEquation||oe!==AddEquation)&&(s.blendEquation(s.FUNC_ADD),B=AddEquation,oe=AddEquation),bt)switch(ye){case NormalBlending:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:s.blendFunc(s.ONE,s.ONE);break;case SubtractiveBlending:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case MultiplyBlending:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}else switch(ye){case NormalBlending:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case SubtractiveBlending:s.blendFuncSeparate(s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ZERO,s.ONE);break;case MultiplyBlending:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}H=null,se=null,Q=null,fe=null,Z.set(0,0,0),ce=0,j=ye,ge=bt}return}at=at||Xe,Vt=Vt||ct,xt=xt||mt,(Xe!==B||at!==oe)&&(s.blendEquationSeparate(Ze[Xe],Ze[at]),B=Xe,oe=at),(ct!==H||mt!==se||Vt!==Q||xt!==fe)&&(s.blendFuncSeparate(nt[ct],nt[mt],nt[Vt],nt[xt]),H=ct,se=mt,Q=Vt,fe=xt),(It.equals(Z)===!1||tn!==ce)&&(s.blendColor(It.r,It.g,It.b,tn),Z.copy(It),ce=tn),j=ye,ge=!1}function gt(ye,Xe){ye.side===DoubleSide?it(s.CULL_FACE):Ke(s.CULL_FACE);let ct=ye.side===BackSide;Xe&&(ct=!ct),et(ct),ye.blending===NormalBlending&&ye.transparent===!1?dt(NoBlending):dt(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.blendColor,ye.blendAlpha,ye.premultipliedAlpha),y.setFunc(ye.depthFunc),y.setTest(ye.depthTest),y.setMask(ye.depthWrite),g.setMask(ye.colorWrite);const mt=ye.stencilWrite;_.setTest(mt),mt&&(_.setMask(ye.stencilWriteMask),_.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),_.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),_e(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?Ke(s.SAMPLE_ALPHA_TO_COVERAGE):it(s.SAMPLE_ALPHA_TO_COVERAGE)}function et(ye){me!==ye&&(ye?s.frontFace(s.CW):s.frontFace(s.CCW),me=ye)}function he(ye){ye!==CullFaceNone?(Ke(s.CULL_FACE),ye!==V&&(ye===CullFaceBack?s.cullFace(s.BACK):ye===CullFaceFront?s.cullFace(s.FRONT):s.cullFace(s.FRONT_AND_BACK))):it(s.CULL_FACE),V=ye}function ue(ye){ye!==R&&(W&&s.lineWidth(ye),R=ye)}function _e(ye,Xe,ct){ye?(Ke(s.POLYGON_OFFSET_FILL),(L!==Xe||z!==ct)&&(s.polygonOffset(Xe,ct),L=Xe,z=ct)):it(s.POLYGON_OFFSET_FILL)}function Ge(ye){ye?Ke(s.SCISSOR_TEST):it(s.SCISSOR_TEST)}function He(ye){ye===void 0&&(ye=s.TEXTURE0+Y-1),X!==ye&&(s.activeTexture(ye),X=ye)}function Ve(ye,Xe,ct){ct===void 0&&(X===null?ct=s.TEXTURE0+Y-1:ct=X);let mt=F[ct];mt===void 0&&(mt={type:void 0,texture:void 0},F[ct]=mt),(mt.type!==ye||mt.texture!==Xe)&&(X!==ct&&(s.activeTexture(ct),X=ct),s.bindTexture(ye,Xe||ze[ye]),mt.type=ye,mt.texture=Xe)}function pt(){const ye=F[X];ye!==void 0&&ye.type!==void 0&&(s.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function We(){try{s.compressedTexImage2D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function te(){try{s.compressedTexImage3D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function U(){try{s.texSubImage2D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function $(){try{s.texSubImage3D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ae(){try{s.compressedTexSubImage2D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function be(){try{s.compressedTexSubImage3D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Se(){try{s.texStorage2D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ae(){try{s.texStorage3D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Ie(){try{s.texImage2D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function $e(){try{s.texImage3D.apply(s,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function je(ye){Re.equals(ye)===!1&&(s.scissor(ye.x,ye.y,ye.z,ye.w),Re.copy(ye))}function lt(ye){Te.equals(ye)===!1&&(s.viewport(ye.x,ye.y,ye.z,ye.w),Te.copy(ye))}function ht(ye,Xe){let ct=S.get(Xe);ct===void 0&&(ct=new WeakMap,S.set(Xe,ct));let mt=ct.get(ye);mt===void 0&&(mt=s.getUniformBlockIndex(Xe,ye.name),ct.set(ye,mt))}function yt(ye,Xe){const mt=S.get(Xe).get(ye);E.get(Xe)!==mt&&(s.uniformBlockBinding(Xe,mt,ye.__bindingPointIndex),E.set(Xe,mt))}function st(){s.disable(s.BLEND),s.disable(s.CULL_FACE),s.disable(s.DEPTH_TEST),s.disable(s.POLYGON_OFFSET_FILL),s.disable(s.SCISSOR_TEST),s.disable(s.STENCIL_TEST),s.disable(s.SAMPLE_ALPHA_TO_COVERAGE),s.blendEquation(s.FUNC_ADD),s.blendFunc(s.ONE,s.ZERO),s.blendFuncSeparate(s.ONE,s.ZERO,s.ONE,s.ZERO),s.blendColor(0,0,0,0),s.colorMask(!0,!0,!0,!0),s.clearColor(0,0,0,0),s.depthMask(!0),s.depthFunc(s.LESS),s.clearDepth(1),s.stencilMask(4294967295),s.stencilFunc(s.ALWAYS,0,4294967295),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),s.clearStencil(0),s.cullFace(s.BACK),s.frontFace(s.CCW),s.polygonOffset(0,0),s.activeTexture(s.TEXTURE0),s.bindFramebuffer(s.FRAMEBUFFER,null),o===!0&&(s.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),s.bindFramebuffer(s.READ_FRAMEBUFFER,null)),s.useProgram(null),s.lineWidth(1),s.scissor(0,0,s.canvas.width,s.canvas.height),s.viewport(0,0,s.canvas.width,s.canvas.height),A={},X=null,F={},C={},N=new WeakMap,O=[],I=null,P=!1,j=null,B=null,H=null,se=null,oe=null,Q=null,fe=null,Z=new Color(0,0,0),ce=0,ge=!1,me=null,V=null,R=null,L=null,z=null,Re.set(0,0,s.canvas.width,s.canvas.height),Te.set(0,0,s.canvas.width,s.canvas.height),g.reset(),y.reset(),_.reset()}return{buffers:{color:g,depth:y,stencil:_},enable:Ke,disable:it,bindFramebuffer:Ye,drawBuffers:Ce,useProgram:ft,setBlending:dt,setMaterial:gt,setFlipSided:et,setCullFace:he,setLineWidth:ue,setPolygonOffset:_e,setScissorTest:Ge,activeTexture:He,bindTexture:Ve,unbindTexture:pt,compressedTexImage2D:We,compressedTexImage3D:te,texImage2D:Ie,texImage3D:$e,updateUBOMapping:ht,uniformBlockBinding:yt,texStorage2D:Se,texStorage3D:Ae,texSubImage2D:U,texSubImage3D:$,compressedTexSubImage2D:ae,compressedTexSubImage3D:be,scissor:je,viewport:lt,reset:st}}function WebGLTextures(s,e,t,o,a,c,d){const g=a.isWebGL2,y=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,_=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),E=new WeakMap;let S;const A=new WeakMap;let C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function N(he,ue){return C?new OffscreenCanvas(he,ue):createElementNS("canvas")}function O(he,ue,_e,Ge){let He=1;if((he.width>Ge||he.height>Ge)&&(He=Ge/Math.max(he.width,he.height)),He<1||ue===!0)if(typeof HTMLImageElement<"u"&&he instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&he instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&he instanceof ImageBitmap){const Ve=ue?floorPowerOfTwo:Math.floor,pt=Ve(He*he.width),We=Ve(He*he.height);S===void 0&&(S=N(pt,We));const te=_e?N(pt,We):S;return te.width=pt,te.height=We,te.getContext("2d").drawImage(he,0,0,pt,We),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+he.width+"x"+he.height+") to ("+pt+"x"+We+")."),te}else return"data"in he&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+he.width+"x"+he.height+")."),he;return he}function I(he){return isPowerOfTwo(he.width)&&isPowerOfTwo(he.height)}function P(he){return g?!1:he.wrapS!==ClampToEdgeWrapping||he.wrapT!==ClampToEdgeWrapping||he.minFilter!==NearestFilter&&he.minFilter!==LinearFilter}function j(he,ue){return he.generateMipmaps&&ue&&he.minFilter!==NearestFilter&&he.minFilter!==LinearFilter}function B(he){s.generateMipmap(he)}function H(he,ue,_e,Ge,He=!1){if(g===!1)return ue;if(he!==null){if(s[he]!==void 0)return s[he];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+he+"'")}let Ve=ue;if(ue===s.RED&&(_e===s.FLOAT&&(Ve=s.R32F),_e===s.HALF_FLOAT&&(Ve=s.R16F),_e===s.UNSIGNED_BYTE&&(Ve=s.R8)),ue===s.RED_INTEGER&&(_e===s.UNSIGNED_BYTE&&(Ve=s.R8UI),_e===s.UNSIGNED_SHORT&&(Ve=s.R16UI),_e===s.UNSIGNED_INT&&(Ve=s.R32UI),_e===s.BYTE&&(Ve=s.R8I),_e===s.SHORT&&(Ve=s.R16I),_e===s.INT&&(Ve=s.R32I)),ue===s.RG&&(_e===s.FLOAT&&(Ve=s.RG32F),_e===s.HALF_FLOAT&&(Ve=s.RG16F),_e===s.UNSIGNED_BYTE&&(Ve=s.RG8)),ue===s.RGBA){const pt=He?LinearTransfer:ColorManagement.getTransfer(Ge);_e===s.FLOAT&&(Ve=s.RGBA32F),_e===s.HALF_FLOAT&&(Ve=s.RGBA16F),_e===s.UNSIGNED_BYTE&&(Ve=pt===SRGBTransfer?s.SRGB8_ALPHA8:s.RGBA8),_e===s.UNSIGNED_SHORT_4_4_4_4&&(Ve=s.RGBA4),_e===s.UNSIGNED_SHORT_5_5_5_1&&(Ve=s.RGB5_A1)}return(Ve===s.R16F||Ve===s.R32F||Ve===s.RG16F||Ve===s.RG32F||Ve===s.RGBA16F||Ve===s.RGBA32F)&&e.get("EXT_color_buffer_float"),Ve}function se(he,ue,_e){return j(he,_e)===!0||he.isFramebufferTexture&&he.minFilter!==NearestFilter&&he.minFilter!==LinearFilter?Math.log2(Math.max(ue.width,ue.height))+1:he.mipmaps!==void 0&&he.mipmaps.length>0?he.mipmaps.length:he.isCompressedTexture&&Array.isArray(he.image)?ue.mipmaps.length:1}function oe(he){return he===NearestFilter||he===NearestMipmapNearestFilter||he===NearestMipmapLinearFilter?s.NEAREST:s.LINEAR}function Q(he){const ue=he.target;ue.removeEventListener("dispose",Q),Z(ue),ue.isVideoTexture&&E.delete(ue)}function fe(he){const ue=he.target;ue.removeEventListener("dispose",fe),ge(ue)}function Z(he){const ue=o.get(he);if(ue.__webglInit===void 0)return;const _e=he.source,Ge=A.get(_e);if(Ge){const He=Ge[ue.__cacheKey];He.usedTimes--,He.usedTimes===0&&ce(he),Object.keys(Ge).length===0&&A.delete(_e)}o.remove(he)}function ce(he){const ue=o.get(he);s.deleteTexture(ue.__webglTexture);const _e=he.source,Ge=A.get(_e);delete Ge[ue.__cacheKey],d.memory.textures--}function ge(he){const ue=he.texture,_e=o.get(he),Ge=o.get(ue);if(Ge.__webglTexture!==void 0&&(s.deleteTexture(Ge.__webglTexture),d.memory.textures--),he.depthTexture&&he.depthTexture.dispose(),he.isWebGLCubeRenderTarget)for(let He=0;He<6;He++){if(Array.isArray(_e.__webglFramebuffer[He]))for(let Ve=0;Ve<_e.__webglFramebuffer[He].length;Ve++)s.deleteFramebuffer(_e.__webglFramebuffer[He][Ve]);else s.deleteFramebuffer(_e.__webglFramebuffer[He]);_e.__webglDepthbuffer&&s.deleteRenderbuffer(_e.__webglDepthbuffer[He])}else{if(Array.isArray(_e.__webglFramebuffer))for(let He=0;He<_e.__webglFramebuffer.length;He++)s.deleteFramebuffer(_e.__webglFramebuffer[He]);else s.deleteFramebuffer(_e.__webglFramebuffer);if(_e.__webglDepthbuffer&&s.deleteRenderbuffer(_e.__webglDepthbuffer),_e.__webglMultisampledFramebuffer&&s.deleteFramebuffer(_e.__webglMultisampledFramebuffer),_e.__webglColorRenderbuffer)for(let He=0;He<_e.__webglColorRenderbuffer.length;He++)_e.__webglColorRenderbuffer[He]&&s.deleteRenderbuffer(_e.__webglColorRenderbuffer[He]);_e.__webglDepthRenderbuffer&&s.deleteRenderbuffer(_e.__webglDepthRenderbuffer)}if(he.isWebGLMultipleRenderTargets)for(let He=0,Ve=ue.length;He<Ve;He++){const pt=o.get(ue[He]);pt.__webglTexture&&(s.deleteTexture(pt.__webglTexture),d.memory.textures--),o.remove(ue[He])}o.remove(ue),o.remove(he)}let me=0;function V(){me=0}function R(){const he=me;return he>=a.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+he+" texture units while this GPU supports only "+a.maxTextures),me+=1,he}function L(he){const ue=[];return ue.push(he.wrapS),ue.push(he.wrapT),ue.push(he.wrapR||0),ue.push(he.magFilter),ue.push(he.minFilter),ue.push(he.anisotropy),ue.push(he.internalFormat),ue.push(he.format),ue.push(he.type),ue.push(he.generateMipmaps),ue.push(he.premultiplyAlpha),ue.push(he.flipY),ue.push(he.unpackAlignment),ue.push(he.colorSpace),ue.join()}function z(he,ue){const _e=o.get(he);if(he.isVideoTexture&&gt(he),he.isRenderTargetTexture===!1&&he.version>0&&_e.__version!==he.version){const Ge=he.image;if(Ge===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Re(_e,he,ue);return}}t.bindTexture(s.TEXTURE_2D,_e.__webglTexture,s.TEXTURE0+ue)}function Y(he,ue){const _e=o.get(he);if(he.version>0&&_e.__version!==he.version){Re(_e,he,ue);return}t.bindTexture(s.TEXTURE_2D_ARRAY,_e.__webglTexture,s.TEXTURE0+ue)}function W(he,ue){const _e=o.get(he);if(he.version>0&&_e.__version!==he.version){Re(_e,he,ue);return}t.bindTexture(s.TEXTURE_3D,_e.__webglTexture,s.TEXTURE0+ue)}function ee(he,ue){const _e=o.get(he);if(he.version>0&&_e.__version!==he.version){Te(_e,he,ue);return}t.bindTexture(s.TEXTURE_CUBE_MAP,_e.__webglTexture,s.TEXTURE0+ue)}const ie={[RepeatWrapping]:s.REPEAT,[ClampToEdgeWrapping]:s.CLAMP_TO_EDGE,[MirroredRepeatWrapping]:s.MIRRORED_REPEAT},X={[NearestFilter]:s.NEAREST,[NearestMipmapNearestFilter]:s.NEAREST_MIPMAP_NEAREST,[NearestMipmapLinearFilter]:s.NEAREST_MIPMAP_LINEAR,[LinearFilter]:s.LINEAR,[LinearMipmapNearestFilter]:s.LINEAR_MIPMAP_NEAREST,[LinearMipmapLinearFilter]:s.LINEAR_MIPMAP_LINEAR},F={[NeverCompare]:s.NEVER,[AlwaysCompare]:s.ALWAYS,[LessCompare]:s.LESS,[LessEqualCompare]:s.LEQUAL,[EqualCompare]:s.EQUAL,[GreaterEqualCompare]:s.GEQUAL,[GreaterCompare]:s.GREATER,[NotEqualCompare]:s.NOTEQUAL};function J(he,ue,_e){if(_e?(s.texParameteri(he,s.TEXTURE_WRAP_S,ie[ue.wrapS]),s.texParameteri(he,s.TEXTURE_WRAP_T,ie[ue.wrapT]),(he===s.TEXTURE_3D||he===s.TEXTURE_2D_ARRAY)&&s.texParameteri(he,s.TEXTURE_WRAP_R,ie[ue.wrapR]),s.texParameteri(he,s.TEXTURE_MAG_FILTER,X[ue.magFilter]),s.texParameteri(he,s.TEXTURE_MIN_FILTER,X[ue.minFilter])):(s.texParameteri(he,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(he,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),(he===s.TEXTURE_3D||he===s.TEXTURE_2D_ARRAY)&&s.texParameteri(he,s.TEXTURE_WRAP_R,s.CLAMP_TO_EDGE),(ue.wrapS!==ClampToEdgeWrapping||ue.wrapT!==ClampToEdgeWrapping)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),s.texParameteri(he,s.TEXTURE_MAG_FILTER,oe(ue.magFilter)),s.texParameteri(he,s.TEXTURE_MIN_FILTER,oe(ue.minFilter)),ue.minFilter!==NearestFilter&&ue.minFilter!==LinearFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),ue.compareFunction&&(s.texParameteri(he,s.TEXTURE_COMPARE_MODE,s.COMPARE_REF_TO_TEXTURE),s.texParameteri(he,s.TEXTURE_COMPARE_FUNC,F[ue.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Ge=e.get("EXT_texture_filter_anisotropic");if(ue.magFilter===NearestFilter||ue.minFilter!==NearestMipmapLinearFilter&&ue.minFilter!==LinearMipmapLinearFilter||ue.type===FloatType&&e.has("OES_texture_float_linear")===!1||g===!1&&ue.type===HalfFloatType&&e.has("OES_texture_half_float_linear")===!1)return;(ue.anisotropy>1||o.get(ue).__currentAnisotropy)&&(s.texParameterf(he,Ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ue.anisotropy,a.getMaxAnisotropy())),o.get(ue).__currentAnisotropy=ue.anisotropy)}}function Ee(he,ue){let _e=!1;he.__webglInit===void 0&&(he.__webglInit=!0,ue.addEventListener("dispose",Q));const Ge=ue.source;let He=A.get(Ge);He===void 0&&(He={},A.set(Ge,He));const Ve=L(ue);if(Ve!==he.__cacheKey){He[Ve]===void 0&&(He[Ve]={texture:s.createTexture(),usedTimes:0},d.memory.textures++,_e=!0),He[Ve].usedTimes++;const pt=He[he.__cacheKey];pt!==void 0&&(He[he.__cacheKey].usedTimes--,pt.usedTimes===0&&ce(ue)),he.__cacheKey=Ve,he.__webglTexture=He[Ve].texture}return _e}function Re(he,ue,_e){let Ge=s.TEXTURE_2D;(ue.isDataArrayTexture||ue.isCompressedArrayTexture)&&(Ge=s.TEXTURE_2D_ARRAY),ue.isData3DTexture&&(Ge=s.TEXTURE_3D);const He=Ee(he,ue),Ve=ue.source;t.bindTexture(Ge,he.__webglTexture,s.TEXTURE0+_e);const pt=o.get(Ve);if(Ve.version!==pt.__version||He===!0){t.activeTexture(s.TEXTURE0+_e);const We=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),te=ue.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(ue.colorSpace),U=ue.colorSpace===NoColorSpace||We===te?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,ue.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,ue.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,U);const $=P(ue)&&I(ue.image)===!1;let ae=O(ue.image,$,!1,a.maxTextureSize);ae=et(ue,ae);const be=I(ae)||g,Se=c.convert(ue.format,ue.colorSpace);let Ae=c.convert(ue.type),Ie=H(ue.internalFormat,Se,Ae,ue.colorSpace,ue.isVideoTexture);J(Ge,ue,be);let $e;const je=ue.mipmaps,lt=g&&ue.isVideoTexture!==!0&&Ie!==RGB_ETC1_Format,ht=pt.__version===void 0||He===!0,yt=se(ue,ae,be);if(ue.isDepthTexture)Ie=s.DEPTH_COMPONENT,g?ue.type===FloatType?Ie=s.DEPTH_COMPONENT32F:ue.type===UnsignedIntType?Ie=s.DEPTH_COMPONENT24:ue.type===UnsignedInt248Type?Ie=s.DEPTH24_STENCIL8:Ie=s.DEPTH_COMPONENT16:ue.type===FloatType&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ue.format===DepthFormat&&Ie===s.DEPTH_COMPONENT&&ue.type!==UnsignedShortType&&ue.type!==UnsignedIntType&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ue.type=UnsignedIntType,Ae=c.convert(ue.type)),ue.format===DepthStencilFormat&&Ie===s.DEPTH_COMPONENT&&(Ie=s.DEPTH_STENCIL,ue.type!==UnsignedInt248Type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ue.type=UnsignedInt248Type,Ae=c.convert(ue.type))),ht&&(lt?t.texStorage2D(s.TEXTURE_2D,1,Ie,ae.width,ae.height):t.texImage2D(s.TEXTURE_2D,0,Ie,ae.width,ae.height,0,Se,Ae,null));else if(ue.isDataTexture)if(je.length>0&&be){lt&&ht&&t.texStorage2D(s.TEXTURE_2D,yt,Ie,je[0].width,je[0].height);for(let st=0,ye=je.length;st<ye;st++)$e=je[st],lt?t.texSubImage2D(s.TEXTURE_2D,st,0,0,$e.width,$e.height,Se,Ae,$e.data):t.texImage2D(s.TEXTURE_2D,st,Ie,$e.width,$e.height,0,Se,Ae,$e.data);ue.generateMipmaps=!1}else lt?(ht&&t.texStorage2D(s.TEXTURE_2D,yt,Ie,ae.width,ae.height),t.texSubImage2D(s.TEXTURE_2D,0,0,0,ae.width,ae.height,Se,Ae,ae.data)):t.texImage2D(s.TEXTURE_2D,0,Ie,ae.width,ae.height,0,Se,Ae,ae.data);else if(ue.isCompressedTexture)if(ue.isCompressedArrayTexture){lt&&ht&&t.texStorage3D(s.TEXTURE_2D_ARRAY,yt,Ie,je[0].width,je[0].height,ae.depth);for(let st=0,ye=je.length;st<ye;st++)$e=je[st],ue.format!==RGBAFormat?Se!==null?lt?t.compressedTexSubImage3D(s.TEXTURE_2D_ARRAY,st,0,0,0,$e.width,$e.height,ae.depth,Se,$e.data,0,0):t.compressedTexImage3D(s.TEXTURE_2D_ARRAY,st,Ie,$e.width,$e.height,ae.depth,0,$e.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):lt?t.texSubImage3D(s.TEXTURE_2D_ARRAY,st,0,0,0,$e.width,$e.height,ae.depth,Se,Ae,$e.data):t.texImage3D(s.TEXTURE_2D_ARRAY,st,Ie,$e.width,$e.height,ae.depth,0,Se,Ae,$e.data)}else{lt&&ht&&t.texStorage2D(s.TEXTURE_2D,yt,Ie,je[0].width,je[0].height);for(let st=0,ye=je.length;st<ye;st++)$e=je[st],ue.format!==RGBAFormat?Se!==null?lt?t.compressedTexSubImage2D(s.TEXTURE_2D,st,0,0,$e.width,$e.height,Se,$e.data):t.compressedTexImage2D(s.TEXTURE_2D,st,Ie,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):lt?t.texSubImage2D(s.TEXTURE_2D,st,0,0,$e.width,$e.height,Se,Ae,$e.data):t.texImage2D(s.TEXTURE_2D,st,Ie,$e.width,$e.height,0,Se,Ae,$e.data)}else if(ue.isDataArrayTexture)lt?(ht&&t.texStorage3D(s.TEXTURE_2D_ARRAY,yt,Ie,ae.width,ae.height,ae.depth),t.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,0,ae.width,ae.height,ae.depth,Se,Ae,ae.data)):t.texImage3D(s.TEXTURE_2D_ARRAY,0,Ie,ae.width,ae.height,ae.depth,0,Se,Ae,ae.data);else if(ue.isData3DTexture)lt?(ht&&t.texStorage3D(s.TEXTURE_3D,yt,Ie,ae.width,ae.height,ae.depth),t.texSubImage3D(s.TEXTURE_3D,0,0,0,0,ae.width,ae.height,ae.depth,Se,Ae,ae.data)):t.texImage3D(s.TEXTURE_3D,0,Ie,ae.width,ae.height,ae.depth,0,Se,Ae,ae.data);else if(ue.isFramebufferTexture){if(ht)if(lt)t.texStorage2D(s.TEXTURE_2D,yt,Ie,ae.width,ae.height);else{let st=ae.width,ye=ae.height;for(let Xe=0;Xe<yt;Xe++)t.texImage2D(s.TEXTURE_2D,Xe,Ie,st,ye,0,Se,Ae,null),st>>=1,ye>>=1}}else if(je.length>0&&be){lt&&ht&&t.texStorage2D(s.TEXTURE_2D,yt,Ie,je[0].width,je[0].height);for(let st=0,ye=je.length;st<ye;st++)$e=je[st],lt?t.texSubImage2D(s.TEXTURE_2D,st,0,0,Se,Ae,$e):t.texImage2D(s.TEXTURE_2D,st,Ie,Se,Ae,$e);ue.generateMipmaps=!1}else lt?(ht&&t.texStorage2D(s.TEXTURE_2D,yt,Ie,ae.width,ae.height),t.texSubImage2D(s.TEXTURE_2D,0,0,0,Se,Ae,ae)):t.texImage2D(s.TEXTURE_2D,0,Ie,Se,Ae,ae);j(ue,be)&&B(Ge),pt.__version=Ve.version,ue.onUpdate&&ue.onUpdate(ue)}he.__version=ue.version}function Te(he,ue,_e){if(ue.image.length!==6)return;const Ge=Ee(he,ue),He=ue.source;t.bindTexture(s.TEXTURE_CUBE_MAP,he.__webglTexture,s.TEXTURE0+_e);const Ve=o.get(He);if(He.version!==Ve.__version||Ge===!0){t.activeTexture(s.TEXTURE0+_e);const pt=ColorManagement.getPrimaries(ColorManagement.workingColorSpace),We=ue.colorSpace===NoColorSpace?null:ColorManagement.getPrimaries(ue.colorSpace),te=ue.colorSpace===NoColorSpace||pt===We?s.NONE:s.BROWSER_DEFAULT_WEBGL;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,ue.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,ue.unpackAlignment),s.pixelStorei(s.UNPACK_COLORSPACE_CONVERSION_WEBGL,te);const U=ue.isCompressedTexture||ue.image[0].isCompressedTexture,$=ue.image[0]&&ue.image[0].isDataTexture,ae=[];for(let st=0;st<6;st++)!U&&!$?ae[st]=O(ue.image[st],!1,!0,a.maxCubemapSize):ae[st]=$?ue.image[st].image:ue.image[st],ae[st]=et(ue,ae[st]);const be=ae[0],Se=I(be)||g,Ae=c.convert(ue.format,ue.colorSpace),Ie=c.convert(ue.type),$e=H(ue.internalFormat,Ae,Ie,ue.colorSpace),je=g&&ue.isVideoTexture!==!0,lt=Ve.__version===void 0||Ge===!0;let ht=se(ue,be,Se);J(s.TEXTURE_CUBE_MAP,ue,Se);let yt;if(U){je&&lt&&t.texStorage2D(s.TEXTURE_CUBE_MAP,ht,$e,be.width,be.height);for(let st=0;st<6;st++){yt=ae[st].mipmaps;for(let ye=0;ye<yt.length;ye++){const Xe=yt[ye];ue.format!==RGBAFormat?Ae!==null?je?t.compressedTexSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye,0,0,Xe.width,Xe.height,Ae,Xe.data):t.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye,$e,Xe.width,Xe.height,0,Xe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):je?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye,0,0,Xe.width,Xe.height,Ae,Ie,Xe.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye,$e,Xe.width,Xe.height,0,Ae,Ie,Xe.data)}}}else{yt=ue.mipmaps,je&&lt&&(yt.length>0&&ht++,t.texStorage2D(s.TEXTURE_CUBE_MAP,ht,$e,ae[0].width,ae[0].height));for(let st=0;st<6;st++)if($){je?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,0,0,ae[st].width,ae[st].height,Ae,Ie,ae[st].data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,$e,ae[st].width,ae[st].height,0,Ae,Ie,ae[st].data);for(let ye=0;ye<yt.length;ye++){const ct=yt[ye].image[st].image;je?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye+1,0,0,ct.width,ct.height,Ae,Ie,ct.data):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye+1,$e,ct.width,ct.height,0,Ae,Ie,ct.data)}}else{je?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,0,0,Ae,Ie,ae[st]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,0,$e,Ae,Ie,ae[st]);for(let ye=0;ye<yt.length;ye++){const Xe=yt[ye];je?t.texSubImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye+1,0,0,Ae,Ie,Xe.image[st]):t.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+st,ye+1,$e,Ae,Ie,Xe.image[st])}}}j(ue,Se)&&B(s.TEXTURE_CUBE_MAP),Ve.__version=He.version,ue.onUpdate&&ue.onUpdate(ue)}he.__version=ue.version}function Ue(he,ue,_e,Ge,He,Ve){const pt=c.convert(_e.format,_e.colorSpace),We=c.convert(_e.type),te=H(_e.internalFormat,pt,We,_e.colorSpace);if(!o.get(ue).__hasExternalTextures){const $=Math.max(1,ue.width>>Ve),ae=Math.max(1,ue.height>>Ve);He===s.TEXTURE_3D||He===s.TEXTURE_2D_ARRAY?t.texImage3D(He,Ve,te,$,ae,ue.depth,0,pt,We,null):t.texImage2D(He,Ve,te,$,ae,0,pt,We,null)}t.bindFramebuffer(s.FRAMEBUFFER,he),dt(ue)?y.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,Ge,He,o.get(_e).__webglTexture,0,nt(ue)):(He===s.TEXTURE_2D||He>=s.TEXTURE_CUBE_MAP_POSITIVE_X&&He<=s.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&s.framebufferTexture2D(s.FRAMEBUFFER,Ge,He,o.get(_e).__webglTexture,Ve),t.bindFramebuffer(s.FRAMEBUFFER,null)}function ze(he,ue,_e){if(s.bindRenderbuffer(s.RENDERBUFFER,he),ue.depthBuffer&&!ue.stencilBuffer){let Ge=g===!0?s.DEPTH_COMPONENT24:s.DEPTH_COMPONENT16;if(_e||dt(ue)){const He=ue.depthTexture;He&&He.isDepthTexture&&(He.type===FloatType?Ge=s.DEPTH_COMPONENT32F:He.type===UnsignedIntType&&(Ge=s.DEPTH_COMPONENT24));const Ve=nt(ue);dt(ue)?y.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ve,Ge,ue.width,ue.height):s.renderbufferStorageMultisample(s.RENDERBUFFER,Ve,Ge,ue.width,ue.height)}else s.renderbufferStorage(s.RENDERBUFFER,Ge,ue.width,ue.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,he)}else if(ue.depthBuffer&&ue.stencilBuffer){const Ge=nt(ue);_e&&dt(ue)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,Ge,s.DEPTH24_STENCIL8,ue.width,ue.height):dt(ue)?y.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,Ge,s.DEPTH24_STENCIL8,ue.width,ue.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,ue.width,ue.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,he)}else{const Ge=ue.isWebGLMultipleRenderTargets===!0?ue.texture:[ue.texture];for(let He=0;He<Ge.length;He++){const Ve=Ge[He],pt=c.convert(Ve.format,Ve.colorSpace),We=c.convert(Ve.type),te=H(Ve.internalFormat,pt,We,Ve.colorSpace),U=nt(ue);_e&&dt(ue)===!1?s.renderbufferStorageMultisample(s.RENDERBUFFER,U,te,ue.width,ue.height):dt(ue)?y.renderbufferStorageMultisampleEXT(s.RENDERBUFFER,U,te,ue.width,ue.height):s.renderbufferStorage(s.RENDERBUFFER,te,ue.width,ue.height)}}s.bindRenderbuffer(s.RENDERBUFFER,null)}function Ke(he,ue){if(ue&&ue.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(s.FRAMEBUFFER,he),!(ue.depthTexture&&ue.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(ue.depthTexture).__webglTexture||ue.depthTexture.image.width!==ue.width||ue.depthTexture.image.height!==ue.height)&&(ue.depthTexture.image.width=ue.width,ue.depthTexture.image.height=ue.height,ue.depthTexture.needsUpdate=!0),z(ue.depthTexture,0);const Ge=o.get(ue.depthTexture).__webglTexture,He=nt(ue);if(ue.depthTexture.format===DepthFormat)dt(ue)?y.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Ge,0,He):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,Ge,0);else if(ue.depthTexture.format===DepthStencilFormat)dt(ue)?y.framebufferTexture2DMultisampleEXT(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Ge,0,He):s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,Ge,0);else throw new Error("Unknown depthTexture format")}function it(he){const ue=o.get(he),_e=he.isWebGLCubeRenderTarget===!0;if(he.depthTexture&&!ue.__autoAllocateDepthBuffer){if(_e)throw new Error("target.depthTexture not supported in Cube render targets");Ke(ue.__webglFramebuffer,he)}else if(_e){ue.__webglDepthbuffer=[];for(let Ge=0;Ge<6;Ge++)t.bindFramebuffer(s.FRAMEBUFFER,ue.__webglFramebuffer[Ge]),ue.__webglDepthbuffer[Ge]=s.createRenderbuffer(),ze(ue.__webglDepthbuffer[Ge],he,!1)}else t.bindFramebuffer(s.FRAMEBUFFER,ue.__webglFramebuffer),ue.__webglDepthbuffer=s.createRenderbuffer(),ze(ue.__webglDepthbuffer,he,!1);t.bindFramebuffer(s.FRAMEBUFFER,null)}function Ye(he,ue,_e){const Ge=o.get(he);ue!==void 0&&Ue(Ge.__webglFramebuffer,he,he.texture,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,0),_e!==void 0&&it(he)}function Ce(he){const ue=he.texture,_e=o.get(he),Ge=o.get(ue);he.addEventListener("dispose",fe),he.isWebGLMultipleRenderTargets!==!0&&(Ge.__webglTexture===void 0&&(Ge.__webglTexture=s.createTexture()),Ge.__version=ue.version,d.memory.textures++);const He=he.isWebGLCubeRenderTarget===!0,Ve=he.isWebGLMultipleRenderTargets===!0,pt=I(he)||g;if(He){_e.__webglFramebuffer=[];for(let We=0;We<6;We++)if(g&&ue.mipmaps&&ue.mipmaps.length>0){_e.__webglFramebuffer[We]=[];for(let te=0;te<ue.mipmaps.length;te++)_e.__webglFramebuffer[We][te]=s.createFramebuffer()}else _e.__webglFramebuffer[We]=s.createFramebuffer()}else{if(g&&ue.mipmaps&&ue.mipmaps.length>0){_e.__webglFramebuffer=[];for(let We=0;We<ue.mipmaps.length;We++)_e.__webglFramebuffer[We]=s.createFramebuffer()}else _e.__webglFramebuffer=s.createFramebuffer();if(Ve)if(a.drawBuffers){const We=he.texture;for(let te=0,U=We.length;te<U;te++){const $=o.get(We[te]);$.__webglTexture===void 0&&($.__webglTexture=s.createTexture(),d.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(g&&he.samples>0&&dt(he)===!1){const We=Ve?ue:[ue];_e.__webglMultisampledFramebuffer=s.createFramebuffer(),_e.__webglColorRenderbuffer=[],t.bindFramebuffer(s.FRAMEBUFFER,_e.__webglMultisampledFramebuffer);for(let te=0;te<We.length;te++){const U=We[te];_e.__webglColorRenderbuffer[te]=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,_e.__webglColorRenderbuffer[te]);const $=c.convert(U.format,U.colorSpace),ae=c.convert(U.type),be=H(U.internalFormat,$,ae,U.colorSpace,he.isXRRenderTarget===!0),Se=nt(he);s.renderbufferStorageMultisample(s.RENDERBUFFER,Se,be,he.width,he.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+te,s.RENDERBUFFER,_e.__webglColorRenderbuffer[te])}s.bindRenderbuffer(s.RENDERBUFFER,null),he.depthBuffer&&(_e.__webglDepthRenderbuffer=s.createRenderbuffer(),ze(_e.__webglDepthRenderbuffer,he,!0)),t.bindFramebuffer(s.FRAMEBUFFER,null)}}if(He){t.bindTexture(s.TEXTURE_CUBE_MAP,Ge.__webglTexture),J(s.TEXTURE_CUBE_MAP,ue,pt);for(let We=0;We<6;We++)if(g&&ue.mipmaps&&ue.mipmaps.length>0)for(let te=0;te<ue.mipmaps.length;te++)Ue(_e.__webglFramebuffer[We][te],he,ue,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+We,te);else Ue(_e.__webglFramebuffer[We],he,ue,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+We,0);j(ue,pt)&&B(s.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ve){const We=he.texture;for(let te=0,U=We.length;te<U;te++){const $=We[te],ae=o.get($);t.bindTexture(s.TEXTURE_2D,ae.__webglTexture),J(s.TEXTURE_2D,$,pt),Ue(_e.__webglFramebuffer,he,$,s.COLOR_ATTACHMENT0+te,s.TEXTURE_2D,0),j($,pt)&&B(s.TEXTURE_2D)}t.unbindTexture()}else{let We=s.TEXTURE_2D;if((he.isWebGL3DRenderTarget||he.isWebGLArrayRenderTarget)&&(g?We=he.isWebGL3DRenderTarget?s.TEXTURE_3D:s.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(We,Ge.__webglTexture),J(We,ue,pt),g&&ue.mipmaps&&ue.mipmaps.length>0)for(let te=0;te<ue.mipmaps.length;te++)Ue(_e.__webglFramebuffer[te],he,ue,s.COLOR_ATTACHMENT0,We,te);else Ue(_e.__webglFramebuffer,he,ue,s.COLOR_ATTACHMENT0,We,0);j(ue,pt)&&B(We),t.unbindTexture()}he.depthBuffer&&it(he)}function ft(he){const ue=I(he)||g,_e=he.isWebGLMultipleRenderTargets===!0?he.texture:[he.texture];for(let Ge=0,He=_e.length;Ge<He;Ge++){const Ve=_e[Ge];if(j(Ve,ue)){const pt=he.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,We=o.get(Ve).__webglTexture;t.bindTexture(pt,We),B(pt),t.unbindTexture()}}}function Ze(he){if(g&&he.samples>0&&dt(he)===!1){const ue=he.isWebGLMultipleRenderTargets?he.texture:[he.texture],_e=he.width,Ge=he.height;let He=s.COLOR_BUFFER_BIT;const Ve=[],pt=he.stencilBuffer?s.DEPTH_STENCIL_ATTACHMENT:s.DEPTH_ATTACHMENT,We=o.get(he),te=he.isWebGLMultipleRenderTargets===!0;if(te)for(let U=0;U<ue.length;U++)t.bindFramebuffer(s.FRAMEBUFFER,We.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+U,s.RENDERBUFFER,null),t.bindFramebuffer(s.FRAMEBUFFER,We.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+U,s.TEXTURE_2D,null,0);t.bindFramebuffer(s.READ_FRAMEBUFFER,We.__webglMultisampledFramebuffer),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,We.__webglFramebuffer);for(let U=0;U<ue.length;U++){Ve.push(s.COLOR_ATTACHMENT0+U),he.depthBuffer&&Ve.push(pt);const $=We.__ignoreDepthValues!==void 0?We.__ignoreDepthValues:!1;if($===!1&&(he.depthBuffer&&(He|=s.DEPTH_BUFFER_BIT),he.stencilBuffer&&(He|=s.STENCIL_BUFFER_BIT)),te&&s.framebufferRenderbuffer(s.READ_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,We.__webglColorRenderbuffer[U]),$===!0&&(s.invalidateFramebuffer(s.READ_FRAMEBUFFER,[pt]),s.invalidateFramebuffer(s.DRAW_FRAMEBUFFER,[pt])),te){const ae=o.get(ue[U]).__webglTexture;s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,ae,0)}s.blitFramebuffer(0,0,_e,Ge,0,0,_e,Ge,He,s.NEAREST),_&&s.invalidateFramebuffer(s.READ_FRAMEBUFFER,Ve)}if(t.bindFramebuffer(s.READ_FRAMEBUFFER,null),t.bindFramebuffer(s.DRAW_FRAMEBUFFER,null),te)for(let U=0;U<ue.length;U++){t.bindFramebuffer(s.FRAMEBUFFER,We.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+U,s.RENDERBUFFER,We.__webglColorRenderbuffer[U]);const $=o.get(ue[U]).__webglTexture;t.bindFramebuffer(s.FRAMEBUFFER,We.__webglFramebuffer),s.framebufferTexture2D(s.DRAW_FRAMEBUFFER,s.COLOR_ATTACHMENT0+U,s.TEXTURE_2D,$,0)}t.bindFramebuffer(s.DRAW_FRAMEBUFFER,We.__webglMultisampledFramebuffer)}}function nt(he){return Math.min(a.maxSamples,he.samples)}function dt(he){const ue=o.get(he);return g&&he.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ue.__useRenderToTexture!==!1}function gt(he){const ue=d.render.frame;E.get(he)!==ue&&(E.set(he,ue),he.update())}function et(he,ue){const _e=he.colorSpace,Ge=he.format,He=he.type;return he.isCompressedTexture===!0||he.isVideoTexture===!0||he.format===_SRGBAFormat||_e!==LinearSRGBColorSpace&&_e!==NoColorSpace&&(ColorManagement.getTransfer(_e)===SRGBTransfer?g===!1?e.has("EXT_sRGB")===!0&&Ge===RGBAFormat?(he.format=_SRGBAFormat,he.minFilter=LinearFilter,he.generateMipmaps=!1):ue=ImageUtils.sRGBToLinear(ue):(Ge!==RGBAFormat||He!==UnsignedByteType)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",_e)),ue}this.allocateTextureUnit=R,this.resetTextureUnits=V,this.setTexture2D=z,this.setTexture2DArray=Y,this.setTexture3D=W,this.setTextureCube=ee,this.rebindTextures=Ye,this.setupRenderTarget=Ce,this.updateRenderTargetMipmap=ft,this.updateMultisampleRenderTarget=Ze,this.setupDepthRenderbuffer=it,this.setupFrameBufferTexture=Ue,this.useMultisampledRTT=dt}function WebGLUtils(s,e,t){const o=t.isWebGL2;function a(c,d=NoColorSpace){let g;const y=ColorManagement.getTransfer(d);if(c===UnsignedByteType)return s.UNSIGNED_BYTE;if(c===UnsignedShort4444Type)return s.UNSIGNED_SHORT_4_4_4_4;if(c===UnsignedShort5551Type)return s.UNSIGNED_SHORT_5_5_5_1;if(c===ByteType)return s.BYTE;if(c===ShortType)return s.SHORT;if(c===UnsignedShortType)return s.UNSIGNED_SHORT;if(c===IntType)return s.INT;if(c===UnsignedIntType)return s.UNSIGNED_INT;if(c===FloatType)return s.FLOAT;if(c===HalfFloatType)return o?s.HALF_FLOAT:(g=e.get("OES_texture_half_float"),g!==null?g.HALF_FLOAT_OES:null);if(c===AlphaFormat)return s.ALPHA;if(c===RGBAFormat)return s.RGBA;if(c===LuminanceFormat)return s.LUMINANCE;if(c===LuminanceAlphaFormat)return s.LUMINANCE_ALPHA;if(c===DepthFormat)return s.DEPTH_COMPONENT;if(c===DepthStencilFormat)return s.DEPTH_STENCIL;if(c===_SRGBAFormat)return g=e.get("EXT_sRGB"),g!==null?g.SRGB_ALPHA_EXT:null;if(c===RedFormat)return s.RED;if(c===RedIntegerFormat)return s.RED_INTEGER;if(c===RGFormat)return s.RG;if(c===RGIntegerFormat)return s.RG_INTEGER;if(c===RGBAIntegerFormat)return s.RGBA_INTEGER;if(c===RGB_S3TC_DXT1_Format||c===RGBA_S3TC_DXT1_Format||c===RGBA_S3TC_DXT3_Format||c===RGBA_S3TC_DXT5_Format)if(y===SRGBTransfer)if(g=e.get("WEBGL_compressed_texture_s3tc_srgb"),g!==null){if(c===RGB_S3TC_DXT1_Format)return g.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(c===RGBA_S3TC_DXT1_Format)return g.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(c===RGBA_S3TC_DXT3_Format)return g.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(c===RGBA_S3TC_DXT5_Format)return g.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(g=e.get("WEBGL_compressed_texture_s3tc"),g!==null){if(c===RGB_S3TC_DXT1_Format)return g.COMPRESSED_RGB_S3TC_DXT1_EXT;if(c===RGBA_S3TC_DXT1_Format)return g.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(c===RGBA_S3TC_DXT3_Format)return g.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(c===RGBA_S3TC_DXT5_Format)return g.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(c===RGB_PVRTC_4BPPV1_Format||c===RGB_PVRTC_2BPPV1_Format||c===RGBA_PVRTC_4BPPV1_Format||c===RGBA_PVRTC_2BPPV1_Format)if(g=e.get("WEBGL_compressed_texture_pvrtc"),g!==null){if(c===RGB_PVRTC_4BPPV1_Format)return g.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(c===RGB_PVRTC_2BPPV1_Format)return g.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(c===RGBA_PVRTC_4BPPV1_Format)return g.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(c===RGBA_PVRTC_2BPPV1_Format)return g.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(c===RGB_ETC1_Format)return g=e.get("WEBGL_compressed_texture_etc1"),g!==null?g.COMPRESSED_RGB_ETC1_WEBGL:null;if(c===RGB_ETC2_Format||c===RGBA_ETC2_EAC_Format)if(g=e.get("WEBGL_compressed_texture_etc"),g!==null){if(c===RGB_ETC2_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ETC2:g.COMPRESSED_RGB8_ETC2;if(c===RGBA_ETC2_EAC_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:g.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(c===RGBA_ASTC_4x4_Format||c===RGBA_ASTC_5x4_Format||c===RGBA_ASTC_5x5_Format||c===RGBA_ASTC_6x5_Format||c===RGBA_ASTC_6x6_Format||c===RGBA_ASTC_8x5_Format||c===RGBA_ASTC_8x6_Format||c===RGBA_ASTC_8x8_Format||c===RGBA_ASTC_10x5_Format||c===RGBA_ASTC_10x6_Format||c===RGBA_ASTC_10x8_Format||c===RGBA_ASTC_10x10_Format||c===RGBA_ASTC_12x10_Format||c===RGBA_ASTC_12x12_Format)if(g=e.get("WEBGL_compressed_texture_astc"),g!==null){if(c===RGBA_ASTC_4x4_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:g.COMPRESSED_RGBA_ASTC_4x4_KHR;if(c===RGBA_ASTC_5x4_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:g.COMPRESSED_RGBA_ASTC_5x4_KHR;if(c===RGBA_ASTC_5x5_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:g.COMPRESSED_RGBA_ASTC_5x5_KHR;if(c===RGBA_ASTC_6x5_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:g.COMPRESSED_RGBA_ASTC_6x5_KHR;if(c===RGBA_ASTC_6x6_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:g.COMPRESSED_RGBA_ASTC_6x6_KHR;if(c===RGBA_ASTC_8x5_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:g.COMPRESSED_RGBA_ASTC_8x5_KHR;if(c===RGBA_ASTC_8x6_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:g.COMPRESSED_RGBA_ASTC_8x6_KHR;if(c===RGBA_ASTC_8x8_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:g.COMPRESSED_RGBA_ASTC_8x8_KHR;if(c===RGBA_ASTC_10x5_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:g.COMPRESSED_RGBA_ASTC_10x5_KHR;if(c===RGBA_ASTC_10x6_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:g.COMPRESSED_RGBA_ASTC_10x6_KHR;if(c===RGBA_ASTC_10x8_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:g.COMPRESSED_RGBA_ASTC_10x8_KHR;if(c===RGBA_ASTC_10x10_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:g.COMPRESSED_RGBA_ASTC_10x10_KHR;if(c===RGBA_ASTC_12x10_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:g.COMPRESSED_RGBA_ASTC_12x10_KHR;if(c===RGBA_ASTC_12x12_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:g.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(c===RGBA_BPTC_Format||c===RGB_BPTC_SIGNED_Format||c===RGB_BPTC_UNSIGNED_Format)if(g=e.get("EXT_texture_compression_bptc"),g!==null){if(c===RGBA_BPTC_Format)return y===SRGBTransfer?g.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:g.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(c===RGB_BPTC_SIGNED_Format)return g.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(c===RGB_BPTC_UNSIGNED_Format)return g.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(c===RED_RGTC1_Format||c===SIGNED_RED_RGTC1_Format||c===RED_GREEN_RGTC2_Format||c===SIGNED_RED_GREEN_RGTC2_Format)if(g=e.get("EXT_texture_compression_rgtc"),g!==null){if(c===RGBA_BPTC_Format)return g.COMPRESSED_RED_RGTC1_EXT;if(c===SIGNED_RED_RGTC1_Format)return g.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(c===RED_GREEN_RGTC2_Format)return g.COMPRESSED_RED_GREEN_RGTC2_EXT;if(c===SIGNED_RED_GREEN_RGTC2_Format)return g.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return c===UnsignedInt248Type?o?s.UNSIGNED_INT_24_8:(g=e.get("WEBGL_depth_texture"),g!==null?g.UNSIGNED_INT_24_8_WEBGL:null):s[c]!==void 0?s[c]:null}return{convert:a}}class ArrayCamera extends PerspectiveCamera{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Group extends Object3D{constructor(){super(),this.isGroup=!0,this.type="Group"}}const _moveEvent={type:"move"};class WebXRController{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Group,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Group,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Vector3,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Vector3),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Group,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Vector3,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Vector3),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const o of e.hand.values())this._getHandJoint(t,o)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,o){let a=null,c=null,d=null;const g=this._targetRay,y=this._grip,_=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(_&&e.hand){d=!0;for(const O of e.hand.values()){const I=t.getJointPose(O,o),P=this._getHandJoint(_,O);I!==null&&(P.matrix.fromArray(I.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.matrixWorldNeedsUpdate=!0,P.jointRadius=I.radius),P.visible=I!==null}const E=_.joints["index-finger-tip"],S=_.joints["thumb-tip"],A=E.position.distanceTo(S.position),C=.02,N=.005;_.inputState.pinching&&A>C+N?(_.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!_.inputState.pinching&&A<=C-N&&(_.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else y!==null&&e.gripSpace&&(c=t.getPose(e.gripSpace,o),c!==null&&(y.matrix.fromArray(c.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,c.linearVelocity?(y.hasLinearVelocity=!0,y.linearVelocity.copy(c.linearVelocity)):y.hasLinearVelocity=!1,c.angularVelocity?(y.hasAngularVelocity=!0,y.angularVelocity.copy(c.angularVelocity)):y.hasAngularVelocity=!1));g!==null&&(a=t.getPose(e.targetRaySpace,o),a===null&&c!==null&&(a=c),a!==null&&(g.matrix.fromArray(a.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,a.linearVelocity?(g.hasLinearVelocity=!0,g.linearVelocity.copy(a.linearVelocity)):g.hasLinearVelocity=!1,a.angularVelocity?(g.hasAngularVelocity=!0,g.angularVelocity.copy(a.angularVelocity)):g.hasAngularVelocity=!1,this.dispatchEvent(_moveEvent)))}return g!==null&&(g.visible=a!==null),y!==null&&(y.visible=c!==null),_!==null&&(_.visible=d!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const o=new Group;o.matrixAutoUpdate=!1,o.visible=!1,e.joints[t.jointName]=o,e.add(o)}return e.joints[t.jointName]}}class WebXRManager extends EventDispatcher{constructor(e,t){super();const o=this;let a=null,c=1,d=null,g="local-floor",y=1,_=null,E=null,S=null,A=null,C=null,N=null;const O=t.getContextAttributes();let I=null,P=null;const j=[],B=[],H=new Vector2;let se=null;const oe=new PerspectiveCamera;oe.layers.enable(1),oe.viewport=new Vector4;const Q=new PerspectiveCamera;Q.layers.enable(2),Q.viewport=new Vector4;const fe=[oe,Q],Z=new ArrayCamera;Z.layers.enable(1),Z.layers.enable(2);let ce=null,ge=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let Ee=j[J];return Ee===void 0&&(Ee=new WebXRController,j[J]=Ee),Ee.getTargetRaySpace()},this.getControllerGrip=function(J){let Ee=j[J];return Ee===void 0&&(Ee=new WebXRController,j[J]=Ee),Ee.getGripSpace()},this.getHand=function(J){let Ee=j[J];return Ee===void 0&&(Ee=new WebXRController,j[J]=Ee),Ee.getHandSpace()};function me(J){const Ee=B.indexOf(J.inputSource);if(Ee===-1)return;const Re=j[Ee];Re!==void 0&&(Re.update(J.inputSource,J.frame,_||d),Re.dispatchEvent({type:J.type,data:J.inputSource}))}function V(){a.removeEventListener("select",me),a.removeEventListener("selectstart",me),a.removeEventListener("selectend",me),a.removeEventListener("squeeze",me),a.removeEventListener("squeezestart",me),a.removeEventListener("squeezeend",me),a.removeEventListener("end",V),a.removeEventListener("inputsourceschange",R);for(let J=0;J<j.length;J++){const Ee=B[J];Ee!==null&&(B[J]=null,j[J].disconnect(Ee))}ce=null,ge=null,e.setRenderTarget(I),C=null,A=null,S=null,a=null,P=null,F.stop(),o.isPresenting=!1,e.setPixelRatio(se),e.setSize(H.width,H.height,!1),o.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){c=J,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){g=J,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return _||d},this.setReferenceSpace=function(J){_=J},this.getBaseLayer=function(){return A!==null?A:C},this.getBinding=function(){return S},this.getFrame=function(){return N},this.getSession=function(){return a},this.setSession=async function(J){if(a=J,a!==null){if(I=e.getRenderTarget(),a.addEventListener("select",me),a.addEventListener("selectstart",me),a.addEventListener("selectend",me),a.addEventListener("squeeze",me),a.addEventListener("squeezestart",me),a.addEventListener("squeezeend",me),a.addEventListener("end",V),a.addEventListener("inputsourceschange",R),O.xrCompatible!==!0&&await t.makeXRCompatible(),se=e.getPixelRatio(),e.getSize(H),a.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const Ee={antialias:a.renderState.layers===void 0?O.antialias:!0,alpha:!0,depth:O.depth,stencil:O.stencil,framebufferScaleFactor:c};C=new XRWebGLLayer(a,t,Ee),a.updateRenderState({baseLayer:C}),e.setPixelRatio(1),e.setSize(C.framebufferWidth,C.framebufferHeight,!1),P=new WebGLRenderTarget(C.framebufferWidth,C.framebufferHeight,{format:RGBAFormat,type:UnsignedByteType,colorSpace:e.outputColorSpace,stencilBuffer:O.stencil})}else{let Ee=null,Re=null,Te=null;O.depth&&(Te=O.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Ee=O.stencil?DepthStencilFormat:DepthFormat,Re=O.stencil?UnsignedInt248Type:UnsignedIntType);const Ue={colorFormat:t.RGBA8,depthFormat:Te,scaleFactor:c};S=new XRWebGLBinding(a,t),A=S.createProjectionLayer(Ue),a.updateRenderState({layers:[A]}),e.setPixelRatio(1),e.setSize(A.textureWidth,A.textureHeight,!1),P=new WebGLRenderTarget(A.textureWidth,A.textureHeight,{format:RGBAFormat,type:UnsignedByteType,depthTexture:new DepthTexture(A.textureWidth,A.textureHeight,Re,void 0,void 0,void 0,void 0,void 0,void 0,Ee),stencilBuffer:O.stencil,colorSpace:e.outputColorSpace,samples:O.antialias?4:0});const ze=e.properties.get(P);ze.__ignoreDepthValues=A.ignoreDepthValues}P.isXRRenderTarget=!0,this.setFoveation(y),_=null,d=await a.requestReferenceSpace(g),F.setContext(a),F.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(a!==null)return a.environmentBlendMode};function R(J){for(let Ee=0;Ee<J.removed.length;Ee++){const Re=J.removed[Ee],Te=B.indexOf(Re);Te>=0&&(B[Te]=null,j[Te].disconnect(Re))}for(let Ee=0;Ee<J.added.length;Ee++){const Re=J.added[Ee];let Te=B.indexOf(Re);if(Te===-1){for(let ze=0;ze<j.length;ze++)if(ze>=B.length){B.push(Re),Te=ze;break}else if(B[ze]===null){B[ze]=Re,Te=ze;break}if(Te===-1)break}const Ue=j[Te];Ue&&Ue.connect(Re)}}const L=new Vector3,z=new Vector3;function Y(J,Ee,Re){L.setFromMatrixPosition(Ee.matrixWorld),z.setFromMatrixPosition(Re.matrixWorld);const Te=L.distanceTo(z),Ue=Ee.projectionMatrix.elements,ze=Re.projectionMatrix.elements,Ke=Ue[14]/(Ue[10]-1),it=Ue[14]/(Ue[10]+1),Ye=(Ue[9]+1)/Ue[5],Ce=(Ue[9]-1)/Ue[5],ft=(Ue[8]-1)/Ue[0],Ze=(ze[8]+1)/ze[0],nt=Ke*ft,dt=Ke*Ze,gt=Te/(-ft+Ze),et=gt*-ft;Ee.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(et),J.translateZ(gt),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert();const he=Ke+gt,ue=it+gt,_e=nt-et,Ge=dt+(Te-et),He=Ye*it/ue*he,Ve=Ce*it/ue*he;J.projectionMatrix.makePerspective(_e,Ge,He,Ve,he,ue),J.projectionMatrixInverse.copy(J.projectionMatrix).invert()}function W(J,Ee){Ee===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(Ee.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(a===null)return;Z.near=Q.near=oe.near=J.near,Z.far=Q.far=oe.far=J.far,(ce!==Z.near||ge!==Z.far)&&(a.updateRenderState({depthNear:Z.near,depthFar:Z.far}),ce=Z.near,ge=Z.far);const Ee=J.parent,Re=Z.cameras;W(Z,Ee);for(let Te=0;Te<Re.length;Te++)W(Re[Te],Ee);Re.length===2?Y(Z,oe,Q):Z.projectionMatrix.copy(oe.projectionMatrix),ee(J,Z,Ee)};function ee(J,Ee,Re){Re===null?J.matrix.copy(Ee.matrixWorld):(J.matrix.copy(Re.matrixWorld),J.matrix.invert(),J.matrix.multiply(Ee.matrixWorld)),J.matrix.decompose(J.position,J.quaternion,J.scale),J.updateMatrixWorld(!0),J.projectionMatrix.copy(Ee.projectionMatrix),J.projectionMatrixInverse.copy(Ee.projectionMatrixInverse),J.isPerspectiveCamera&&(J.fov=RAD2DEG*2*Math.atan(1/J.projectionMatrix.elements[5]),J.zoom=1)}this.getCamera=function(){return Z},this.getFoveation=function(){if(!(A===null&&C===null))return y},this.setFoveation=function(J){y=J,A!==null&&(A.fixedFoveation=J),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=J)};let ie=null;function X(J,Ee){if(E=Ee.getViewerPose(_||d),N=Ee,E!==null){const Re=E.views;C!==null&&(e.setRenderTargetFramebuffer(P,C.framebuffer),e.setRenderTarget(P));let Te=!1;Re.length!==Z.cameras.length&&(Z.cameras.length=0,Te=!0);for(let Ue=0;Ue<Re.length;Ue++){const ze=Re[Ue];let Ke=null;if(C!==null)Ke=C.getViewport(ze);else{const Ye=S.getViewSubImage(A,ze);Ke=Ye.viewport,Ue===0&&(e.setRenderTargetTextures(P,Ye.colorTexture,A.ignoreDepthValues?void 0:Ye.depthStencilTexture),e.setRenderTarget(P))}let it=fe[Ue];it===void 0&&(it=new PerspectiveCamera,it.layers.enable(Ue),it.viewport=new Vector4,fe[Ue]=it),it.matrix.fromArray(ze.transform.matrix),it.matrix.decompose(it.position,it.quaternion,it.scale),it.projectionMatrix.fromArray(ze.projectionMatrix),it.projectionMatrixInverse.copy(it.projectionMatrix).invert(),it.viewport.set(Ke.x,Ke.y,Ke.width,Ke.height),Ue===0&&(Z.matrix.copy(it.matrix),Z.matrix.decompose(Z.position,Z.quaternion,Z.scale)),Te===!0&&Z.cameras.push(it)}}for(let Re=0;Re<j.length;Re++){const Te=B[Re],Ue=j[Re];Te!==null&&Ue!==void 0&&Ue.update(Te,Ee,_||d)}ie&&ie(J,Ee),Ee.detectedPlanes&&o.dispatchEvent({type:"planesdetected",data:Ee}),N=null}const F=new WebGLAnimation;F.setAnimationLoop(X),this.setAnimationLoop=function(J){ie=J},this.dispose=function(){}}}function WebGLMaterials(s,e){function t(I,P){I.matrixAutoUpdate===!0&&I.updateMatrix(),P.value.copy(I.matrix)}function o(I,P){P.color.getRGB(I.fogColor.value,getUnlitUniformColorSpace(s)),P.isFog?(I.fogNear.value=P.near,I.fogFar.value=P.far):P.isFogExp2&&(I.fogDensity.value=P.density)}function a(I,P,j,B,H){P.isMeshBasicMaterial||P.isMeshLambertMaterial?c(I,P):P.isMeshToonMaterial?(c(I,P),S(I,P)):P.isMeshPhongMaterial?(c(I,P),E(I,P)):P.isMeshStandardMaterial?(c(I,P),A(I,P),P.isMeshPhysicalMaterial&&C(I,P,H)):P.isMeshMatcapMaterial?(c(I,P),N(I,P)):P.isMeshDepthMaterial?c(I,P):P.isMeshDistanceMaterial?(c(I,P),O(I,P)):P.isMeshNormalMaterial?c(I,P):P.isLineBasicMaterial?(d(I,P),P.isLineDashedMaterial&&g(I,P)):P.isPointsMaterial?y(I,P,j,B):P.isSpriteMaterial?_(I,P):P.isShadowMaterial?(I.color.value.copy(P.color),I.opacity.value=P.opacity):P.isShaderMaterial&&(P.uniformsNeedUpdate=!1)}function c(I,P){I.opacity.value=P.opacity,P.color&&I.diffuse.value.copy(P.color),P.emissive&&I.emissive.value.copy(P.emissive).multiplyScalar(P.emissiveIntensity),P.map&&(I.map.value=P.map,t(P.map,I.mapTransform)),P.alphaMap&&(I.alphaMap.value=P.alphaMap,t(P.alphaMap,I.alphaMapTransform)),P.bumpMap&&(I.bumpMap.value=P.bumpMap,t(P.bumpMap,I.bumpMapTransform),I.bumpScale.value=P.bumpScale,P.side===BackSide&&(I.bumpScale.value*=-1)),P.normalMap&&(I.normalMap.value=P.normalMap,t(P.normalMap,I.normalMapTransform),I.normalScale.value.copy(P.normalScale),P.side===BackSide&&I.normalScale.value.negate()),P.displacementMap&&(I.displacementMap.value=P.displacementMap,t(P.displacementMap,I.displacementMapTransform),I.displacementScale.value=P.displacementScale,I.displacementBias.value=P.displacementBias),P.emissiveMap&&(I.emissiveMap.value=P.emissiveMap,t(P.emissiveMap,I.emissiveMapTransform)),P.specularMap&&(I.specularMap.value=P.specularMap,t(P.specularMap,I.specularMapTransform)),P.alphaTest>0&&(I.alphaTest.value=P.alphaTest);const j=e.get(P).envMap;if(j&&(I.envMap.value=j,I.flipEnvMap.value=j.isCubeTexture&&j.isRenderTargetTexture===!1?-1:1,I.reflectivity.value=P.reflectivity,I.ior.value=P.ior,I.refractionRatio.value=P.refractionRatio),P.lightMap){I.lightMap.value=P.lightMap;const B=s._useLegacyLights===!0?Math.PI:1;I.lightMapIntensity.value=P.lightMapIntensity*B,t(P.lightMap,I.lightMapTransform)}P.aoMap&&(I.aoMap.value=P.aoMap,I.aoMapIntensity.value=P.aoMapIntensity,t(P.aoMap,I.aoMapTransform))}function d(I,P){I.diffuse.value.copy(P.color),I.opacity.value=P.opacity,P.map&&(I.map.value=P.map,t(P.map,I.mapTransform))}function g(I,P){I.dashSize.value=P.dashSize,I.totalSize.value=P.dashSize+P.gapSize,I.scale.value=P.scale}function y(I,P,j,B){I.diffuse.value.copy(P.color),I.opacity.value=P.opacity,I.size.value=P.size*j,I.scale.value=B*.5,P.map&&(I.map.value=P.map,t(P.map,I.uvTransform)),P.alphaMap&&(I.alphaMap.value=P.alphaMap,t(P.alphaMap,I.alphaMapTransform)),P.alphaTest>0&&(I.alphaTest.value=P.alphaTest)}function _(I,P){I.diffuse.value.copy(P.color),I.opacity.value=P.opacity,I.rotation.value=P.rotation,P.map&&(I.map.value=P.map,t(P.map,I.mapTransform)),P.alphaMap&&(I.alphaMap.value=P.alphaMap,t(P.alphaMap,I.alphaMapTransform)),P.alphaTest>0&&(I.alphaTest.value=P.alphaTest)}function E(I,P){I.specular.value.copy(P.specular),I.shininess.value=Math.max(P.shininess,1e-4)}function S(I,P){P.gradientMap&&(I.gradientMap.value=P.gradientMap)}function A(I,P){I.metalness.value=P.metalness,P.metalnessMap&&(I.metalnessMap.value=P.metalnessMap,t(P.metalnessMap,I.metalnessMapTransform)),I.roughness.value=P.roughness,P.roughnessMap&&(I.roughnessMap.value=P.roughnessMap,t(P.roughnessMap,I.roughnessMapTransform)),e.get(P).envMap&&(I.envMapIntensity.value=P.envMapIntensity)}function C(I,P,j){I.ior.value=P.ior,P.sheen>0&&(I.sheenColor.value.copy(P.sheenColor).multiplyScalar(P.sheen),I.sheenRoughness.value=P.sheenRoughness,P.sheenColorMap&&(I.sheenColorMap.value=P.sheenColorMap,t(P.sheenColorMap,I.sheenColorMapTransform)),P.sheenRoughnessMap&&(I.sheenRoughnessMap.value=P.sheenRoughnessMap,t(P.sheenRoughnessMap,I.sheenRoughnessMapTransform))),P.clearcoat>0&&(I.clearcoat.value=P.clearcoat,I.clearcoatRoughness.value=P.clearcoatRoughness,P.clearcoatMap&&(I.clearcoatMap.value=P.clearcoatMap,t(P.clearcoatMap,I.clearcoatMapTransform)),P.clearcoatRoughnessMap&&(I.clearcoatRoughnessMap.value=P.clearcoatRoughnessMap,t(P.clearcoatRoughnessMap,I.clearcoatRoughnessMapTransform)),P.clearcoatNormalMap&&(I.clearcoatNormalMap.value=P.clearcoatNormalMap,t(P.clearcoatNormalMap,I.clearcoatNormalMapTransform),I.clearcoatNormalScale.value.copy(P.clearcoatNormalScale),P.side===BackSide&&I.clearcoatNormalScale.value.negate())),P.iridescence>0&&(I.iridescence.value=P.iridescence,I.iridescenceIOR.value=P.iridescenceIOR,I.iridescenceThicknessMinimum.value=P.iridescenceThicknessRange[0],I.iridescenceThicknessMaximum.value=P.iridescenceThicknessRange[1],P.iridescenceMap&&(I.iridescenceMap.value=P.iridescenceMap,t(P.iridescenceMap,I.iridescenceMapTransform)),P.iridescenceThicknessMap&&(I.iridescenceThicknessMap.value=P.iridescenceThicknessMap,t(P.iridescenceThicknessMap,I.iridescenceThicknessMapTransform))),P.transmission>0&&(I.transmission.value=P.transmission,I.transmissionSamplerMap.value=j.texture,I.transmissionSamplerSize.value.set(j.width,j.height),P.transmissionMap&&(I.transmissionMap.value=P.transmissionMap,t(P.transmissionMap,I.transmissionMapTransform)),I.thickness.value=P.thickness,P.thicknessMap&&(I.thicknessMap.value=P.thicknessMap,t(P.thicknessMap,I.thicknessMapTransform)),I.attenuationDistance.value=P.attenuationDistance,I.attenuationColor.value.copy(P.attenuationColor)),P.anisotropy>0&&(I.anisotropyVector.value.set(P.anisotropy*Math.cos(P.anisotropyRotation),P.anisotropy*Math.sin(P.anisotropyRotation)),P.anisotropyMap&&(I.anisotropyMap.value=P.anisotropyMap,t(P.anisotropyMap,I.anisotropyMapTransform))),I.specularIntensity.value=P.specularIntensity,I.specularColor.value.copy(P.specularColor),P.specularColorMap&&(I.specularColorMap.value=P.specularColorMap,t(P.specularColorMap,I.specularColorMapTransform)),P.specularIntensityMap&&(I.specularIntensityMap.value=P.specularIntensityMap,t(P.specularIntensityMap,I.specularIntensityMapTransform))}function N(I,P){P.matcap&&(I.matcap.value=P.matcap)}function O(I,P){const j=e.get(P).light;I.referencePosition.value.setFromMatrixPosition(j.matrixWorld),I.nearDistance.value=j.shadow.camera.near,I.farDistance.value=j.shadow.camera.far}return{refreshFogUniforms:o,refreshMaterialUniforms:a}}function WebGLUniformsGroups(s,e,t,o){let a={},c={},d=[];const g=t.isWebGL2?s.getParameter(s.MAX_UNIFORM_BUFFER_BINDINGS):0;function y(j,B){const H=B.program;o.uniformBlockBinding(j,H)}function _(j,B){let H=a[j.id];H===void 0&&(N(j),H=E(j),a[j.id]=H,j.addEventListener("dispose",I));const se=B.program;o.updateUBOMapping(j,se);const oe=e.render.frame;c[j.id]!==oe&&(A(j),c[j.id]=oe)}function E(j){const B=S();j.__bindingPointIndex=B;const H=s.createBuffer(),se=j.__size,oe=j.usage;return s.bindBuffer(s.UNIFORM_BUFFER,H),s.bufferData(s.UNIFORM_BUFFER,se,oe),s.bindBuffer(s.UNIFORM_BUFFER,null),s.bindBufferBase(s.UNIFORM_BUFFER,B,H),H}function S(){for(let j=0;j<g;j++)if(d.indexOf(j)===-1)return d.push(j),j;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function A(j){const B=a[j.id],H=j.uniforms,se=j.__cache;s.bindBuffer(s.UNIFORM_BUFFER,B);for(let oe=0,Q=H.length;oe<Q;oe++){const fe=Array.isArray(H[oe])?H[oe]:[H[oe]];for(let Z=0,ce=fe.length;Z<ce;Z++){const ge=fe[Z];if(C(ge,oe,Z,se)===!0){const me=ge.__offset,V=Array.isArray(ge.value)?ge.value:[ge.value];let R=0;for(let L=0;L<V.length;L++){const z=V[L],Y=O(z);typeof z=="number"||typeof z=="boolean"?(ge.__data[0]=z,s.bufferSubData(s.UNIFORM_BUFFER,me+R,ge.__data)):z.isMatrix3?(ge.__data[0]=z.elements[0],ge.__data[1]=z.elements[1],ge.__data[2]=z.elements[2],ge.__data[3]=0,ge.__data[4]=z.elements[3],ge.__data[5]=z.elements[4],ge.__data[6]=z.elements[5],ge.__data[7]=0,ge.__data[8]=z.elements[6],ge.__data[9]=z.elements[7],ge.__data[10]=z.elements[8],ge.__data[11]=0):(z.toArray(ge.__data,R),R+=Y.storage/Float32Array.BYTES_PER_ELEMENT)}s.bufferSubData(s.UNIFORM_BUFFER,me,ge.__data)}}}s.bindBuffer(s.UNIFORM_BUFFER,null)}function C(j,B,H,se){const oe=j.value,Q=B+"_"+H;if(se[Q]===void 0)return typeof oe=="number"||typeof oe=="boolean"?se[Q]=oe:se[Q]=oe.clone(),!0;{const fe=se[Q];if(typeof oe=="number"||typeof oe=="boolean"){if(fe!==oe)return se[Q]=oe,!0}else if(fe.equals(oe)===!1)return fe.copy(oe),!0}return!1}function N(j){const B=j.uniforms;let H=0;const se=16;for(let Q=0,fe=B.length;Q<fe;Q++){const Z=Array.isArray(B[Q])?B[Q]:[B[Q]];for(let ce=0,ge=Z.length;ce<ge;ce++){const me=Z[ce],V=Array.isArray(me.value)?me.value:[me.value];for(let R=0,L=V.length;R<L;R++){const z=V[R],Y=O(z),W=H%se;W!==0&&se-W<Y.boundary&&(H+=se-W),me.__data=new Float32Array(Y.storage/Float32Array.BYTES_PER_ELEMENT),me.__offset=H,H+=Y.storage}}}const oe=H%se;return oe>0&&(H+=se-oe),j.__size=H,j.__cache={},this}function O(j){const B={boundary:0,storage:0};return typeof j=="number"||typeof j=="boolean"?(B.boundary=4,B.storage=4):j.isVector2?(B.boundary=8,B.storage=8):j.isVector3||j.isColor?(B.boundary=16,B.storage=12):j.isVector4?(B.boundary=16,B.storage=16):j.isMatrix3?(B.boundary=48,B.storage=48):j.isMatrix4?(B.boundary=64,B.storage=64):j.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",j),B}function I(j){const B=j.target;B.removeEventListener("dispose",I);const H=d.indexOf(B.__bindingPointIndex);d.splice(H,1),s.deleteBuffer(a[B.id]),delete a[B.id],delete c[B.id]}function P(){for(const j in a)s.deleteBuffer(a[j]);d=[],a={},c={}}return{bind:y,update:_,dispose:P}}class WebGLRenderer{constructor(e={}){const{canvas:t=createCanvasElement(),context:o=null,depth:a=!0,stencil:c=!0,alpha:d=!1,antialias:g=!1,premultipliedAlpha:y=!0,preserveDrawingBuffer:_=!1,powerPreference:E="default",failIfMajorPerformanceCaveat:S=!1}=e;this.isWebGLRenderer=!0;let A;o!==null?A=o.getContextAttributes().alpha:A=d;const C=new Uint32Array(4),N=new Int32Array(4);let O=null,I=null;const P=[],j=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=SRGBColorSpace,this._useLegacyLights=!1,this.toneMapping=NoToneMapping,this.toneMappingExposure=1;const B=this;let H=!1,se=0,oe=0,Q=null,fe=-1,Z=null;const ce=new Vector4,ge=new Vector4;let me=null;const V=new Color(0);let R=0,L=t.width,z=t.height,Y=1,W=null,ee=null;const ie=new Vector4(0,0,L,z),X=new Vector4(0,0,L,z);let F=!1;const J=new Frustum;let Ee=!1,Re=!1,Te=null;const Ue=new Matrix4,ze=new Vector2,Ke=new Vector3,it={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ye(){return Q===null?Y:1}let Ce=o;function ft(de,Me){for(let De=0;De<de.length;De++){const Fe=de[De],Pe=t.getContext(Fe,Me);if(Pe!==null)return Pe}return null}try{const de={alpha:!0,depth:a,stencil:c,antialias:g,premultipliedAlpha:y,preserveDrawingBuffer:_,powerPreference:E,failIfMajorPerformanceCaveat:S};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${REVISION}`),t.addEventListener("webglcontextlost",st,!1),t.addEventListener("webglcontextrestored",ye,!1),t.addEventListener("webglcontextcreationerror",Xe,!1),Ce===null){const Me=["webgl2","webgl","experimental-webgl"];if(B.isWebGL1Renderer===!0&&Me.shift(),Ce=ft(Me,de),Ce===null)throw ft(Me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&Ce instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),Ce.getShaderPrecisionFormat===void 0&&(Ce.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(de){throw console.error("THREE.WebGLRenderer: "+de.message),de}let Ze,nt,dt,gt,et,he,ue,_e,Ge,He,Ve,pt,We,te,U,$,ae,be,Se,Ae,Ie,$e,je,lt;function ht(){Ze=new WebGLExtensions(Ce),nt=new WebGLCapabilities(Ce,Ze,e),Ze.init(nt),$e=new WebGLUtils(Ce,Ze,nt),dt=new WebGLState(Ce,Ze,nt),gt=new WebGLInfo(Ce),et=new WebGLProperties,he=new WebGLTextures(Ce,Ze,dt,et,nt,$e,gt),ue=new WebGLCubeMaps(B),_e=new WebGLCubeUVMaps(B),Ge=new WebGLAttributes(Ce,nt),je=new WebGLBindingStates(Ce,Ze,Ge,nt),He=new WebGLGeometries(Ce,Ge,gt,je),Ve=new WebGLObjects(Ce,He,Ge,gt),Se=new WebGLMorphtargets(Ce,nt,he),$=new WebGLClipping(et),pt=new WebGLPrograms(B,ue,_e,Ze,nt,je,$),We=new WebGLMaterials(B,et),te=new WebGLRenderLists,U=new WebGLRenderStates(Ze,nt),be=new WebGLBackground(B,ue,_e,dt,Ve,A,y),ae=new WebGLShadowMap(B,Ve,nt),lt=new WebGLUniformsGroups(Ce,gt,nt,dt),Ae=new WebGLBufferRenderer(Ce,Ze,gt,nt),Ie=new WebGLIndexedBufferRenderer(Ce,Ze,gt,nt),gt.programs=pt.programs,B.capabilities=nt,B.extensions=Ze,B.properties=et,B.renderLists=te,B.shadowMap=ae,B.state=dt,B.info=gt}ht();const yt=new WebXRManager(B,Ce);this.xr=yt,this.getContext=function(){return Ce},this.getContextAttributes=function(){return Ce.getContextAttributes()},this.forceContextLoss=function(){const de=Ze.get("WEBGL_lose_context");de&&de.loseContext()},this.forceContextRestore=function(){const de=Ze.get("WEBGL_lose_context");de&&de.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(de){de!==void 0&&(Y=de,this.setSize(L,z,!1))},this.getSize=function(de){return de.set(L,z)},this.setSize=function(de,Me,De=!0){if(yt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}L=de,z=Me,t.width=Math.floor(de*Y),t.height=Math.floor(Me*Y),De===!0&&(t.style.width=de+"px",t.style.height=Me+"px"),this.setViewport(0,0,de,Me)},this.getDrawingBufferSize=function(de){return de.set(L*Y,z*Y).floor()},this.setDrawingBufferSize=function(de,Me,De){L=de,z=Me,Y=De,t.width=Math.floor(de*De),t.height=Math.floor(Me*De),this.setViewport(0,0,de,Me)},this.getCurrentViewport=function(de){return de.copy(ce)},this.getViewport=function(de){return de.copy(ie)},this.setViewport=function(de,Me,De,Fe){de.isVector4?ie.set(de.x,de.y,de.z,de.w):ie.set(de,Me,De,Fe),dt.viewport(ce.copy(ie).multiplyScalar(Y).floor())},this.getScissor=function(de){return de.copy(X)},this.setScissor=function(de,Me,De,Fe){de.isVector4?X.set(de.x,de.y,de.z,de.w):X.set(de,Me,De,Fe),dt.scissor(ge.copy(X).multiplyScalar(Y).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(de){dt.setScissorTest(F=de)},this.setOpaqueSort=function(de){W=de},this.setTransparentSort=function(de){ee=de},this.getClearColor=function(de){return de.copy(be.getClearColor())},this.setClearColor=function(){be.setClearColor.apply(be,arguments)},this.getClearAlpha=function(){return be.getClearAlpha()},this.setClearAlpha=function(){be.setClearAlpha.apply(be,arguments)},this.clear=function(de=!0,Me=!0,De=!0){let Fe=0;if(de){let Pe=!1;if(Q!==null){const rt=Q.texture.format;Pe=rt===RGBAIntegerFormat||rt===RGIntegerFormat||rt===RedIntegerFormat}if(Pe){const rt=Q.texture.type,ot=rt===UnsignedByteType||rt===UnsignedIntType||rt===UnsignedShortType||rt===UnsignedInt248Type||rt===UnsignedShort4444Type||rt===UnsignedShort5551Type,St=be.getClearColor(),Et=be.getClearAlpha(),Rt=St.r,Oe=St.g,Mt=St.b;ot?(C[0]=Rt,C[1]=Oe,C[2]=Mt,C[3]=Et,Ce.clearBufferuiv(Ce.COLOR,0,C)):(N[0]=Rt,N[1]=Oe,N[2]=Mt,N[3]=Et,Ce.clearBufferiv(Ce.COLOR,0,N))}else Fe|=Ce.COLOR_BUFFER_BIT}Me&&(Fe|=Ce.DEPTH_BUFFER_BIT),De&&(Fe|=Ce.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Ce.clear(Fe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",st,!1),t.removeEventListener("webglcontextrestored",ye,!1),t.removeEventListener("webglcontextcreationerror",Xe,!1),te.dispose(),U.dispose(),et.dispose(),ue.dispose(),_e.dispose(),Ve.dispose(),je.dispose(),lt.dispose(),pt.dispose(),yt.dispose(),yt.removeEventListener("sessionstart",tn),yt.removeEventListener("sessionend",bt),Te&&(Te.dispose(),Te=null),Dt.stop()};function st(de){de.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),H=!0}function ye(){console.log("THREE.WebGLRenderer: Context Restored."),H=!1;const de=gt.autoReset,Me=ae.enabled,De=ae.autoUpdate,Fe=ae.needsUpdate,Pe=ae.type;ht(),gt.autoReset=de,ae.enabled=Me,ae.autoUpdate=De,ae.needsUpdate=Fe,ae.type=Pe}function Xe(de){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",de.statusMessage)}function ct(de){const Me=de.target;Me.removeEventListener("dispose",ct),mt(Me)}function mt(de){at(de),et.remove(de)}function at(de){const Me=et.get(de).programs;Me!==void 0&&(Me.forEach(function(De){pt.releaseProgram(De)}),de.isShaderMaterial&&pt.releaseShaderCache(de))}this.renderBufferDirect=function(de,Me,De,Fe,Pe,rt){Me===null&&(Me=it);const ot=Pe.isMesh&&Pe.matrixWorld.determinant()<0,St=Ft(de,Me,De,Fe,Pe);dt.setMaterial(Fe,ot);let Et=De.index,Rt=1;if(Fe.wireframe===!0){if(Et=He.getWireframeAttribute(De),Et===void 0)return;Rt=2}const Oe=De.drawRange,Mt=De.attributes.position;let Ct=Oe.start*Rt,Qt=(Oe.start+Oe.count)*Rt;rt!==null&&(Ct=Math.max(Ct,rt.start*Rt),Qt=Math.min(Qt,(rt.start+rt.count)*Rt)),Et!==null?(Ct=Math.max(Ct,0),Qt=Math.min(Qt,Et.count)):Mt!=null&&(Ct=Math.max(Ct,0),Qt=Math.min(Qt,Mt.count));const Jt=Qt-Ct;if(Jt<0||Jt===1/0)return;je.setup(Pe,Fe,St,De,Et);let Lt,_t=Ae;if(Et!==null&&(Lt=Ge.get(Et),_t=Ie,_t.setIndex(Lt)),Pe.isMesh)Fe.wireframe===!0?(dt.setLineWidth(Fe.wireframeLinewidth*Ye()),_t.setMode(Ce.LINES)):_t.setMode(Ce.TRIANGLES);else if(Pe.isLine){let ut=Fe.linewidth;ut===void 0&&(ut=1),dt.setLineWidth(ut*Ye()),Pe.isLineSegments?_t.setMode(Ce.LINES):Pe.isLineLoop?_t.setMode(Ce.LINE_LOOP):_t.setMode(Ce.LINE_STRIP)}else Pe.isPoints?_t.setMode(Ce.POINTS):Pe.isSprite&&_t.setMode(Ce.TRIANGLES);if(Pe.isBatchedMesh)_t.renderMultiDraw(Pe._multiDrawStarts,Pe._multiDrawCounts,Pe._multiDrawCount);else if(Pe.isInstancedMesh)_t.renderInstances(Ct,Jt,Pe.count);else if(De.isInstancedBufferGeometry){const ut=De._maxInstanceCount!==void 0?De._maxInstanceCount:1/0,In=Math.min(De.instanceCount,ut);_t.renderInstances(Ct,Jt,In)}else _t.render(Ct,Jt)};function Vt(de,Me,De){de.transparent===!0&&de.side===DoubleSide&&de.forceSinglePass===!1?(de.side=BackSide,de.needsUpdate=!0,Qe(de,Me,De),de.side=FrontSide,de.needsUpdate=!0,Qe(de,Me,De),de.side=DoubleSide):Qe(de,Me,De)}this.compile=function(de,Me,De=null){De===null&&(De=de),I=U.get(De),I.init(),j.push(I),De.traverseVisible(function(Pe){Pe.isLight&&Pe.layers.test(Me.layers)&&(I.pushLight(Pe),Pe.castShadow&&I.pushShadow(Pe))}),de!==De&&de.traverseVisible(function(Pe){Pe.isLight&&Pe.layers.test(Me.layers)&&(I.pushLight(Pe),Pe.castShadow&&I.pushShadow(Pe))}),I.setupLights(B._useLegacyLights);const Fe=new Set;return de.traverse(function(Pe){const rt=Pe.material;if(rt)if(Array.isArray(rt))for(let ot=0;ot<rt.length;ot++){const St=rt[ot];Vt(St,De,Pe),Fe.add(St)}else Vt(rt,De,Pe),Fe.add(rt)}),j.pop(),I=null,Fe},this.compileAsync=function(de,Me,De=null){const Fe=this.compile(de,Me,De);return new Promise(Pe=>{function rt(){if(Fe.forEach(function(ot){et.get(ot).currentProgram.isReady()&&Fe.delete(ot)}),Fe.size===0){Pe(de);return}setTimeout(rt,10)}Ze.get("KHR_parallel_shader_compile")!==null?rt():setTimeout(rt,10)})};let xt=null;function It(de){xt&&xt(de)}function tn(){Dt.stop()}function bt(){Dt.start()}const Dt=new WebGLAnimation;Dt.setAnimationLoop(It),typeof self<"u"&&Dt.setContext(self),this.setAnimationLoop=function(de){xt=de,yt.setAnimationLoop(de),de===null?Dt.stop():Dt.start()},yt.addEventListener("sessionstart",tn),yt.addEventListener("sessionend",bt),this.render=function(de,Me){if(Me!==void 0&&Me.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(H===!0)return;de.matrixWorldAutoUpdate===!0&&de.updateMatrixWorld(),Me.parent===null&&Me.matrixWorldAutoUpdate===!0&&Me.updateMatrixWorld(),yt.enabled===!0&&yt.isPresenting===!0&&(yt.cameraAutoUpdate===!0&&yt.updateCamera(Me),Me=yt.getCamera()),de.isScene===!0&&de.onBeforeRender(B,de,Me,Q),I=U.get(de,j.length),I.init(),j.push(I),Ue.multiplyMatrices(Me.projectionMatrix,Me.matrixWorldInverse),J.setFromProjectionMatrix(Ue),Re=this.localClippingEnabled,Ee=$.init(this.clippingPlanes,Re),O=te.get(de,P.length),O.init(),P.push(O),on(de,Me,0,B.sortObjects),O.finish(),B.sortObjects===!0&&O.sort(W,ee),this.info.render.frame++,Ee===!0&&$.beginShadows();const De=I.state.shadowsArray;if(ae.render(De,de,Me),Ee===!0&&$.endShadows(),this.info.autoReset===!0&&this.info.reset(),be.render(O,de),I.setupLights(B._useLegacyLights),Me.isArrayCamera){const Fe=Me.cameras;for(let Pe=0,rt=Fe.length;Pe<rt;Pe++){const ot=Fe[Pe];Wt(O,de,ot,ot.viewport)}}else Wt(O,de,Me);Q!==null&&(he.updateMultisampleRenderTarget(Q),he.updateRenderTargetMipmap(Q)),de.isScene===!0&&de.onAfterRender(B,de,Me),je.resetDefaultState(),fe=-1,Z=null,j.pop(),j.length>0?I=j[j.length-1]:I=null,P.pop(),P.length>0?O=P[P.length-1]:O=null};function on(de,Me,De,Fe){if(de.visible===!1)return;if(de.layers.test(Me.layers)){if(de.isGroup)De=de.renderOrder;else if(de.isLOD)de.autoUpdate===!0&&de.update(Me);else if(de.isLight)I.pushLight(de),de.castShadow&&I.pushShadow(de);else if(de.isSprite){if(!de.frustumCulled||J.intersectsSprite(de)){Fe&&Ke.setFromMatrixPosition(de.matrixWorld).applyMatrix4(Ue);const ot=Ve.update(de),St=de.material;St.visible&&O.push(de,ot,St,De,Ke.z,null)}}else if((de.isMesh||de.isLine||de.isPoints)&&(!de.frustumCulled||J.intersectsObject(de))){const ot=Ve.update(de),St=de.material;if(Fe&&(de.boundingSphere!==void 0?(de.boundingSphere===null&&de.computeBoundingSphere(),Ke.copy(de.boundingSphere.center)):(ot.boundingSphere===null&&ot.computeBoundingSphere(),Ke.copy(ot.boundingSphere.center)),Ke.applyMatrix4(de.matrixWorld).applyMatrix4(Ue)),Array.isArray(St)){const Et=ot.groups;for(let Rt=0,Oe=Et.length;Rt<Oe;Rt++){const Mt=Et[Rt],Ct=St[Mt.materialIndex];Ct&&Ct.visible&&O.push(de,ot,Ct,De,Ke.z,Mt)}}else St.visible&&O.push(de,ot,St,De,Ke.z,null)}}const rt=de.children;for(let ot=0,St=rt.length;ot<St;ot++)on(rt[ot],Me,De,Fe)}function Wt(de,Me,De,Fe){const Pe=de.opaque,rt=de.transmissive,ot=de.transparent;I.setupLightsView(De),Ee===!0&&$.setGlobalState(B.clippingPlanes,De),rt.length>0&&kt(Pe,rt,Me,De),Fe&&dt.viewport(ce.copy(Fe)),Pe.length>0&&yn(Pe,Me,De),rt.length>0&&yn(rt,Me,De),ot.length>0&&yn(ot,Me,De),dt.buffers.depth.setTest(!0),dt.buffers.depth.setMask(!0),dt.buffers.color.setMask(!0),dt.setPolygonOffset(!1)}function kt(de,Me,De,Fe){if((De.isScene===!0?De.overrideMaterial:null)!==null)return;const rt=nt.isWebGL2;Te===null&&(Te=new WebGLRenderTarget(1,1,{generateMipmaps:!0,type:Ze.has("EXT_color_buffer_half_float")?HalfFloatType:UnsignedByteType,minFilter:LinearMipmapLinearFilter,samples:rt?4:0})),B.getDrawingBufferSize(ze),rt?Te.setSize(ze.x,ze.y):Te.setSize(floorPowerOfTwo(ze.x),floorPowerOfTwo(ze.y));const ot=B.getRenderTarget();B.setRenderTarget(Te),B.getClearColor(V),R=B.getClearAlpha(),R<1&&B.setClearColor(16777215,.5),B.clear();const St=B.toneMapping;B.toneMapping=NoToneMapping,yn(de,De,Fe),he.updateMultisampleRenderTarget(Te),he.updateRenderTargetMipmap(Te);let Et=!1;for(let Rt=0,Oe=Me.length;Rt<Oe;Rt++){const Mt=Me[Rt],Ct=Mt.object,Qt=Mt.geometry,Jt=Mt.material,Lt=Mt.group;if(Jt.side===DoubleSide&&Ct.layers.test(Fe.layers)){const _t=Jt.side;Jt.side=BackSide,Jt.needsUpdate=!0,Ut(Ct,De,Fe,Qt,Jt,Lt),Jt.side=_t,Jt.needsUpdate=!0,Et=!0}}Et===!0&&(he.updateMultisampleRenderTarget(Te),he.updateRenderTargetMipmap(Te)),B.setRenderTarget(ot),B.setClearColor(V,R),B.toneMapping=St}function yn(de,Me,De){const Fe=Me.isScene===!0?Me.overrideMaterial:null;for(let Pe=0,rt=de.length;Pe<rt;Pe++){const ot=de[Pe],St=ot.object,Et=ot.geometry,Rt=Fe===null?ot.material:Fe,Oe=ot.group;St.layers.test(De.layers)&&Ut(St,Me,De,Et,Rt,Oe)}}function Ut(de,Me,De,Fe,Pe,rt){de.onBeforeRender(B,Me,De,Fe,Pe,rt),de.modelViewMatrix.multiplyMatrices(De.matrixWorldInverse,de.matrixWorld),de.normalMatrix.getNormalMatrix(de.modelViewMatrix),Pe.onBeforeRender(B,Me,De,Fe,de,rt),Pe.transparent===!0&&Pe.side===DoubleSide&&Pe.forceSinglePass===!1?(Pe.side=BackSide,Pe.needsUpdate=!0,B.renderBufferDirect(De,Me,Fe,Pe,de,rt),Pe.side=FrontSide,Pe.needsUpdate=!0,B.renderBufferDirect(De,Me,Fe,Pe,de,rt),Pe.side=DoubleSide):B.renderBufferDirect(De,Me,Fe,Pe,de,rt),de.onAfterRender(B,Me,De,Fe,Pe,rt)}function Qe(de,Me,De){Me.isScene!==!0&&(Me=it);const Fe=et.get(de),Pe=I.state.lights,rt=I.state.shadowsArray,ot=Pe.state.version,St=pt.getParameters(de,Pe.state,rt,Me,De),Et=pt.getProgramCacheKey(St);let Rt=Fe.programs;Fe.environment=de.isMeshStandardMaterial?Me.environment:null,Fe.fog=Me.fog,Fe.envMap=(de.isMeshStandardMaterial?_e:ue).get(de.envMap||Fe.environment),Rt===void 0&&(de.addEventListener("dispose",ct),Rt=new Map,Fe.programs=Rt);let Oe=Rt.get(Et);if(Oe!==void 0){if(Fe.currentProgram===Oe&&Fe.lightsStateVersion===ot)return Kt(de,St),Oe}else St.uniforms=pt.getUniforms(de),de.onBuild(De,St,B),de.onBeforeCompile(St,B),Oe=pt.acquireProgram(St,Et),Rt.set(Et,Oe),Fe.uniforms=St.uniforms;const Mt=Fe.uniforms;return(!de.isShaderMaterial&&!de.isRawShaderMaterial||de.clipping===!0)&&(Mt.clippingPlanes=$.uniform),Kt(de,St),Fe.needsLights=Xt(de),Fe.lightsStateVersion=ot,Fe.needsLights&&(Mt.ambientLightColor.value=Pe.state.ambient,Mt.lightProbe.value=Pe.state.probe,Mt.directionalLights.value=Pe.state.directional,Mt.directionalLightShadows.value=Pe.state.directionalShadow,Mt.spotLights.value=Pe.state.spot,Mt.spotLightShadows.value=Pe.state.spotShadow,Mt.rectAreaLights.value=Pe.state.rectArea,Mt.ltc_1.value=Pe.state.rectAreaLTC1,Mt.ltc_2.value=Pe.state.rectAreaLTC2,Mt.pointLights.value=Pe.state.point,Mt.pointLightShadows.value=Pe.state.pointShadow,Mt.hemisphereLights.value=Pe.state.hemi,Mt.directionalShadowMap.value=Pe.state.directionalShadowMap,Mt.directionalShadowMatrix.value=Pe.state.directionalShadowMatrix,Mt.spotShadowMap.value=Pe.state.spotShadowMap,Mt.spotLightMatrix.value=Pe.state.spotLightMatrix,Mt.spotLightMap.value=Pe.state.spotLightMap,Mt.pointShadowMap.value=Pe.state.pointShadowMap,Mt.pointShadowMatrix.value=Pe.state.pointShadowMatrix),Fe.currentProgram=Oe,Fe.uniformsList=null,Oe}function An(de){if(de.uniformsList===null){const Me=de.currentProgram.getUniforms();de.uniformsList=WebGLUniforms.seqWithValue(Me.seq,de.uniforms)}return de.uniformsList}function Kt(de,Me){const De=et.get(de);De.outputColorSpace=Me.outputColorSpace,De.batching=Me.batching,De.instancing=Me.instancing,De.instancingColor=Me.instancingColor,De.skinning=Me.skinning,De.morphTargets=Me.morphTargets,De.morphNormals=Me.morphNormals,De.morphColors=Me.morphColors,De.morphTargetsCount=Me.morphTargetsCount,De.numClippingPlanes=Me.numClippingPlanes,De.numIntersection=Me.numClipIntersection,De.vertexAlphas=Me.vertexAlphas,De.vertexTangents=Me.vertexTangents,De.toneMapping=Me.toneMapping}function Ft(de,Me,De,Fe,Pe){Me.isScene!==!0&&(Me=it),he.resetTextureUnits();const rt=Me.fog,ot=Fe.isMeshStandardMaterial?Me.environment:null,St=Q===null?B.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:LinearSRGBColorSpace,Et=(Fe.isMeshStandardMaterial?_e:ue).get(Fe.envMap||ot),Rt=Fe.vertexColors===!0&&!!De.attributes.color&&De.attributes.color.itemSize===4,Oe=!!De.attributes.tangent&&(!!Fe.normalMap||Fe.anisotropy>0),Mt=!!De.morphAttributes.position,Ct=!!De.morphAttributes.normal,Qt=!!De.morphAttributes.color;let Jt=NoToneMapping;Fe.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(Jt=B.toneMapping);const Lt=De.morphAttributes.position||De.morphAttributes.normal||De.morphAttributes.color,_t=Lt!==void 0?Lt.length:0,ut=et.get(Fe),In=I.state.lights;if(Ee===!0&&(Re===!0||de!==Z)){const ln=de===Z&&Fe.id===fe;$.setState(Fe,de,ln)}let zt=!1;Fe.version===ut.__version?(ut.needsLights&&ut.lightsStateVersion!==In.state.version||ut.outputColorSpace!==St||Pe.isBatchedMesh&&ut.batching===!1||!Pe.isBatchedMesh&&ut.batching===!0||Pe.isInstancedMesh&&ut.instancing===!1||!Pe.isInstancedMesh&&ut.instancing===!0||Pe.isSkinnedMesh&&ut.skinning===!1||!Pe.isSkinnedMesh&&ut.skinning===!0||Pe.isInstancedMesh&&ut.instancingColor===!0&&Pe.instanceColor===null||Pe.isInstancedMesh&&ut.instancingColor===!1&&Pe.instanceColor!==null||ut.envMap!==Et||Fe.fog===!0&&ut.fog!==rt||ut.numClippingPlanes!==void 0&&(ut.numClippingPlanes!==$.numPlanes||ut.numIntersection!==$.numIntersection)||ut.vertexAlphas!==Rt||ut.vertexTangents!==Oe||ut.morphTargets!==Mt||ut.morphNormals!==Ct||ut.morphColors!==Qt||ut.toneMapping!==Jt||nt.isWebGL2===!0&&ut.morphTargetsCount!==_t)&&(zt=!0):(zt=!0,ut.__version=Fe.version);let Ln=ut.currentProgram;zt===!0&&(Ln=Qe(Fe,Me,Pe));let rn=!1,_n=!1,Wn=!1;const Bt=Ln.getUniforms(),xn=ut.uniforms;if(dt.useProgram(Ln.program)&&(rn=!0,_n=!0,Wn=!0),Fe.id!==fe&&(fe=Fe.id,_n=!0),rn||Z!==de){Bt.setValue(Ce,"projectionMatrix",de.projectionMatrix),Bt.setValue(Ce,"viewMatrix",de.matrixWorldInverse);const ln=Bt.map.cameraPosition;ln!==void 0&&ln.setValue(Ce,Ke.setFromMatrixPosition(de.matrixWorld)),nt.logarithmicDepthBuffer&&Bt.setValue(Ce,"logDepthBufFC",2/(Math.log(de.far+1)/Math.LN2)),(Fe.isMeshPhongMaterial||Fe.isMeshToonMaterial||Fe.isMeshLambertMaterial||Fe.isMeshBasicMaterial||Fe.isMeshStandardMaterial||Fe.isShaderMaterial)&&Bt.setValue(Ce,"isOrthographic",de.isOrthographicCamera===!0),Z!==de&&(Z=de,_n=!0,Wn=!0)}if(Pe.isSkinnedMesh){Bt.setOptional(Ce,Pe,"bindMatrix"),Bt.setOptional(Ce,Pe,"bindMatrixInverse");const ln=Pe.skeleton;ln&&(nt.floatVertexTextures?(ln.boneTexture===null&&ln.computeBoneTexture(),Bt.setValue(Ce,"boneTexture",ln.boneTexture,he)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}Pe.isBatchedMesh&&(Bt.setOptional(Ce,Pe,"batchingTexture"),Bt.setValue(Ce,"batchingTexture",Pe._matricesTexture,he));const Kn=De.morphAttributes;if((Kn.position!==void 0||Kn.normal!==void 0||Kn.color!==void 0&&nt.isWebGL2===!0)&&Se.update(Pe,De,Ln),(_n||ut.receiveShadow!==Pe.receiveShadow)&&(ut.receiveShadow=Pe.receiveShadow,Bt.setValue(Ce,"receiveShadow",Pe.receiveShadow)),Fe.isMeshGouraudMaterial&&Fe.envMap!==null&&(xn.envMap.value=Et,xn.flipEnvMap.value=Et.isCubeTexture&&Et.isRenderTargetTexture===!1?-1:1),_n&&(Bt.setValue(Ce,"toneMappingExposure",B.toneMappingExposure),ut.needsLights&&Mn(xn,Wn),rt&&Fe.fog===!0&&We.refreshFogUniforms(xn,rt),We.refreshMaterialUniforms(xn,Fe,Y,z,Te),WebGLUniforms.upload(Ce,An(ut),xn,he)),Fe.isShaderMaterial&&Fe.uniformsNeedUpdate===!0&&(WebGLUniforms.upload(Ce,An(ut),xn,he),Fe.uniformsNeedUpdate=!1),Fe.isSpriteMaterial&&Bt.setValue(Ce,"center",Pe.center),Bt.setValue(Ce,"modelViewMatrix",Pe.modelViewMatrix),Bt.setValue(Ce,"normalMatrix",Pe.normalMatrix),Bt.setValue(Ce,"modelMatrix",Pe.matrixWorld),Fe.isShaderMaterial||Fe.isRawShaderMaterial){const ln=Fe.uniformsGroups;for(let jt=0,dn=ln.length;jt<dn;jt++)if(nt.isWebGL2){const Ne=ln[jt];lt.update(Ne,Ln),lt.bind(Ne,Ln)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Ln}function Mn(de,Me){de.ambientLightColor.needsUpdate=Me,de.lightProbe.needsUpdate=Me,de.directionalLights.needsUpdate=Me,de.directionalLightShadows.needsUpdate=Me,de.pointLights.needsUpdate=Me,de.pointLightShadows.needsUpdate=Me,de.spotLights.needsUpdate=Me,de.spotLightShadows.needsUpdate=Me,de.rectAreaLights.needsUpdate=Me,de.hemisphereLights.needsUpdate=Me}function Xt(de){return de.isMeshLambertMaterial||de.isMeshToonMaterial||de.isMeshPhongMaterial||de.isMeshStandardMaterial||de.isShadowMaterial||de.isShaderMaterial&&de.lights===!0}this.getActiveCubeFace=function(){return se},this.getActiveMipmapLevel=function(){return oe},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function(de,Me,De){et.get(de.texture).__webglTexture=Me,et.get(de.depthTexture).__webglTexture=De;const Fe=et.get(de);Fe.__hasExternalTextures=!0,Fe.__hasExternalTextures&&(Fe.__autoAllocateDepthBuffer=De===void 0,Fe.__autoAllocateDepthBuffer||Ze.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Fe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(de,Me){const De=et.get(de);De.__webglFramebuffer=Me,De.__useDefaultFramebuffer=Me===void 0},this.setRenderTarget=function(de,Me=0,De=0){Q=de,se=Me,oe=De;let Fe=!0,Pe=null,rt=!1,ot=!1;if(de){const Et=et.get(de);Et.__useDefaultFramebuffer!==void 0?(dt.bindFramebuffer(Ce.FRAMEBUFFER,null),Fe=!1):Et.__webglFramebuffer===void 0?he.setupRenderTarget(de):Et.__hasExternalTextures&&he.rebindTextures(de,et.get(de.texture).__webglTexture,et.get(de.depthTexture).__webglTexture);const Rt=de.texture;(Rt.isData3DTexture||Rt.isDataArrayTexture||Rt.isCompressedArrayTexture)&&(ot=!0);const Oe=et.get(de).__webglFramebuffer;de.isWebGLCubeRenderTarget?(Array.isArray(Oe[Me])?Pe=Oe[Me][De]:Pe=Oe[Me],rt=!0):nt.isWebGL2&&de.samples>0&&he.useMultisampledRTT(de)===!1?Pe=et.get(de).__webglMultisampledFramebuffer:Array.isArray(Oe)?Pe=Oe[De]:Pe=Oe,ce.copy(de.viewport),ge.copy(de.scissor),me=de.scissorTest}else ce.copy(ie).multiplyScalar(Y).floor(),ge.copy(X).multiplyScalar(Y).floor(),me=F;if(dt.bindFramebuffer(Ce.FRAMEBUFFER,Pe)&&nt.drawBuffers&&Fe&&dt.drawBuffers(de,Pe),dt.viewport(ce),dt.scissor(ge),dt.setScissorTest(me),rt){const Et=et.get(de.texture);Ce.framebufferTexture2D(Ce.FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Ce.TEXTURE_CUBE_MAP_POSITIVE_X+Me,Et.__webglTexture,De)}else if(ot){const Et=et.get(de.texture),Rt=Me||0;Ce.framebufferTextureLayer(Ce.FRAMEBUFFER,Ce.COLOR_ATTACHMENT0,Et.__webglTexture,De||0,Rt)}fe=-1},this.readRenderTargetPixels=function(de,Me,De,Fe,Pe,rt,ot){if(!(de&&de.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let St=et.get(de).__webglFramebuffer;if(de.isWebGLCubeRenderTarget&&ot!==void 0&&(St=St[ot]),St){dt.bindFramebuffer(Ce.FRAMEBUFFER,St);try{const Et=de.texture,Rt=Et.format,Oe=Et.type;if(Rt!==RGBAFormat&&$e.convert(Rt)!==Ce.getParameter(Ce.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Mt=Oe===HalfFloatType&&(Ze.has("EXT_color_buffer_half_float")||nt.isWebGL2&&Ze.has("EXT_color_buffer_float"));if(Oe!==UnsignedByteType&&$e.convert(Oe)!==Ce.getParameter(Ce.IMPLEMENTATION_COLOR_READ_TYPE)&&!(Oe===FloatType&&(nt.isWebGL2||Ze.has("OES_texture_float")||Ze.has("WEBGL_color_buffer_float")))&&!Mt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Me>=0&&Me<=de.width-Fe&&De>=0&&De<=de.height-Pe&&Ce.readPixels(Me,De,Fe,Pe,$e.convert(Rt),$e.convert(Oe),rt)}finally{const Et=Q!==null?et.get(Q).__webglFramebuffer:null;dt.bindFramebuffer(Ce.FRAMEBUFFER,Et)}}},this.copyFramebufferToTexture=function(de,Me,De=0){const Fe=Math.pow(2,-De),Pe=Math.floor(Me.image.width*Fe),rt=Math.floor(Me.image.height*Fe);he.setTexture2D(Me,0),Ce.copyTexSubImage2D(Ce.TEXTURE_2D,De,0,0,de.x,de.y,Pe,rt),dt.unbindTexture()},this.copyTextureToTexture=function(de,Me,De,Fe=0){const Pe=Me.image.width,rt=Me.image.height,ot=$e.convert(De.format),St=$e.convert(De.type);he.setTexture2D(De,0),Ce.pixelStorei(Ce.UNPACK_FLIP_Y_WEBGL,De.flipY),Ce.pixelStorei(Ce.UNPACK_PREMULTIPLY_ALPHA_WEBGL,De.premultiplyAlpha),Ce.pixelStorei(Ce.UNPACK_ALIGNMENT,De.unpackAlignment),Me.isDataTexture?Ce.texSubImage2D(Ce.TEXTURE_2D,Fe,de.x,de.y,Pe,rt,ot,St,Me.image.data):Me.isCompressedTexture?Ce.compressedTexSubImage2D(Ce.TEXTURE_2D,Fe,de.x,de.y,Me.mipmaps[0].width,Me.mipmaps[0].height,ot,Me.mipmaps[0].data):Ce.texSubImage2D(Ce.TEXTURE_2D,Fe,de.x,de.y,ot,St,Me.image),Fe===0&&De.generateMipmaps&&Ce.generateMipmap(Ce.TEXTURE_2D),dt.unbindTexture()},this.copyTextureToTexture3D=function(de,Me,De,Fe,Pe=0){if(B.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const rt=de.max.x-de.min.x+1,ot=de.max.y-de.min.y+1,St=de.max.z-de.min.z+1,Et=$e.convert(Fe.format),Rt=$e.convert(Fe.type);let Oe;if(Fe.isData3DTexture)he.setTexture3D(Fe,0),Oe=Ce.TEXTURE_3D;else if(Fe.isDataArrayTexture||Fe.isCompressedArrayTexture)he.setTexture2DArray(Fe,0),Oe=Ce.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ce.pixelStorei(Ce.UNPACK_FLIP_Y_WEBGL,Fe.flipY),Ce.pixelStorei(Ce.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Fe.premultiplyAlpha),Ce.pixelStorei(Ce.UNPACK_ALIGNMENT,Fe.unpackAlignment);const Mt=Ce.getParameter(Ce.UNPACK_ROW_LENGTH),Ct=Ce.getParameter(Ce.UNPACK_IMAGE_HEIGHT),Qt=Ce.getParameter(Ce.UNPACK_SKIP_PIXELS),Jt=Ce.getParameter(Ce.UNPACK_SKIP_ROWS),Lt=Ce.getParameter(Ce.UNPACK_SKIP_IMAGES),_t=De.isCompressedTexture?De.mipmaps[Pe]:De.image;Ce.pixelStorei(Ce.UNPACK_ROW_LENGTH,_t.width),Ce.pixelStorei(Ce.UNPACK_IMAGE_HEIGHT,_t.height),Ce.pixelStorei(Ce.UNPACK_SKIP_PIXELS,de.min.x),Ce.pixelStorei(Ce.UNPACK_SKIP_ROWS,de.min.y),Ce.pixelStorei(Ce.UNPACK_SKIP_IMAGES,de.min.z),De.isDataTexture||De.isData3DTexture?Ce.texSubImage3D(Oe,Pe,Me.x,Me.y,Me.z,rt,ot,St,Et,Rt,_t.data):De.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ce.compressedTexSubImage3D(Oe,Pe,Me.x,Me.y,Me.z,rt,ot,St,Et,_t.data)):Ce.texSubImage3D(Oe,Pe,Me.x,Me.y,Me.z,rt,ot,St,Et,Rt,_t),Ce.pixelStorei(Ce.UNPACK_ROW_LENGTH,Mt),Ce.pixelStorei(Ce.UNPACK_IMAGE_HEIGHT,Ct),Ce.pixelStorei(Ce.UNPACK_SKIP_PIXELS,Qt),Ce.pixelStorei(Ce.UNPACK_SKIP_ROWS,Jt),Ce.pixelStorei(Ce.UNPACK_SKIP_IMAGES,Lt),Pe===0&&Fe.generateMipmaps&&Ce.generateMipmap(Oe),dt.unbindTexture()},this.initTexture=function(de){de.isCubeTexture?he.setTextureCube(de,0):de.isData3DTexture?he.setTexture3D(de,0):de.isDataArrayTexture||de.isCompressedArrayTexture?he.setTexture2DArray(de,0):he.setTexture2D(de,0),dt.unbindTexture()},this.resetState=function(){se=0,oe=0,Q=null,dt.reset(),je.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return WebGLCoordinateSystem}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===DisplayP3ColorSpace?"display-p3":"srgb",t.unpackColorSpace=ColorManagement.workingColorSpace===LinearDisplayP3ColorSpace?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===SRGBColorSpace?sRGBEncoding:LinearEncoding}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===sRGBEncoding?SRGBColorSpace:LinearSRGBColorSpace}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class WebGL1Renderer extends WebGLRenderer{}WebGL1Renderer.prototype.isWebGL1Renderer=!0;class Scene extends Object3D{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class CanvasTexture extends Texture{constructor(e,t,o,a,c,d,g,y,_){super(e,t,o,a,c,d,g,y,_),this.isCanvasTexture=!0,this.needsUpdate=!0}}class MeshStandardMaterial extends Material{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Light extends Object3D{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Color(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const _projScreenMatrix$1=new Matrix4,_lightPositionWorld$1=new Vector3,_lookTarget$1=new Vector3;class LightShadow{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,o=this.matrix;_lightPositionWorld$1.setFromMatrixPosition(e.matrixWorld),t.position.copy(_lightPositionWorld$1),_lookTarget$1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(_lookTarget$1),t.updateMatrixWorld(),_projScreenMatrix$1.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix$1),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(_projScreenMatrix$1)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}const _projScreenMatrix=new Matrix4,_lightPositionWorld=new Vector3,_lookTarget=new Vector3;class PointLightShadow extends LightShadow{constructor(){super(new PerspectiveCamera(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}updateMatrices(e,t=0){const o=this.camera,a=this.matrix,c=e.distance||o.far;c!==o.far&&(o.far=c,o.updateProjectionMatrix()),_lightPositionWorld.setFromMatrixPosition(e.matrixWorld),o.position.copy(_lightPositionWorld),_lookTarget.copy(o.position),_lookTarget.add(this._cubeDirections[t]),o.up.copy(this._cubeUps[t]),o.lookAt(_lookTarget),o.updateMatrixWorld(),a.makeTranslation(-_lightPositionWorld.x,-_lightPositionWorld.y,-_lightPositionWorld.z),_projScreenMatrix.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_projScreenMatrix)}}class PointLight extends Light{constructor(e,t,o=0,a=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=o,this.decay=a,this.shadow=new PointLightShadow}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class DirectionalLightShadow extends LightShadow{constructor(){super(new OrthographicCamera(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class DirectionalLight extends Light{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Object3D.DEFAULT_UP),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class AmbientLight extends Light{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:REVISION}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=REVISION);function createQRTexture(s){const t=document.createElement("canvas");t.width=256,t.height=256;const o=t.getContext("2d"),a=document.createElement("div");document.body.appendChild(a);const c=document.createElement("img");return c.src=`https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=${encodeURIComponent(s)}`,new Promise(d=>{c.onload=()=>{o.clearRect(0,0,256,256),o.drawImage(c,0,0,256,256),document.body.removeChild(a),d(new CanvasTexture(t))},a.appendChild(c)})}const BOX_SIZE=2;function ThreeDBoxSection(){const{t:s}=useTranslation(),e=reactExports.useRef(),t="https://spp-demo-nft.com/free-nft";return reactExports.useEffect(()=>{let o,a,c,d,g,y,_=350,E=350;const S=async()=>{if(!e.current)return;a=new WebGLRenderer({antialias:!0,alpha:!0}),a.setSize(_,E),a.setClearColor(0,0),e.current.appendChild(a.domElement),c=new Scene,d=new PerspectiveCamera(50,_/E,.1,100),d.position.set(0,0,5);const C=[];for(let j=0;j<6;j++)if(j===4)y=await createQRTexture(t),C.push(new MeshBasicMaterial({map:y}));else{const B=[5195493,6514417,8141549,9133302,9647082,11032055];C.push(new MeshStandardMaterial({color:B[j],metalness:.3,roughness:.4}))}const N=new BoxGeometry(BOX_SIZE,BOX_SIZE,BOX_SIZE);g=new Mesh(N,C),g.castShadow=!0,g.receiveShadow=!0,c.add(g),console.log("Box created and added to scene:",g);const O=new AmbientLight(16777215,.7);c.add(O);const I=new DirectionalLight(16777215,1.2);I.position.set(5,5,5),I.castShadow=!0,c.add(I);const P=new PointLight(5195493,.5,10);P.position.set(0,2,2),c.add(P),console.log("Scene initialized with box, lights, and camera"),A()},A=()=>{let C=0;if(e.current){const N=e.current.getBoundingClientRect(),O=window.innerHeight;N.top<O&&N.bottom>0&&(C=1-(N.bottom-O)/(N.height+O),C=Math.max(0,Math.min(1,C)))}if(g&&a){const N=Date.now()*.001,O=C<.1?Math.sin(N*.5)*.1:0;g.rotation.y=C*Math.PI*2+O,g.rotation.x=.2+C*.5+O*.5,g.position.x=C*2.5,g.position.y=-C*1.5,a.render(c,d),Math.floor(C*100)%10===0&&console.log("Box animation - scrollY:",C,"rotation:",g.rotation,"position:",g.position)}o=requestAnimationFrame(A)};return S(),window.addEventListener("scroll",A),()=>{cancelAnimationFrame(o),window.removeEventListener("scroll",A),a&&(a.dispose(),a.domElement&&e.current&&e.current.removeChild(a.domElement)),y&&y.dispose(),g&&g.geometry.dispose(),g&&g.material&&(Array.isArray(g.material)?g.material.forEach(C=>C.dispose()):g.material.dispose())}},[]),jsxRuntimeExports.jsx("section",{className:"py-24 bg-gradient-to-br from-gray-900 via-gray-800 to-black",children:jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.5},transition:{duration:.8,delay:.2},className:"flex flex-col items-center justify-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-6 text-center drop-shadow-lg",children:s("3d_demo_title","3D NFT Demo: Scan & Claim!")}),jsxRuntimeExports.jsx("p",{className:"text-lg text-gray-200 mb-8 text-center max-w-2xl",children:s("3d_demo_desc","Спробуйте наші можливості: обертайте 3D коробку, проскануйте QR-код та отримайте тестовий NFT. Це демонстрація для виробників, драйверів, споживачів. NFT безкоштовний!")}),jsxRuntimeExports.jsx("div",{className:"w-full flex flex-col items-center",children:jsxRuntimeExports.jsx("div",{ref:e,className:"w-[350px] h-[350px] bg-transparent rounded-2xl shadow-2xl overflow-visible"})}),jsxRuntimeExports.jsxs("div",{className:"mt-8 text-center text-gray-300 text-base max-w-xl",children:[jsxRuntimeExports.jsx("strong",{children:s("3d_demo_nft_title","Тестове NFT:")})," ",s("3d_demo_nft_desc","Виробник: SPP Demo | Категорія: драйвери | Для тесту — відскануйте QR-код та отримайте NFT у свій гаманець Solana.")]})]})})})}const Navigation=({walletAddress:s,role:e,connectWallet:t,disconnectWallet:o,addManufacturer:a})=>{const{t:c}=useTranslation();reactExports.useState(""),reactExports.useState(""),reactExports.useState(!1);const[d,g]=reactExports.useState(!1);console.log("Navigation render - Role:",e);const y=E=>{switch(E){case"admin":return jsxRuntimeExports.jsx(StarIcon$1,{className:"w-4 h-4 text-yellow-400"});case"manufacturer":return jsxRuntimeExports.jsx(BuildingOfficeIcon$1,{className:"w-4 h-4 text-blue-400"});case"dealer":return jsxRuntimeExports.jsx(ShoppingBagIcon$1,{className:"w-4 h-4 text-green-400"});case"consumer":return jsxRuntimeExports.jsx(UserIcon$1,{className:"w-4 h-4 text-purple-400"});default:return jsxRuntimeExports.jsx(UserIcon$1,{className:"w-4 h-4 text-gray-400"})}},_=E=>{switch(E){case"admin":return"bg-purple-500/10 text-purple-400 border-purple-500/20";case"manufacturer":return"bg-green-500/10 text-green-400 border-green-500/20";default:return"bg-blue-500/10 text-blue-400 border-blue-500/20"}};return jsxRuntimeExports.jsx(motion.nav,{initial:{y:-100},animate:{y:0},className:"bg-gray-900 fixed w-full top-0 z-50 border-b border-gray-800 shadow-lg",style:{boxShadow:"0 2px 16px 0 rgba(16,16,32,0.25)"},children:jsxRuntimeExports.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between h-16 pb-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-6",children:[jsxRuntimeExports.jsxs(Link,{to:"/",className:"text-white text-xl font-bold flex items-center gap-2 py-4",children:[jsxRuntimeExports.jsx("img",{src:logo,alt:"Smart Product Passport Logo",className:"w-16"}),c("title")]}),s&&jsxRuntimeExports.jsx("div",{className:"hidden md:block ml-10",children:jsxRuntimeExports.jsxs("div",{className:"flex items-baseline space-x-4",children:[jsxRuntimeExports.jsxs(NavLink,{to:"/",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors",children:[jsxRuntimeExports.jsx(HomeIcon$1,{className:"w-4 h-4 mr-2"}),c("main")]}),jsxRuntimeExports.jsxs(NavLink,{to:"/passports",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors",children:[jsxRuntimeExports.jsx(DocumentTextIcon$1,{className:"w-4 h-4 mr-2"}),c("passports")]}),jsxRuntimeExports.jsxs(NavLink,{to:"/scan",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors",children:[jsxRuntimeExports.jsx(CameraIcon$1,{className:"w-4 h-4 mr-2"}),c("scan")]}),jsxRuntimeExports.jsxs(NavLink,{to:"/create-nft",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors",children:[jsxRuntimeExports.jsx(PlusIcon$1,{className:"w-4 h-4 mr-2"}),c("createNFT")]}),jsxRuntimeExports.jsxs(NavLink,{to:"/about",className:"text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium flex items-center transition-colors",children:[jsxRuntimeExports.jsx(InformationCircleIcon$1,{className:"w-4 h-4 mr-2"}),c("about")]})]})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx(LanguageSwitcher,{}),s?jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"relative",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>g(!d),className:"flex items-center gap-3 px-4 py-2 rounded-lg backdrop-blur-md bg-white/10 text-white border border-white/20 hover:bg-white/20 hover:border-white/30 transition-all duration-300 shadow-lg",children:[jsxRuntimeExports.jsx(CreditCardIcon$1,{className:"w-5 h-5 text-white"}),jsxRuntimeExports.jsxs("div",{className:"text-gray-300 text-sm font-mono",children:[s.slice(0,4),"...",s.slice(-4)]}),e&&jsxRuntimeExports.jsxs("div",{className:`text-sm px-2 py-1 rounded-full flex items-center gap-1.5 border ${_(e)}`,children:[y(e),jsxRuntimeExports.jsx("span",{className:"capitalize",children:e})]})]}),d&&jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"absolute top-full right-0 mt-2 w-48 bg-gray-800 rounded-lg shadow-xl border border-gray-700/50 py-2 z-50",children:[jsxRuntimeExports.jsxs(Link,{to:"/passports",className:"flex items-center gap-2 px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-700/50 transition-colors",onClick:()=>g(!1),children:[jsxRuntimeExports.jsx(DocumentTextIcon$1,{className:"w-4 h-4"}),c("passports")]}),jsxRuntimeExports.jsxs(Link,{to:"/create-nft",className:"flex items-center gap-2 px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-700/50 transition-colors",onClick:()=>g(!1),children:[jsxRuntimeExports.jsx(PlusIcon$1,{className:"w-4 h-4"}),c("create_passport")]}),jsxRuntimeExports.jsxs(Link,{to:"/scan",className:"flex items-center gap-2 px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-700/50 transition-colors",onClick:()=>g(!1),children:[jsxRuntimeExports.jsx(CameraIcon$1,{className:"w-4 h-4"}),c("scan")]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{o(),g(!1)},className:"w-full flex items-center gap-2 px-4 py-2 text-gray-300 hover:text-white hover:bg-gray-700/50 transition-colors",children:[jsxRuntimeExports.jsx(ArrowRightOnRectangleIcon$1,{className:"w-4 h-4"}),"Disconnect"]})]})]}):jsxRuntimeExports.jsxs("button",{onClick:t,className:"backdrop-blur-md bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 transition-all duration-300 border border-white/20 hover:border-white/30 shadow-lg",children:[jsxRuntimeExports.jsx(CreditCardIcon$1,{className:"w-5 h-5 text-white"}),c("connectWallet")]})]})]})})})},NavLink=({to:s,children:e,...t})=>{const o=window.location.pathname===s;return jsxRuntimeExports.jsx(Link,{to:s,className:`${o?"text-white bg-gray-800/50":""} ${t.className}`,...t,children:e})},LandingPage=()=>{const{t:s}=useTranslation();return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-black pt-20",children:[jsxRuntimeExports.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},className:"text-center",children:[jsxRuntimeExports.jsx("h1",{className:"text-4xl font-extrabold bg-gradient-to-r from-blue-300 via-blue-400 to-purple-400 text-transparent bg-clip-text mb-2 drop-shadow-lg",children:"Smart Product Passport"}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-300 mb-16 max-w-3xl mx-auto leading-relaxed",children:s("secure_storage_desc")})]}),jsxRuntimeExports.jsxs(motion.div,{id:"scan3d",initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.5},transition:{duration:.8,delay:.2},className:"flex flex-col items-center justify-center my-20",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold text-white mb-6",children:s("qr_codes")}),jsxRuntimeExports.jsxs("div",{className:"relative w-64 h-64 flex items-center justify-center",children:[jsxRuntimeExports.jsx("div",{className:"absolute w-48 h-48 bg-gradient-to-br from-blue-800 to-purple-700 rounded-2xl shadow-2xl transform rotate-12 scale-110 blur-sm opacity-60"}),jsxRuntimeExports.jsxs("div",{className:"relative w-48 h-48 bg-gradient-to-br from-blue-500 to-purple-500 rounded-2xl shadow-2xl flex flex-col items-center justify-center animate-pulse",children:[jsxRuntimeExports.jsx("div",{className:"bg-white p-2 rounded-lg shadow-lg mb-4",children:jsxRuntimeExports.jsx("img",{src:"https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=TestNFT",alt:"Test NFT QR",className:"w-28 h-28"})}),jsxRuntimeExports.jsx("span",{className:"text-white text-lg font-semibold",children:"NFT QR"})]})]}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 mt-4 max-w-md",children:s("qr_codes_desc")})]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-3 gap-8 max-w-5xl mx-auto",children:[jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.2},whileHover:{scale:1.05},className:"bg-gradient-to-br from-gray-800 to-gray-900 p-8 rounded-2xl shadow-xl border border-gray-700/50 hover:border-blue-500/50 transition-all duration-300",children:[jsxRuntimeExports.jsx("div",{className:"h-12 w-12 bg-blue-500/10 rounded-xl flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(ShieldCheckIcon$1,{className:"w-8 h-8 text-blue-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:s("secure_storage")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 leading-relaxed",children:s("secure_storage_desc")})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.4},whileHover:{scale:1.05},className:"bg-gradient-to-br from-gray-800 to-gray-900 p-8 rounded-2xl shadow-xl border border-gray-700/50 hover:border-purple-500/50 transition-all duration-300",children:[jsxRuntimeExports.jsx("div",{className:"h-12 w-12 bg-purple-500/10 rounded-xl flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(QrCodeIcon$1,{className:"w-8 h-8 text-purple-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:s("qr_codes")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 leading-relaxed",children:s("qr_codes_desc")})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},whileHover:{scale:1.05},className:"bg-gradient-to-br from-gray-800 to-gray-900 p-8 rounded-2xl shadow-xl border border-gray-700/50 hover:border-green-500/50 transition-all duration-300",children:[jsxRuntimeExports.jsx("div",{className:"h-12 w-12 bg-green-500/10 rounded-xl flex items-center justify-center mb-6",children:jsxRuntimeExports.jsx(CheckCircleIcon$1,{className:"w-8 h-8 text-green-400"})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:s("authenticity_check")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 leading-relaxed",children:s("authenticity_check_desc")})]})]}),jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.8},className:"mt-20 text-center",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold text-white mb-8",children:s("how_it_works")}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-4 gap-6 max-w-5xl mx-auto",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-xl border border-gray-700/50",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-blue-400 mb-2 flex items-center justify-center",children:jsxRuntimeExports.jsx("i",{className:"fas fa-wallet text-3xl"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:s("step1")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:s("step1")})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-xl border border-gray-700/50",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-purple-400 mb-2 flex items-center justify-center",children:jsxRuntimeExports.jsx(PlusIcon$1,{className:"w-8 h-8"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:s("step2")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:s("step2")})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-xl border border-gray-700/50",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-green-400 mb-2 flex items-center justify-center",children:jsxRuntimeExports.jsx(QrCodeIcon$1,{className:"w-8 h-8"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:s("step3")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:s("step3")})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-xl border border-gray-700/50",children:[jsxRuntimeExports.jsx("div",{className:"text-2xl font-bold text-yellow-400 mb-2 flex items-center justify-center",children:jsxRuntimeExports.jsx(CameraIcon$1,{className:"w-8 h-8"})}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:s("step4")}),jsxRuntimeExports.jsx("p",{className:"text-gray-400 text-sm",children:s("step4")})]})]})]}),jsxRuntimeExports.jsx(FAQ,{})]}),jsxRuntimeExports.jsx(ThreeDBoxSection,{}),jsxRuntimeExports.jsx(Community,{})]})},AboutPage=()=>{const{t:s}=useTranslation();return jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 pt-20",children:jsxRuntimeExports.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:jsxRuntimeExports.jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8},children:[jsxRuntimeExports.jsxs("h1",{className:"text-4xl font-bold text-white mb-8 text-center flex items-center justify-center gap-3",children:[jsxRuntimeExports.jsx(HeartIcon$1,{className:"w-8 h-8 text-blue-400"}),s("about_us")]}),jsxRuntimeExports.jsx("div",{className:"bg-gray-800/50 p-8 rounded-xl border border-gray-700/50",children:jsxRuntimeExports.jsxs("div",{className:"space-y-8",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold text-white mb-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(CircleStackIcon$1,{className:"w-5 h-5 text-blue-400"}),s("about_mission_title","Наша Місія")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 leading-relaxed flex items-start gap-3",children:[jsxRuntimeExports.jsx(LightBulbIcon$1,{className:"w-4 h-4 text-gray-500 mt-1"}),s("about_us_text1")]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold text-white mb-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(GiftIcon$1,{className:"w-5 h-5 text-blue-400"}),s("about_offerings_title","Що ми пропонуємо")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 leading-relaxed mb-4 flex items-start gap-3",children:[jsxRuntimeExports.jsx(CheckCircleIcon$1,{className:"w-4 h-4 text-gray-500 mt-1"}),s("about_offerings_desc","Ми надаємо комплексні інструменти для всіх учасників ринку:")]}),jsxRuntimeExports.jsxs("ul",{className:"text-gray-300 space-y-3 ml-6",children:[jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(BuildingOfficeIcon$1,{className:"w-4 h-4 text-blue-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("strong",{children:s("about_manufacturers","Виробникам:")}),jsxRuntimeExports.jsx("span",{className:"ml-2",children:s("about_manufacturers_desc","створення та управління цифровими паспортами продуктів")})]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(ShoppingBagIcon$1,{className:"w-4 h-4 text-blue-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("strong",{children:s("about_dealers","Дилерам:")}),jsxRuntimeExports.jsx("span",{className:"ml-2",children:s("about_dealers_desc","перевірка автентичності та відстеження продуктів")})]})]}),jsxRuntimeExports.jsxs("li",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx(UsersIcon$1,{className:"w-4 h-4 text-blue-400"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("strong",{children:s("about_consumers","Споживачам:")}),jsxRuntimeExports.jsx("span",{className:"ml-2",children:s("about_consumers_desc","миттєва перевірка справжності продуктів через QR-коди")})]})]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold text-white mb-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(StarIcon$1,{className:"w-5 h-5 text-blue-400"}),s("about_benefits_title","Ключові переваги")]}),jsxRuntimeExports.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(ShieldCheckIcon$1,{className:"w-4 h-4 text-blue-400"}),s("secure_storage")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm flex items-start gap-2",children:[jsxRuntimeExports.jsx(LockClosedIcon$1,{className:"w-4 h-4 text-gray-500 mt-0.5"}),s("secure_storage_desc")]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(DevicePhoneMobileIcon$1,{className:"w-4 h-4 text-blue-400"}),s("about_convenience","Зручність")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm flex items-start gap-2",children:[jsxRuntimeExports.jsx(DevicePhoneMobileIcon$1,{className:"w-4 h-4 text-gray-500 mt-0.5"}),s("about_convenience_desc","Швидкий доступ через QR-коди та мобільні пристрої")]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(EyeIcon$1,{className:"w-4 h-4 text-blue-400"}),s("about_transparency","Прозорість")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm flex items-start gap-2",children:[jsxRuntimeExports.jsx(MagnifyingGlassIcon$1,{className:"w-4 h-4 text-gray-500 mt-0.5"}),s("about_transparency_desc","Повна історія продукту доступна кожному користувачу")]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-lg border border-gray-600/30",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(BoltIcon$1,{className:"w-4 h-4 text-blue-400"}),s("about_speed","Швидкість")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm flex items-start gap-2",children:[jsxRuntimeExports.jsx(ClockIcon$1,{className:"w-4 h-4 text-gray-500 mt-0.5"}),s("about_speed_desc","Миттєва верифікація автентичності продуктів")]})]})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("h2",{className:"text-2xl font-semibold text-white mb-4 flex items-center gap-3",children:[jsxRuntimeExports.jsx(FlagIcon$1,{className:"w-5 h-5 text-blue-400"}),s("about_goal_title","Наша мета")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 leading-relaxed flex items-start gap-3",children:[jsxRuntimeExports.jsx(ArrowRightIcon$1,{className:"w-4 h-4 text-gray-500 mt-1"}),s("about_us_text3")]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 p-6 rounded-lg",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-white mb-2 flex items-center gap-2",children:[jsxRuntimeExports.jsx(RocketLaunchIcon$1,{className:"w-4 h-4 text-blue-400"}),s("about_future_title","Технології майбутнього")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm flex items-start gap-3",children:[jsxRuntimeExports.jsx(CogIcon$1,{className:"w-4 h-4 text-gray-500 mt-0.5"}),s("about_future_desc","Використовуючи найновіші технології блокчейну, ми створюємо екосистему, де кожен продукт має свій унікальний цифровий паспорт, що гарантує його автентичність та надає повну інформацію про його історію.")]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gradient-to-r from-blue-500/10 to-purple-500/10 border border-blue-500/20 p-6 rounded-lg",children:[jsxRuntimeExports.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[jsxRuntimeExports.jsx(HandThumbUpIcon$1,{className:"w-5 h-5 text-blue-400"}),s("about_join_title","Приєднуйтесь до нас")]}),jsxRuntimeExports.jsxs("p",{className:"text-gray-300 text-sm flex items-start gap-3",children:[jsxRuntimeExports.jsx(UsersIcon$1,{className:"w-4 h-4 text-gray-500 mt-0.5"}),s("about_join_desc","Станьте частиною революції в сфері цифрових паспортів продуктів. Разом ми створюємо безпечніше та прозоріше майбутнє для всіх учасників ринку.")]}),jsxRuntimeExports.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[jsxRuntimeExports.jsx(CheckCircleIcon$1,{className:"w-4 h-4 text-green-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:s("about_trust","Довіра")})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[jsxRuntimeExports.jsx(CheckCircleIcon$1,{className:"w-4 h-4 text-green-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:s("about_security","Безпека")})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[jsxRuntimeExports.jsx(CheckCircleIcon$1,{className:"w-4 h-4 text-green-400"}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:s("about_innovation","Інновації")})]})]})]})]})})]})})})},ComicsSection=()=>{const{t:s}=useTranslation(),[e,t]=reactExports.useState(null),o=[{id:1,title:s("comic_1_title"),image:"/src/assets/comics/Протокол Розумних Паспортів Продуктів.png",description:s("comic_1_desc"),fullStory:s("comic_1_fullStory"),technology:s("comic_1_technology")},{id:2,title:s("comic_2_title"),image:"/src/assets/comics/Хакатон Solana Breakpoint_ Революція блокчейну.png",description:s("comic_2_desc"),fullStory:s("comic_2_fullStory"),technology:s("comic_2_technology")},{id:3,title:s("comic_3_title"),image:"/src/assets/comics/Майбутнє NFT та СМАРТ-Паспортів.png",description:s("comic_3_desc"),fullStory:s("comic_3_fullStory"),technology:s("comic_3_technology")},{id:4,title:s("comic_4_title"),image:"/src/assets/comics/Оновлення через Smart Product Passport.png",description:s("comic_4_desc"),fullStory:s("comic_4_fullStory"),technology:s("comic_4_technology")},{id:5,title:s("comic_5_title"),image:"/src/assets/comics/Скайдайвінг над футуристичним містом.png",description:s("comic_5_desc"),fullStory:s("comic_5_fullStory"),technology:s("comic_5_technology")},{id:6,title:s("comic_6_title"),image:"/src/assets/comics/Оновлення драйверів з легкістю.png",description:s("comic_6_desc"),fullStory:s("comic_6_fullStory"),technology:s("comic_6_technology")}];return jsxRuntimeExports.jsx("section",{className:"py-16 bg-gradient-to-b from-gray-900 to-gray-800",children:jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-4",children:[jsxRuntimeExports.jsxs("div",{className:"text-center mb-12",children:[jsxRuntimeExports.jsx("h2",{className:"text-4xl md:text-5xl font-bold text-white mb-4",children:s("comics_title").split(" ").map((a,c)=>c===1?jsxRuntimeExports.jsxs("span",{className:"text-primary",children:[" ",a]},c):a)}),jsxRuntimeExports.jsx("p",{className:"text-xl text-gray-300 max-w-3xl mx-auto",children:s("comics_subtitle")})]}),jsxRuntimeExports.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:o.map(a=>jsxRuntimeExports.jsxs("div",{className:"group relative overflow-hidden rounded-2xl bg-gray-800/50 border border-gray-700/50 hover:border-primary/50 transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-primary/20 cursor-pointer",onClick:()=>t(a),children:[jsxRuntimeExports.jsxs("div",{className:"relative overflow-hidden aspect-[4/3]",children:[jsxRuntimeExports.jsx("img",{src:a.image,alt:a.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500"}),jsxRuntimeExports.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-gray-900/80 via-gray-900/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),jsxRuntimeExports.jsxs("div",{className:"p-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-bold text-white mb-3 group-hover:text-primary transition-colors duration-300",children:a.title}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 text-sm leading-relaxed",children:a.description}),jsxRuntimeExports.jsxs("div",{className:"mt-4 inline-flex items-center text-primary hover:text-primary/80 font-semibold text-sm transition-colors duration-300 group-hover:translate-x-1",children:[s("comics_read_more"),jsxRuntimeExports.jsx("svg",{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:jsxRuntimeExports.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),jsxRuntimeExports.jsxs("div",{className:"absolute top-4 right-4 bg-primary/90 text-white text-xs px-2 py-1 rounded-full font-medium",children:["#",a.id]})]},a.id))}),e&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:jsxRuntimeExports.jsx("div",{className:"bg-gray-900 rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:jsxRuntimeExports.jsxs("div",{className:"p-8",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-start mb-6",children:[jsxRuntimeExports.jsx("h2",{className:"text-3xl font-bold text-white",children:e.title}),jsxRuntimeExports.jsx("button",{onClick:()=>t(null),className:"text-gray-400 hover:text-white transition-colors",children:jsxRuntimeExports.jsx(XMarkIcon$1,{className:"w-8 h-8"})})]}),jsxRuntimeExports.jsx("div",{className:"mb-6",children:jsxRuntimeExports.jsx("img",{src:e.image,alt:e.title,className:"w-full rounded-xl shadow-2xl"})}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:s("full_story")}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 leading-relaxed",children:e.fullStory})]}),jsxRuntimeExports.jsxs("div",{className:"mb-6",children:[jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold text-white mb-3",children:s("technology_details")}),jsxRuntimeExports.jsx("p",{className:"text-gray-300 leading-relaxed",children:e.technology})]}),jsxRuntimeExports.jsx("div",{className:"text-center",children:jsxRuntimeExports.jsx("button",{onClick:()=>t(null),className:"bg-primary hover:bg-primary/90 text-white px-6 py-3 rounded-xl font-semibold transition-all duration-300 hover:scale-105",children:s("close")})})]})})})]})})},Footer=()=>{const{t:s}=useTranslation();return jsxRuntimeExports.jsxs("footer",{className:"w-full bg-gray-900 text-gray-400 py-6 border-t border-gray-800 text-center flex flex-col items-center gap-2 shadow-lg",style:{boxShadow:"0 -2px 16px 0 rgba(16,16,32,0.25)"},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center mb-2",children:[jsxRuntimeExports.jsx("img",{src:"/src/assets/SPP_logo_white.png",alt:"Smart Product Passport",className:"h-8 mr-2"}),jsxRuntimeExports.jsx("span",{className:"text-white font-semibold text-lg",children:"Smart Product Passport"})]}),jsxRuntimeExports.jsx("span",{className:"text-sm",children:s("footer_text")}),jsxRuntimeExports.jsxs("div",{className:"flex gap-4 justify-center items-center mt-2",children:[jsxRuntimeExports.jsx("a",{href:"https://x.com/SmartProductID",target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 transition-colors text-xl flex items-center justify-center",children:jsxRuntimeExports.jsx("i",{className:"fab fa-twitter"})}),jsxRuntimeExports.jsx("a",{href:"https://discord.gg/UGKBgREr",target:"_blank",rel:"noopener noreferrer",className:"hover:opacity-80 transition-opacity flex items-center justify-center",children:jsxRuntimeExports.jsx("img",{src:"https://svgl.app/library/discord.svg",alt:"Discord",className:"w-5 h-5"})})]})]})},App=()=>{useTranslation();const[s,e]=reactExports.useState(null),[t,o]=reactExports.useState(()=>localStorage.getItem("userRole")||null),[a,c]=reactExports.useState({serialNumber:"",productionDate:"",deviceModel:"",warrantyPeriod:"",countryOfOrigin:"",manufacturerId:"",ipfsCid:""}),[d,g]=reactExports.useState(null),[y,_]=reactExports.useState(""),[E,S]=reactExports.useState([]),[A,C]=reactExports.useState(null);reactExports.useState("");const[N,O]=reactExports.useState("serialNumber"),[I,P]=reactExports.useState("asc"),[j,B]=reactExports.useState(!0),[H,se]=reactExports.useState(!1),oe=new Connection("https://api.devnet.solana.com","confirmed"),Q=new PublicKey({}.VITE_PROGRAM_ID||"8tdpknetCPXv5Ztk8yoJWceRCgCxp3T6U56TnUGk99t4"),fe=new PublicKey("79p8ggDFPaYshTZaGsXLkJNdrphD3QrQsRv6hhdwAfFD");reactExports.useEffect(()=>{(async()=>{try{if(window.solana&&window.solana.isPhantom){const F=(await window.solana.connect({onlyIfTrusted:!0})).publicKey.toString();e(F);const J=localStorage.getItem("userRole");J?o(J):await Z(F),await R()}}catch{console.log("Wallet not connected")}finally{B(!1)}})()},[]);const Z=async ie=>{try{const X=await Y();if(!X)return;const[F]=PublicKey.findProgramAddressSync([Buffer.from("manufacturer_list")],Q);let J;try{J=await X.account.manufacturerList.fetch(F),console.log("Manufacturer list:",J)}catch(Te){console.log("Error fetching manufacturer list:",Te),J=null}const Ee=((J==null?void 0:J.manufacturers)||[]).map(Te=>Te.toString());console.log("Manufacturers:",Ee),console.log("Admin key:",fe.toString());let Re;ie===fe.toString()?(console.log("Setting role: admin"),Re="admin",await initializeManufacturerList()):Ee.includes(ie)?(console.log("Setting role: manufacturer"),Re="manufacturer"):(console.log("Setting role: user"),Re="user"),o(Re),localStorage.setItem("userRole",Re)}catch(X){console.error("Error determining user role:",X)}},ce=async()=>{try{const{solana:ie}=window;if(!ie||!ie.isPhantom){_("Please install Phantom wallet.");return}const F=(await ie.connect()).publicKey.toString();e(F),console.log("Connected wallet:",F),await Z(F),_("Wallet connected!"),await R()}catch(ie){console.error("Error connecting wallet:",ie),_(`Error connecting wallet: ${ie.message}`)}},ge=ie=>{ie.target.files&&ie.target.files[0]&&g(ie.target.files[0])},me=ie=>{const{name:X,value:F}=ie.target;c(J=>({...J,[X]:F}))},V=async ie=>{ie.preventDefault(),se(!0);try{if(!s)throw console.error("Wallet not connected"),new Error("Please connect your wallet first");console.log("Initializing program...");const X=await Y();if(!X)throw console.error("Program initialization failed"),new Error("Failed to initialize program. Please check if the program is deployed.");if(console.log("Checking if program is deployed..."),!await oe.getAccountInfo(Q))throw console.error("Program not found on chain"),new Error("Program not found on chain. Please make sure the program is deployed to devnet.");if(console.log("Checking user role:",t),t!=="manufacturer"&&t!=="admin")throw console.error("User role not authorized:",t),new Error("Only manufacturers and admins can create passports");console.log("Finding PDA for passport...");const[J]=PublicKey.findProgramAddressSync([Buffer.from("passport"),Buffer.from(a.serialNumber)],Q);console.log("Checking if passport already exists...");try{const Re=await X.account.passport.fetch(J);if(Re)throw console.error("Passport already exists:",Re),new Error("Passport with this serial number already exists")}catch(Re){if(!Re.message.includes("Account does not exist"))throw console.error("Error checking existing passport:",Re),Re}console.log("Creating passport transaction...");const Ee=await X.methods.createPassport(a.serialNumber,a.productionDate,a.deviceModel,a.warrantyPeriod,a.countryOfOrigin,a.manufacturerId||s,"",new PublicKey(s)).accounts({passport:J,manufacturer:new PublicKey(s),systemProgram:SystemProgram.programId}).rpc();console.log("Transaction signature:",Ee),_("Passport created successfully!"),c({serialNumber:"",productionDate:"",deviceModel:"",warrantyPeriod:"",countryOfOrigin:"",manufacturerId:"",ipfsCid:""}),g(null),await R(),window.location.href="/passports"}catch(X){console.error("Error creating passport:",X);let F=X.message;throw X.logs&&(console.error("Program logs:",X.logs),F+=`
Program logs: ${X.logs.join(`
`)}`),_(`Error creating passport: ${F}`),X}finally{se(!1)}},R=async()=>{if(s)try{const ie=await Y();if(!ie)return;const F=(await ie.account.passport.all()).map(J=>({...J.account,address:J.publicKey.toString()})).filter(J=>t==="user"?J.owner.toString()===s:t==="manufacturer"&&J.manufacturerId===s);S(F)}catch(ie){console.error("Error fetching passports:",ie),_(`Error fetching passports: ${ie.message}`)}},L=ie=>{N===ie?P(I==="asc"?"desc":"asc"):(O(ie),P("asc"))},z=async ie=>{try{const X=await Y();if(!X)return;const[F]=PublicKey.findProgramAddressSync([Buffer.from("passport"),Buffer.from(ie)],Q),J=await X.account.passport.fetch(F);C(J)}catch(X){console.error("Error scanning QR:",X),_(`Error scanning QR: ${X.message}`)}},Y=async()=>{try{if(!oe||!window.solana)throw new Error("Connection or wallet not initialized");const ie=new AnchorProvider(oe,window.solana,{preflightCommitment:"confirmed"});try{const F=await Program.fetchIdl(Q,ie);if(F)return console.log("Successfully fetched IDL from network"),new Program(F,Q,ie)}catch{console.log("Could not fetch IDL from network, using local version")}const X={version:"0.1.0",name:"smart_passport",instructions:[{name:"initialize",accounts:[{name:"manufacturerList",isMut:!0,isSigner:!1,docs:"The manufacturer list account"},{name:"admin",isMut:!0,isSigner:!0,docs:"The admin account"},{name:"systemProgram",isMut:!1,isSigner:!1,docs:"The system program"}],args:[]},{name:"addManufacturer",accounts:[{name:"manufacturerList",isMut:!0,isSigner:!1,docs:"The manufacturer list account"},{name:"admin",isMut:!1,isSigner:!0,docs:"The admin account"}],args:[{name:"manufacturer",type:"publicKey",docs:"The manufacturer public key"},{name:"name",type:"string",docs:"The manufacturer name"}]},{name:"createPassport",accounts:[{name:"passport",isMut:!0,isSigner:!1,docs:"The passport account"},{name:"manufacturer",isMut:!0,isSigner:!0,docs:"The manufacturer account"},{name:"systemProgram",isMut:!1,isSigner:!1,docs:"The system program"}],args:[{name:"serialNumber",type:"string",docs:"The passport serial number"},{name:"productionDate",type:"string",docs:"The production date"},{name:"deviceModel",type:"string",docs:"The device model"},{name:"warrantyPeriod",type:"string",docs:"The warranty period"},{name:"countryOfOrigin",type:"string",docs:"The country of origin"},{name:"manufacturerId",type:"string",docs:"The manufacturer ID"},{name:"ipfsCid",type:"string",docs:"The IPFS CID"},{name:"owner",type:"publicKey",docs:"The owner account"}]}],accounts:[{name:"ManufacturerList",docs:"The manufacturer list account",type:{kind:"struct",fields:[{name:"manufacturers",docs:"The list of manufacturers",type:{vec:{kind:"struct",fields:[{name:"name",docs:"The manufacturer name",type:"string"},{name:"pubkey",docs:"The manufacturer public key",type:"publicKey"}]}}}]}},{name:"Passport",docs:"The passport account",type:{kind:"struct",fields:[{name:"serialNumber",docs:"The passport serial number",type:"string"},{name:"productionDate",docs:"The production date",type:"string"},{name:"deviceModel",docs:"The device model",type:"string"},{name:"warrantyPeriod",docs:"The warranty period",type:"string"},{name:"countryOfOrigin",docs:"The country of origin",type:"string"},{name:"manufacturerId",docs:"The manufacturer ID",type:"string"},{name:"ipfsCid",docs:"The IPFS CID",type:"string"},{name:"owner",docs:"The owner account",type:"publicKey"}]}}],errors:[{code:6e3,name:"ManufacturerAlreadyExists",msg:"Manufacturer already exists in the list"}]};return console.log("Using local IDL version"),new Program(X,Q,ie)}catch(ie){return console.error("Error initializing program:",ie),_(`Error initializing program: ${ie.message}`),null}},W=async()=>{try{window.solana&&(await window.solana.disconnect(),e(null),o(null),localStorage.removeItem("userRole"),S([]),_("Wallet disconnected"))}catch(ie){console.error("Error disconnecting wallet:",ie),_(`Error disconnecting wallet: ${ie.message}`)}},ee=async(ie,X)=>{try{if(!s){_("Please connect your wallet first");return}if(t!=="admin"){_("Only admin can add manufacturers");return}const F=await Y();if(!F)throw new Error("Failed to initialize program");const[J]=PublicKey.findProgramAddressSync([Buffer.from("manufacturer_list")],Q);try{await F.account.manufacturerList.fetch(J)}catch(Ue){if(Ue.message.includes("Account does not exist"))await initializeManufacturerList();else throw Ue}const Ee=new PublicKey(ie),Re=await F.methods.addManufacturer(Ee,X).accounts({manufacturerList:J,admin:new PublicKey(s)}).rpc();console.log("Add manufacturer transaction:",Re),_("Manufacturer added successfully!");const Te=await F.account.manufacturerList.fetch(J);console.log("Updated manufacturer list:",Te)}catch(F){console.error("Error adding manufacturer:",F),_(`Error adding manufacturer: ${F.message}`)}};return j?jsxRuntimeExports.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center",children:jsxRuntimeExports.jsx(LoadingSpinner,{size:"lg",text:"Initializing application..."})}):jsxRuntimeExports.jsx(BrowserRouter,{children:jsxRuntimeExports.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-gray-900 to-gray-800",children:[jsxRuntimeExports.jsx(Navigation,{walletAddress:s,role:t,connectWallet:ce,disconnectWallet:W,addManufacturer:ee}),jsxRuntimeExports.jsx("div",{className:"flex-1",children:jsxRuntimeExports.jsxs(Routes,{children:[jsxRuntimeExports.jsx(Route,{path:"/",element:jsxRuntimeExports.jsx(LandingPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/about",element:jsxRuntimeExports.jsx(AboutPage,{})}),jsxRuntimeExports.jsx(Route,{path:"/create-nft",element:s?jsxRuntimeExports.jsx(CreateNFTPage,{mintPassport:V,handleInputChange:me,handleFileChange:ge,formData:a,file:d,status:y,isProcessing:H}):jsxRuntimeExports.jsx(Navigate,{to:"/"})}),jsxRuntimeExports.jsx(Route,{path:"/passports",element:s?jsxRuntimeExports.jsx(PassportsPage,{role:t,passports:E,formData:a,handleInputChange:me,handleFileChange:ge,mintPassport:V,handleSort:L,sortField:N,sortOrder:I}):jsxRuntimeExports.jsx(Navigate,{to:"/"})}),jsxRuntimeExports.jsx(Route,{path:"/scan",element:s?jsxRuntimeExports.jsx(ScanPage,{handleQrScan:z}):jsxRuntimeExports.jsx(Navigate,{to:"/"})})]})}),jsxRuntimeExports.jsx(ComicsSection,{}),jsxRuntimeExports.jsx(Footer,{}),y&&jsxRuntimeExports.jsx("div",{className:"fixed bottom-4 right-4 bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg",children:y}),H&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:jsxRuntimeExports.jsx(LoadingSpinner,{size:"lg",text:"Creating passport..."})})]})})},index="",isString=s=>typeof s=="string",defer=()=>{let s,e;const t=new Promise((o,a)=>{s=o,e=a});return t.resolve=s,t.reject=e,t},makeString=s=>s==null?"":""+s,copy=(s,e,t)=>{s.forEach(o=>{e[o]&&(t[o]=e[o])})},lastOfPathSeparatorRegExp=/###/g,cleanKey=s=>s&&s.indexOf("###")>-1?s.replace(lastOfPathSeparatorRegExp,"."):s,canNotTraverseDeeper=s=>!s||isString(s),getLastOfPath=(s,e,t)=>{const o=isString(e)?e.split("."):e;let a=0;for(;a<o.length-1;){if(canNotTraverseDeeper(s))return{};const c=cleanKey(o[a]);!s[c]&&t&&(s[c]=new t),Object.prototype.hasOwnProperty.call(s,c)?s=s[c]:s={},++a}return canNotTraverseDeeper(s)?{}:{obj:s,k:cleanKey(o[a])}},setPath=(s,e,t)=>{const{obj:o,k:a}=getLastOfPath(s,e,Object);if(o!==void 0||e.length===1){o[a]=t;return}let c=e[e.length-1],d=e.slice(0,e.length-1),g=getLastOfPath(s,d,Object);for(;g.obj===void 0&&d.length;)c=`${d[d.length-1]}.${c}`,d=d.slice(0,d.length-1),g=getLastOfPath(s,d,Object),g&&g.obj&&typeof g.obj[`${g.k}.${c}`]<"u"&&(g.obj=void 0);g.obj[`${g.k}.${c}`]=t},pushPath=(s,e,t,o)=>{const{obj:a,k:c}=getLastOfPath(s,e,Object);a[c]=a[c]||[],a[c].push(t)},getPath=(s,e)=>{const{obj:t,k:o}=getLastOfPath(s,e);if(t)return t[o]},getPathWithDefaults=(s,e,t)=>{const o=getPath(s,t);return o!==void 0?o:getPath(e,t)},deepExtend=(s,e,t)=>{for(const o in e)o!=="__proto__"&&o!=="constructor"&&(o in s?isString(s[o])||s[o]instanceof String||isString(e[o])||e[o]instanceof String?t&&(s[o]=e[o]):deepExtend(s[o],e[o],t):s[o]=e[o]);return s},regexEscape=s=>s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const escape=s=>isString(s)?s.replace(/[&<>"'\/]/g,e=>_entityMap[e]):s;class RegExpCache{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const o=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,o),this.regExpQueue.push(e),o}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20),looksLikeObjectPath=(s,e,t)=>{e=e||"",t=t||"";const o=chars.filter(d=>e.indexOf(d)<0&&t.indexOf(d)<0);if(o.length===0)return!0;const a=looksLikeObjectPathRegExpCache.getRegExp(`(${o.map(d=>d==="?"?"\\?":d).join("|")})`);let c=!a.test(s);if(!c){const d=s.indexOf(t);d>0&&!a.test(s.substring(0,d))&&(c=!0)}return c},deepFind=function(s,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!s)return;if(s[e])return s[e];const o=e.split(t);let a=s;for(let c=0;c<o.length;){if(!a||typeof a!="object")return;let d,g="";for(let y=c;y<o.length;++y)if(y!==c&&(g+=t),g+=o[y],d=a[g],d!==void 0){if(["string","number","boolean"].indexOf(typeof d)>-1&&y<o.length-1)continue;c+=y-c+1;break}a=d}return a},getCleanedCode=s=>s&&s.replace("_","-"),consoleLogger={type:"logger",log(s){this.output("log",s)},warn(s){this.output("warn",s)},error(s){this.output("error",s)},output(s,e){console&&console[s]&&console[s].apply(console,e)}};class Logger{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||consoleLogger,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,o,a){return a&&!this.debug?null:(isString(e[0])&&(e[0]=`${o}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Logger(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Logger(this.logger,e)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(o=>{this.observers[o]||(this.observers[o]=new Map);const a=this.observers[o].get(t)||0;this.observers[o].set(t,a+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),a=1;a<t;a++)o[a-1]=arguments[a];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(d=>{let[g,y]=d;for(let _=0;_<y;_++)g(...o)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(d=>{let[g,y]=d;for(let _=0;_<y;_++)g.apply(g,[e,...o])})}}class ResourceStore extends EventEmitter{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,o){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const c=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator,d=a.ignoreJSONStructure!==void 0?a.ignoreJSONStructure:this.options.ignoreJSONStructure;let g;e.indexOf(".")>-1?g=e.split("."):(g=[e,t],o&&(Array.isArray(o)?g.push(...o):isString(o)&&c?g.push(...o.split(c)):g.push(o)));const y=getPath(this.data,g);return!y&&!t&&!o&&e.indexOf(".")>-1&&(e=g[0],t=g[1],o=g.slice(2).join(".")),y||!d||!isString(o)?y:deepFind(this.data&&this.data[e]&&this.data[e][t],o,c)}addResource(e,t,o,a){let c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const d=c.keySeparator!==void 0?c.keySeparator:this.options.keySeparator;let g=[e,t];o&&(g=g.concat(d?o.split(d):o)),e.indexOf(".")>-1&&(g=e.split("."),a=t,t=g[1]),this.addNamespaces(t),setPath(this.data,g,a),c.silent||this.emit("added",e,t,o,a)}addResources(e,t,o){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const c in o)(isString(o[c])||Array.isArray(o[c]))&&this.addResource(e,t,c,o[c],{silent:!0});a.silent||this.emit("added",e,t,o)}addResourceBundle(e,t,o,a,c){let d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},g=[e,t];e.indexOf(".")>-1&&(g=e.split("."),a=o,o=t,t=g[1]),this.addNamespaces(t);let y=getPath(this.data,g)||{};d.skipCopy||(o=JSON.parse(JSON.stringify(o))),a?deepExtend(y,o,c):y={...y,...o},setPath(this.data,g,y),d.silent||this.emit("added",e,t,o)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(a=>t[a]&&Object.keys(t[a]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(s){this.processors[s.name]=s},handle(s,e,t,o,a){return s.forEach(c=>{this.processors[c]&&(e=this.processors[c].process(e,t,o,a))}),e}};const checkedLoadedFor={};class Translator extends EventEmitter{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const o=this.resolve(e,t);return o&&o.res!==void 0}extractFromKey(e,t){let o=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;o===void 0&&(o=":");const a=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let c=t.ns||this.options.defaultNS||[];const d=o&&e.indexOf(o)>-1,g=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!looksLikeObjectPath(e,o,a);if(d&&!g){const y=e.match(this.interpolator.nestingRegexp);if(y&&y.length>0)return{key:e,namespaces:isString(c)?[c]:c};const _=e.split(o);(o!==a||o===a&&this.options.ns.indexOf(_[0])>-1)&&(c=_.shift()),e=_.join(a)}return{key:e,namespaces:isString(c)?[c]:c}}translate(e,t,o){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const a=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,c=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:d,namespaces:g}=this.extractFromKey(e[e.length-1],t),y=g[g.length-1],_=t.lng||this.language,E=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(_&&_.toLowerCase()==="cimode"){if(E){const H=t.nsSeparator||this.options.nsSeparator;return a?{res:`${y}${H}${d}`,usedKey:d,exactUsedKey:d,usedLng:_,usedNS:y,usedParams:this.getUsedParamsDetails(t)}:`${y}${H}${d}`}return a?{res:d,usedKey:d,exactUsedKey:d,usedLng:_,usedNS:y,usedParams:this.getUsedParamsDetails(t)}:d}const S=this.resolve(e,t);let A=S&&S.res;const C=S&&S.usedKey||d,N=S&&S.exactUsedKey||d,O=Object.prototype.toString.apply(A),I=["[object Number]","[object Function]","[object RegExp]"],P=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,j=!this.i18nFormat||this.i18nFormat.handleAsObject,B=!isString(A)&&typeof A!="boolean"&&typeof A!="number";if(j&&A&&B&&I.indexOf(O)<0&&!(isString(P)&&Array.isArray(A))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const H=this.options.returnedObjectHandler?this.options.returnedObjectHandler(C,A,{...t,ns:g}):`key '${d} (${this.language})' returned an object instead of string.`;return a?(S.res=H,S.usedParams=this.getUsedParamsDetails(t),S):H}if(c){const H=Array.isArray(A),se=H?[]:{},oe=H?N:C;for(const Q in A)if(Object.prototype.hasOwnProperty.call(A,Q)){const fe=`${oe}${c}${Q}`;se[Q]=this.translate(fe,{...t,joinArrays:!1,ns:g}),se[Q]===fe&&(se[Q]=A[Q])}A=se}}else if(j&&isString(P)&&Array.isArray(A))A=A.join(P),A&&(A=this.extendTranslation(A,e,t,o));else{let H=!1,se=!1;const oe=t.count!==void 0&&!isString(t.count),Q=Translator.hasDefaultValue(t),fe=oe?this.pluralResolver.getSuffix(_,t.count,t):"",Z=t.ordinal&&oe?this.pluralResolver.getSuffix(_,t.count,{ordinal:!1}):"",ce=oe&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),ge=ce&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${fe}`]||t[`defaultValue${Z}`]||t.defaultValue;!this.isValidLookup(A)&&Q&&(H=!0,A=ge),this.isValidLookup(A)||(se=!0,A=d);const V=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&se?void 0:A,R=Q&&ge!==A&&this.options.updateMissing;if(se||H||R){if(this.logger.log(R?"updateKey":"missingKey",_,y,d,R?ge:A),c){const W=this.resolve(d,{...t,keySeparator:!1});W&&W.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let L=[];const z=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&z&&z[0])for(let W=0;W<z.length;W++)L.push(z[W]);else this.options.saveMissingTo==="all"?L=this.languageUtils.toResolveHierarchy(t.lng||this.language):L.push(t.lng||this.language);const Y=(W,ee,ie)=>{const X=Q&&ie!==A?ie:V;this.options.missingKeyHandler?this.options.missingKeyHandler(W,y,ee,X,R,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(W,y,ee,X,R,t),this.emit("missingKey",W,y,ee,A)};this.options.saveMissing&&(this.options.saveMissingPlurals&&oe?L.forEach(W=>{const ee=this.pluralResolver.getSuffixes(W,t);ce&&t[`defaultValue${this.options.pluralSeparator}zero`]&&ee.indexOf(`${this.options.pluralSeparator}zero`)<0&&ee.push(`${this.options.pluralSeparator}zero`),ee.forEach(ie=>{Y([W],d+ie,t[`defaultValue${ie}`]||ge)})}):Y(L,d,ge))}A=this.extendTranslation(A,e,t,S,o),se&&A===d&&this.options.appendNamespaceToMissingKey&&(A=`${y}:${d}`),(se||H)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?A=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${y}:${d}`:d,H?A:void 0):A=this.options.parseMissingKeyHandler(A))}return a?(S.res=A,S.usedParams=this.getUsedParamsDetails(t),S):A}extendTranslation(e,t,o,a,c){var d=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...o},o.lng||this.language||a.usedLng,a.usedNS,a.usedKey,{resolved:a});else if(!o.skipInterpolation){o.interpolation&&this.interpolator.init({...o,interpolation:{...this.options.interpolation,...o.interpolation}});const _=isString(e)&&(o&&o.interpolation&&o.interpolation.skipOnVariables!==void 0?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let E;if(_){const A=e.match(this.interpolator.nestingRegexp);E=A&&A.length}let S=o.replace&&!isString(o.replace)?o.replace:o;if(this.options.interpolation.defaultVariables&&(S={...this.options.interpolation.defaultVariables,...S}),e=this.interpolator.interpolate(e,S,o.lng||this.language||a.usedLng,o),_){const A=e.match(this.interpolator.nestingRegexp),C=A&&A.length;E<C&&(o.nest=!1)}!o.lng&&this.options.compatibilityAPI!=="v1"&&a&&a.res&&(o.lng=this.language||a.usedLng),o.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var A=arguments.length,C=new Array(A),N=0;N<A;N++)C[N]=arguments[N];return c&&c[0]===C[0]&&!o.context?(d.logger.warn(`It seems you are nesting recursively key: ${C[0]} in key: ${t[0]}`),null):d.translate(...C,t)},o)),o.interpolation&&this.interpolator.reset()}const g=o.postProcess||this.options.postProcess,y=isString(g)?[g]:g;return e!=null&&y&&y.length&&o.applyPostProcessor!==!1&&(e=postProcessor.handle(y,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...a,usedParams:this.getUsedParamsDetails(o)},...o}:o,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o,a,c,d,g;return isString(e)&&(e=[e]),e.forEach(y=>{if(this.isValidLookup(o))return;const _=this.extractFromKey(y,t),E=_.key;a=E;let S=_.namespaces;this.options.fallbackNS&&(S=S.concat(this.options.fallbackNS));const A=t.count!==void 0&&!isString(t.count),C=A&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),N=t.context!==void 0&&(isString(t.context)||typeof t.context=="number")&&t.context!=="",O=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);S.forEach(I=>{this.isValidLookup(o)||(g=I,!checkedLoadedFor[`${O[0]}-${I}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(g)&&(checkedLoadedFor[`${O[0]}-${I}`]=!0,this.logger.warn(`key "${a}" for languages "${O.join(", ")}" won't get resolved as namespace "${g}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),O.forEach(P=>{if(this.isValidLookup(o))return;d=P;const j=[E];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(j,E,P,I,t);else{let H;A&&(H=this.pluralResolver.getSuffix(P,t.count,t));const se=`${this.options.pluralSeparator}zero`,oe=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(A&&(j.push(E+H),t.ordinal&&H.indexOf(oe)===0&&j.push(E+H.replace(oe,this.options.pluralSeparator)),C&&j.push(E+se)),N){const Q=`${E}${this.options.contextSeparator}${t.context}`;j.push(Q),A&&(j.push(Q+H),t.ordinal&&H.indexOf(oe)===0&&j.push(Q+H.replace(oe,this.options.pluralSeparator)),C&&j.push(Q+se))}}let B;for(;B=j.pop();)this.isValidLookup(o)||(c=B,o=this.getResource(P,I,B,t))}))})}),{res:o,usedKey:a,exactUsedKey:c,usedLng:d,usedNS:g}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,o){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,o,a):this.resourceStore.getResource(e,t,o,a)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],o=e.replace&&!isString(e.replace);let a=o?e.replace:e;if(o&&typeof e.count<"u"&&(a.count=e.count),this.options.interpolation.defaultVariables&&(a={...this.options.interpolation.defaultVariables,...a}),!o){a={...a};for(const c of t)delete a[c]}return a}static hasDefaultValue(e){const t="defaultValue";for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)&&t===o.substring(0,t.length)&&e[o]!==void 0)return!0;return!1}}const capitalize=s=>s.charAt(0).toUpperCase()+s.slice(1);class LanguageUtil{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(e){if(e=getCleanedCode(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=getCleanedCode(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(isString(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let a=Intl.getCanonicalLocales(e)[0];if(a&&this.options.lowerCaseLng&&(a=a.toLowerCase()),a)return a}catch{}const t=["hans","hant","latn","cyrl","cans","mong","arab"];let o=e.split("-");return this.options.lowerCaseLng?o=o.map(a=>a.toLowerCase()):o.length===2?(o[0]=o[0].toLowerCase(),o[1]=o[1].toUpperCase(),t.indexOf(o[1].toLowerCase())>-1&&(o[1]=capitalize(o[1].toLowerCase()))):o.length===3&&(o[0]=o[0].toLowerCase(),o[1].length===2&&(o[1]=o[1].toUpperCase()),o[0]!=="sgn"&&o[2].length===2&&(o[2]=o[2].toUpperCase()),t.indexOf(o[1].toLowerCase())>-1&&(o[1]=capitalize(o[1].toLowerCase())),t.indexOf(o[2].toLowerCase())>-1&&(o[2]=capitalize(o[2].toLowerCase()))),o.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(o=>{if(t)return;const a=this.formatLanguageCode(o);(!this.options.supportedLngs||this.isSupportedCode(a))&&(t=a)}),!t&&this.options.supportedLngs&&e.forEach(o=>{if(t)return;const a=this.getLanguagePartFromCode(o);if(this.isSupportedCode(a))return t=a;t=this.options.supportedLngs.find(c=>{if(c===a)return c;if(!(c.indexOf("-")<0&&a.indexOf("-")<0)&&(c.indexOf("-")>0&&a.indexOf("-")<0&&c.substring(0,c.indexOf("-"))===a||c.indexOf(a)===0&&a.length>1))return c})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),isString(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let o=e[t];return o||(o=e[this.getScriptPartFromCode(t)]),o||(o=e[this.formatLanguageCode(t)]),o||(o=e[this.getLanguagePartFromCode(t)]),o||(o=e.default),o||[]}toResolveHierarchy(e,t){const o=this.getFallbackCodes(t||this.options.fallbackLng||[],e),a=[],c=d=>{d&&(this.isSupportedCode(d)?a.push(d):this.logger.warn(`rejecting language code not found in supportedLngs: ${d}`))};return isString(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&c(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&c(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&c(this.getLanguagePartFromCode(e))):isString(e)&&c(this.formatLanguageCode(e)),o.forEach(d=>{a.indexOf(d)<0&&c(this.formatLanguageCode(d))}),a}}let sets=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],_rulesPluralsTypes={1:s=>+(s>1),2:s=>+(s!=1),3:s=>0,4:s=>s%10==1&&s%100!=11?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2,5:s=>s==0?0:s==1?1:s==2?2:s%100>=3&&s%100<=10?3:s%100>=11?4:5,6:s=>s==1?0:s>=2&&s<=4?1:2,7:s=>s==1?0:s%10>=2&&s%10<=4&&(s%100<10||s%100>=20)?1:2,8:s=>s==1?0:s==2?1:s!=8&&s!=11?2:3,9:s=>+(s>=2),10:s=>s==1?0:s==2?1:s<7?2:s<11?3:4,11:s=>s==1||s==11?0:s==2||s==12?1:s>2&&s<20?2:3,12:s=>+(s%10!=1||s%100==11),13:s=>+(s!==0),14:s=>s==1?0:s==2?1:s==3?2:3,15:s=>s%10==1&&s%100!=11?0:s%10>=2&&(s%100<10||s%100>=20)?1:2,16:s=>s%10==1&&s%100!=11?0:s!==0?1:2,17:s=>s==1||s%10==1&&s%100!=11?0:1,18:s=>s==0?0:s==1?1:2,19:s=>s==1?0:s==0||s%100>1&&s%100<11?1:s%100>10&&s%100<20?2:3,20:s=>s==1?0:s==0||s%100>0&&s%100<20?1:2,21:s=>s%100==1?1:s%100==2?2:s%100==3||s%100==4?3:0,22:s=>s==1?0:s==2?1:(s<0||s>10)&&s%10==0?2:3};const nonIntlVersions=["v1","v2","v3"],intlVersions=["v4"],suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5},createRules=()=>{const s={};return sets.forEach(e=>{e.lngs.forEach(t=>{s[t]={numbers:e.nr,plurals:_rulesPluralsTypes[e.fc]}})}),s};class PluralResolver{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=baseLogger.create("pluralResolver"),(!this.options.compatibilityJSON||intlVersions.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=createRules(),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const o=getCleanedCode(e==="dev"?"en":e),a=t.ordinal?"ordinal":"cardinal",c=JSON.stringify({cleanedCode:o,type:a});if(c in this.pluralRulesCache)return this.pluralRulesCache[c];let d;try{d=new Intl.PluralRules(o,{type:a})}catch{if(!e.match(/-|_/))return;const y=this.languageUtils.getLanguagePartFromCode(e);d=this.getRule(y,t)}return this.pluralRulesCache[c]=d,d}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=this.getRule(e,t);return this.shouldUseIntlApi()?o&&o.resolvedOptions().pluralCategories.length>1:o&&o.numbers.length>1}getPluralFormsOfKey(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,o).map(a=>`${t}${a}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=this.getRule(e,t);return o?this.shouldUseIntlApi()?o.resolvedOptions().pluralCategories.sort((a,c)=>suffixesOrder[a]-suffixesOrder[c]).map(a=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${a}`):o.numbers.map(a=>this.getSuffix(e,a,t)):[]}getSuffix(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const a=this.getRule(e,o);return a?this.shouldUseIntlApi()?`${this.options.prepend}${o.ordinal?`ordinal${this.options.prepend}`:""}${a.select(t)}`:this.getSuffixRetroCompatible(a,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const o=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let a=e.numbers[o];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(a===2?a="plural":a===1&&(a=""));const c=()=>this.options.prepend&&a.toString()?this.options.prepend+a.toString():a.toString();return this.options.compatibilityJSON==="v1"?a===1?"":typeof a=="number"?`_plural_${a.toString()}`:c():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?c():this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString()}shouldUseIntlApi(){return!nonIntlVersions.includes(this.options.compatibilityJSON)}}const deepFindWithDefaults=function(s,e,t){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,c=getPathWithDefaults(s,e,t);return!c&&a&&isString(t)&&(c=deepFind(s,t,o),c===void 0&&(c=deepFind(e,t,o))),c},regexSafe=s=>s.replace(/\$/g,"$$$$");class Interpolator{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(t=>t),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:o,useRawValueToEscape:a,prefix:c,prefixEscaped:d,suffix:g,suffixEscaped:y,formatSeparator:_,unescapeSuffix:E,unescapePrefix:S,nestingPrefix:A,nestingPrefixEscaped:C,nestingSuffix:N,nestingSuffixEscaped:O,nestingOptionsSeparator:I,maxReplaces:P,alwaysFormat:j}=e.interpolation;this.escape=t!==void 0?t:escape,this.escapeValue=o!==void 0?o:!0,this.useRawValueToEscape=a!==void 0?a:!1,this.prefix=c?regexEscape(c):d||"{{",this.suffix=g?regexEscape(g):y||"}}",this.formatSeparator=_||",",this.unescapePrefix=E?"":S||"-",this.unescapeSuffix=this.unescapePrefix?"":E||"",this.nestingPrefix=A?regexEscape(A):C||regexEscape("$t("),this.nestingSuffix=N?regexEscape(N):O||regexEscape(")"),this.nestingOptionsSeparator=I||",",this.maxReplaces=P||1e3,this.alwaysFormat=j!==void 0?j:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,o)=>t&&t.source===o?(t.lastIndex=0,t):new RegExp(o,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,o,a){let c,d,g;const y=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},_=C=>{if(C.indexOf(this.formatSeparator)<0){const P=deepFindWithDefaults(t,y,C,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(P,void 0,o,{...a,...t,interpolationkey:C}):P}const N=C.split(this.formatSeparator),O=N.shift().trim(),I=N.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(t,y,O,this.options.keySeparator,this.options.ignoreJSONStructure),I,o,{...a,...t,interpolationkey:O})};this.resetRegExp();const E=a&&a.missingInterpolationHandler||this.options.missingInterpolationHandler,S=a&&a.interpolation&&a.interpolation.skipOnVariables!==void 0?a.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:C=>regexSafe(C)},{regex:this.regexp,safeValue:C=>this.escapeValue?regexSafe(this.escape(C)):regexSafe(C)}].forEach(C=>{for(g=0;c=C.regex.exec(e);){const N=c[1].trim();if(d=_(N),d===void 0)if(typeof E=="function"){const I=E(e,c,a);d=isString(I)?I:""}else if(a&&Object.prototype.hasOwnProperty.call(a,N))d="";else if(S){d=c[0];continue}else this.logger.warn(`missed to pass in variable ${N} for interpolating ${e}`),d="";else!isString(d)&&!this.useRawValueToEscape&&(d=makeString(d));const O=C.safeValue(d);if(e=e.replace(c[0],O),S?(C.regex.lastIndex+=d.length,C.regex.lastIndex-=c[0].length):C.regex.lastIndex=0,g++,g>=this.maxReplaces)break}}),e}nest(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a,c,d;const g=(y,_)=>{const E=this.nestingOptionsSeparator;if(y.indexOf(E)<0)return y;const S=y.split(new RegExp(`${E}[ ]*{`));let A=`{${S[1]}`;y=S[0],A=this.interpolate(A,d);const C=A.match(/'/g),N=A.match(/"/g);(C&&C.length%2===0&&!N||N.length%2!==0)&&(A=A.replace(/'/g,'"'));try{d=JSON.parse(A),_&&(d={..._,...d})}catch(O){return this.logger.warn(`failed parsing options string in nesting for key ${y}`,O),`${y}${E}${A}`}return d.defaultValue&&d.defaultValue.indexOf(this.prefix)>-1&&delete d.defaultValue,y};for(;a=this.nestingRegexp.exec(e);){let y=[];d={...o},d=d.replace&&!isString(d.replace)?d.replace:d,d.applyPostProcessor=!1,delete d.defaultValue;let _=!1;if(a[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(a[1])){const E=a[1].split(this.formatSeparator).map(S=>S.trim());a[1]=E.shift(),y=E,_=!0}if(c=t(g.call(this,a[1].trim(),d),d),c&&a[0]===e&&!isString(c))return c;isString(c)||(c=makeString(c)),c||(this.logger.warn(`missed to resolve ${a[1]} for nesting ${e}`),c=""),_&&(c=y.reduce((E,S)=>this.format(E,S,o.lng,{...o,interpolationkey:a[1].trim()}),c.trim())),e=e.replace(a[0],c),this.regexp.lastIndex=0}return e}}const parseFormatStr=s=>{let e=s.toLowerCase().trim();const t={};if(s.indexOf("(")>-1){const o=s.split("(");e=o[0].toLowerCase().trim();const a=o[1].substring(0,o[1].length-1);e==="currency"&&a.indexOf(":")<0?t.currency||(t.currency=a.trim()):e==="relativetime"&&a.indexOf(":")<0?t.range||(t.range=a.trim()):a.split(";").forEach(d=>{if(d){const[g,...y]=d.split(":"),_=y.join(":").trim().replace(/^'+|'+$/g,""),E=g.trim();t[E]||(t[E]=_),_==="false"&&(t[E]=!1),_==="true"&&(t[E]=!0),isNaN(_)||(t[E]=parseInt(_,10))}})}return{formatName:e,formatOptions:t}},createCachedFormatter=s=>{const e={};return(t,o,a)=>{let c=a;a&&a.interpolationkey&&a.formatParams&&a.formatParams[a.interpolationkey]&&a[a.interpolationkey]&&(c={...c,[a.interpolationkey]:void 0});const d=o+JSON.stringify(c);let g=e[d];return g||(g=s(getCleanedCode(o),a),e[d]=g),g(t)}};class Formatter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("formatter"),this.options=e,this.formats={number:createCachedFormatter((t,o)=>{const a=new Intl.NumberFormat(t,{...o});return c=>a.format(c)}),currency:createCachedFormatter((t,o)=>{const a=new Intl.NumberFormat(t,{...o,style:"currency"});return c=>a.format(c)}),datetime:createCachedFormatter((t,o)=>{const a=new Intl.DateTimeFormat(t,{...o});return c=>a.format(c)}),relativetime:createCachedFormatter((t,o)=>{const a=new Intl.RelativeTimeFormat(t,{...o});return c=>a.format(c,o.range||"day")}),list:createCachedFormatter((t,o)=>{const a=new Intl.ListFormat(t,{...o});return c=>a.format(c)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=createCachedFormatter(t)}format(e,t,o){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const c=t.split(this.formatSeparator);if(c.length>1&&c[0].indexOf("(")>1&&c[0].indexOf(")")<0&&c.find(g=>g.indexOf(")")>-1)){const g=c.findIndex(y=>y.indexOf(")")>-1);c[0]=[c[0],...c.splice(1,g)].join(this.formatSeparator)}return c.reduce((g,y)=>{const{formatName:_,formatOptions:E}=parseFormatStr(y);if(this.formats[_]){let S=g;try{const A=a&&a.formatParams&&a.formatParams[a.interpolationkey]||{},C=A.locale||A.lng||a.locale||a.lng||o;S=this.formats[_](g,C,{...E,...a,...A})}catch(A){this.logger.warn(A)}return S}else this.logger.warn(`there was no format function for ${_}`);return g},e)}}const removePending=(s,e)=>{s.pending[e]!==void 0&&(delete s.pending[e],s.pendingCount--)};class Connector extends EventEmitter{constructor(e,t,o){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=o,this.languageUtils=o.languageUtils,this.options=a,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=a.maxParallelReads||10,this.readingCalls=0,this.maxRetries=a.maxRetries>=0?a.maxRetries:5,this.retryTimeout=a.retryTimeout>=1?a.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(o,a.backend,a)}queueLoad(e,t,o,a){const c={},d={},g={},y={};return e.forEach(_=>{let E=!0;t.forEach(S=>{const A=`${_}|${S}`;!o.reload&&this.store.hasResourceBundle(_,S)?this.state[A]=2:this.state[A]<0||(this.state[A]===1?d[A]===void 0&&(d[A]=!0):(this.state[A]=1,E=!1,d[A]===void 0&&(d[A]=!0),c[A]===void 0&&(c[A]=!0),y[S]===void 0&&(y[S]=!0)))}),E||(g[_]=!0)}),(Object.keys(c).length||Object.keys(d).length)&&this.queue.push({pending:d,pendingCount:Object.keys(d).length,loaded:{},errors:[],callback:a}),{toLoad:Object.keys(c),pending:Object.keys(d),toLoadLanguages:Object.keys(g),toLoadNamespaces:Object.keys(y)}}loaded(e,t,o){const a=e.split("|"),c=a[0],d=a[1];t&&this.emit("failedLoading",c,d,t),!t&&o&&this.store.addResourceBundle(c,d,o,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&o&&(this.state[e]=0);const g={};this.queue.forEach(y=>{pushPath(y.loaded,[c],d),removePending(y,e),t&&y.errors.push(t),y.pendingCount===0&&!y.done&&(Object.keys(y.loaded).forEach(_=>{g[_]||(g[_]={});const E=y.loaded[_];E.length&&E.forEach(S=>{g[_][S]===void 0&&(g[_][S]=!0)})}),y.done=!0,y.errors.length?y.callback(y.errors):y.callback())}),this.emit("loaded",g),this.queue=this.queue.filter(y=>!y.done)}read(e,t,o){let a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,d=arguments.length>5?arguments[5]:void 0;if(!e.length)return d(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:o,tried:a,wait:c,callback:d});return}this.readingCalls++;const g=(_,E)=>{if(this.readingCalls--,this.waitingReads.length>0){const S=this.waitingReads.shift();this.read(S.lng,S.ns,S.fcName,S.tried,S.wait,S.callback)}if(_&&E&&a<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,o,a+1,c*2,d)},c);return}d(_,E)},y=this.backend[o].bind(this.backend);if(y.length===2){try{const _=y(e,t);_&&typeof _.then=="function"?_.then(E=>g(null,E)).catch(g):g(null,_)}catch(_){g(_)}return}return y(e,t,g)}prepareLoading(e,t){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();isString(e)&&(e=this.languageUtils.toResolveHierarchy(e)),isString(t)&&(t=[t]);const c=this.queueLoad(e,t,o,a);if(!c.toLoad.length)return c.pending.length||a(),null;c.toLoad.forEach(d=>{this.loadOne(d)})}load(e,t,o){this.prepareLoading(e,t,{},o)}reload(e,t,o){this.prepareLoading(e,t,{reload:!0},o)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const o=e.split("|"),a=o[0],c=o[1];this.read(a,c,"read",void 0,void 0,(d,g)=>{d&&this.logger.warn(`${t}loading namespace ${c} for language ${a} failed`,d),!d&&g&&this.logger.log(`${t}loaded namespace ${c} for language ${a}`,g),this.loaded(e,d,g)})}saveMissing(e,t,o,a,c){let d=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},g=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${o}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(o==null||o==="")){if(this.backend&&this.backend.create){const y={...d,isUpdate:c},_=this.backend.create.bind(this.backend);if(_.length<6)try{let E;_.length===5?E=_(e,t,o,a,y):E=_(e,t,o,a),E&&typeof E.then=="function"?E.then(S=>g(null,S)).catch(g):g(null,E)}catch(E){g(E)}else _(e,t,o,a,g,y)}!e||!e[0]||this.store.addResource(e[0],t,o,a)}}}const get=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:s=>{let e={};if(typeof s[1]=="object"&&(e=s[1]),isString(s[1])&&(e.defaultValue=s[1]),isString(s[2])&&(e.tDescription=s[2]),typeof s[2]=="object"||typeof s[3]=="object"){const t=s[3]||s[2];Object.keys(t).forEach(o=>{e[o]=t[o]})}return e},interpolation:{escapeValue:!0,format:s=>s,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),transformOptions=s=>(isString(s.ns)&&(s.ns=[s.ns]),isString(s.fallbackLng)&&(s.fallbackLng=[s.fallbackLng]),isString(s.fallbackNS)&&(s.fallbackNS=[s.fallbackNS]),s.supportedLngs&&s.supportedLngs.indexOf("cimode")<0&&(s.supportedLngs=s.supportedLngs.concat(["cimode"])),s),noop=()=>{},bindMemberFunctions=s=>{Object.getOwnPropertyNames(Object.getPrototypeOf(s)).forEach(t=>{typeof s[t]=="function"&&(s[t]=s[t].bind(s))})};class I18n extends EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=transformOptions(e),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(o=t,t={}),!t.defaultNS&&t.defaultNS!==!1&&t.ns&&(isString(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const a=get();this.options={...a,...this.options,...transformOptions(t)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...a.interpolation,...this.options.interpolation}),t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const c=E=>E?typeof E=="function"?new E:E:null;if(!this.options.isClone){this.modules.logger?baseLogger.init(c(this.modules.logger),this.options):baseLogger.init(null,this.options);let E;this.modules.formatter?E=this.modules.formatter:typeof Intl<"u"&&(E=Formatter);const S=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const A=this.services;A.logger=baseLogger,A.resourceStore=this.store,A.languageUtils=S,A.pluralResolver=new PluralResolver(S,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),E&&(!this.options.interpolation.format||this.options.interpolation.format===a.interpolation.format)&&(A.formatter=c(E),A.formatter.init(A,this.options),this.options.interpolation.format=A.formatter.format.bind(A.formatter)),A.interpolator=new Interpolator(this.options),A.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},A.backendConnector=new Connector(c(this.modules.backend),A.resourceStore,A,this.options),A.backendConnector.on("*",function(C){for(var N=arguments.length,O=new Array(N>1?N-1:0),I=1;I<N;I++)O[I-1]=arguments[I];e.emit(C,...O)}),this.modules.languageDetector&&(A.languageDetector=c(this.modules.languageDetector),A.languageDetector.init&&A.languageDetector.init(A,this.options.detection,this.options)),this.modules.i18nFormat&&(A.i18nFormat=c(this.modules.i18nFormat),A.i18nFormat.init&&A.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",function(C){for(var N=arguments.length,O=new Array(N>1?N-1:0),I=1;I<N;I++)O[I-1]=arguments[I];e.emit(C,...O)}),this.modules.external.forEach(C=>{C.init&&C.init(this)})}if(this.format=this.options.interpolation.format,o||(o=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const E=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);E.length>0&&E[0]!=="dev"&&(this.options.lng=E[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(E=>{this[E]=function(){return e.store[E](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(E=>{this[E]=function(){return e.store[E](...arguments),e}});const y=defer(),_=()=>{const E=(S,A)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),y.resolve(A),o(S,A)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return E(null,this.t.bind(this));this.changeLanguage(this.options.lng,E)};return this.options.resources||!this.options.initImmediate?_():setTimeout(_,0),y}loadResources(e){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const a=isString(e)?e:this.language;if(typeof e=="function"&&(o=e),!this.options.resources||this.options.partialBundledLanguages){if(a&&a.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return o();const c=[],d=g=>{if(!g||g==="cimode")return;this.services.languageUtils.toResolveHierarchy(g).forEach(_=>{_!=="cimode"&&c.indexOf(_)<0&&c.push(_)})};a?d(a):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(y=>d(y)),this.options.preload&&this.options.preload.forEach(g=>d(g)),this.services.backendConnector.load(c,this.options.ns,g=>{!g&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),o(g)})}else o(null)}reloadResources(e,t,o){const a=defer();return typeof e=="function"&&(o=e,e=void 0),typeof t=="function"&&(o=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),o||(o=noop),this.services.backendConnector.reload(e,t,c=>{a.resolve(),o(c)}),a}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&postProcessor.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const o=this.languages[t];if(!(["cimode","dev"].indexOf(o)>-1)&&this.store.hasLanguageSomeTranslations(o)){this.resolvedLanguage=o;break}}}changeLanguage(e,t){var o=this;this.isLanguageChangingTo=e;const a=defer();this.emit("languageChanging",e);const c=y=>{this.language=y,this.languages=this.services.languageUtils.toResolveHierarchy(y),this.resolvedLanguage=void 0,this.setResolvedLanguage(y)},d=(y,_)=>{_?(c(_),this.translator.changeLanguage(_),this.isLanguageChangingTo=void 0,this.emit("languageChanged",_),this.logger.log("languageChanged",_)):this.isLanguageChangingTo=void 0,a.resolve(function(){return o.t(...arguments)}),t&&t(y,function(){return o.t(...arguments)})},g=y=>{!e&&!y&&this.services.languageDetector&&(y=[]);const _=isString(y)?y:this.services.languageUtils.getBestMatchFromCodes(y);_&&(this.language||c(_),this.translator.language||this.translator.changeLanguage(_),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(_)),this.loadResources(_,E=>{d(E,_)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?g(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(g):this.services.languageDetector.detect(g):g(e),a}getFixedT(e,t,o){var a=this;const c=function(d,g){let y;if(typeof g!="object"){for(var _=arguments.length,E=new Array(_>2?_-2:0),S=2;S<_;S++)E[S-2]=arguments[S];y=a.options.overloadTranslationOptionHandler([d,g].concat(E))}else y={...g};y.lng=y.lng||c.lng,y.lngs=y.lngs||c.lngs,y.ns=y.ns||c.ns,y.keyPrefix!==""&&(y.keyPrefix=y.keyPrefix||o||c.keyPrefix);const A=a.options.keySeparator||".";let C;return y.keyPrefix&&Array.isArray(d)?C=d.map(N=>`${y.keyPrefix}${A}${N}`):C=y.keyPrefix?`${y.keyPrefix}${A}${d}`:d,a.t(C,y)};return isString(e)?c.lng=e:c.lngs=e,c.ns=t,c.keyPrefix=o,c}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const o=t.lng||this.resolvedLanguage||this.languages[0],a=this.options?this.options.fallbackLng:!1,c=this.languages[this.languages.length-1];if(o.toLowerCase()==="cimode")return!0;const d=(g,y)=>{const _=this.services.backendConnector.state[`${g}|${y}`];return _===-1||_===0||_===2};if(t.precheck){const g=t.precheck(this,d);if(g!==void 0)return g}return!!(this.hasResourceBundle(o,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||d(o,e)&&(!a||d(c,e)))}loadNamespaces(e,t){const o=defer();return this.options.ns?(isString(e)&&(e=[e]),e.forEach(a=>{this.options.ns.indexOf(a)<0&&this.options.ns.push(a)}),this.loadResources(a=>{o.resolve(),t&&t(a)}),o):(t&&t(),Promise.resolve())}loadLanguages(e,t){const o=defer();isString(e)&&(e=[e]);const a=this.options.preload||[],c=e.filter(d=>a.indexOf(d)<0&&this.services.languageUtils.isSupportedCode(d));return c.length?(this.options.preload=a.concat(c),this.loadResources(d=>{o.resolve(),t&&t(d)}),o):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],o=this.services&&this.services.languageUtils||new LanguageUtil(get());return t.indexOf(o.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new I18n(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const o=e.forkResourceStore;o&&delete e.forkResourceStore;const a={...this.options,...e,isClone:!0},c=new I18n(a);return(e.debug!==void 0||e.prefix!==void 0)&&(c.logger=c.logger.clone(e)),["store","services","language"].forEach(g=>{c[g]=this[g]}),c.services={...this.services},c.services.utils={hasLoadedNamespace:c.hasLoadedNamespace.bind(c)},o&&(c.store=new ResourceStore(this.store.data,a),c.services.resourceStore=c.store),c.translator=new Translator(c.services,a),c.translator.on("*",function(g){for(var y=arguments.length,_=new Array(y>1?y-1:0),E=1;E<y;E++)_[E-1]=arguments[E];c.emit(g,..._)}),c.init(a,t),c.translator.options=a,c.translator.backendConnector.services.utils={hasLoadedNamespace:c.hasLoadedNamespace.bind(c)},c}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance=I18n.createInstance();instance.createInstance=I18n.createInstance;instance.createInstance;instance.dir;instance.init;instance.loadResources;instance.reloadResources;instance.use;instance.changeLanguage;instance.getFixedT;instance.t;instance.exists;instance.setDefaultNamespace;instance.hasLoadedNamespace;instance.loadNamespaces;instance.loadLanguages;const title="Smart Product Passport",connect_wallet$1="Connect Wallet",scan$1="Scan Product",passports$1="Passports",about$1="About",main$1="Home",language$1="Language",english$1="English",ukrainian$1="Ukrainian",secure_storage$1="Secure Storage",secure_storage_desc$1="All data is stored in the decentralized Solana network, ensuring maximum security and reliability.",qr_codes$1="QR Codes",qr_codes_desc$1="Quick access to information via QR codes for instant product authenticity checks.",authenticity_check$1="Authenticity Check",authenticity_check_desc$1="Instant product authenticity verification with detailed history and characteristics.",how_it_works$1="How it works?",step1$1="Connect your Solana wallet to access the system.",step2$1="Add product information and upload documents.",step3$1="Get a unique QR code for your product.",step4$1="Scan QR codes to verify product authenticity.",footer_text$1="© 2025 Smart Product Passport. All rights reserved.",create_passport$1="Create Passport",manufacturer_id$1="Manufacturer ID",additional_docs$1="Additional Documents",view$1="View",none$1="None",serial_number$1="Serial Number",production_date$1="Production Date",model$1="Model",warranty_period$1="Warranty Period",country_of_origin$1="Country of Origin",actions$1="Actions",about_us$1="About Us",about_us_text1$1="Smart Product Passport is an innovative solution for creating and managing digital product passports. Our platform uses the Solana blockchain for data security and transparency.",about_us_text2$1="We provide tools for manufacturers, dealers, and end users to create, verify, and manage digital product passports.",about_us_text3$1="Our mission is to make product tracking and verification more efficient and secure.",about_mission_title$1="Our Mission",about_offerings_title$1="What We Offer",about_offerings_desc$1="We provide comprehensive tools for all market participants:",about_manufacturers$1="Manufacturers:",about_manufacturers_desc$1="creation and management of digital product passports",about_dealers$1="Dealers:",about_dealers_desc$1="authenticity verification and product tracking",about_consumers$1="Consumers:",about_consumers_desc$1="instant verification of product authenticity through QR codes",about_benefits_title$1="Key Benefits",about_convenience$1="Convenience",about_convenience_desc$1="Quick access through QR codes and mobile devices",about_transparency$1="Transparency",about_transparency_desc$1="Complete product history available to every user",about_speed$1="Speed",about_speed_desc$1="Instant verification of product authenticity",about_goal_title$1="Our Goal",about_future_title$1="Future Technologies",about_future_desc$1="Using the latest blockchain technologies, we create an ecosystem where every product has its unique digital passport, guaranteeing its authenticity and providing complete information about its history.",about_join_title$1="Join Us",about_join_desc$1="Become part of the revolution in digital product passports. Together we create a safer and more transparent future for all market participants.",about_trust$1="Trust",about_security$1="Security",about_innovation$1="Innovation",faq_title$1="Frequently Asked Questions",faq_manufacturer_q$1="How can manufacturers use Smart Product Passport?",faq_manufacturer_a$1="Manufacturers can create digital passports for their products, including detailed information about manufacturing date, warranty, and authenticity. This helps in product tracking, warranty management, and combating counterfeiting.",faq_consumer_q$1="How does Smart Product Passport benefit consumers?",faq_consumer_a$1="Consumers can verify product authenticity, access warranty information, and view product history by simply scanning a QR code. This ensures they're purchasing genuine products and helps with warranty claims.",faq_retailer_q$1="What advantages does Smart Product Passport offer to retailers?",faq_retailer_a$1="Retailers can verify product authenticity, manage inventory more effectively, and provide better customer service by having instant access to product information. It also helps in building trust with customers.",faq_warranty_q$1="How does the warranty system work?",faq_warranty_a$1="Each product passport contains warranty information that is stored on the blockchain. This ensures warranty data cannot be tampered with and provides a transparent record of warranty terms and conditions.",faq_authenticity_q$1="How can I verify product authenticity?",faq_authenticity_a$1="Simply scan the QR code on the product using our app. The system will instantly verify the product's authenticity by checking its digital passport on the blockchain, providing you with detailed product information and history.",comics_title$1="Our Comics",comics_subtitle$1="Learn more about Smart Product Passport through our exciting comics",comics_read_more$1="Read more",comics_view_all$1="View all comics",comic_1_title$1="Smart Product Passport Protocol",comic_1_desc$1="Revolutionary protocol for creating digital product passports",comic_1_fullStory="This comic shows the revolutionary Smart Product Passport protocol, which creates digital passports for every product. Our technology allows the entire product history to be stored on the Solana blockchain, ensuring transparency and trust among all market participants. Each product receives a unique digital identifier containing information about the manufacturer, production date, warranty, and all subsequent transactions.",comic_1_technology="Solana blockchain provides speed, security, and low transaction costs. IPFS stores documents and images. QR codes provide instant access to information.",comic_2_title$1="Solana Breakpoint Hackathon",comic_2_desc$1="Our project at the largest Solana hackathon",comic_2_fullStory="At the Solana Breakpoint hackathon, we presented our solution to the global developer community. This comic shows how our team created an innovative solution for digital product passports. The hackathon allowed us to test the technology in real conditions and receive valuable feedback from blockchain industry experts.",comic_2_technology="Solana Breakpoint is the largest hackathon in the Solana ecosystem. Our team used the Anchor framework for smart contract development and React for an intuitive interface.",comic_3_title$1="Future of NFTs and Smart Passports",comic_3_desc$1="How NFT technologies are changing the world of products",comic_3_fullStory="The future belongs to NFT technologies and smart passports. This comic illustrates how every product becomes a unique digital asset with a complete history. NFT passports allow tracking the entire product lifecycle—from manufacturing to disposal—ensuring transparency and trust.",comic_3_technology="NFTs (Non-Fungible Tokens) ensure the uniqueness of each passport. Smart contracts automate verification and ownership transfer processes. This is a revolution in logistics and anti-counterfeiting.",comic_4_title$1="Updates through Smart Product Passport",comic_4_desc$1="Easy product updates using smart passports",comic_4_fullStory="Smart Product Passport makes product updates simple and secure. The user can easily update firmware, drivers, or settings via QR code. The entire update history is stored on the blockchain, ensuring transparency and security of the process.",comic_4_technology="QR codes provide instant access to information. Blockchain stores the history of all updates. Automated processes reduce the risk of errors and ensure data consistency.",comic_5_title$1="Skydiving over Futuristic City",comic_5_desc$1="Daring flight into the future of technology",comic_5_fullStory="As a skydiver rises above the city, so does our technology elevate the industry to a new level. This comic symbolizes a bold flight into the future, where every product has its digital passport. This is the future of transparency, trust, and innovation.",comic_5_technology="Blockchain technologies create a new paradigm of trust. Decentralized systems ensure independence from central authorities. This is the foundation for the Web3 economy.",comic_6_title$1="Easy Driver Updates",comic_6_desc$1="Simplified software update process",comic_6_fullStory$1="Driver updates are no longer a complex task. Smart Product Passport automatically identifies the product and finds the appropriate updates. The user receives personalized recommendations and can easily install the necessary updates via QR code.",comic_6_technology$1="AI algorithms analyze product characteristics and find suitable updates. Blockchain ensures the authenticity of updates. Automated processes reduce technical complexity for users.",full_story$1="Full Story",technology_details$1="Technology Details",close$1="Close",en={title,connect_wallet:connect_wallet$1,scan:scan$1,passports:passports$1,about:about$1,main:main$1,language:language$1,english:english$1,ukrainian:ukrainian$1,secure_storage:secure_storage$1,secure_storage_desc:secure_storage_desc$1,qr_codes:qr_codes$1,qr_codes_desc:qr_codes_desc$1,authenticity_check:authenticity_check$1,authenticity_check_desc:authenticity_check_desc$1,how_it_works:how_it_works$1,step1:step1$1,step2:step2$1,step3:step3$1,step4:step4$1,footer_text:footer_text$1,create_passport:create_passport$1,manufacturer_id:manufacturer_id$1,additional_docs:additional_docs$1,view:view$1,none:none$1,serial_number:serial_number$1,production_date:production_date$1,model:model$1,warranty_period:warranty_period$1,country_of_origin:country_of_origin$1,actions:actions$1,about_us:about_us$1,about_us_text1:about_us_text1$1,about_us_text2:about_us_text2$1,about_us_text3:about_us_text3$1,about_mission_title:about_mission_title$1,about_offerings_title:about_offerings_title$1,about_offerings_desc:about_offerings_desc$1,about_manufacturers:about_manufacturers$1,about_manufacturers_desc:about_manufacturers_desc$1,about_dealers:about_dealers$1,about_dealers_desc:about_dealers_desc$1,about_consumers:about_consumers$1,about_consumers_desc:about_consumers_desc$1,about_benefits_title:about_benefits_title$1,about_convenience:about_convenience$1,about_convenience_desc:about_convenience_desc$1,about_transparency:about_transparency$1,about_transparency_desc:about_transparency_desc$1,about_speed:about_speed$1,about_speed_desc:about_speed_desc$1,about_goal_title:about_goal_title$1,about_future_title:about_future_title$1,about_future_desc:about_future_desc$1,about_join_title:about_join_title$1,about_join_desc:about_join_desc$1,about_trust:about_trust$1,about_security:about_security$1,about_innovation:about_innovation$1,faq_title:faq_title$1,faq_manufacturer_q:faq_manufacturer_q$1,faq_manufacturer_a:faq_manufacturer_a$1,faq_consumer_q:faq_consumer_q$1,faq_consumer_a:faq_consumer_a$1,faq_retailer_q:faq_retailer_q$1,faq_retailer_a:faq_retailer_a$1,faq_warranty_q:faq_warranty_q$1,faq_warranty_a:faq_warranty_a$1,faq_authenticity_q:faq_authenticity_q$1,faq_authenticity_a:faq_authenticity_a$1,comics_title:comics_title$1,comics_subtitle:comics_subtitle$1,comics_read_more:comics_read_more$1,comics_view_all:comics_view_all$1,comic_1_title:comic_1_title$1,comic_1_desc:comic_1_desc$1,comic_1_fullStory,comic_1_technology,comic_2_title:comic_2_title$1,comic_2_desc:comic_2_desc$1,comic_2_fullStory,comic_2_technology,comic_3_title:comic_3_title$1,comic_3_desc:comic_3_desc$1,comic_3_fullStory,comic_3_technology,comic_4_title:comic_4_title$1,comic_4_desc:comic_4_desc$1,comic_4_fullStory,comic_4_technology,comic_5_title:comic_5_title$1,comic_5_desc:comic_5_desc$1,comic_5_fullStory,comic_5_technology,comic_6_title:comic_6_title$1,comic_6_desc:comic_6_desc$1,comic_6_fullStory:comic_6_fullStory$1,comic_6_technology:comic_6_technology$1,full_story:full_story$1,technology_details:technology_details$1,close:close$1,"3d_demo_title":"3D NFT Demo: Scan & Claim!","3d_demo_desc":"Try our capabilities: rotate the 3D box, scan the QR code, and get a test NFT. This is a demonstration for manufacturers, drivers, consumers. NFT is free!","3d_demo_nft_title":"Test NFT:","3d_demo_nft_desc":"Manufacturer: SPP Demo | Category: drivers | For testing — scan the QR code and get the NFT to your Solana wallet."},connect_wallet="Підключити гаманець",scan="Сканувати продукт",passports="Паспорти",about="Про нас",main="Головна",language="Мова",english="Англійська",ukrainian="Українська",secure_storage="Безпечне зберігання",secure_storage_desc="Всі дані зберігаються в децентралізованій мережі Solana, забезпечуючи максимальну безпеку та надійність.",qr_codes="QR-коди",qr_codes_desc="Швидкий доступ до інформації через QR-коди, що дозволяє миттєво перевіряти автентичність продуктів.",authenticity_check="Перевірка автентичності",authenticity_check_desc="Миттєва перевірка справжності продукту з детальною інформацією про його історію та характеристики.",how_it_works="Як це працює?",step1="Підключіть свій Solana гаманець для доступу до системи.",step2="Додайте інформацію про продукт та завантажте документи.",step3="Отримайте унікальний QR-код для вашого продукту.",step4="Скануйте QR-коди для перевірки автентичності продуктів.",footer_text="© 2025 Смарт-продуктовий паспорт. Всі права захищені.",create_passport="Створити паспорт",manufacturer_id="ID виробника",additional_docs="Додаткові документи",view="Переглянути",none="Немає",serial_number="Серійний номер",production_date="Дата виробництва",model="Модель",warranty_period="Гарантійний термін",country_of_origin="Країна виробництва",actions="Дії",about_us="Про нас",about_us_text1="Smart Product Passport — це інноваційне рішення для створення та управління цифровими паспортами продуктів. Наша платформа використовує блокчейн Solana для забезпечення безпеки та прозорості даних.",about_us_text2="Ми надаємо інструменти для виробників, дилерів та кінцевих користувачів, дозволяючи їм створювати, перевіряти та керувати цифровими паспортами продуктів.",about_us_text3="Наша місія — зробити процес відстеження та перевірки продуктів більш ефективним та безпечним.",about_mission_title="Наша Місія",about_offerings_title="Що ми пропонуємо",about_offerings_desc="Ми надаємо комплексні інструменти для всіх учасників ринку:",about_manufacturers="Виробникам:",about_manufacturers_desc="створення та управління цифровими паспортами продуктів",about_dealers="Дилерам:",about_dealers_desc="перевірка автентичності та відстеження продуктів",about_consumers="Споживачам:",about_consumers_desc="миттєва перевірка справжності продуктів через QR-коди",about_benefits_title="Ключові переваги",about_convenience="Зручність",about_convenience_desc="Швидкий доступ через QR-коди та мобільні пристрої",about_transparency="Прозорість",about_transparency_desc="Повна історія продукту доступна кожному користувачу",about_speed="Швидкість",about_speed_desc="Миттєва верифікація автентичності продуктів",about_goal_title="Наша мета",about_future_title="Технології майбутнього",about_future_desc="Використовуючи найновіші технології блокчейну, ми створюємо екосистему, де кожен продукт має свій унікальний цифровий паспорт, що гарантує його автентичність та надає повну інформацію про його історію.",about_join_title="Приєднуйтесь до нас",about_join_desc="Станьте частиною революції в сфері цифрових паспортів продуктів. Разом ми створюємо безпечніше та прозоріше майбутнє для всіх учасників ринку.",about_trust="Довіра",about_security="Безпека",about_innovation="Інновації",faq_title="Часті запитання",faq_manufacturer_q="Як виробники можуть використовувати Smart Product Passport?",faq_manufacturer_a="Виробники можуть створювати цифрові паспорти для своїх продуктів, включаючи детальну інформацію про дату виробництва, гарантію та автентичність. Це допомагає в відстеженні продуктів, управлінні гарантією та боротьбі з підробками.",faq_consumer_q="Як Smart Product Passport допомагає споживачам?",faq_consumer_a="Споживачі можуть перевіряти автентичність продуктів, отримувати інформацію про гарантію та переглядати історію продукту, просто скануючи QR-код. Це гарантує, що вони купують справжні продукти та допомагає з гарантійними вимогами.",faq_retailer_q="Які переваги надає Smart Product Passport роздрібним торговцям?",faq_retailer_a="Роздрібні торговці можуть перевіряти автентичність продуктів, ефективніше керувати запасами та надавати кращий обслуговування клієнтів, маючи миттєвий доступ до інформації про продукт. Це також допомагає будувати довіру з клієнтами.",faq_warranty_q="Як працює система гарантії?",faq_warranty_a="Кожен паспорт продукту містить інформацію про гарантію, яка зберігається в блокчейні. Це гарантує, що дані про гарантію не можуть бути підроблені та надає прозорий запис умов та положень гарантії.",faq_authenticity_q="Як я можу перевірити автентичність продукту?",faq_authenticity_a="Просто відскануйте QR-код на продукті за допомогою нашого додатку. Система миттєво перевірить автентичність продукту, перевіривши його цифровий паспорт в блокчейні, надавши вам детальну інформацію про продукт та його історію.",comics_title="Наші Комікси",comics_subtitle="Дізнайтеся більше про Smart Product Passport через наші захоплюючі комікси",comics_read_more="Читати більше",comics_view_all="Побачити всі комікси",comic_1_title="Протокол Розумних Паспортів Продуктів",comic_1_desc="Революційний протокол для створення цифрових паспортів продуктів",comic_2_title="Хакатон Solana Breakpoint",comic_2_desc="Наш проект на найбільшому хакатоні Solana",comic_3_title="Майбутнє NFT та СМАРТ-Паспортів",comic_3_desc="Як NFT технології змінюють світ продуктів",comic_4_title="Оновлення через Smart Product Passport",comic_4_desc="Легке оновлення продуктів за допомогою смарт-паспортів",comic_5_title="Скайдайвінг над футуристичним містом",comic_5_desc="Відважний політ у майбутнє технологій",comic_6_title="Оновлення драйверів з легкістю",comic_6_desc="Спрощений процес оновлення програмного забезпечення",comic_6_fullStory="Оновлення драйверів більше не є складною задачею. Smart Product Passport автоматично ідентифікує продукт та знаходить відповідні оновлення. Користувач отримує персоналізовані рекомендації та може легко встановити необхідні оновлення через QR-код.",comic_6_technology="AI алгоритми аналізують характеристики продукту та знаходять відповідні оновлення. Блокчейн забезпечує автентичність оновлень. Автоматизовані процеси зменшують технічну складність для користувачів.",full_story="Повна історія",technology_details="Технологічні деталі",close="Закрити",uk={connect_wallet,scan,passports,about,main,language,english,ukrainian,secure_storage,secure_storage_desc,qr_codes,qr_codes_desc,authenticity_check,authenticity_check_desc,how_it_works,step1,step2,step3,step4,footer_text,create_passport,manufacturer_id,additional_docs,view,none,serial_number,production_date,model,warranty_period,country_of_origin,actions,about_us,about_us_text1,about_us_text2,about_us_text3,about_mission_title,about_offerings_title,about_offerings_desc,about_manufacturers,about_manufacturers_desc,about_dealers,about_dealers_desc,about_consumers,about_consumers_desc,about_benefits_title,about_convenience,about_convenience_desc,about_transparency,about_transparency_desc,about_speed,about_speed_desc,about_goal_title,about_future_title,about_future_desc,about_join_title,about_join_desc,about_trust,about_security,about_innovation,faq_title,faq_manufacturer_q,faq_manufacturer_a,faq_consumer_q,faq_consumer_a,faq_retailer_q,faq_retailer_a,faq_warranty_q,faq_warranty_a,faq_authenticity_q,faq_authenticity_a,comics_title,comics_subtitle,comics_read_more,comics_view_all,comic_1_title,comic_1_desc,comic_2_title,comic_2_desc,comic_3_title,comic_3_desc,comic_4_title,comic_4_desc,comic_5_title,comic_5_desc,comic_6_title,comic_6_desc,comic_6_fullStory,comic_6_technology,full_story,technology_details,close,"3d_demo_title":"3D NFT демо: Скануй та отримуй!","3d_demo_desc":"Спробуйте наші можливості: обертайте 3D коробку, проскануйте QR-код та отримайте тестовий NFT. Це демонстрація для виробників, драйверів, споживачів. NFT безкоштовний!","3d_demo_nft_title":"Тестове NFT:","3d_demo_nft_desc":"Виробник: SPP Demo | Категорія: драйвери | Для тесту — відскануйте QR-код та отримайте NFT у свій гаманець Solana."};instance.use(initReactI18next).init({resources:{en:{translation:en},uk:{translation:uk}},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1}});client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React$1.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
